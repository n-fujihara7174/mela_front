{"remainingRequest":"/app/app/node_modules/babel-loader/lib/index.js!/app/app/node_modules/eslint-loader/index.js??ref--14-0!/app/app/src/js/gsapPackage/gsap-core.js","dependencies":[{"path":"/app/app/src/js/gsapPackage/gsap-core.js","mtime":499162500000},{"path":"/app/app/babel.config.js","mtime":1643593581402},{"path":"/app/app/node_modules/cache-loader/dist/cjs.js","mtime":1639906761392},{"path":"/app/app/node_modules/babel-loader/lib/index.js","mtime":1639906767681},{"path":"/app/app/node_modules/eslint-loader/index.js","mtime":1639906762562}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpOwogIHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOwogIHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7Cn0KLyohCiAqIEdTQVAgMy45LjEKICogaHR0cHM6Ly9ncmVlbnNvY2suY29tCiAqCiAqIEBsaWNlbnNlIENvcHlyaWdodCAyMDA4LTIwMjEsIEdyZWVuU29jay4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogU3ViamVjdCB0byB0aGUgdGVybXMgYXQgaHR0cHM6Ly9ncmVlbnNvY2suY29tL3N0YW5kYXJkLWxpY2Vuc2Ugb3IgZm9yCiAqIENsdWIgR3JlZW5Tb2NrIG1lbWJlcnMsIHRoZSBhZ3JlZW1lbnQgaXNzdWVkIHdpdGggdGhhdCBtZW1iZXJzaGlwLgogKiBAYXV0aG9yOiBKYWNrIERveWxlLCBqYWNrQGdyZWVuc29jay5jb20KKi8KCi8qIGVzbGludC1kaXNhYmxlICovCgoKdmFyIF9jb25maWcgPSB7CiAgYXV0b1NsZWVwOiAxMjAsCiAgZm9yY2UzRDogImF1dG8iLAogIG51bGxUYXJnZXRXYXJuOiAxLAogIHVuaXRzOiB7CiAgICBsaW5lSGVpZ2h0OiAiIgogIH0KfSwKICAgIF9kZWZhdWx0cyA9IHsKICBkdXJhdGlvbjogLjUsCiAgb3ZlcndyaXRlOiBmYWxzZSwKICBkZWxheTogMAp9LAogICAgX3N1cHByZXNzT3ZlcndyaXRlcywKICAgIF9iaWdOdW0gPSAxZTgsCiAgICBfdGlueU51bSA9IDEgLyBfYmlnTnVtLAogICAgXzJQSSA9IE1hdGguUEkgKiAyLAogICAgX0hBTEZfUEkgPSBfMlBJIC8gNCwKICAgIF9nc0lEID0gMCwKICAgIF9zcXJ0ID0gTWF0aC5zcXJ0LAogICAgX2NvcyA9IE1hdGguY29zLAogICAgX3NpbiA9IE1hdGguc2luLAogICAgX2lzU3RyaW5nID0gZnVuY3Rpb24gX2lzU3RyaW5nKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyI7Cn0sCiAgICBfaXNGdW5jdGlvbiA9IGZ1bmN0aW9uIF9pc0Z1bmN0aW9uKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gImZ1bmN0aW9uIjsKfSwKICAgIF9pc051bWJlciA9IGZ1bmN0aW9uIF9pc051bWJlcih2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICJudW1iZXIiOwp9LAogICAgX2lzVW5kZWZpbmVkID0gZnVuY3Rpb24gX2lzVW5kZWZpbmVkKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gInVuZGVmaW5lZCI7Cn0sCiAgICBfaXNPYmplY3QgPSBmdW5jdGlvbiBfaXNPYmplY3QodmFsdWUpIHsKICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAib2JqZWN0IjsKfSwKICAgIF9pc05vdEZhbHNlID0gZnVuY3Rpb24gX2lzTm90RmFsc2UodmFsdWUpIHsKICByZXR1cm4gdmFsdWUgIT09IGZhbHNlOwp9LAogICAgX3dpbmRvd0V4aXN0cyA9IGZ1bmN0aW9uIF93aW5kb3dFeGlzdHMoKSB7CiAgcmV0dXJuIHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiOwp9LAogICAgX2lzRnVuY09yU3RyaW5nID0gZnVuY3Rpb24gX2lzRnVuY09yU3RyaW5nKHZhbHVlKSB7CiAgcmV0dXJuIF9pc0Z1bmN0aW9uKHZhbHVlKSB8fCBfaXNTdHJpbmcodmFsdWUpOwp9LAogICAgX2lzVHlwZWRBcnJheSA9IHR5cGVvZiBBcnJheUJ1ZmZlciA9PT0gImZ1bmN0aW9uIiAmJiBBcnJheUJ1ZmZlci5pc1ZpZXcgfHwgZnVuY3Rpb24gKCkge30sCiAgICAvLyBub3RlOiBJRTEwIGhhcyBBcnJheUJ1ZmZlciwgYnV0IE5PVCBBcnJheUJ1ZmZlci5pc1ZpZXcoKS4KX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5LAogICAgX3N0cmljdE51bUV4cCA9IC8oPzotP1wuP1xkfFwuKSsvZ2ksCiAgICAvL29ubHkgbnVtYmVycyAoaW5jbHVkaW5nIG5lZ2F0aXZlcyBhbmQgZGVjaW1hbHMpIGJ1dCBOT1QgcmVsYXRpdmUgdmFsdWVzLgpfbnVtRXhwID0gL1stKz0uXSpcZCtbLmVcLStdKlxkKltlXC0rXSpcZCovZywKICAgIC8vZmluZHMgYW55IG51bWJlcnMsIGluY2x1ZGluZyBvbmVzIHRoYXQgc3RhcnQgd2l0aCArPSBvciAtPSwgbmVnYXRpdmUgbnVtYmVycywgYW5kIG9uZXMgaW4gc2NpZW50aWZpYyBub3RhdGlvbiBsaWtlIDFlLTguCl9udW1XaXRoVW5pdEV4cCA9IC9bLSs9Ll0qXGQrWy5lLV0qXGQqW2EteiVdKi9nLAogICAgX2NvbXBsZXhTdHJpbmdOdW1FeHAgPSAvWy0rPS5dKlxkK1wuP1xkKig/OmUtfGVcKyk/XGQqL2dpLAogICAgLy9kdXBsaWNhdGUgc28gdGhhdCB3aGlsZSB3ZSdyZSBsb29waW5nIHRocm91Z2ggbWF0Y2hlcyBmcm9tIGV4ZWMoKSwgaXQgZG9lc24ndCBjb250YW1pbmF0ZSB0aGUgbGFzdEluZGV4IG9mIF9udW1FeHAgd2hpY2ggd2UgdXNlIHRvIHNlYXJjaCBmb3IgY29sb3JzIHRvby4KX3JlbEV4cCA9IC9bKy1dPS0/Wy5cZF0rLywKICAgIF9kZWxpbWl0ZWRWYWx1ZUV4cCA9IC9bXiwnIlxbXF1cc10rL2dpLAogICAgLy8gcHJldmlvdXNseSAvWyNcLSsuXSpcYlthLXpcZFwtPSslLl0rL2dpIGJ1dCBkaWRuJ3QgY2F0Y2ggc3BlY2lhbCBjaGFyYWN0ZXJzLgpfdW5pdEV4cCA9IC9bXGQuK1wtPV0rKD86ZVstK11cZCopKi9pLAogICAgX2dsb2JhbFRpbWVsaW5lLAogICAgX3dpbiwKICAgIF9jb3JlSW5pdHRlZCwKICAgIF9kb2MsCiAgICBfZ2xvYmFscyA9IHt9LAogICAgX2luc3RhbGxTY29wZSA9IHt9LAogICAgX2NvcmVSZWFkeSwKICAgIF9pbnN0YWxsID0gZnVuY3Rpb24gX2luc3RhbGwoc2NvcGUpIHsKICByZXR1cm4gKF9pbnN0YWxsU2NvcGUgPSBfbWVyZ2Uoc2NvcGUsIF9nbG9iYWxzKSkgJiYgZ3NhcDsKfSwKICAgIF9taXNzaW5nUGx1Z2luID0gZnVuY3Rpb24gX21pc3NpbmdQbHVnaW4ocHJvcGVydHksIHZhbHVlKSB7CiAgcmV0dXJuIGNvbnNvbGUud2FybigiSW52YWxpZCBwcm9wZXJ0eSIsIHByb3BlcnR5LCAic2V0IHRvIiwgdmFsdWUsICJNaXNzaW5nIHBsdWdpbj8gZ3NhcC5yZWdpc3RlclBsdWdpbigpIik7Cn0sCiAgICBfd2FybiA9IGZ1bmN0aW9uIF93YXJuKG1lc3NhZ2UsIHN1cHByZXNzKSB7CiAgcmV0dXJuICFzdXBwcmVzcyAmJiBjb25zb2xlLndhcm4obWVzc2FnZSk7Cn0sCiAgICBfYWRkR2xvYmFsID0gZnVuY3Rpb24gX2FkZEdsb2JhbChuYW1lLCBvYmopIHsKICByZXR1cm4gbmFtZSAmJiAoX2dsb2JhbHNbbmFtZV0gPSBvYmopICYmIF9pbnN0YWxsU2NvcGUgJiYgKF9pbnN0YWxsU2NvcGVbbmFtZV0gPSBvYmopIHx8IF9nbG9iYWxzOwp9LAogICAgX2VtcHR5RnVuYyA9IGZ1bmN0aW9uIF9lbXB0eUZ1bmMoKSB7CiAgcmV0dXJuIDA7Cn0sCiAgICBfcmVzZXJ2ZWRQcm9wcyA9IHt9LAogICAgX2xhenlUd2VlbnMgPSBbXSwKICAgIF9sYXp5TG9va3VwID0ge30sCiAgICBfbGFzdFJlbmRlcmVkRnJhbWUsCiAgICBfcGx1Z2lucyA9IHt9LAogICAgX2VmZmVjdHMgPSB7fSwKICAgIF9uZXh0R0NGcmFtZSA9IDMwLAogICAgX2hhcm5lc3NQbHVnaW5zID0gW10sCiAgICBfY2FsbGJhY2tOYW1lcyA9ICIiLAogICAgX2hhcm5lc3MgPSBmdW5jdGlvbiBfaGFybmVzcyh0YXJnZXRzKSB7CiAgdmFyIHRhcmdldCA9IHRhcmdldHNbMF0sCiAgICAgIGhhcm5lc3NQbHVnaW4sCiAgICAgIGk7CiAgX2lzT2JqZWN0KHRhcmdldCkgfHwgX2lzRnVuY3Rpb24odGFyZ2V0KSB8fCAodGFyZ2V0cyA9IFt0YXJnZXRzXSk7CgogIGlmICghKGhhcm5lc3NQbHVnaW4gPSAodGFyZ2V0Ll9nc2FwIHx8IHt9KS5oYXJuZXNzKSkgewogICAgLy8gZmluZCB0aGUgZmlyc3QgdGFyZ2V0IHdpdGggYSBoYXJuZXNzLiBXZSBhc3N1bWUgdGFyZ2V0cyBwYXNzZWQgaW50byBhbiBhbmltYXRpb24gd2lsbCBiZSBvZiBzaW1pbGFyIHR5cGUsIG1lYW5pbmcgdGhlIHNhbWUga2luZCBvZiBoYXJuZXNzIGNhbiBiZSB1c2VkIGZvciB0aGVtIGFsbCAocGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uKQogICAgaSA9IF9oYXJuZXNzUGx1Z2lucy5sZW5ndGg7CgogICAgd2hpbGUgKGktLSAmJiAhX2hhcm5lc3NQbHVnaW5zW2ldLnRhcmdldFRlc3QodGFyZ2V0KSkge30KCiAgICBoYXJuZXNzUGx1Z2luID0gX2hhcm5lc3NQbHVnaW5zW2ldOwogIH0KCiAgaSA9IHRhcmdldHMubGVuZ3RoOwoKICB3aGlsZSAoaS0tKSB7CiAgICB0YXJnZXRzW2ldICYmICh0YXJnZXRzW2ldLl9nc2FwIHx8ICh0YXJnZXRzW2ldLl9nc2FwID0gbmV3IEdTQ2FjaGUodGFyZ2V0c1tpXSwgaGFybmVzc1BsdWdpbikpKSB8fCB0YXJnZXRzLnNwbGljZShpLCAxKTsKICB9CgogIHJldHVybiB0YXJnZXRzOwp9LAogICAgX2dldENhY2hlID0gZnVuY3Rpb24gX2dldENhY2hlKHRhcmdldCkgewogIHJldHVybiB0YXJnZXQuX2dzYXAgfHwgX2hhcm5lc3ModG9BcnJheSh0YXJnZXQpKVswXS5fZ3NhcDsKfSwKICAgIF9nZXRQcm9wZXJ0eSA9IGZ1bmN0aW9uIF9nZXRQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCB2KSB7CiAgcmV0dXJuICh2ID0gdGFyZ2V0W3Byb3BlcnR5XSkgJiYgX2lzRnVuY3Rpb24odikgPyB0YXJnZXRbcHJvcGVydHldKCkgOiBfaXNVbmRlZmluZWQodikgJiYgdGFyZ2V0LmdldEF0dHJpYnV0ZSAmJiB0YXJnZXQuZ2V0QXR0cmlidXRlKHByb3BlcnR5KSB8fCB2Owp9LAogICAgX2ZvckVhY2hOYW1lID0gZnVuY3Rpb24gX2ZvckVhY2hOYW1lKG5hbWVzLCBmdW5jKSB7CiAgcmV0dXJuIChuYW1lcyA9IG5hbWVzLnNwbGl0KCIsIikpLmZvckVhY2goZnVuYykgfHwgbmFtZXM7Cn0sCiAgICAvL3NwbGl0IGEgY29tbWEtZGVsaW1pdGVkIGxpc3Qgb2YgbmFtZXMgaW50byBhbiBhcnJheSwgdGhlbiBydW4gYSBmb3JFYWNoKCkgZnVuY3Rpb24gYW5kIHJldHVybiB0aGUgc3BsaXQgYXJyYXkgKHRoaXMgaXMganVzdCBhIHdheSB0byBjb25zb2xpZGF0ZS9zaG9ydGVuIHNvbWUgY29kZSkuCl9yb3VuZCA9IGZ1bmN0aW9uIF9yb3VuZCh2YWx1ZSkgewogIHJldHVybiBNYXRoLnJvdW5kKHZhbHVlICogMTAwMDAwKSAvIDEwMDAwMCB8fCAwOwp9LAogICAgX3JvdW5kUHJlY2lzZSA9IGZ1bmN0aW9uIF9yb3VuZFByZWNpc2UodmFsdWUpIHsKICByZXR1cm4gTWF0aC5yb3VuZCh2YWx1ZSAqIDEwMDAwMDAwKSAvIDEwMDAwMDAwIHx8IDA7Cn0sCiAgICAvLyBpbmNyZWFzZWQgcHJlY2lzaW9uIG1vc3RseSBmb3IgdGltaW5nIHZhbHVlcy4KX2FycmF5Q29udGFpbnNBbnkgPSBmdW5jdGlvbiBfYXJyYXlDb250YWluc0FueSh0b1NlYXJjaCwgdG9GaW5kKSB7CiAgLy9zZWFyY2hlcyBvbmUgYXJyYXkgdG8gZmluZCBtYXRjaGVzIGZvciBhbnkgb2YgdGhlIGl0ZW1zIGluIHRoZSB0b0ZpbmQgYXJyYXkuIEFzIHNvb24gYXMgb25lIGlzIGZvdW5kLCBpdCByZXR1cm5zIHRydWUuIEl0IGRvZXMgTk9UIHJldHVybiBhbGwgdGhlIG1hdGNoZXM7IGl0J3Mgc2ltcGx5IGEgYm9vbGVhbiBzZWFyY2guCiAgdmFyIGwgPSB0b0ZpbmQubGVuZ3RoLAogICAgICBpID0gMDsKCiAgZm9yICg7IHRvU2VhcmNoLmluZGV4T2YodG9GaW5kW2ldKSA8IDAgJiYgKytpIDwgbDspIHt9CgogIHJldHVybiBpIDwgbDsKfSwKICAgIF9sYXp5UmVuZGVyID0gZnVuY3Rpb24gX2xhenlSZW5kZXIoKSB7CiAgdmFyIGwgPSBfbGF6eVR3ZWVucy5sZW5ndGgsCiAgICAgIGEgPSBfbGF6eVR3ZWVucy5zbGljZSgwKSwKICAgICAgaSwKICAgICAgdHdlZW47CgogIF9sYXp5TG9va3VwID0ge307CiAgX2xhenlUd2VlbnMubGVuZ3RoID0gMDsKCiAgZm9yIChpID0gMDsgaSA8IGw7IGkrKykgewogICAgdHdlZW4gPSBhW2ldOwogICAgdHdlZW4gJiYgdHdlZW4uX2xhenkgJiYgKHR3ZWVuLnJlbmRlcih0d2Vlbi5fbGF6eVswXSwgdHdlZW4uX2xhenlbMV0sIHRydWUpLl9sYXp5ID0gMCk7CiAgfQp9LAogICAgX2xhenlTYWZlUmVuZGVyID0gZnVuY3Rpb24gX2xhenlTYWZlUmVuZGVyKGFuaW1hdGlvbiwgdGltZSwgc3VwcHJlc3NFdmVudHMsIGZvcmNlKSB7CiAgX2xhenlUd2VlbnMubGVuZ3RoICYmIF9sYXp5UmVuZGVyKCk7CiAgYW5pbWF0aW9uLnJlbmRlcih0aW1lLCBzdXBwcmVzc0V2ZW50cywgZm9yY2UpOwogIF9sYXp5VHdlZW5zLmxlbmd0aCAmJiBfbGF6eVJlbmRlcigpOyAvL2luIGNhc2UgcmVuZGVyaW5nIGNhdXNlZCBhbnkgdHdlZW5zIHRvIGxhenktaW5pdCwgd2Ugc2hvdWxkIHJlbmRlciB0aGVtIGJlY2F1c2UgdHlwaWNhbGx5IHdoZW4gc29tZW9uZSBjYWxscyBzZWVrKCkgb3IgdGltZSgpIG9yIHByb2dyZXNzKCksIHRoZXkgZXhwZWN0IGFuIGltbWVkaWF0ZSByZW5kZXIuCn0sCiAgICBfbnVtZXJpY0lmUG9zc2libGUgPSBmdW5jdGlvbiBfbnVtZXJpY0lmUG9zc2libGUodmFsdWUpIHsKICB2YXIgbiA9IHBhcnNlRmxvYXQodmFsdWUpOwogIHJldHVybiAobiB8fCBuID09PSAwKSAmJiAodmFsdWUgKyAiIikubWF0Y2goX2RlbGltaXRlZFZhbHVlRXhwKS5sZW5ndGggPCAyID8gbiA6IF9pc1N0cmluZyh2YWx1ZSkgPyB2YWx1ZS50cmltKCkgOiB2YWx1ZTsKfSwKICAgIF9wYXNzVGhyb3VnaCA9IGZ1bmN0aW9uIF9wYXNzVGhyb3VnaChwKSB7CiAgcmV0dXJuIHA7Cn0sCiAgICBfc2V0RGVmYXVsdHMgPSBmdW5jdGlvbiBfc2V0RGVmYXVsdHMob2JqLCBkZWZhdWx0cykgewogIGZvciAodmFyIHAgaW4gZGVmYXVsdHMpIHsKICAgIHAgaW4gb2JqIHx8IChvYmpbcF0gPSBkZWZhdWx0c1twXSk7CiAgfQoKICByZXR1cm4gb2JqOwp9LAogICAgX3NldEtleWZyYW1lRGVmYXVsdHMgPSBmdW5jdGlvbiBfc2V0S2V5ZnJhbWVEZWZhdWx0cyhleGNsdWRlRHVyYXRpb24pIHsKICByZXR1cm4gZnVuY3Rpb24gKG9iaiwgZGVmYXVsdHMpIHsKICAgIGZvciAodmFyIHAgaW4gZGVmYXVsdHMpIHsKICAgICAgcCBpbiBvYmogfHwgcCA9PT0gImR1cmF0aW9uIiAmJiBleGNsdWRlRHVyYXRpb24gfHwgcCA9PT0gImVhc2UiIHx8IChvYmpbcF0gPSBkZWZhdWx0c1twXSk7CiAgICB9CiAgfTsKfSwKICAgIF9tZXJnZSA9IGZ1bmN0aW9uIF9tZXJnZShiYXNlLCB0b01lcmdlKSB7CiAgZm9yICh2YXIgcCBpbiB0b01lcmdlKSB7CiAgICBiYXNlW3BdID0gdG9NZXJnZVtwXTsKICB9CgogIHJldHVybiBiYXNlOwp9LAogICAgX21lcmdlRGVlcCA9IGZ1bmN0aW9uIF9tZXJnZURlZXAoYmFzZSwgdG9NZXJnZSkgewogIGZvciAodmFyIHAgaW4gdG9NZXJnZSkgewogICAgcCAhPT0gIl9fcHJvdG9fXyIgJiYgcCAhPT0gImNvbnN0cnVjdG9yIiAmJiBwICE9PSAicHJvdG90eXBlIiAmJiAoYmFzZVtwXSA9IF9pc09iamVjdCh0b01lcmdlW3BdKSA/IF9tZXJnZURlZXAoYmFzZVtwXSB8fCAoYmFzZVtwXSA9IHt9KSwgdG9NZXJnZVtwXSkgOiB0b01lcmdlW3BdKTsKICB9CgogIHJldHVybiBiYXNlOwp9LAogICAgX2NvcHlFeGNsdWRpbmcgPSBmdW5jdGlvbiBfY29weUV4Y2x1ZGluZyhvYmosIGV4Y2x1ZGluZykgewogIHZhciBjb3B5ID0ge30sCiAgICAgIHA7CgogIGZvciAocCBpbiBvYmopIHsKICAgIHAgaW4gZXhjbHVkaW5nIHx8IChjb3B5W3BdID0gb2JqW3BdKTsKICB9CgogIHJldHVybiBjb3B5Owp9LAogICAgX2luaGVyaXREZWZhdWx0cyA9IGZ1bmN0aW9uIF9pbmhlcml0RGVmYXVsdHModmFycykgewogIHZhciBwYXJlbnQgPSB2YXJzLnBhcmVudCB8fCBfZ2xvYmFsVGltZWxpbmUsCiAgICAgIGZ1bmMgPSB2YXJzLmtleWZyYW1lcyA/IF9zZXRLZXlmcmFtZURlZmF1bHRzKF9pc0FycmF5KHZhcnMua2V5ZnJhbWVzKSkgOiBfc2V0RGVmYXVsdHM7CgogIGlmIChfaXNOb3RGYWxzZSh2YXJzLmluaGVyaXQpKSB7CiAgICB3aGlsZSAocGFyZW50KSB7CiAgICAgIGZ1bmModmFycywgcGFyZW50LnZhcnMuZGVmYXVsdHMpOwogICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50IHx8IHBhcmVudC5fZHA7CiAgICB9CiAgfQoKICByZXR1cm4gdmFyczsKfSwKICAgIF9hcnJheXNNYXRjaCA9IGZ1bmN0aW9uIF9hcnJheXNNYXRjaChhMSwgYTIpIHsKICB2YXIgaSA9IGExLmxlbmd0aCwKICAgICAgbWF0Y2ggPSBpID09PSBhMi5sZW5ndGg7CgogIHdoaWxlIChtYXRjaCAmJiBpLS0gJiYgYTFbaV0gPT09IGEyW2ldKSB7fQoKICByZXR1cm4gaSA8IDA7Cn0sCiAgICBfYWRkTGlua2VkTGlzdEl0ZW0gPSBmdW5jdGlvbiBfYWRkTGlua2VkTGlzdEl0ZW0ocGFyZW50LCBjaGlsZCwgZmlyc3RQcm9wLCBsYXN0UHJvcCwgc29ydEJ5KSB7CiAgaWYgKGZpcnN0UHJvcCA9PT0gdm9pZCAwKSB7CiAgICBmaXJzdFByb3AgPSAiX2ZpcnN0IjsKICB9CgogIGlmIChsYXN0UHJvcCA9PT0gdm9pZCAwKSB7CiAgICBsYXN0UHJvcCA9ICJfbGFzdCI7CiAgfQoKICB2YXIgcHJldiA9IHBhcmVudFtsYXN0UHJvcF0sCiAgICAgIHQ7CgogIGlmIChzb3J0QnkpIHsKICAgIHQgPSBjaGlsZFtzb3J0QnldOwoKICAgIHdoaWxlIChwcmV2ICYmIHByZXZbc29ydEJ5XSA+IHQpIHsKICAgICAgcHJldiA9IHByZXYuX3ByZXY7CiAgICB9CiAgfQoKICBpZiAocHJldikgewogICAgY2hpbGQuX25leHQgPSBwcmV2Ll9uZXh0OwogICAgcHJldi5fbmV4dCA9IGNoaWxkOwogIH0gZWxzZSB7CiAgICBjaGlsZC5fbmV4dCA9IHBhcmVudFtmaXJzdFByb3BdOwogICAgcGFyZW50W2ZpcnN0UHJvcF0gPSBjaGlsZDsKICB9CgogIGlmIChjaGlsZC5fbmV4dCkgewogICAgY2hpbGQuX25leHQuX3ByZXYgPSBjaGlsZDsKICB9IGVsc2UgewogICAgcGFyZW50W2xhc3RQcm9wXSA9IGNoaWxkOwogIH0KCiAgY2hpbGQuX3ByZXYgPSBwcmV2OwogIGNoaWxkLnBhcmVudCA9IGNoaWxkLl9kcCA9IHBhcmVudDsKICByZXR1cm4gY2hpbGQ7Cn0sCiAgICBfcmVtb3ZlTGlua2VkTGlzdEl0ZW0gPSBmdW5jdGlvbiBfcmVtb3ZlTGlua2VkTGlzdEl0ZW0ocGFyZW50LCBjaGlsZCwgZmlyc3RQcm9wLCBsYXN0UHJvcCkgewogIGlmIChmaXJzdFByb3AgPT09IHZvaWQgMCkgewogICAgZmlyc3RQcm9wID0gIl9maXJzdCI7CiAgfQoKICBpZiAobGFzdFByb3AgPT09IHZvaWQgMCkgewogICAgbGFzdFByb3AgPSAiX2xhc3QiOwogIH0KCiAgdmFyIHByZXYgPSBjaGlsZC5fcHJldiwKICAgICAgbmV4dCA9IGNoaWxkLl9uZXh0OwoKICBpZiAocHJldikgewogICAgcHJldi5fbmV4dCA9IG5leHQ7CiAgfSBlbHNlIGlmIChwYXJlbnRbZmlyc3RQcm9wXSA9PT0gY2hpbGQpIHsKICAgIHBhcmVudFtmaXJzdFByb3BdID0gbmV4dDsKICB9CgogIGlmIChuZXh0KSB7CiAgICBuZXh0Ll9wcmV2ID0gcHJldjsKICB9IGVsc2UgaWYgKHBhcmVudFtsYXN0UHJvcF0gPT09IGNoaWxkKSB7CiAgICBwYXJlbnRbbGFzdFByb3BdID0gcHJldjsKICB9CgogIGNoaWxkLl9uZXh0ID0gY2hpbGQuX3ByZXYgPSBjaGlsZC5wYXJlbnQgPSBudWxsOyAvLyBkb24ndCBkZWxldGUgdGhlIF9kcCBqdXN0IHNvIHdlIGNhbiByZXZlcnQgaWYgbmVjZXNzYXJ5LiBCdXQgcGFyZW50IHNob3VsZCBiZSBudWxsIHRvIGluZGljYXRlIHRoZSBpdGVtIGlzbid0IGluIGEgbGlua2VkIGxpc3QuCn0sCiAgICBfcmVtb3ZlRnJvbVBhcmVudCA9IGZ1bmN0aW9uIF9yZW1vdmVGcm9tUGFyZW50KGNoaWxkLCBvbmx5SWZQYXJlbnRIYXNBdXRvUmVtb3ZlKSB7CiAgY2hpbGQucGFyZW50ICYmICghb25seUlmUGFyZW50SGFzQXV0b1JlbW92ZSB8fCBjaGlsZC5wYXJlbnQuYXV0b1JlbW92ZUNoaWxkcmVuKSAmJiBjaGlsZC5wYXJlbnQucmVtb3ZlKGNoaWxkKTsKICBjaGlsZC5fYWN0ID0gMDsKfSwKICAgIF91bmNhY2hlID0gZnVuY3Rpb24gX3VuY2FjaGUoYW5pbWF0aW9uLCBjaGlsZCkgewogIGlmIChhbmltYXRpb24gJiYgKCFjaGlsZCB8fCBjaGlsZC5fZW5kID4gYW5pbWF0aW9uLl9kdXIgfHwgY2hpbGQuX3N0YXJ0IDwgMCkpIHsKICAgIC8vIHBlcmZvcm1hbmNlIG9wdGltaXphdGlvbjogaWYgYSBjaGlsZCBhbmltYXRpb24gaXMgcGFzc2VkIGluIHdlIHNob3VsZCBvbmx5IHVuY2FjaGUgaWYgdGhhdCBjaGlsZCBFWFRFTkRTIHRoZSBhbmltYXRpb24gKGl0cyBlbmQgdGltZSBpcyBiZXlvbmQgdGhlIGVuZCkKICAgIHZhciBhID0gYW5pbWF0aW9uOwoKICAgIHdoaWxlIChhKSB7CiAgICAgIGEuX2RpcnR5ID0gMTsKICAgICAgYSA9IGEucGFyZW50OwogICAgfQogIH0KCiAgcmV0dXJuIGFuaW1hdGlvbjsKfSwKICAgIF9yZWNhY2hlQW5jZXN0b3JzID0gZnVuY3Rpb24gX3JlY2FjaGVBbmNlc3RvcnMoYW5pbWF0aW9uKSB7CiAgdmFyIHBhcmVudCA9IGFuaW1hdGlvbi5wYXJlbnQ7CgogIHdoaWxlIChwYXJlbnQgJiYgcGFyZW50LnBhcmVudCkgewogICAgLy9zb21ldGltZXMgd2UgbXVzdCBmb3JjZSBhIHJlLXNvcnQgb2YgYWxsIGNoaWxkcmVuIGFuZCB1cGRhdGUgdGhlIGR1cmF0aW9uL3RvdGFsRHVyYXRpb24gb2YgYWxsIGFuY2VzdG9yIHRpbWVsaW5lcyBpbW1lZGlhdGVseSBpbiBjYXNlLCBmb3IgZXhhbXBsZSwgaW4gdGhlIG1pZGRsZSBvZiBhIHJlbmRlciBsb29wLCBvbmUgdHdlZW4gYWx0ZXJzIGFub3RoZXIgdHdlZW4ncyB0aW1lU2NhbGUgd2hpY2ggc2hvdmVzIGl0cyBzdGFydFRpbWUgYmVmb3JlIDAsIGZvcmNpbmcgdGhlIHBhcmVudCB0aW1lbGluZSB0byBzaGlmdCBhcm91bmQgYW5kIHNoaWZ0Q2hpbGRyZW4oKSB3aGljaCBjb3VsZCBhZmZlY3QgdGhhdCBuZXh0IHR3ZWVuJ3MgcmVuZGVyIChzdGFydFRpbWUpLiBEb2Vzbid0IG1hdHRlciBmb3IgdGhlIHJvb3QgdGltZWxpbmUgdGhvdWdoLgogICAgcGFyZW50Ll9kaXJ0eSA9IDE7CiAgICBwYXJlbnQudG90YWxEdXJhdGlvbigpOwogICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDsKICB9CgogIHJldHVybiBhbmltYXRpb247Cn0sCiAgICBfaGFzTm9QYXVzZWRBbmNlc3RvcnMgPSBmdW5jdGlvbiBfaGFzTm9QYXVzZWRBbmNlc3RvcnMoYW5pbWF0aW9uKSB7CiAgcmV0dXJuICFhbmltYXRpb24gfHwgYW5pbWF0aW9uLl90cyAmJiBfaGFzTm9QYXVzZWRBbmNlc3RvcnMoYW5pbWF0aW9uLnBhcmVudCk7Cn0sCiAgICBfZWxhcHNlZEN5Y2xlRHVyYXRpb24gPSBmdW5jdGlvbiBfZWxhcHNlZEN5Y2xlRHVyYXRpb24oYW5pbWF0aW9uKSB7CiAgcmV0dXJuIGFuaW1hdGlvbi5fcmVwZWF0ID8gX2FuaW1hdGlvbkN5Y2xlKGFuaW1hdGlvbi5fdFRpbWUsIGFuaW1hdGlvbiA9IGFuaW1hdGlvbi5kdXJhdGlvbigpICsgYW5pbWF0aW9uLl9yRGVsYXkpICogYW5pbWF0aW9uIDogMDsKfSwKICAgIC8vIGZlZWQgaW4gdGhlIHRvdGFsVGltZSBhbmQgY3ljbGVEdXJhdGlvbiBhbmQgaXQnbGwgcmV0dXJuIHRoZSBjeWNsZSAoaXRlcmF0aW9uIG1pbnVzIDEpIGFuZCBpZiB0aGUgcGxheWhlYWQgaXMgZXhhY3RseSBhdCB0aGUgdmVyeSBFTkQsIGl0IHdpbGwgTk9UIGJ1bXAgdXAgdG8gdGhlIG5leHQgY3ljbGUuCl9hbmltYXRpb25DeWNsZSA9IGZ1bmN0aW9uIF9hbmltYXRpb25DeWNsZSh0VGltZSwgY3ljbGVEdXJhdGlvbikgewogIHZhciB3aG9sZSA9IE1hdGguZmxvb3IodFRpbWUgLz0gY3ljbGVEdXJhdGlvbik7CiAgcmV0dXJuIHRUaW1lICYmIHdob2xlID09PSB0VGltZSA/IHdob2xlIC0gMSA6IHdob2xlOwp9LAogICAgX3BhcmVudFRvQ2hpbGRUb3RhbFRpbWUgPSBmdW5jdGlvbiBfcGFyZW50VG9DaGlsZFRvdGFsVGltZShwYXJlbnRUaW1lLCBjaGlsZCkgewogIHJldHVybiAocGFyZW50VGltZSAtIGNoaWxkLl9zdGFydCkgKiBjaGlsZC5fdHMgKyAoY2hpbGQuX3RzID49IDAgPyAwIDogY2hpbGQuX2RpcnR5ID8gY2hpbGQudG90YWxEdXJhdGlvbigpIDogY2hpbGQuX3REdXIpOwp9LAogICAgX3NldEVuZCA9IGZ1bmN0aW9uIF9zZXRFbmQoYW5pbWF0aW9uKSB7CiAgcmV0dXJuIGFuaW1hdGlvbi5fZW5kID0gX3JvdW5kUHJlY2lzZShhbmltYXRpb24uX3N0YXJ0ICsgKGFuaW1hdGlvbi5fdER1ciAvIE1hdGguYWJzKGFuaW1hdGlvbi5fdHMgfHwgYW5pbWF0aW9uLl9ydHMgfHwgX3RpbnlOdW0pIHx8IDApKTsKfSwKICAgIF9hbGlnblBsYXloZWFkID0gZnVuY3Rpb24gX2FsaWduUGxheWhlYWQoYW5pbWF0aW9uLCB0b3RhbFRpbWUpIHsKICAvLyBhZGp1c3RzIHRoZSBhbmltYXRpb24ncyBfc3RhcnQgYW5kIF9lbmQgYWNjb3JkaW5nIHRvIHRoZSBwcm92aWRlZCB0b3RhbFRpbWUgKG9ubHkgaWYgdGhlIHBhcmVudCdzIHNtb290aENoaWxkVGltaW5nIGlzIHRydWUgYW5kIHRoZSBhbmltYXRpb24gaXNuJ3QgcGF1c2VkKS4gSXQgZG9lc24ndCBkbyBhbnkgcmVuZGVyaW5nIG9yIGZvcmNpbmcgdGhpbmdzIGJhY2sgaW50byBwYXJlbnQgdGltZWxpbmVzLCBldGMuIC0gdGhhdCdzIHdoYXQgdG90YWxUaW1lKCkgaXMgZm9yLgogIHZhciBwYXJlbnQgPSBhbmltYXRpb24uX2RwOwoKICBpZiAocGFyZW50ICYmIHBhcmVudC5zbW9vdGhDaGlsZFRpbWluZyAmJiBhbmltYXRpb24uX3RzKSB7CiAgICBhbmltYXRpb24uX3N0YXJ0ID0gX3JvdW5kUHJlY2lzZShwYXJlbnQuX3RpbWUgLSAoYW5pbWF0aW9uLl90cyA+IDAgPyB0b3RhbFRpbWUgLyBhbmltYXRpb24uX3RzIDogKChhbmltYXRpb24uX2RpcnR5ID8gYW5pbWF0aW9uLnRvdGFsRHVyYXRpb24oKSA6IGFuaW1hdGlvbi5fdER1cikgLSB0b3RhbFRpbWUpIC8gLWFuaW1hdGlvbi5fdHMpKTsKCiAgICBfc2V0RW5kKGFuaW1hdGlvbik7CgogICAgcGFyZW50Ll9kaXJ0eSB8fCBfdW5jYWNoZShwYXJlbnQsIGFuaW1hdGlvbik7IC8vZm9yIHBlcmZvcm1hbmNlIGltcHJvdmVtZW50LiBJZiB0aGUgcGFyZW50J3MgY2FjaGUgaXMgYWxyZWFkeSBkaXJ0eSwgaXQgYWxyZWFkeSB0b29rIGNhcmUgb2YgbWFya2luZyB0aGUgYW5jZXN0b3JzIGFzIGRpcnR5IHRvbywgc28gc2tpcCB0aGUgZnVuY3Rpb24gY2FsbCBoZXJlLgogIH0KCiAgcmV0dXJuIGFuaW1hdGlvbjsKfSwKCi8qCl90b3RhbFRpbWVUb1RpbWUgPSAoY2xhbXBlZFRvdGFsVGltZSwgZHVyYXRpb24sIHJlcGVhdCwgcmVwZWF0RGVsYXksIHlveW8pID0+IHsKCWxldCBjeWNsZUR1cmF0aW9uID0gZHVyYXRpb24gKyByZXBlYXREZWxheSwKCQl0aW1lID0gX3JvdW5kKGNsYW1wZWRUb3RhbFRpbWUgJSBjeWNsZUR1cmF0aW9uKTsKCWlmICh0aW1lID4gZHVyYXRpb24pIHsKCQl0aW1lID0gZHVyYXRpb247Cgl9CglyZXR1cm4gKHlveW8gJiYgKH5+KGNsYW1wZWRUb3RhbFRpbWUgLyBjeWNsZUR1cmF0aW9uKSAmIDEpKSA/IGR1cmF0aW9uIC0gdGltZSA6IHRpbWU7Cn0sCiovCl9wb3N0QWRkQ2hlY2tzID0gZnVuY3Rpb24gX3Bvc3RBZGRDaGVja3ModGltZWxpbmUsIGNoaWxkKSB7CiAgdmFyIHQ7CgogIGlmIChjaGlsZC5fdGltZSB8fCBjaGlsZC5faW5pdHRlZCAmJiAhY2hpbGQuX2R1cikgewogICAgLy9pbiBjYXNlLCBmb3IgZXhhbXBsZSwgdGhlIF9zdGFydCBpcyBtb3ZlZCBvbiBhIHR3ZWVuIHRoYXQgaGFzIGFscmVhZHkgcmVuZGVyZWQuIEltYWdpbmUgaXQncyBhdCBpdHMgZW5kIHN0YXRlLCB0aGVuIHRoZSBzdGFydFRpbWUgaXMgbW92ZWQgV0FZIGxhdGVyIChhZnRlciB0aGUgZW5kIG9mIHRoaXMgdGltZWxpbmUpLCBpdCBzaG91bGQgcmVuZGVyIGF0IGl0cyBiZWdpbm5pbmcuCiAgICB0ID0gX3BhcmVudFRvQ2hpbGRUb3RhbFRpbWUodGltZWxpbmUucmF3VGltZSgpLCBjaGlsZCk7CgogICAgaWYgKCFjaGlsZC5fZHVyIHx8IF9jbGFtcCgwLCBjaGlsZC50b3RhbER1cmF0aW9uKCksIHQpIC0gY2hpbGQuX3RUaW1lID4gX3RpbnlOdW0pIHsKICAgICAgY2hpbGQucmVuZGVyKHQsIHRydWUpOwogICAgfQogIH0gLy9pZiB0aGUgdGltZWxpbmUgaGFzIGFscmVhZHkgZW5kZWQgYnV0IHRoZSBpbnNlcnRlZCB0d2Vlbi90aW1lbGluZSBleHRlbmRzIHRoZSBkdXJhdGlvbiwgd2Ugc2hvdWxkIGVuYWJsZSB0aGlzIHRpbWVsaW5lIGFnYWluIHNvIHRoYXQgaXQgcmVuZGVycyBwcm9wZXJseS4gV2Ugc2hvdWxkIGFsc28gYWxpZ24gdGhlIHBsYXloZWFkIHdpdGggdGhlIHBhcmVudCB0aW1lbGluZSdzIHdoZW4gYXBwcm9wcmlhdGUuCgoKICBpZiAoX3VuY2FjaGUodGltZWxpbmUsIGNoaWxkKS5fZHAgJiYgdGltZWxpbmUuX2luaXR0ZWQgJiYgdGltZWxpbmUuX3RpbWUgPj0gdGltZWxpbmUuX2R1ciAmJiB0aW1lbGluZS5fdHMpIHsKICAgIC8vaW4gY2FzZSBhbnkgb2YgdGhlIGFuY2VzdG9ycyBoYWQgY29tcGxldGVkIGJ1dCBzaG91bGQgbm93IGJlIGVuYWJsZWQuLi4KICAgIGlmICh0aW1lbGluZS5fZHVyIDwgdGltZWxpbmUuZHVyYXRpb24oKSkgewogICAgICB0ID0gdGltZWxpbmU7CgogICAgICB3aGlsZSAodC5fZHApIHsKICAgICAgICB0LnJhd1RpbWUoKSA+PSAwICYmIHQudG90YWxUaW1lKHQuX3RUaW1lKTsgLy9tb3ZlcyB0aGUgdGltZWxpbmUgKHNoaWZ0cyBpdHMgc3RhcnRUaW1lKSBpZiBuZWNlc3NhcnksIGFuZCBhbHNvIGVuYWJsZXMgaXQuIElmIGl0J3MgY3VycmVudGx5IHplcm8sIHRob3VnaCwgaXQgbWF5IG5vdCBiZSBzY2hlZHVsZWQgdG8gcmVuZGVyIHVudGlsIGxhdGVyIHNvIHRoZXJlJ3Mgbm8gbmVlZCB0byBmb3JjZSBpdCB0byBhbGlnbiB3aXRoIHRoZSBjdXJyZW50IHBsYXloZWFkIHBvc2l0aW9uLiBPbmx5IG1vdmUgdG8gY2F0Y2ggdXAgd2l0aCB0aGUgcGxheWhlYWQuCgogICAgICAgIHQgPSB0Ll9kcDsKICAgICAgfQogICAgfQoKICAgIHRpbWVsaW5lLl96VGltZSA9IC1fdGlueU51bTsgLy8gaGVscHMgZW5zdXJlIHRoYXQgdGhlIG5leHQgcmVuZGVyKCkgd2lsbCBiZSBmb3JjZWQgKGNyb3NzaW5nU3RhcnQgPSB0cnVlIGluIHJlbmRlcigpKSwgZXZlbiBpZiB0aGUgZHVyYXRpb24gaGFzbid0IGNoYW5nZWQgKHdlJ3JlIGFkZGluZyBhIGNoaWxkIHdoaWNoIHdvdWxkIG5lZWQgdG8gZ2V0IHJlbmRlcmVkKS4gRGVmaW5pdGVseSBhbiBlZGdlIGNhc2UuIE5vdGU6IHdlIE1VU1QgZG8gdGhpcyBBRlRFUiB0aGUgbG9vcCBhYm92ZSB3aGVyZSB0aGUgdG90YWxUaW1lKCkgbWlnaHQgdHJpZ2dlciBhIHJlbmRlcigpIGJlY2F1c2UgdGhpcyBfYWRkVG9UaW1lbGluZSgpIG1ldGhvZCBnZXRzIGNhbGxlZCBmcm9tIHRoZSBBbmltYXRpb24gY29uc3RydWN0b3IsIEJFRk9SRSB0d2VlbnMgZXZlbiByZWNvcmQgdGhlaXIgdGFyZ2V0cywgZXRjLiBzbyB3ZSB3b3VsZG4ndCB3YW50IHRoaW5ncyB0byBnZXQgdHJpZ2dlcmVkIGluIHRoZSB3cm9uZyBvcmRlci4KICB9Cn0sCiAgICBfYWRkVG9UaW1lbGluZSA9IGZ1bmN0aW9uIF9hZGRUb1RpbWVsaW5lKHRpbWVsaW5lLCBjaGlsZCwgcG9zaXRpb24sIHNraXBDaGVja3MpIHsKICBjaGlsZC5wYXJlbnQgJiYgX3JlbW92ZUZyb21QYXJlbnQoY2hpbGQpOwogIGNoaWxkLl9zdGFydCA9IF9yb3VuZFByZWNpc2UoKF9pc051bWJlcihwb3NpdGlvbikgPyBwb3NpdGlvbiA6IHBvc2l0aW9uIHx8IHRpbWVsaW5lICE9PSBfZ2xvYmFsVGltZWxpbmUgPyBfcGFyc2VQb3NpdGlvbih0aW1lbGluZSwgcG9zaXRpb24sIGNoaWxkKSA6IHRpbWVsaW5lLl90aW1lKSArIGNoaWxkLl9kZWxheSk7CiAgY2hpbGQuX2VuZCA9IF9yb3VuZFByZWNpc2UoY2hpbGQuX3N0YXJ0ICsgKGNoaWxkLnRvdGFsRHVyYXRpb24oKSAvIE1hdGguYWJzKGNoaWxkLnRpbWVTY2FsZSgpKSB8fCAwKSk7CgogIF9hZGRMaW5rZWRMaXN0SXRlbSh0aW1lbGluZSwgY2hpbGQsICJfZmlyc3QiLCAiX2xhc3QiLCB0aW1lbGluZS5fc29ydCA/ICJfc3RhcnQiIDogMCk7CgogIF9pc0Zyb21PckZyb21TdGFydChjaGlsZCkgfHwgKHRpbWVsaW5lLl9yZWNlbnQgPSBjaGlsZCk7CiAgc2tpcENoZWNrcyB8fCBfcG9zdEFkZENoZWNrcyh0aW1lbGluZSwgY2hpbGQpOwogIHJldHVybiB0aW1lbGluZTsKfSwKICAgIF9zY3JvbGxUcmlnZ2VyID0gZnVuY3Rpb24gX3Njcm9sbFRyaWdnZXIoYW5pbWF0aW9uLCB0cmlnZ2VyKSB7CiAgcmV0dXJuIChfZ2xvYmFscy5TY3JvbGxUcmlnZ2VyIHx8IF9taXNzaW5nUGx1Z2luKCJzY3JvbGxUcmlnZ2VyIiwgdHJpZ2dlcikpICYmIF9nbG9iYWxzLlNjcm9sbFRyaWdnZXIuY3JlYXRlKHRyaWdnZXIsIGFuaW1hdGlvbik7Cn0sCiAgICBfYXR0ZW1wdEluaXRUd2VlbiA9IGZ1bmN0aW9uIF9hdHRlbXB0SW5pdFR3ZWVuKHR3ZWVuLCB0b3RhbFRpbWUsIGZvcmNlLCBzdXBwcmVzc0V2ZW50cykgewogIF9pbml0VHdlZW4odHdlZW4sIHRvdGFsVGltZSk7CgogIGlmICghdHdlZW4uX2luaXR0ZWQpIHsKICAgIHJldHVybiAxOwogIH0KCiAgaWYgKCFmb3JjZSAmJiB0d2Vlbi5fcHQgJiYgKHR3ZWVuLl9kdXIgJiYgdHdlZW4udmFycy5sYXp5ICE9PSBmYWxzZSB8fCAhdHdlZW4uX2R1ciAmJiB0d2Vlbi52YXJzLmxhenkpICYmIF9sYXN0UmVuZGVyZWRGcmFtZSAhPT0gX3RpY2tlci5mcmFtZSkgewogICAgX2xhenlUd2VlbnMucHVzaCh0d2Vlbik7CgogICAgdHdlZW4uX2xhenkgPSBbdG90YWxUaW1lLCBzdXBwcmVzc0V2ZW50c107CiAgICByZXR1cm4gMTsKICB9Cn0sCiAgICBfcGFyZW50UGxheWhlYWRJc0JlZm9yZVN0YXJ0ID0gZnVuY3Rpb24gX3BhcmVudFBsYXloZWFkSXNCZWZvcmVTdGFydChfcmVmKSB7CiAgdmFyIHBhcmVudCA9IF9yZWYucGFyZW50OwogIHJldHVybiBwYXJlbnQgJiYgcGFyZW50Ll90cyAmJiBwYXJlbnQuX2luaXR0ZWQgJiYgIXBhcmVudC5fbG9jayAmJiAocGFyZW50LnJhd1RpbWUoKSA8IDAgfHwgX3BhcmVudFBsYXloZWFkSXNCZWZvcmVTdGFydChwYXJlbnQpKTsKfSwKICAgIC8vIGNoZWNrIHBhcmVudCdzIF9sb2NrIGJlY2F1c2Ugd2hlbiBhIHRpbWVsaW5lIHJlcGVhdHMveW95b3MgYW5kIGRvZXMgaXRzIGFydGlmaWNpYWwgd3JhcHBpbmcsIHdlIHNob3VsZG4ndCBmb3JjZSB0aGUgcmF0aW8gYmFjayB0byAwCl9pc0Zyb21PckZyb21TdGFydCA9IGZ1bmN0aW9uIF9pc0Zyb21PckZyb21TdGFydChfcmVmMikgewogIHZhciBkYXRhID0gX3JlZjIuZGF0YTsKICByZXR1cm4gZGF0YSA9PT0gImlzRnJvbVN0YXJ0IiB8fCBkYXRhID09PSAiaXNTdGFydCI7Cn0sCiAgICBfcmVuZGVyWmVyb0R1cmF0aW9uVHdlZW4gPSBmdW5jdGlvbiBfcmVuZGVyWmVyb0R1cmF0aW9uVHdlZW4odHdlZW4sIHRvdGFsVGltZSwgc3VwcHJlc3NFdmVudHMsIGZvcmNlKSB7CiAgdmFyIHByZXZSYXRpbyA9IHR3ZWVuLnJhdGlvLAogICAgICByYXRpbyA9IHRvdGFsVGltZSA8IDAgfHwgIXRvdGFsVGltZSAmJiAoIXR3ZWVuLl9zdGFydCAmJiBfcGFyZW50UGxheWhlYWRJc0JlZm9yZVN0YXJ0KHR3ZWVuKSAmJiAhKCF0d2Vlbi5faW5pdHRlZCAmJiBfaXNGcm9tT3JGcm9tU3RhcnQodHdlZW4pKSB8fCAodHdlZW4uX3RzIDwgMCB8fCB0d2Vlbi5fZHAuX3RzIDwgMCkgJiYgIV9pc0Zyb21PckZyb21TdGFydCh0d2VlbikpID8gMCA6IDEsCiAgICAgIC8vIGlmIHRoZSB0d2VlbiBvciBpdHMgcGFyZW50IGlzIHJldmVyc2VkIGFuZCB0aGUgdG90YWxUaW1lIGlzIDAsIHdlIHNob3VsZCBnbyB0byBhIHJhdGlvIG9mIDAuIEVkZ2UgY2FzZTogaWYgYSBmcm9tKCkgb3IgZnJvbVRvKCkgc3RhZ2dlciB0d2VlbiBpcyBwbGFjZWQgbGF0ZXIgaW4gYSB0aW1lbGluZSwgdGhlICJzdGFydEF0IiB6ZXJvLWR1cmF0aW9uIHR3ZWVuIGNvdWxkIGluaXRpYWxseSByZW5kZXIgYXQgYSB0aW1lIHdoZW4gdGhlIHBhcmVudCB0aW1lbGluZSdzIHBsYXloZWFkIGlzIHRlY2huaWNhbGx5IEJFRk9SRSB3aGVyZSB0aGlzIHR3ZWVuIGlzLCBzbyBtYWtlIHN1cmUgdGhhdCBhbnkgImZyb20iIGFuZCAiZnJvbVRvIiBzdGFydEF0IHR3ZWVucyBhcmUgcmVuZGVyZWQgdGhlIGZpcnN0IHRpbWUgYXQgYSByYXRpbyBvZiAxLgogIHJlcGVhdERlbGF5ID0gdHdlZW4uX3JEZWxheSwKICAgICAgdFRpbWUgPSAwLAogICAgICBwdCwKICAgICAgaXRlcmF0aW9uLAogICAgICBwcmV2SXRlcmF0aW9uOwoKICBpZiAocmVwZWF0RGVsYXkgJiYgdHdlZW4uX3JlcGVhdCkgewogICAgLy8gaW4gY2FzZSB0aGVyZSdzIGEgemVyby1kdXJhdGlvbiB0d2VlbiB0aGF0IGhhcyBhIHJlcGVhdCB3aXRoIGEgcmVwZWF0RGVsYXkKICAgIHRUaW1lID0gX2NsYW1wKDAsIHR3ZWVuLl90RHVyLCB0b3RhbFRpbWUpOwogICAgaXRlcmF0aW9uID0gX2FuaW1hdGlvbkN5Y2xlKHRUaW1lLCByZXBlYXREZWxheSk7CiAgICB0d2Vlbi5feW95byAmJiBpdGVyYXRpb24gJiAxICYmIChyYXRpbyA9IDEgLSByYXRpbyk7CgogICAgaWYgKGl0ZXJhdGlvbiAhPT0gX2FuaW1hdGlvbkN5Y2xlKHR3ZWVuLl90VGltZSwgcmVwZWF0RGVsYXkpKSB7CiAgICAgIC8vIGlmIGl0ZXJhdGlvbiBjaGFuZ2VkCiAgICAgIHByZXZSYXRpbyA9IDEgLSByYXRpbzsKICAgICAgdHdlZW4udmFycy5yZXBlYXRSZWZyZXNoICYmIHR3ZWVuLl9pbml0dGVkICYmIHR3ZWVuLmludmFsaWRhdGUoKTsKICAgIH0KICB9CgogIGlmIChyYXRpbyAhPT0gcHJldlJhdGlvIHx8IGZvcmNlIHx8IHR3ZWVuLl96VGltZSA9PT0gX3RpbnlOdW0gfHwgIXRvdGFsVGltZSAmJiB0d2Vlbi5felRpbWUpIHsKICAgIGlmICghdHdlZW4uX2luaXR0ZWQgJiYgX2F0dGVtcHRJbml0VHdlZW4odHdlZW4sIHRvdGFsVGltZSwgZm9yY2UsIHN1cHByZXNzRXZlbnRzKSkgewogICAgICAvLyBpZiB3ZSByZW5kZXIgdGhlIHZlcnkgYmVnaW5uaW5nICh0aW1lID09IDApIG9mIGEgZnJvbVRvKCksIHdlIG11c3QgZm9yY2UgdGhlIHJlbmRlciAobm9ybWFsIHR3ZWVucyB3b3VsZG4ndCBuZWVkIHRvIHJlbmRlciBhdCBhIHRpbWUgb2YgMCB3aGVuIHRoZSBwcmV2VGltZSB3YXMgYWxzbyAwKS4gVGhpcyBpcyBhbHNvIG1hbmRhdG9yeSB0byBtYWtlIHN1cmUgb3ZlcndyaXRpbmcga2lja3MgaW4gaW1tZWRpYXRlbHkuCiAgICAgIHJldHVybjsKICAgIH0KCiAgICBwcmV2SXRlcmF0aW9uID0gdHdlZW4uX3pUaW1lOwogICAgdHdlZW4uX3pUaW1lID0gdG90YWxUaW1lIHx8IChzdXBwcmVzc0V2ZW50cyA/IF90aW55TnVtIDogMCk7IC8vIHdoZW4gdGhlIHBsYXloZWFkIGFycml2ZXMgYXQgRVhBQ1RMWSB0aW1lIDAgKHJpZ2h0IG9uIHRvcCkgb2YgYSB6ZXJvLWR1cmF0aW9uIHR3ZWVuLCB3ZSBuZWVkIHRvIGRpc2Nlcm4gaWYgZXZlbnRzIGFyZSBzdXBwcmVzc2VkIHNvIHRoYXQgd2hlbiB0aGUgcGxheWhlYWQgbW92ZXMgYWdhaW4gKG5leHQgdGltZSksIGl0J2xsIHRyaWdnZXIgdGhlIGNhbGxiYWNrLiBJZiBldmVudHMgYXJlIE5PVCBzdXBwcmVzc2VkLCBvYnZpb3VzbHkgdGhlIGNhbGxiYWNrIHdvdWxkIGJlIHRyaWdnZXJlZCBpbiB0aGlzIHJlbmRlci4gQmFzaWNhbGx5LCB0aGUgY2FsbGJhY2sgc2hvdWxkIGZpcmUgZWl0aGVyIHdoZW4gdGhlIHBsYXloZWFkIEFSUklWRVMgb3IgTEVBVkVTIHRoaXMgZXhhY3Qgc3BvdCwgbm90IGJvdGguIEltYWdpbmUgZG9pbmcgYSB0aW1lbGluZS5zZWVrKDApIGFuZCB0aGVyZSdzIGEgY2FsbGJhY2sgdGhhdCBzaXRzIGF0IDAuIFNpbmNlIGV2ZW50cyBhcmUgc3VwcHJlc3NlZCBvbiB0aGF0IHNlZWsoKSBieSBkZWZhdWx0LCBub3RoaW5nIHdpbGwgZmlyZSwgYnV0IHdoZW4gdGhlIHBsYXloZWFkIG1vdmVzIG9mZiBvZiB0aGF0IHBvc2l0aW9uLCB0aGUgY2FsbGJhY2sgc2hvdWxkIGZpcmUuIFRoaXMgYmVoYXZpb3IgaXMgd2hhdCBwZW9wbGUgaW50dWl0aXZlbHkgZXhwZWN0LgoKICAgIHN1cHByZXNzRXZlbnRzIHx8IChzdXBwcmVzc0V2ZW50cyA9IHRvdGFsVGltZSAmJiAhcHJldkl0ZXJhdGlvbik7IC8vIGlmIGl0IHdhcyByZW5kZXJlZCBwcmV2aW91c2x5IGF0IGV4YWN0bHkgMCAoX3pUaW1lKSBhbmQgbm93IHRoZSBwbGF5aGVhZCBpcyBtb3ZpbmcgYXdheSwgRE9OJ1QgZmlyZSBjYWxsYmFja3Mgb3RoZXJ3aXNlIHRoZXknbGwgc2VlbSBsaWtlIGR1cGxpY2F0ZXMuCgogICAgdHdlZW4ucmF0aW8gPSByYXRpbzsKICAgIHR3ZWVuLl9mcm9tICYmIChyYXRpbyA9IDEgLSByYXRpbyk7CiAgICB0d2Vlbi5fdGltZSA9IDA7CiAgICB0d2Vlbi5fdFRpbWUgPSB0VGltZTsKICAgIHB0ID0gdHdlZW4uX3B0OwoKICAgIHdoaWxlIChwdCkgewogICAgICBwdC5yKHJhdGlvLCBwdC5kKTsKICAgICAgcHQgPSBwdC5fbmV4dDsKICAgIH0KCiAgICB0d2Vlbi5fc3RhcnRBdCAmJiB0b3RhbFRpbWUgPCAwICYmIHR3ZWVuLl9zdGFydEF0LnJlbmRlcih0b3RhbFRpbWUsIHRydWUsIHRydWUpOwogICAgdHdlZW4uX29uVXBkYXRlICYmICFzdXBwcmVzc0V2ZW50cyAmJiBfY2FsbGJhY2sodHdlZW4sICJvblVwZGF0ZSIpOwogICAgdFRpbWUgJiYgdHdlZW4uX3JlcGVhdCAmJiAhc3VwcHJlc3NFdmVudHMgJiYgdHdlZW4ucGFyZW50ICYmIF9jYWxsYmFjayh0d2VlbiwgIm9uUmVwZWF0Iik7CgogICAgaWYgKCh0b3RhbFRpbWUgPj0gdHdlZW4uX3REdXIgfHwgdG90YWxUaW1lIDwgMCkgJiYgdHdlZW4ucmF0aW8gPT09IHJhdGlvKSB7CiAgICAgIHJhdGlvICYmIF9yZW1vdmVGcm9tUGFyZW50KHR3ZWVuLCAxKTsKCiAgICAgIGlmICghc3VwcHJlc3NFdmVudHMpIHsKICAgICAgICBfY2FsbGJhY2sodHdlZW4sIHJhdGlvID8gIm9uQ29tcGxldGUiIDogIm9uUmV2ZXJzZUNvbXBsZXRlIiwgdHJ1ZSk7CgogICAgICAgIHR3ZWVuLl9wcm9tICYmIHR3ZWVuLl9wcm9tKCk7CiAgICAgIH0KICAgIH0KICB9IGVsc2UgaWYgKCF0d2Vlbi5felRpbWUpIHsKICAgIHR3ZWVuLl96VGltZSA9IHRvdGFsVGltZTsKICB9Cn0sCiAgICBfZmluZE5leHRQYXVzZVR3ZWVuID0gZnVuY3Rpb24gX2ZpbmROZXh0UGF1c2VUd2VlbihhbmltYXRpb24sIHByZXZUaW1lLCB0aW1lKSB7CiAgdmFyIGNoaWxkOwoKICBpZiAodGltZSA+IHByZXZUaW1lKSB7CiAgICBjaGlsZCA9IGFuaW1hdGlvbi5fZmlyc3Q7CgogICAgd2hpbGUgKGNoaWxkICYmIGNoaWxkLl9zdGFydCA8PSB0aW1lKSB7CiAgICAgIGlmIChjaGlsZC5kYXRhID09PSAiaXNQYXVzZSIgJiYgY2hpbGQuX3N0YXJ0ID4gcHJldlRpbWUpIHsKICAgICAgICByZXR1cm4gY2hpbGQ7CiAgICAgIH0KCiAgICAgIGNoaWxkID0gY2hpbGQuX25leHQ7CiAgICB9CiAgfSBlbHNlIHsKICAgIGNoaWxkID0gYW5pbWF0aW9uLl9sYXN0OwoKICAgIHdoaWxlIChjaGlsZCAmJiBjaGlsZC5fc3RhcnQgPj0gdGltZSkgewogICAgICBpZiAoY2hpbGQuZGF0YSA9PT0gImlzUGF1c2UiICYmIGNoaWxkLl9zdGFydCA8IHByZXZUaW1lKSB7CiAgICAgICAgcmV0dXJuIGNoaWxkOwogICAgICB9CgogICAgICBjaGlsZCA9IGNoaWxkLl9wcmV2OwogICAgfQogIH0KfSwKICAgIF9zZXREdXJhdGlvbiA9IGZ1bmN0aW9uIF9zZXREdXJhdGlvbihhbmltYXRpb24sIGR1cmF0aW9uLCBza2lwVW5jYWNoZSwgbGVhdmVQbGF5aGVhZCkgewogIHZhciByZXBlYXQgPSBhbmltYXRpb24uX3JlcGVhdCwKICAgICAgZHVyID0gX3JvdW5kUHJlY2lzZShkdXJhdGlvbikgfHwgMCwKICAgICAgdG90YWxQcm9ncmVzcyA9IGFuaW1hdGlvbi5fdFRpbWUgLyBhbmltYXRpb24uX3REdXI7CiAgdG90YWxQcm9ncmVzcyAmJiAhbGVhdmVQbGF5aGVhZCAmJiAoYW5pbWF0aW9uLl90aW1lICo9IGR1ciAvIGFuaW1hdGlvbi5fZHVyKTsKICBhbmltYXRpb24uX2R1ciA9IGR1cjsKICBhbmltYXRpb24uX3REdXIgPSAhcmVwZWF0ID8gZHVyIDogcmVwZWF0IDwgMCA/IDFlMTAgOiBfcm91bmRQcmVjaXNlKGR1ciAqIChyZXBlYXQgKyAxKSArIGFuaW1hdGlvbi5fckRlbGF5ICogcmVwZWF0KTsKICB0b3RhbFByb2dyZXNzID4gMCAmJiAhbGVhdmVQbGF5aGVhZCA/IF9hbGlnblBsYXloZWFkKGFuaW1hdGlvbiwgYW5pbWF0aW9uLl90VGltZSA9IGFuaW1hdGlvbi5fdER1ciAqIHRvdGFsUHJvZ3Jlc3MpIDogYW5pbWF0aW9uLnBhcmVudCAmJiBfc2V0RW5kKGFuaW1hdGlvbik7CiAgc2tpcFVuY2FjaGUgfHwgX3VuY2FjaGUoYW5pbWF0aW9uLnBhcmVudCwgYW5pbWF0aW9uKTsKICByZXR1cm4gYW5pbWF0aW9uOwp9LAogICAgX29uVXBkYXRlVG90YWxEdXJhdGlvbiA9IGZ1bmN0aW9uIF9vblVwZGF0ZVRvdGFsRHVyYXRpb24oYW5pbWF0aW9uKSB7CiAgcmV0dXJuIGFuaW1hdGlvbiBpbnN0YW5jZW9mIFRpbWVsaW5lID8gX3VuY2FjaGUoYW5pbWF0aW9uKSA6IF9zZXREdXJhdGlvbihhbmltYXRpb24sIGFuaW1hdGlvbi5fZHVyKTsKfSwKICAgIF96ZXJvUG9zaXRpb24gPSB7CiAgX3N0YXJ0OiAwLAogIGVuZFRpbWU6IF9lbXB0eUZ1bmMsCiAgdG90YWxEdXJhdGlvbjogX2VtcHR5RnVuYwp9LAogICAgX3BhcnNlUG9zaXRpb24gPSBmdW5jdGlvbiBfcGFyc2VQb3NpdGlvbihhbmltYXRpb24sIHBvc2l0aW9uLCBwZXJjZW50QW5pbWF0aW9uKSB7CiAgdmFyIGxhYmVscyA9IGFuaW1hdGlvbi5sYWJlbHMsCiAgICAgIHJlY2VudCA9IGFuaW1hdGlvbi5fcmVjZW50IHx8IF96ZXJvUG9zaXRpb24sCiAgICAgIGNsaXBwZWREdXJhdGlvbiA9IGFuaW1hdGlvbi5kdXJhdGlvbigpID49IF9iaWdOdW0gPyByZWNlbnQuZW5kVGltZShmYWxzZSkgOiBhbmltYXRpb24uX2R1ciwKICAgICAgLy9pbiBjYXNlIHRoZXJlJ3MgYSBjaGlsZCB0aGF0IGluZmluaXRlbHkgcmVwZWF0cywgdXNlcnMgYWxtb3N0IG5ldmVyIGludGVuZCBmb3IgdGhlIGluc2VydGlvbiBwb2ludCBvZiBhIG5ldyBjaGlsZCB0byBiZSBiYXNlZCBvbiBhIFNVUEVSIGxvbmcgdmFsdWUgbGlrZSB0aGF0IHNvIHdlIGNsaXAgaXQgYW5kIGFzc3VtZSB0aGUgbW9zdCByZWNlbnRseS1hZGRlZCBjaGlsZCdzIGVuZFRpbWUgc2hvdWxkIGJlIHVzZWQgaW5zdGVhZC4KICBpLAogICAgICBvZmZzZXQsCiAgICAgIGlzUGVyY2VudDsKCiAgaWYgKF9pc1N0cmluZyhwb3NpdGlvbikgJiYgKGlzTmFOKHBvc2l0aW9uKSB8fCBwb3NpdGlvbiBpbiBsYWJlbHMpKSB7CiAgICAvL2lmIHRoZSBzdHJpbmcgaXMgYSBudW1iZXIgbGlrZSAiMSIsIGNoZWNrIHRvIHNlZSBpZiB0aGVyZSdzIGEgbGFiZWwgd2l0aCB0aGF0IG5hbWUsIG90aGVyd2lzZSBpbnRlcnByZXQgaXQgYXMgYSBudW1iZXIgKGFic29sdXRlIHZhbHVlKS4KICAgIG9mZnNldCA9IHBvc2l0aW9uLmNoYXJBdCgwKTsKICAgIGlzUGVyY2VudCA9IHBvc2l0aW9uLnN1YnN0cigtMSkgPT09ICIlIjsKICAgIGkgPSBwb3NpdGlvbi5pbmRleE9mKCI9Iik7CgogICAgaWYgKG9mZnNldCA9PT0gIjwiIHx8IG9mZnNldCA9PT0gIj4iKSB7CiAgICAgIGkgPj0gMCAmJiAocG9zaXRpb24gPSBwb3NpdGlvbi5yZXBsYWNlKC89LywgIiIpKTsKICAgICAgcmV0dXJuIChvZmZzZXQgPT09ICI8IiA/IHJlY2VudC5fc3RhcnQgOiByZWNlbnQuZW5kVGltZShyZWNlbnQuX3JlcGVhdCA+PSAwKSkgKyAocGFyc2VGbG9hdChwb3NpdGlvbi5zdWJzdHIoMSkpIHx8IDApICogKGlzUGVyY2VudCA/IChpIDwgMCA/IHJlY2VudCA6IHBlcmNlbnRBbmltYXRpb24pLnRvdGFsRHVyYXRpb24oKSAvIDEwMCA6IDEpOwogICAgfQoKICAgIGlmIChpIDwgMCkgewogICAgICBwb3NpdGlvbiBpbiBsYWJlbHMgfHwgKGxhYmVsc1twb3NpdGlvbl0gPSBjbGlwcGVkRHVyYXRpb24pOwogICAgICByZXR1cm4gbGFiZWxzW3Bvc2l0aW9uXTsKICAgIH0KCiAgICBvZmZzZXQgPSBwYXJzZUZsb2F0KHBvc2l0aW9uLmNoYXJBdChpIC0gMSkgKyBwb3NpdGlvbi5zdWJzdHIoaSArIDEpKTsKCiAgICBpZiAoaXNQZXJjZW50ICYmIHBlcmNlbnRBbmltYXRpb24pIHsKICAgICAgb2Zmc2V0ID0gb2Zmc2V0IC8gMTAwICogKF9pc0FycmF5KHBlcmNlbnRBbmltYXRpb24pID8gcGVyY2VudEFuaW1hdGlvblswXSA6IHBlcmNlbnRBbmltYXRpb24pLnRvdGFsRHVyYXRpb24oKTsKICAgIH0KCiAgICByZXR1cm4gaSA+IDEgPyBfcGFyc2VQb3NpdGlvbihhbmltYXRpb24sIHBvc2l0aW9uLnN1YnN0cigwLCBpIC0gMSksIHBlcmNlbnRBbmltYXRpb24pICsgb2Zmc2V0IDogY2xpcHBlZER1cmF0aW9uICsgb2Zmc2V0OwogIH0KCiAgcmV0dXJuIHBvc2l0aW9uID09IG51bGwgPyBjbGlwcGVkRHVyYXRpb24gOiArcG9zaXRpb247Cn0sCiAgICBfY3JlYXRlVHdlZW5UeXBlID0gZnVuY3Rpb24gX2NyZWF0ZVR3ZWVuVHlwZSh0eXBlLCBwYXJhbXMsIHRpbWVsaW5lKSB7CiAgdmFyIGlzTGVnYWN5ID0gX2lzTnVtYmVyKHBhcmFtc1sxXSksCiAgICAgIHZhcnNJbmRleCA9IChpc0xlZ2FjeSA/IDIgOiAxKSArICh0eXBlIDwgMiA/IDAgOiAxKSwKICAgICAgdmFycyA9IHBhcmFtc1t2YXJzSW5kZXhdLAogICAgICBpclZhcnMsCiAgICAgIHBhcmVudDsKCiAgaXNMZWdhY3kgJiYgKHZhcnMuZHVyYXRpb24gPSBwYXJhbXNbMV0pOwogIHZhcnMucGFyZW50ID0gdGltZWxpbmU7CgogIGlmICh0eXBlKSB7CiAgICBpclZhcnMgPSB2YXJzOwogICAgcGFyZW50ID0gdGltZWxpbmU7CgogICAgd2hpbGUgKHBhcmVudCAmJiAhKCJpbW1lZGlhdGVSZW5kZXIiIGluIGlyVmFycykpIHsKICAgICAgLy8gaW5oZXJpdGFuY2UgaGFzbid0IGhhcHBlbmVkIHlldCwgYnV0IHNvbWVvbmUgbWF5IGhhdmUgc2V0IGEgZGVmYXVsdCBpbiBhbiBhbmNlc3RvciB0aW1lbGluZS4gV2UgY291bGQgZG8gdmFycy5pbW1lZGlhdGVSZW5kZXIgPSBfaXNOb3RGYWxzZShfaW5oZXJpdERlZmF1bHRzKHZhcnMpLmltbWVkaWF0ZVJlbmRlcikgYnV0IHRoYXQnZCBleGFjdCBhIHNsaWdodCBwZXJmb3JtYW5jZSBwZW5hbHR5IGJlY2F1c2UgX2luaGVyaXREZWZhdWx0cygpIGFsc28gcnVucyBpbiB0aGUgVHdlZW4gY29uc3RydWN0b3IuIFdlJ3JlIHBheWluZyBhIHNtYWxsIGtiIHByaWNlIGhlcmUgdG8gZ2FpbiBzcGVlZC4KICAgICAgaXJWYXJzID0gcGFyZW50LnZhcnMuZGVmYXVsdHMgfHwge307CiAgICAgIHBhcmVudCA9IF9pc05vdEZhbHNlKHBhcmVudC52YXJzLmluaGVyaXQpICYmIHBhcmVudC5wYXJlbnQ7CiAgICB9CgogICAgdmFycy5pbW1lZGlhdGVSZW5kZXIgPSBfaXNOb3RGYWxzZShpclZhcnMuaW1tZWRpYXRlUmVuZGVyKTsKICAgIHR5cGUgPCAyID8gdmFycy5ydW5CYWNrd2FyZHMgPSAxIDogdmFycy5zdGFydEF0ID0gcGFyYW1zW3ZhcnNJbmRleCAtIDFdOyAvLyAiZnJvbSIgdmFycwogIH0KCiAgcmV0dXJuIG5ldyBUd2VlbihwYXJhbXNbMF0sIHZhcnMsIHBhcmFtc1t2YXJzSW5kZXggKyAxXSk7Cn0sCiAgICBfY29uZGl0aW9uYWxSZXR1cm4gPSBmdW5jdGlvbiBfY29uZGl0aW9uYWxSZXR1cm4odmFsdWUsIGZ1bmMpIHsKICByZXR1cm4gdmFsdWUgfHwgdmFsdWUgPT09IDAgPyBmdW5jKHZhbHVlKSA6IGZ1bmM7Cn0sCiAgICBfY2xhbXAgPSBmdW5jdGlvbiBfY2xhbXAobWluLCBtYXgsIHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlIDwgbWluID8gbWluIDogdmFsdWUgPiBtYXggPyBtYXggOiB2YWx1ZTsKfSwKICAgIGdldFVuaXQgPSBmdW5jdGlvbiBnZXRVbml0KHZhbHVlLCB2KSB7CiAgcmV0dXJuICFfaXNTdHJpbmcodmFsdWUpIHx8ICEodiA9IF91bml0RXhwLmV4ZWModmFsdWUpKSA/ICIiIDogdmFsdWUuc3Vic3RyKHYuaW5kZXggKyB2WzBdLmxlbmd0aCk7Cn0sCiAgICAvLyBub3RlOiBwcm90ZWN0IGFnYWluc3QgcGFkZGVkIG51bWJlcnMgYXMgc3RyaW5ncywgbGlrZSAiMTAwLjEwMCIuIFRoYXQgc2hvdWxkbid0IHJldHVybiAiMDAiIGFzIHRoZSB1bml0LiBJZiBpdCdzIG51bWVyaWMsIHJldHVybiBubyB1bml0LgpjbGFtcCA9IGZ1bmN0aW9uIGNsYW1wKG1pbiwgbWF4LCB2YWx1ZSkgewogIHJldHVybiBfY29uZGl0aW9uYWxSZXR1cm4odmFsdWUsIGZ1bmN0aW9uICh2KSB7CiAgICByZXR1cm4gX2NsYW1wKG1pbiwgbWF4LCB2KTsKICB9KTsKfSwKICAgIF9zbGljZSA9IFtdLnNsaWNlLAogICAgX2lzQXJyYXlMaWtlID0gZnVuY3Rpb24gX2lzQXJyYXlMaWtlKHZhbHVlLCBub25FbXB0eSkgewogIHJldHVybiB2YWx1ZSAmJiBfaXNPYmplY3QodmFsdWUpICYmICJsZW5ndGgiIGluIHZhbHVlICYmICghbm9uRW1wdHkgJiYgIXZhbHVlLmxlbmd0aCB8fCB2YWx1ZS5sZW5ndGggLSAxIGluIHZhbHVlICYmIF9pc09iamVjdCh2YWx1ZVswXSkpICYmICF2YWx1ZS5ub2RlVHlwZSAmJiB2YWx1ZSAhPT0gX3dpbjsKfSwKICAgIF9mbGF0dGVuID0gZnVuY3Rpb24gX2ZsYXR0ZW4oYXIsIGxlYXZlU3RyaW5ncywgYWNjdW11bGF0b3IpIHsKICBpZiAoYWNjdW11bGF0b3IgPT09IHZvaWQgMCkgewogICAgYWNjdW11bGF0b3IgPSBbXTsKICB9CgogIHJldHVybiBhci5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgdmFyIF9hY2N1bXVsYXRvcjsKCiAgICByZXR1cm4gX2lzU3RyaW5nKHZhbHVlKSAmJiAhbGVhdmVTdHJpbmdzIHx8IF9pc0FycmF5TGlrZSh2YWx1ZSwgMSkgPyAoX2FjY3VtdWxhdG9yID0gYWNjdW11bGF0b3IpLnB1c2guYXBwbHkoX2FjY3VtdWxhdG9yLCB0b0FycmF5KHZhbHVlKSkgOiBhY2N1bXVsYXRvci5wdXNoKHZhbHVlKTsKICB9KSB8fCBhY2N1bXVsYXRvcjsKfSwKICAgIC8vdGFrZXMgYW55IHZhbHVlIGFuZCByZXR1cm5zIGFuIGFycmF5LiBJZiBpdCdzIGEgc3RyaW5nIChhbmQgbGVhdmVTdHJpbmdzIGlzbid0IHRydWUpLCBpdCdsbCB1c2UgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgpIGFuZCBjb252ZXJ0IHRoYXQgdG8gYW4gYXJyYXkuIEl0J2xsIGFsc28gYWNjZXB0IGl0ZXJhYmxlcyBsaWtlIGpRdWVyeSBvYmplY3RzLgp0b0FycmF5ID0gZnVuY3Rpb24gdG9BcnJheSh2YWx1ZSwgc2NvcGUsIGxlYXZlU3RyaW5ncykgewogIHJldHVybiBfaXNTdHJpbmcodmFsdWUpICYmICFsZWF2ZVN0cmluZ3MgJiYgKF9jb3JlSW5pdHRlZCB8fCAhX3dha2UoKSkgPyBfc2xpY2UuY2FsbCgoc2NvcGUgfHwgX2RvYykucXVlcnlTZWxlY3RvckFsbCh2YWx1ZSksIDApIDogX2lzQXJyYXkodmFsdWUpID8gX2ZsYXR0ZW4odmFsdWUsIGxlYXZlU3RyaW5ncykgOiBfaXNBcnJheUxpa2UodmFsdWUpID8gX3NsaWNlLmNhbGwodmFsdWUsIDApIDogdmFsdWUgPyBbdmFsdWVdIDogW107Cn0sCiAgICBzZWxlY3RvciA9IGZ1bmN0aW9uIHNlbGVjdG9yKHZhbHVlKSB7CiAgdmFsdWUgPSB0b0FycmF5KHZhbHVlKVswXSB8fCBfd2FybigiSW52YWxpZCBzY29wZSIpIHx8IHt9OwogIHJldHVybiBmdW5jdGlvbiAodikgewogICAgdmFyIGVsID0gdmFsdWUuY3VycmVudCB8fCB2YWx1ZS5uYXRpdmVFbGVtZW50IHx8IHZhbHVlOwogICAgcmV0dXJuIHRvQXJyYXkodiwgZWwucXVlcnlTZWxlY3RvckFsbCA/IGVsIDogZWwgPT09IHZhbHVlID8gX3dhcm4oIkludmFsaWQgc2NvcGUiKSB8fCBfZG9jLmNyZWF0ZUVsZW1lbnQoImRpdiIpIDogdmFsdWUpOwogIH07Cn0sCiAgICBzaHVmZmxlID0gZnVuY3Rpb24gc2h1ZmZsZShhKSB7CiAgcmV0dXJuIGEuc29ydChmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gLjUgLSBNYXRoLnJhbmRvbSgpOwogIH0pOwp9LAogICAgLy8gYWx0ZXJuYXRpdmUgdGhhdCdzIGEgYml0IGZhc3RlciBhbmQgbW9yZSByZWxpYWJseSBkaXZlcnNlIGJ1dCBiaWdnZXI6ICAgZm9yIChsZXQgaiwgdiwgaSA9IGEubGVuZ3RoOyBpOyBqID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaSksIHYgPSBhWy0taV0sIGFbaV0gPSBhW2pdLCBhW2pdID0gdik7IHJldHVybiBhOwovL2ZvciBkaXN0cmlidXRpbmcgdmFsdWVzIGFjcm9zcyBhbiBhcnJheS4gQ2FuIGFjY2VwdCBhIG51bWJlciwgYSBmdW5jdGlvbiBvciAobW9zdCBjb21tb25seSkgYSBmdW5jdGlvbiB3aGljaCBjYW4gY29udGFpbiB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6IHtiYXNlLCBhbW91bnQsIGZyb20sIGVhc2UsIGdyaWQsIGF4aXMsIGxlbmd0aCwgZWFjaH0uIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGV4cGVjdHMgdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOiBpbmRleCwgdGFyZ2V0LCBhcnJheS4gUmVjb2duaXplcyB0aGUgZm9sbG93aW5nCmRpc3RyaWJ1dGUgPSBmdW5jdGlvbiBkaXN0cmlidXRlKHYpIHsKICBpZiAoX2lzRnVuY3Rpb24odikpIHsKICAgIHJldHVybiB2OwogIH0KCiAgdmFyIHZhcnMgPSBfaXNPYmplY3QodikgPyB2IDogewogICAgZWFjaDogdgogIH0sCiAgICAgIC8vbjoxIGlzIGp1c3QgdG8gaW5kaWNhdGUgdiB3YXMgYSBudW1iZXI7IHdlIGxldmVyYWdlIHRoYXQgbGF0ZXIgdG8gc2V0IHYgYWNjb3JkaW5nIHRvIHRoZSBsZW5ndGggd2UgZ2V0LiBJZiBhIG51bWJlciBpcyBwYXNzZWQgaW4sIHdlIHRyZWF0IGl0IGxpa2UgdGhlIG9sZCBzdGFnZ2VyIHZhbHVlIHdoZXJlIDAuMSwgZm9yIGV4YW1wbGUsIHdvdWxkIG1lYW4gdGhhdCB0aGluZ3Mgd291bGQgYmUgZGlzdHJpYnV0ZWQgd2l0aCAwLjEgYmV0d2VlbiBlYWNoIGVsZW1lbnQgaW4gdGhlIGFycmF5IHJhdGhlciB0aGFuIGEgdG90YWwgImFtb3VudCIgdGhhdCdzIGNodW5rZWQgb3V0IGFtb25nIHRoZW0gYWxsLgogIGVhc2UgPSBfcGFyc2VFYXNlKHZhcnMuZWFzZSksCiAgICAgIGZyb20gPSB2YXJzLmZyb20gfHwgMCwKICAgICAgYmFzZSA9IHBhcnNlRmxvYXQodmFycy5iYXNlKSB8fCAwLAogICAgICBjYWNoZSA9IHt9LAogICAgICBpc0RlY2ltYWwgPSBmcm9tID4gMCAmJiBmcm9tIDwgMSwKICAgICAgcmF0aW9zID0gaXNOYU4oZnJvbSkgfHwgaXNEZWNpbWFsLAogICAgICBheGlzID0gdmFycy5heGlzLAogICAgICByYXRpb1ggPSBmcm9tLAogICAgICByYXRpb1kgPSBmcm9tOwoKICBpZiAoX2lzU3RyaW5nKGZyb20pKSB7CiAgICByYXRpb1ggPSByYXRpb1kgPSB7CiAgICAgIGNlbnRlcjogLjUsCiAgICAgIGVkZ2VzOiAuNSwKICAgICAgZW5kOiAxCiAgICB9W2Zyb21dIHx8IDA7CiAgfSBlbHNlIGlmICghaXNEZWNpbWFsICYmIHJhdGlvcykgewogICAgcmF0aW9YID0gZnJvbVswXTsKICAgIHJhdGlvWSA9IGZyb21bMV07CiAgfQoKICByZXR1cm4gZnVuY3Rpb24gKGksIHRhcmdldCwgYSkgewogICAgdmFyIGwgPSAoYSB8fCB2YXJzKS5sZW5ndGgsCiAgICAgICAgZGlzdGFuY2VzID0gY2FjaGVbbF0sCiAgICAgICAgb3JpZ2luWCwKICAgICAgICBvcmlnaW5ZLAogICAgICAgIHgsCiAgICAgICAgeSwKICAgICAgICBkLAogICAgICAgIGosCiAgICAgICAgbWF4LAogICAgICAgIG1pbiwKICAgICAgICB3cmFwQXQ7CgogICAgaWYgKCFkaXN0YW5jZXMpIHsKICAgICAgd3JhcEF0ID0gdmFycy5ncmlkID09PSAiYXV0byIgPyAwIDogKHZhcnMuZ3JpZCB8fCBbMSwgX2JpZ051bV0pWzFdOwoKICAgICAgaWYgKCF3cmFwQXQpIHsKICAgICAgICBtYXggPSAtX2JpZ051bTsKCiAgICAgICAgd2hpbGUgKG1heCA8IChtYXggPSBhW3dyYXBBdCsrXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0KSAmJiB3cmFwQXQgPCBsKSB7fQoKICAgICAgICB3cmFwQXQtLTsKICAgICAgfQoKICAgICAgZGlzdGFuY2VzID0gY2FjaGVbbF0gPSBbXTsKICAgICAgb3JpZ2luWCA9IHJhdGlvcyA/IE1hdGgubWluKHdyYXBBdCwgbCkgKiByYXRpb1ggLSAuNSA6IGZyb20gJSB3cmFwQXQ7CiAgICAgIG9yaWdpblkgPSB3cmFwQXQgPT09IF9iaWdOdW0gPyAwIDogcmF0aW9zID8gbCAqIHJhdGlvWSAvIHdyYXBBdCAtIC41IDogZnJvbSAvIHdyYXBBdCB8IDA7CiAgICAgIG1heCA9IDA7CiAgICAgIG1pbiA9IF9iaWdOdW07CgogICAgICBmb3IgKGogPSAwOyBqIDwgbDsgaisrKSB7CiAgICAgICAgeCA9IGogJSB3cmFwQXQgLSBvcmlnaW5YOwogICAgICAgIHkgPSBvcmlnaW5ZIC0gKGogLyB3cmFwQXQgfCAwKTsKICAgICAgICBkaXN0YW5jZXNbal0gPSBkID0gIWF4aXMgPyBfc3FydCh4ICogeCArIHkgKiB5KSA6IE1hdGguYWJzKGF4aXMgPT09ICJ5IiA/IHkgOiB4KTsKICAgICAgICBkID4gbWF4ICYmIChtYXggPSBkKTsKICAgICAgICBkIDwgbWluICYmIChtaW4gPSBkKTsKICAgICAgfQoKICAgICAgZnJvbSA9PT0gInJhbmRvbSIgJiYgc2h1ZmZsZShkaXN0YW5jZXMpOwogICAgICBkaXN0YW5jZXMubWF4ID0gbWF4IC0gbWluOwogICAgICBkaXN0YW5jZXMubWluID0gbWluOwogICAgICBkaXN0YW5jZXMudiA9IGwgPSAocGFyc2VGbG9hdCh2YXJzLmFtb3VudCkgfHwgcGFyc2VGbG9hdCh2YXJzLmVhY2gpICogKHdyYXBBdCA+IGwgPyBsIC0gMSA6ICFheGlzID8gTWF0aC5tYXgod3JhcEF0LCBsIC8gd3JhcEF0KSA6IGF4aXMgPT09ICJ5IiA/IGwgLyB3cmFwQXQgOiB3cmFwQXQpIHx8IDApICogKGZyb20gPT09ICJlZGdlcyIgPyAtMSA6IDEpOwogICAgICBkaXN0YW5jZXMuYiA9IGwgPCAwID8gYmFzZSAtIGwgOiBiYXNlOwogICAgICBkaXN0YW5jZXMudSA9IGdldFVuaXQodmFycy5hbW91bnQgfHwgdmFycy5lYWNoKSB8fCAwOyAvL3VuaXQKCiAgICAgIGVhc2UgPSBlYXNlICYmIGwgPCAwID8gX2ludmVydEVhc2UoZWFzZSkgOiBlYXNlOwogICAgfQoKICAgIGwgPSAoZGlzdGFuY2VzW2ldIC0gZGlzdGFuY2VzLm1pbikgLyBkaXN0YW5jZXMubWF4IHx8IDA7CiAgICByZXR1cm4gX3JvdW5kUHJlY2lzZShkaXN0YW5jZXMuYiArIChlYXNlID8gZWFzZShsKSA6IGwpICogZGlzdGFuY2VzLnYpICsgZGlzdGFuY2VzLnU7IC8vcm91bmQgaW4gb3JkZXIgdG8gd29yayBhcm91bmQgZmxvYXRpbmcgcG9pbnQgZXJyb3JzCiAgfTsKfSwKICAgIF9yb3VuZE1vZGlmaWVyID0gZnVuY3Rpb24gX3JvdW5kTW9kaWZpZXIodikgewogIC8vcGFzcyBpbiAwLjEgZ2V0IGEgZnVuY3Rpb24gdGhhdCdsbCByb3VuZCB0byB0aGUgbmVhcmVzdCB0ZW50aCwgb3IgNSB0byByb3VuZCB0byB0aGUgY2xvc2VzdCA1LCBvciAwLjAwMSB0byB0aGUgY2xvc2VzdCAxMDAwdGgsIGV0Yy4KICB2YXIgcCA9IE1hdGgucG93KDEwLCAoKHYgKyAiIikuc3BsaXQoIi4iKVsxXSB8fCAiIikubGVuZ3RoKTsgLy90byBhdm9pZCBmbG9hdGluZyBwb2ludCBtYXRoIGVycm9ycyAobGlrZSAyNCAqIDAuMSA9PSAyLjQwMDAwMDAwMDAwMDAwMDQpLCB3ZSBjaG9wIG9mZiBhdCBhIHNwZWNpZmljIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlcyAobXVjaCBmYXN0ZXIgdGhhbiB0b0ZpeGVkKCkpCgogIHJldHVybiBmdW5jdGlvbiAocmF3KSB7CiAgICB2YXIgbiA9IE1hdGgucm91bmQocGFyc2VGbG9hdChyYXcpIC8gdikgKiB2ICogcDsKICAgIHJldHVybiAobiAtIG4gJSAxKSAvIHAgKyAoX2lzTnVtYmVyKHJhdykgPyAwIDogZ2V0VW5pdChyYXcpKTsgLy8gbiAtIG4gJSAxIHJlcGxhY2VzIE1hdGguZmxvb3IoKSBpbiBvcmRlciB0byBoYW5kbGUgbmVnYXRpdmUgdmFsdWVzIHByb3Blcmx5LiBGb3IgZXhhbXBsZSwgTWF0aC5mbG9vcigtMTUwLjAwMDAwMDAwMDAwMDAzKSBpcyAxNTEhCiAgfTsKfSwKICAgIHNuYXAgPSBmdW5jdGlvbiBzbmFwKHNuYXBUbywgdmFsdWUpIHsKICB2YXIgaXNBcnJheSA9IF9pc0FycmF5KHNuYXBUbyksCiAgICAgIHJhZGl1cywKICAgICAgaXMyRDsKCiAgaWYgKCFpc0FycmF5ICYmIF9pc09iamVjdChzbmFwVG8pKSB7CiAgICByYWRpdXMgPSBpc0FycmF5ID0gc25hcFRvLnJhZGl1cyB8fCBfYmlnTnVtOwoKICAgIGlmIChzbmFwVG8udmFsdWVzKSB7CiAgICAgIHNuYXBUbyA9IHRvQXJyYXkoc25hcFRvLnZhbHVlcyk7CgogICAgICBpZiAoaXMyRCA9ICFfaXNOdW1iZXIoc25hcFRvWzBdKSkgewogICAgICAgIHJhZGl1cyAqPSByYWRpdXM7IC8vcGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uIHNvIHdlIGRvbid0IGhhdmUgdG8gTWF0aC5zcXJ0KCkgaW4gdGhlIGxvb3AuCiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHNuYXBUbyA9IF9yb3VuZE1vZGlmaWVyKHNuYXBUby5pbmNyZW1lbnQpOwogICAgfQogIH0KCiAgcmV0dXJuIF9jb25kaXRpb25hbFJldHVybih2YWx1ZSwgIWlzQXJyYXkgPyBfcm91bmRNb2RpZmllcihzbmFwVG8pIDogX2lzRnVuY3Rpb24oc25hcFRvKSA/IGZ1bmN0aW9uIChyYXcpIHsKICAgIGlzMkQgPSBzbmFwVG8ocmF3KTsKICAgIHJldHVybiBNYXRoLmFicyhpczJEIC0gcmF3KSA8PSByYWRpdXMgPyBpczJEIDogcmF3OwogIH0gOiBmdW5jdGlvbiAocmF3KSB7CiAgICB2YXIgeCA9IHBhcnNlRmxvYXQoaXMyRCA/IHJhdy54IDogcmF3KSwKICAgICAgICB5ID0gcGFyc2VGbG9hdChpczJEID8gcmF3LnkgOiAwKSwKICAgICAgICBtaW4gPSBfYmlnTnVtLAogICAgICAgIGNsb3Nlc3QgPSAwLAogICAgICAgIGkgPSBzbmFwVG8ubGVuZ3RoLAogICAgICAgIGR4LAogICAgICAgIGR5OwoKICAgIHdoaWxlIChpLS0pIHsKICAgICAgaWYgKGlzMkQpIHsKICAgICAgICBkeCA9IHNuYXBUb1tpXS54IC0geDsKICAgICAgICBkeSA9IHNuYXBUb1tpXS55IC0geTsKICAgICAgICBkeCA9IGR4ICogZHggKyBkeSAqIGR5OwogICAgICB9IGVsc2UgewogICAgICAgIGR4ID0gTWF0aC5hYnMoc25hcFRvW2ldIC0geCk7CiAgICAgIH0KCiAgICAgIGlmIChkeCA8IG1pbikgewogICAgICAgIG1pbiA9IGR4OwogICAgICAgIGNsb3Nlc3QgPSBpOwogICAgICB9CiAgICB9CgogICAgY2xvc2VzdCA9ICFyYWRpdXMgfHwgbWluIDw9IHJhZGl1cyA/IHNuYXBUb1tjbG9zZXN0XSA6IHJhdzsKICAgIHJldHVybiBpczJEIHx8IGNsb3Nlc3QgPT09IHJhdyB8fCBfaXNOdW1iZXIocmF3KSA/IGNsb3Nlc3QgOiBjbG9zZXN0ICsgZ2V0VW5pdChyYXcpOwogIH0pOwp9LAogICAgcmFuZG9tID0gZnVuY3Rpb24gcmFuZG9tKG1pbiwgbWF4LCByb3VuZGluZ0luY3JlbWVudCwgcmV0dXJuRnVuY3Rpb24pIHsKICByZXR1cm4gX2NvbmRpdGlvbmFsUmV0dXJuKF9pc0FycmF5KG1pbikgPyAhbWF4IDogcm91bmRpbmdJbmNyZW1lbnQgPT09IHRydWUgPyAhIShyb3VuZGluZ0luY3JlbWVudCA9IDApIDogIXJldHVybkZ1bmN0aW9uLCBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gX2lzQXJyYXkobWluKSA/IG1pblt+fihNYXRoLnJhbmRvbSgpICogbWluLmxlbmd0aCldIDogKHJvdW5kaW5nSW5jcmVtZW50ID0gcm91bmRpbmdJbmNyZW1lbnQgfHwgMWUtNSkgJiYgKHJldHVybkZ1bmN0aW9uID0gcm91bmRpbmdJbmNyZW1lbnQgPCAxID8gTWF0aC5wb3coMTAsIChyb3VuZGluZ0luY3JlbWVudCArICIiKS5sZW5ndGggLSAyKSA6IDEpICYmIE1hdGguZmxvb3IoTWF0aC5yb3VuZCgobWluIC0gcm91bmRpbmdJbmNyZW1lbnQgLyAyICsgTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyByb3VuZGluZ0luY3JlbWVudCAqIC45OSkpIC8gcm91bmRpbmdJbmNyZW1lbnQpICogcm91bmRpbmdJbmNyZW1lbnQgKiByZXR1cm5GdW5jdGlvbikgLyByZXR1cm5GdW5jdGlvbjsKICB9KTsKfSwKICAgIHBpcGUgPSBmdW5jdGlvbiBwaXBlKCkgewogIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBmdW5jdGlvbnMgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICBmdW5jdGlvbnNbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgfQoKICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICByZXR1cm4gZnVuY3Rpb25zLnJlZHVjZShmdW5jdGlvbiAodiwgZikgewogICAgICByZXR1cm4gZih2KTsKICAgIH0sIHZhbHVlKTsKICB9Owp9LAogICAgdW5pdGl6ZSA9IGZ1bmN0aW9uIHVuaXRpemUoZnVuYywgdW5pdCkgewogIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHsKICAgIHJldHVybiBmdW5jKHBhcnNlRmxvYXQodmFsdWUpKSArICh1bml0IHx8IGdldFVuaXQodmFsdWUpKTsKICB9Owp9LAogICAgbm9ybWFsaXplID0gZnVuY3Rpb24gbm9ybWFsaXplKG1pbiwgbWF4LCB2YWx1ZSkgewogIHJldHVybiBtYXBSYW5nZShtaW4sIG1heCwgMCwgMSwgdmFsdWUpOwp9LAogICAgX3dyYXBBcnJheSA9IGZ1bmN0aW9uIF93cmFwQXJyYXkoYSwgd3JhcHBlciwgdmFsdWUpIHsKICByZXR1cm4gX2NvbmRpdGlvbmFsUmV0dXJuKHZhbHVlLCBmdW5jdGlvbiAoaW5kZXgpIHsKICAgIHJldHVybiBhW35+d3JhcHBlcihpbmRleCldOwogIH0pOwp9LAogICAgd3JhcCA9IGZ1bmN0aW9uIHdyYXAobWluLCBtYXgsIHZhbHVlKSB7CiAgLy8gTk9URTogd3JhcCgpIENBTk5PVCBiZSBhbiBhcnJvdyBmdW5jdGlvbiEgQSB2ZXJ5IG9kZCBjb21waWxpbmcgYnVnIGNhdXNlcyBwcm9ibGVtcyAodW5yZWxhdGVkIHRvIEdTQVApLgogIHZhciByYW5nZSA9IG1heCAtIG1pbjsKICByZXR1cm4gX2lzQXJyYXkobWluKSA/IF93cmFwQXJyYXkobWluLCB3cmFwKDAsIG1pbi5sZW5ndGgpLCBtYXgpIDogX2NvbmRpdGlvbmFsUmV0dXJuKHZhbHVlLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgIHJldHVybiAocmFuZ2UgKyAodmFsdWUgLSBtaW4pICUgcmFuZ2UpICUgcmFuZ2UgKyBtaW47CiAgfSk7Cn0sCiAgICB3cmFwWW95byA9IGZ1bmN0aW9uIHdyYXBZb3lvKG1pbiwgbWF4LCB2YWx1ZSkgewogIHZhciByYW5nZSA9IG1heCAtIG1pbiwKICAgICAgdG90YWwgPSByYW5nZSAqIDI7CiAgcmV0dXJuIF9pc0FycmF5KG1pbikgPyBfd3JhcEFycmF5KG1pbiwgd3JhcFlveW8oMCwgbWluLmxlbmd0aCAtIDEpLCBtYXgpIDogX2NvbmRpdGlvbmFsUmV0dXJuKHZhbHVlLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgIHZhbHVlID0gKHRvdGFsICsgKHZhbHVlIC0gbWluKSAlIHRvdGFsKSAlIHRvdGFsIHx8IDA7CiAgICByZXR1cm4gbWluICsgKHZhbHVlID4gcmFuZ2UgPyB0b3RhbCAtIHZhbHVlIDogdmFsdWUpOwogIH0pOwp9LAogICAgX3JlcGxhY2VSYW5kb20gPSBmdW5jdGlvbiBfcmVwbGFjZVJhbmRvbSh2YWx1ZSkgewogIC8vcmVwbGFjZXMgYWxsIG9jY3VycmVuY2VzIG9mIHJhbmRvbSguLi4pIGluIGEgc3RyaW5nIHdpdGggdGhlIGNhbGN1bGF0ZWQgcmFuZG9tIHZhbHVlLiBjYW4gYmUgYSByYW5nZSBsaWtlIHJhbmRvbSgtMTAwLCAxMDAsIDUpIG9yIGFuIGFycmF5IGxpa2UgcmFuZG9tKFswLCAxMDAsIDUwMF0pCiAgdmFyIHByZXYgPSAwLAogICAgICBzID0gIiIsCiAgICAgIGksCiAgICAgIG51bXMsCiAgICAgIGVuZCwKICAgICAgaXNBcnJheTsKCiAgd2hpbGUgKH4oaSA9IHZhbHVlLmluZGV4T2YoInJhbmRvbSgiLCBwcmV2KSkpIHsKICAgIGVuZCA9IHZhbHVlLmluZGV4T2YoIikiLCBpKTsKICAgIGlzQXJyYXkgPSB2YWx1ZS5jaGFyQXQoaSArIDcpID09PSAiWyI7CiAgICBudW1zID0gdmFsdWUuc3Vic3RyKGkgKyA3LCBlbmQgLSBpIC0gNykubWF0Y2goaXNBcnJheSA/IF9kZWxpbWl0ZWRWYWx1ZUV4cCA6IF9zdHJpY3ROdW1FeHApOwogICAgcyArPSB2YWx1ZS5zdWJzdHIocHJldiwgaSAtIHByZXYpICsgcmFuZG9tKGlzQXJyYXkgPyBudW1zIDogK251bXNbMF0sIGlzQXJyYXkgPyAwIDogK251bXNbMV0sICtudW1zWzJdIHx8IDFlLTUpOwogICAgcHJldiA9IGVuZCArIDE7CiAgfQoKICByZXR1cm4gcyArIHZhbHVlLnN1YnN0cihwcmV2LCB2YWx1ZS5sZW5ndGggLSBwcmV2KTsKfSwKICAgIG1hcFJhbmdlID0gZnVuY3Rpb24gbWFwUmFuZ2UoaW5NaW4sIGluTWF4LCBvdXRNaW4sIG91dE1heCwgdmFsdWUpIHsKICB2YXIgaW5SYW5nZSA9IGluTWF4IC0gaW5NaW4sCiAgICAgIG91dFJhbmdlID0gb3V0TWF4IC0gb3V0TWluOwogIHJldHVybiBfY29uZGl0aW9uYWxSZXR1cm4odmFsdWUsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgcmV0dXJuIG91dE1pbiArICgodmFsdWUgLSBpbk1pbikgLyBpblJhbmdlICogb3V0UmFuZ2UgfHwgMCk7CiAgfSk7Cn0sCiAgICBpbnRlcnBvbGF0ZSA9IGZ1bmN0aW9uIGludGVycG9sYXRlKHN0YXJ0LCBlbmQsIHByb2dyZXNzLCBtdXRhdGUpIHsKICB2YXIgZnVuYyA9IGlzTmFOKHN0YXJ0ICsgZW5kKSA/IDAgOiBmdW5jdGlvbiAocCkgewogICAgcmV0dXJuICgxIC0gcCkgKiBzdGFydCArIHAgKiBlbmQ7CiAgfTsKCiAgaWYgKCFmdW5jKSB7CiAgICB2YXIgaXNTdHJpbmcgPSBfaXNTdHJpbmcoc3RhcnQpLAogICAgICAgIG1hc3RlciA9IHt9LAogICAgICAgIHAsCiAgICAgICAgaSwKICAgICAgICBpbnRlcnBvbGF0b3JzLAogICAgICAgIGwsCiAgICAgICAgaWw7CgogICAgcHJvZ3Jlc3MgPT09IHRydWUgJiYgKG11dGF0ZSA9IDEpICYmIChwcm9ncmVzcyA9IG51bGwpOwoKICAgIGlmIChpc1N0cmluZykgewogICAgICBzdGFydCA9IHsKICAgICAgICBwOiBzdGFydAogICAgICB9OwogICAgICBlbmQgPSB7CiAgICAgICAgcDogZW5kCiAgICAgIH07CiAgICB9IGVsc2UgaWYgKF9pc0FycmF5KHN0YXJ0KSAmJiAhX2lzQXJyYXkoZW5kKSkgewogICAgICBpbnRlcnBvbGF0b3JzID0gW107CiAgICAgIGwgPSBzdGFydC5sZW5ndGg7CiAgICAgIGlsID0gbCAtIDI7CgogICAgICBmb3IgKGkgPSAxOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgaW50ZXJwb2xhdG9ycy5wdXNoKGludGVycG9sYXRlKHN0YXJ0W2kgLSAxXSwgc3RhcnRbaV0pKTsgLy9idWlsZCB0aGUgaW50ZXJwb2xhdG9ycyB1cCBmcm9udCBhcyBhIHBlcmZvcm1hbmNlIG9wdGltaXphdGlvbiBzbyB0aGF0IHdoZW4gdGhlIGZ1bmN0aW9uIGlzIGNhbGxlZCBtYW55IHRpbWVzLCBpdCBjYW4ganVzdCByZXVzZSB0aGVtLgogICAgICB9CgogICAgICBsLS07CgogICAgICBmdW5jID0gZnVuY3Rpb24gZnVuYyhwKSB7CiAgICAgICAgcCAqPSBsOwogICAgICAgIHZhciBpID0gTWF0aC5taW4oaWwsIH5+cCk7CiAgICAgICAgcmV0dXJuIGludGVycG9sYXRvcnNbaV0ocCAtIGkpOwogICAgICB9OwoKICAgICAgcHJvZ3Jlc3MgPSBlbmQ7CiAgICB9IGVsc2UgaWYgKCFtdXRhdGUpIHsKICAgICAgc3RhcnQgPSBfbWVyZ2UoX2lzQXJyYXkoc3RhcnQpID8gW10gOiB7fSwgc3RhcnQpOwogICAgfQoKICAgIGlmICghaW50ZXJwb2xhdG9ycykgewogICAgICBmb3IgKHAgaW4gZW5kKSB7CiAgICAgICAgX2FkZFByb3BUd2Vlbi5jYWxsKG1hc3Rlciwgc3RhcnQsIHAsICJnZXQiLCBlbmRbcF0pOwogICAgICB9CgogICAgICBmdW5jID0gZnVuY3Rpb24gZnVuYyhwKSB7CiAgICAgICAgcmV0dXJuIF9yZW5kZXJQcm9wVHdlZW5zKHAsIG1hc3RlcikgfHwgKGlzU3RyaW5nID8gc3RhcnQucCA6IHN0YXJ0KTsKICAgICAgfTsKICAgIH0KICB9CgogIHJldHVybiBfY29uZGl0aW9uYWxSZXR1cm4ocHJvZ3Jlc3MsIGZ1bmMpOwp9LAogICAgX2dldExhYmVsSW5EaXJlY3Rpb24gPSBmdW5jdGlvbiBfZ2V0TGFiZWxJbkRpcmVjdGlvbih0aW1lbGluZSwgZnJvbVRpbWUsIGJhY2t3YXJkKSB7CiAgLy91c2VkIGZvciBuZXh0TGFiZWwoKSBhbmQgcHJldmlvdXNMYWJlbCgpCiAgdmFyIGxhYmVscyA9IHRpbWVsaW5lLmxhYmVscywKICAgICAgbWluID0gX2JpZ051bSwKICAgICAgcCwKICAgICAgZGlzdGFuY2UsCiAgICAgIGxhYmVsOwoKICBmb3IgKHAgaW4gbGFiZWxzKSB7CiAgICBkaXN0YW5jZSA9IGxhYmVsc1twXSAtIGZyb21UaW1lOwoKICAgIGlmIChkaXN0YW5jZSA8IDAgPT09ICEhYmFja3dhcmQgJiYgZGlzdGFuY2UgJiYgbWluID4gKGRpc3RhbmNlID0gTWF0aC5hYnMoZGlzdGFuY2UpKSkgewogICAgICBsYWJlbCA9IHA7CiAgICAgIG1pbiA9IGRpc3RhbmNlOwogICAgfQogIH0KCiAgcmV0dXJuIGxhYmVsOwp9LAogICAgX2NhbGxiYWNrID0gZnVuY3Rpb24gX2NhbGxiYWNrKGFuaW1hdGlvbiwgdHlwZSwgZXhlY3V0ZUxhenlGaXJzdCkgewogIHZhciB2ID0gYW5pbWF0aW9uLnZhcnMsCiAgICAgIGNhbGxiYWNrID0gdlt0eXBlXSwKICAgICAgcGFyYW1zLAogICAgICBzY29wZTsKCiAgaWYgKCFjYWxsYmFjaykgewogICAgcmV0dXJuOwogIH0KCiAgcGFyYW1zID0gdlt0eXBlICsgIlBhcmFtcyJdOwogIHNjb3BlID0gdi5jYWxsYmFja1Njb3BlIHx8IGFuaW1hdGlvbjsKICBleGVjdXRlTGF6eUZpcnN0ICYmIF9sYXp5VHdlZW5zLmxlbmd0aCAmJiBfbGF6eVJlbmRlcigpOyAvL2luIGNhc2UgcmVuZGVyaW5nIGNhdXNlZCBhbnkgdHdlZW5zIHRvIGxhenktaW5pdCwgd2Ugc2hvdWxkIHJlbmRlciB0aGVtIGJlY2F1c2UgdHlwaWNhbGx5IHdoZW4gYSB0aW1lbGluZSBmaW5pc2hlcywgdXNlcnMgZXhwZWN0IHRoaW5ncyB0byBoYXZlIHJlbmRlcmVkIGZ1bGx5LiBJbWFnaW5lIGFuIG9uVXBkYXRlIG9uIGEgdGltZWxpbmUgdGhhdCByZXBvcnRzL2NoZWNrcyB0d2VlbmVkIHZhbHVlcy4KCiAgcmV0dXJuIHBhcmFtcyA/IGNhbGxiYWNrLmFwcGx5KHNjb3BlLCBwYXJhbXMpIDogY2FsbGJhY2suY2FsbChzY29wZSk7Cn0sCiAgICBfaW50ZXJydXB0ID0gZnVuY3Rpb24gX2ludGVycnVwdChhbmltYXRpb24pIHsKICBfcmVtb3ZlRnJvbVBhcmVudChhbmltYXRpb24pOwoKICBhbmltYXRpb24uc2Nyb2xsVHJpZ2dlciAmJiBhbmltYXRpb24uc2Nyb2xsVHJpZ2dlci5raWxsKGZhbHNlKTsKICBhbmltYXRpb24ucHJvZ3Jlc3MoKSA8IDEgJiYgX2NhbGxiYWNrKGFuaW1hdGlvbiwgIm9uSW50ZXJydXB0Iik7CiAgcmV0dXJuIGFuaW1hdGlvbjsKfSwKICAgIF9xdWlja1R3ZWVuLAogICAgX2NyZWF0ZVBsdWdpbiA9IGZ1bmN0aW9uIF9jcmVhdGVQbHVnaW4oY29uZmlnKSB7CiAgY29uZmlnID0gIWNvbmZpZy5uYW1lICYmIGNvbmZpZ1siZGVmYXVsdCJdIHx8IGNvbmZpZzsgLy9VTUQgcGFja2FnaW5nIHdyYXBzIHRoaW5ncyBvZGRseSwgc28gZm9yIGV4YW1wbGUgTW90aW9uUGF0aEhlbHBlciBiZWNvbWVzIHtNb3Rpb25QYXRoSGVscGVyOk1vdGlvblBhdGhIZWxwZXIsIGRlZmF1bHQ6TW90aW9uUGF0aEhlbHBlcn0uCgogIHZhciBuYW1lID0gY29uZmlnLm5hbWUsCiAgICAgIGlzRnVuYyA9IF9pc0Z1bmN0aW9uKGNvbmZpZyksCiAgICAgIFBsdWdpbiA9IG5hbWUgJiYgIWlzRnVuYyAmJiBjb25maWcuaW5pdCA/IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuX3Byb3BzID0gW107CiAgfSA6IGNvbmZpZywKICAgICAgLy9pbiBjYXNlIHNvbWVvbmUgcGFzc2VzIGluIGFuIG9iamVjdCB0aGF0J3Mgbm90IGEgcGx1Z2luLCBsaWtlIEN1c3RvbUVhc2UKICBpbnN0YW5jZURlZmF1bHRzID0gewogICAgaW5pdDogX2VtcHR5RnVuYywKICAgIHJlbmRlcjogX3JlbmRlclByb3BUd2VlbnMsCiAgICBhZGQ6IF9hZGRQcm9wVHdlZW4sCiAgICBraWxsOiBfa2lsbFByb3BUd2VlbnNPZiwKICAgIG1vZGlmaWVyOiBfYWRkUGx1Z2luTW9kaWZpZXIsCiAgICByYXdWYXJzOiAwCiAgfSwKICAgICAgc3RhdGljcyA9IHsKICAgIHRhcmdldFRlc3Q6IDAsCiAgICBnZXQ6IDAsCiAgICBnZXRTZXR0ZXI6IF9nZXRTZXR0ZXIsCiAgICBhbGlhc2VzOiB7fSwKICAgIHJlZ2lzdGVyOiAwCiAgfTsKCiAgX3dha2UoKTsKCiAgaWYgKGNvbmZpZyAhPT0gUGx1Z2luKSB7CiAgICBpZiAoX3BsdWdpbnNbbmFtZV0pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIF9zZXREZWZhdWx0cyhQbHVnaW4sIF9zZXREZWZhdWx0cyhfY29weUV4Y2x1ZGluZyhjb25maWcsIGluc3RhbmNlRGVmYXVsdHMpLCBzdGF0aWNzKSk7IC8vc3RhdGljIG1ldGhvZHMKCgogICAgX21lcmdlKFBsdWdpbi5wcm90b3R5cGUsIF9tZXJnZShpbnN0YW5jZURlZmF1bHRzLCBfY29weUV4Y2x1ZGluZyhjb25maWcsIHN0YXRpY3MpKSk7IC8vaW5zdGFuY2UgbWV0aG9kcwoKCiAgICBfcGx1Z2luc1tQbHVnaW4ucHJvcCA9IG5hbWVdID0gUGx1Z2luOwoKICAgIGlmIChjb25maWcudGFyZ2V0VGVzdCkgewogICAgICBfaGFybmVzc1BsdWdpbnMucHVzaChQbHVnaW4pOwoKICAgICAgX3Jlc2VydmVkUHJvcHNbbmFtZV0gPSAxOwogICAgfQoKICAgIG5hbWUgPSAobmFtZSA9PT0gImNzcyIgPyAiQ1NTIiA6IG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnN1YnN0cigxKSkgKyAiUGx1Z2luIjsgLy9mb3IgdGhlIGdsb2JhbCBuYW1lLiAibW90aW9uUGF0aCIgc2hvdWxkIGJlY29tZSBNb3Rpb25QYXRoUGx1Z2luCiAgfQoKICBfYWRkR2xvYmFsKG5hbWUsIFBsdWdpbik7CgogIGNvbmZpZy5yZWdpc3RlciAmJiBjb25maWcucmVnaXN0ZXIoZ3NhcCwgUGx1Z2luLCBQcm9wVHdlZW4pOwp9LAoKLyoKICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICogQ09MT1JTCiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqLwpfMjU1ID0gMjU1LAogICAgX2NvbG9yTG9va3VwID0gewogIGFxdWE6IFswLCBfMjU1LCBfMjU1XSwKICBsaW1lOiBbMCwgXzI1NSwgMF0sCiAgc2lsdmVyOiBbMTkyLCAxOTIsIDE5Ml0sCiAgYmxhY2s6IFswLCAwLCAwXSwKICBtYXJvb246IFsxMjgsIDAsIDBdLAogIHRlYWw6IFswLCAxMjgsIDEyOF0sCiAgYmx1ZTogWzAsIDAsIF8yNTVdLAogIG5hdnk6IFswLCAwLCAxMjhdLAogIHdoaXRlOiBbXzI1NSwgXzI1NSwgXzI1NV0sCiAgb2xpdmU6IFsxMjgsIDEyOCwgMF0sCiAgeWVsbG93OiBbXzI1NSwgXzI1NSwgMF0sCiAgb3JhbmdlOiBbXzI1NSwgMTY1LCAwXSwKICBncmF5OiBbMTI4LCAxMjgsIDEyOF0sCiAgcHVycGxlOiBbMTI4LCAwLCAxMjhdLAogIGdyZWVuOiBbMCwgMTI4LCAwXSwKICByZWQ6IFtfMjU1LCAwLCAwXSwKICBwaW5rOiBbXzI1NSwgMTkyLCAyMDNdLAogIGN5YW46IFswLCBfMjU1LCBfMjU1XSwKICB0cmFuc3BhcmVudDogW18yNTUsIF8yNTUsIF8yNTUsIDBdCn0sCiAgICAvLyBwb3NzaWJsZSBmdXR1cmUgaWRlYSB0byByZXBsYWNlIHRoZSBoYXJkLWNvZGVkIGNvbG9yIG5hbWUgdmFsdWVzIC0gcHV0IHRoaXMgaW4gdGhlIHRpY2tlci53YWtlKCkgd2hlcmUgd2Ugc2V0IHRoZSBfZG9jOgovLyBsZXQgY3R4ID0gX2RvYy5jcmVhdGVFbGVtZW50KCJjYW52YXMiKS5nZXRDb250ZXh0KCIyZCIpOwovLyBfZm9yRWFjaE5hbWUoImFxdWEsbGltZSxzaWx2ZXIsYmxhY2ssbWFyb29uLHRlYWwsYmx1ZSxuYXZ5LHdoaXRlLG9saXZlLHllbGxvdyxvcmFuZ2UsZ3JheSxwdXJwbGUsZ3JlZW4scmVkLHBpbmssY3lhbiIsIGNvbG9yID0+IHtjdHguZmlsbFN0eWxlID0gY29sb3I7IF9jb2xvckxvb2t1cFtjb2xvcl0gPSBzcGxpdENvbG9yKGN0eC5maWxsU3R5bGUpfSk7Cl9odWUgPSBmdW5jdGlvbiBfaHVlKGgsIG0xLCBtMikgewogIGggKz0gaCA8IDAgPyAxIDogaCA+IDEgPyAtMSA6IDA7CiAgcmV0dXJuIChoICogNiA8IDEgPyBtMSArIChtMiAtIG0xKSAqIGggKiA2IDogaCA8IC41ID8gbTIgOiBoICogMyA8IDIgPyBtMSArIChtMiAtIG0xKSAqICgyIC8gMyAtIGgpICogNiA6IG0xKSAqIF8yNTUgKyAuNSB8IDA7Cn0sCiAgICBzcGxpdENvbG9yID0gZnVuY3Rpb24gc3BsaXRDb2xvcih2LCB0b0hTTCwgZm9yY2VBbHBoYSkgewogIHZhciBhID0gIXYgPyBfY29sb3JMb29rdXAuYmxhY2sgOiBfaXNOdW1iZXIodikgPyBbdiA+PiAxNiwgdiA+PiA4ICYgXzI1NSwgdiAmIF8yNTVdIDogMCwKICAgICAgciwKICAgICAgZywKICAgICAgYiwKICAgICAgaCwKICAgICAgcywKICAgICAgbCwKICAgICAgbWF4LAogICAgICBtaW4sCiAgICAgIGQsCiAgICAgIHdhc0hTTDsKCiAgaWYgKCFhKSB7CiAgICBpZiAodi5zdWJzdHIoLTEpID09PSAiLCIpIHsKICAgICAgLy9zb21ldGltZXMgYSB0cmFpbGluZyBjb21tYSBpcyBpbmNsdWRlZCBhbmQgd2Ugc2hvdWxkIGNob3AgaXQgb2ZmICh0eXBpY2FsbHkgZnJvbSBhIGNvbW1hLWRlbGltaXRlZCBsaXN0IG9mIHZhbHVlcyBsaWtlIGEgdGV4dFNoYWRvdzoiMnB4IDJweCAycHggYmx1ZSwgNXB4IDVweCA1cHggcmdiKDI1NSwwLDApIiAtIGluIHRoaXMgZXhhbXBsZSAiYmx1ZSwiIGhhcyBhIHRyYWlsaW5nIGNvbW1hLiBXZSBjb3VsZCBzdHJpcCBpdCBvdXQgaW5zaWRlIHBhcnNlQ29tcGxleCgpIGJ1dCB3ZSdkIG5lZWQgdG8gZG8gaXQgdG8gdGhlIGJlZ2lubmluZyBhbmQgZW5kaW5nIHZhbHVlcyBwbHVzIGl0IHdvdWxkbid0IHByb3ZpZGUgcHJvdGVjdGlvbiBmcm9tIG90aGVyIHBvdGVudGlhbCBzY2VuYXJpb3MgbGlrZSBpZiB0aGUgdXNlciBwYXNzZXMgaW4gYSBzaW1pbGFyIHZhbHVlLgogICAgICB2ID0gdi5zdWJzdHIoMCwgdi5sZW5ndGggLSAxKTsKICAgIH0KCiAgICBpZiAoX2NvbG9yTG9va3VwW3ZdKSB7CiAgICAgIGEgPSBfY29sb3JMb29rdXBbdl07CiAgICB9IGVsc2UgaWYgKHYuY2hhckF0KDApID09PSAiIyIpIHsKICAgICAgaWYgKHYubGVuZ3RoIDwgNikgewogICAgICAgIC8vZm9yIHNob3J0aGFuZCBsaWtlICM5RjAgb3IgIzlGMEYgKGNvdWxkIGhhdmUgYWxwaGEpCiAgICAgICAgciA9IHYuY2hhckF0KDEpOwogICAgICAgIGcgPSB2LmNoYXJBdCgyKTsKICAgICAgICBiID0gdi5jaGFyQXQoMyk7CiAgICAgICAgdiA9ICIjIiArIHIgKyByICsgZyArIGcgKyBiICsgYiArICh2Lmxlbmd0aCA9PT0gNSA/IHYuY2hhckF0KDQpICsgdi5jaGFyQXQoNCkgOiAiIik7CiAgICAgIH0KCiAgICAgIGlmICh2Lmxlbmd0aCA9PT0gOSkgewogICAgICAgIC8vIGhleCB3aXRoIGFscGhhLCBsaWtlICNmZDVlNTNmZgogICAgICAgIGEgPSBwYXJzZUludCh2LnN1YnN0cigxLCA2KSwgMTYpOwogICAgICAgIHJldHVybiBbYSA+PiAxNiwgYSA+PiA4ICYgXzI1NSwgYSAmIF8yNTUsIHBhcnNlSW50KHYuc3Vic3RyKDcpLCAxNikgLyAyNTVdOwogICAgICB9CgogICAgICB2ID0gcGFyc2VJbnQodi5zdWJzdHIoMSksIDE2KTsKICAgICAgYSA9IFt2ID4+IDE2LCB2ID4+IDggJiBfMjU1LCB2ICYgXzI1NV07CiAgICB9IGVsc2UgaWYgKHYuc3Vic3RyKDAsIDMpID09PSAiaHNsIikgewogICAgICBhID0gd2FzSFNMID0gdi5tYXRjaChfc3RyaWN0TnVtRXhwKTsKCiAgICAgIGlmICghdG9IU0wpIHsKICAgICAgICBoID0gK2FbMF0gJSAzNjAgLyAzNjA7CiAgICAgICAgcyA9ICthWzFdIC8gMTAwOwogICAgICAgIGwgPSArYVsyXSAvIDEwMDsKICAgICAgICBnID0gbCA8PSAuNSA/IGwgKiAocyArIDEpIDogbCArIHMgLSBsICogczsKICAgICAgICByID0gbCAqIDIgLSBnOwogICAgICAgIGEubGVuZ3RoID4gMyAmJiAoYVszXSAqPSAxKTsgLy9jYXN0IGFzIG51bWJlcgoKICAgICAgICBhWzBdID0gX2h1ZShoICsgMSAvIDMsIHIsIGcpOwogICAgICAgIGFbMV0gPSBfaHVlKGgsIHIsIGcpOwogICAgICAgIGFbMl0gPSBfaHVlKGggLSAxIC8gMywgciwgZyk7CiAgICAgIH0gZWxzZSBpZiAofnYuaW5kZXhPZigiPSIpKSB7CiAgICAgICAgLy9pZiByZWxhdGl2ZSB2YWx1ZXMgYXJlIGZvdW5kLCBqdXN0IHJldHVybiB0aGUgcmF3IHN0cmluZ3Mgd2l0aCB0aGUgcmVsYXRpdmUgcHJlZml4ZXMgaW4gcGxhY2UuCiAgICAgICAgYSA9IHYubWF0Y2goX251bUV4cCk7CiAgICAgICAgZm9yY2VBbHBoYSAmJiBhLmxlbmd0aCA8IDQgJiYgKGFbM10gPSAxKTsKICAgICAgICByZXR1cm4gYTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgYSA9IHYubWF0Y2goX3N0cmljdE51bUV4cCkgfHwgX2NvbG9yTG9va3VwLnRyYW5zcGFyZW50OwogICAgfQoKICAgIGEgPSBhLm1hcChOdW1iZXIpOwogIH0KCiAgaWYgKHRvSFNMICYmICF3YXNIU0wpIHsKICAgIHIgPSBhWzBdIC8gXzI1NTsKICAgIGcgPSBhWzFdIC8gXzI1NTsKICAgIGIgPSBhWzJdIC8gXzI1NTsKICAgIG1heCA9IE1hdGgubWF4KHIsIGcsIGIpOwogICAgbWluID0gTWF0aC5taW4ociwgZywgYik7CiAgICBsID0gKG1heCArIG1pbikgLyAyOwoKICAgIGlmIChtYXggPT09IG1pbikgewogICAgICBoID0gcyA9IDA7CiAgICB9IGVsc2UgewogICAgICBkID0gbWF4IC0gbWluOwogICAgICBzID0gbCA+IDAuNSA/IGQgLyAoMiAtIG1heCAtIG1pbikgOiBkIC8gKG1heCArIG1pbik7CiAgICAgIGggPSBtYXggPT09IHIgPyAoZyAtIGIpIC8gZCArIChnIDwgYiA/IDYgOiAwKSA6IG1heCA9PT0gZyA/IChiIC0gcikgLyBkICsgMiA6IChyIC0gZykgLyBkICsgNDsKICAgICAgaCAqPSA2MDsKICAgIH0KCiAgICBhWzBdID0gfn4oaCArIC41KTsKICAgIGFbMV0gPSB+fihzICogMTAwICsgLjUpOwogICAgYVsyXSA9IH5+KGwgKiAxMDAgKyAuNSk7CiAgfQoKICBmb3JjZUFscGhhICYmIGEubGVuZ3RoIDwgNCAmJiAoYVszXSA9IDEpOwogIHJldHVybiBhOwp9LAogICAgX2NvbG9yT3JkZXJEYXRhID0gZnVuY3Rpb24gX2NvbG9yT3JkZXJEYXRhKHYpIHsKICAvLyBzdHJpcHMgb3V0IHRoZSBjb2xvcnMgZnJvbSB0aGUgc3RyaW5nLCBmaW5kcyBhbGwgdGhlIG51bWVyaWMgc2xvdHMgKHdpdGggdW5pdHMpIGFuZCByZXR1cm5zIGFuIGFycmF5IG9mIHRob3NlLiBUaGUgQXJyYXkgYWxzbyBoYXMgYSAiYyIgcHJvcGVydHkgd2hpY2ggaXMgYW4gQXJyYXkgb2YgdGhlIGluZGV4IHZhbHVlcyB3aGVyZSB0aGUgY29sb3JzIGJlbG9uZy4gVGhpcyBpcyB0byBoZWxwIHdvcmsgYXJvdW5kIGlzc3VlcyB3aGVyZSB0aGVyZSdzIGEgbWlzLW1hdGNoZWQgb3JkZXIgb2YgY29sb3IvbnVtZXJpYyBkYXRhIGxpa2UgZHJvcC1zaGFkb3coI2YwMCAwcHggMXB4IDJweCkgYW5kIGRyb3Atc2hhZG93KDB4IDFweCAycHggI2YwMCkuIFRoaXMgaXMgYmFzaWNhbGx5IGEgaGVscGVyIGZ1bmN0aW9uIHVzZWQgaW4gX2Zvcm1hdENvbG9ycygpCiAgdmFyIHZhbHVlcyA9IFtdLAogICAgICBjID0gW10sCiAgICAgIGkgPSAtMTsKICB2LnNwbGl0KF9jb2xvckV4cCkuZm9yRWFjaChmdW5jdGlvbiAodikgewogICAgdmFyIGEgPSB2Lm1hdGNoKF9udW1XaXRoVW5pdEV4cCkgfHwgW107CiAgICB2YWx1ZXMucHVzaC5hcHBseSh2YWx1ZXMsIGEpOwogICAgYy5wdXNoKGkgKz0gYS5sZW5ndGggKyAxKTsKICB9KTsKICB2YWx1ZXMuYyA9IGM7CiAgcmV0dXJuIHZhbHVlczsKfSwKICAgIF9mb3JtYXRDb2xvcnMgPSBmdW5jdGlvbiBfZm9ybWF0Q29sb3JzKHMsIHRvSFNMLCBvcmRlck1hdGNoRGF0YSkgewogIHZhciByZXN1bHQgPSAiIiwKICAgICAgY29sb3JzID0gKHMgKyByZXN1bHQpLm1hdGNoKF9jb2xvckV4cCksCiAgICAgIHR5cGUgPSB0b0hTTCA/ICJoc2xhKCIgOiAicmdiYSgiLAogICAgICBpID0gMCwKICAgICAgYywKICAgICAgc2hlbGwsCiAgICAgIGQsCiAgICAgIGw7CgogIGlmICghY29sb3JzKSB7CiAgICByZXR1cm4gczsKICB9CgogIGNvbG9ycyA9IGNvbG9ycy5tYXAoZnVuY3Rpb24gKGNvbG9yKSB7CiAgICByZXR1cm4gKGNvbG9yID0gc3BsaXRDb2xvcihjb2xvciwgdG9IU0wsIDEpKSAmJiB0eXBlICsgKHRvSFNMID8gY29sb3JbMF0gKyAiLCIgKyBjb2xvclsxXSArICIlLCIgKyBjb2xvclsyXSArICIlLCIgKyBjb2xvclszXSA6IGNvbG9yLmpvaW4oIiwiKSkgKyAiKSI7CiAgfSk7CgogIGlmIChvcmRlck1hdGNoRGF0YSkgewogICAgZCA9IF9jb2xvck9yZGVyRGF0YShzKTsKICAgIGMgPSBvcmRlck1hdGNoRGF0YS5jOwoKICAgIGlmIChjLmpvaW4ocmVzdWx0KSAhPT0gZC5jLmpvaW4ocmVzdWx0KSkgewogICAgICBzaGVsbCA9IHMucmVwbGFjZShfY29sb3JFeHAsICIxIikuc3BsaXQoX251bVdpdGhVbml0RXhwKTsKICAgICAgbCA9IHNoZWxsLmxlbmd0aCAtIDE7CgogICAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICAgIHJlc3VsdCArPSBzaGVsbFtpXSArICh+Yy5pbmRleE9mKGkpID8gY29sb3JzLnNoaWZ0KCkgfHwgdHlwZSArICIwLDAsMCwwKSIgOiAoZC5sZW5ndGggPyBkIDogY29sb3JzLmxlbmd0aCA/IGNvbG9ycyA6IG9yZGVyTWF0Y2hEYXRhKS5zaGlmdCgpKTsKICAgICAgfQogICAgfQogIH0KCiAgaWYgKCFzaGVsbCkgewogICAgc2hlbGwgPSBzLnNwbGl0KF9jb2xvckV4cCk7CiAgICBsID0gc2hlbGwubGVuZ3RoIC0gMTsKCiAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICByZXN1bHQgKz0gc2hlbGxbaV0gKyBjb2xvcnNbaV07CiAgICB9CiAgfQoKICByZXR1cm4gcmVzdWx0ICsgc2hlbGxbbF07Cn0sCiAgICBfY29sb3JFeHAgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIHMgPSAiKD86XFxiKD86KD86cmdifHJnYmF8aHNsfGhzbGEpXFwoLis/XFwpKXxcXEIjKD86WzAtOWEtZl17Myw0fSl7MSwyfVxcYiIsCiAgICAgIC8vd2UnbGwgZHluYW1pY2FsbHkgYnVpbGQgdGhpcyBSZWd1bGFyIEV4cHJlc3Npb24gdG8gY29uc2VydmUgZmlsZSBzaXplLiBBZnRlciBidWlsZGluZyBpdCwgaXQgd2lsbCBiZSBhYmxlIHRvIGZpbmQgcmdiKCksIHJnYmEoKSwgIyAoaGV4YWRlY2ltYWwpLCBhbmQgbmFtZWQgY29sb3IgdmFsdWVzIGxpa2UgcmVkLCBibHVlLCBwdXJwbGUsIGV0Yy4sCiAgcDsKCiAgZm9yIChwIGluIF9jb2xvckxvb2t1cCkgewogICAgcyArPSAifCIgKyBwICsgIlxcYiI7CiAgfQoKICByZXR1cm4gbmV3IFJlZ0V4cChzICsgIikiLCAiZ2kiKTsKfSgpLAogICAgX2hzbEV4cCA9IC9oc2xbYV0/XCgvLAogICAgX2NvbG9yU3RyaW5nRmlsdGVyID0gZnVuY3Rpb24gX2NvbG9yU3RyaW5nRmlsdGVyKGEpIHsKICB2YXIgY29tYmluZWQgPSBhLmpvaW4oIiAiKSwKICAgICAgdG9IU0w7CiAgX2NvbG9yRXhwLmxhc3RJbmRleCA9IDA7CgogIGlmIChfY29sb3JFeHAudGVzdChjb21iaW5lZCkpIHsKICAgIHRvSFNMID0gX2hzbEV4cC50ZXN0KGNvbWJpbmVkKTsKICAgIGFbMV0gPSBfZm9ybWF0Q29sb3JzKGFbMV0sIHRvSFNMKTsKICAgIGFbMF0gPSBfZm9ybWF0Q29sb3JzKGFbMF0sIHRvSFNMLCBfY29sb3JPcmRlckRhdGEoYVsxXSkpOyAvLyBtYWtlIHN1cmUgdGhlIG9yZGVyIG9mIG51bWJlcnMvY29sb3JzIG1hdGNoIHdpdGggdGhlIEVORCB2YWx1ZS4KCiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0sCgovKgogKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogKiBUSUNLRVIKICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICovCl90aWNrZXJBY3RpdmUsCiAgICBfdGlja2VyID0gZnVuY3Rpb24gKCkgewogIHZhciBfZ2V0VGltZSA9IERhdGUubm93LAogICAgICBfbGFnVGhyZXNob2xkID0gNTAwLAogICAgICBfYWRqdXN0ZWRMYWcgPSAzMywKICAgICAgX3N0YXJ0VGltZSA9IF9nZXRUaW1lKCksCiAgICAgIF9sYXN0VXBkYXRlID0gX3N0YXJ0VGltZSwKICAgICAgX2dhcCA9IDEwMDAgLyAyNDAsCiAgICAgIF9uZXh0VGltZSA9IF9nYXAsCiAgICAgIF9saXN0ZW5lcnMgPSBbXSwKICAgICAgX2lkLAogICAgICBfcmVxLAogICAgICBfcmFmLAogICAgICBfc2VsZiwKICAgICAgX2RlbHRhLAogICAgICBfaSwKICAgICAgX3RpY2sgPSBmdW5jdGlvbiBfdGljayh2KSB7CiAgICB2YXIgZWxhcHNlZCA9IF9nZXRUaW1lKCkgLSBfbGFzdFVwZGF0ZSwKICAgICAgICBtYW51YWwgPSB2ID09PSB0cnVlLAogICAgICAgIG92ZXJsYXAsCiAgICAgICAgZGlzcGF0Y2gsCiAgICAgICAgdGltZSwKICAgICAgICBmcmFtZTsKCiAgICBlbGFwc2VkID4gX2xhZ1RocmVzaG9sZCAmJiAoX3N0YXJ0VGltZSArPSBlbGFwc2VkIC0gX2FkanVzdGVkTGFnKTsKICAgIF9sYXN0VXBkYXRlICs9IGVsYXBzZWQ7CiAgICB0aW1lID0gX2xhc3RVcGRhdGUgLSBfc3RhcnRUaW1lOwogICAgb3ZlcmxhcCA9IHRpbWUgLSBfbmV4dFRpbWU7CgogICAgaWYgKG92ZXJsYXAgPiAwIHx8IG1hbnVhbCkgewogICAgICBmcmFtZSA9ICsrX3NlbGYuZnJhbWU7CiAgICAgIF9kZWx0YSA9IHRpbWUgLSBfc2VsZi50aW1lICogMTAwMDsKICAgICAgX3NlbGYudGltZSA9IHRpbWUgPSB0aW1lIC8gMTAwMDsKICAgICAgX25leHRUaW1lICs9IG92ZXJsYXAgKyAob3ZlcmxhcCA+PSBfZ2FwID8gNCA6IF9nYXAgLSBvdmVybGFwKTsKICAgICAgZGlzcGF0Y2ggPSAxOwogICAgfQoKICAgIG1hbnVhbCB8fCAoX2lkID0gX3JlcShfdGljaykpOyAvL21ha2Ugc3VyZSB0aGUgcmVxdWVzdCBpcyBtYWRlIGJlZm9yZSB3ZSBkaXNwYXRjaCB0aGUgInRpY2siIGV2ZW50IHNvIHRoYXQgdGltaW5nIGlzIG1haW50YWluZWQuIE90aGVyd2lzZSwgaWYgcHJvY2Vzc2luZyB0aGUgInRpY2siIHJlcXVpcmVzIGEgYnVuY2ggb2YgdGltZSAobGlrZSAxNW1zKSBhbmQgd2UncmUgdXNpbmcgYSBzZXRUaW1lb3V0KCkgdGhhdCdzIGJhc2VkIG9uIDE2LjdtcywgaXQnZCB0ZWNobmljYWxseSB0YWtlIDMxLjdtcyBiZXR3ZWVuIGZyYW1lcyBvdGhlcndpc2UuCgogICAgaWYgKGRpc3BhdGNoKSB7CiAgICAgIGZvciAoX2kgPSAwOyBfaSA8IF9saXN0ZW5lcnMubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgLy8gdXNlIF9pIGFuZCBjaGVjayBfbGlzdGVuZXJzLmxlbmd0aCBpbnN0ZWFkIG9mIGEgdmFyaWFibGUgYmVjYXVzZSBhIGxpc3RlbmVyIGNvdWxkIGdldCByZW1vdmVkIGR1cmluZyB0aGUgbG9vcCwgYW5kIGlmIHRoYXQgaGFwcGVucyB0byBhbiBlbGVtZW50IGxlc3MgdGhhbiB0aGUgY3VycmVudCBpbmRleCwgaXQnZCB0aHJvdyB0aGluZ3Mgb2ZmIGluIHRoZSBsb29wLgogICAgICAgIF9saXN0ZW5lcnNbX2ldKHRpbWUsIF9kZWx0YSwgZnJhbWUsIHYpOwogICAgICB9CiAgICB9CiAgfTsKCiAgX3NlbGYgPSB7CiAgICB0aW1lOiAwLAogICAgZnJhbWU6IDAsCiAgICB0aWNrOiBmdW5jdGlvbiB0aWNrKCkgewogICAgICBfdGljayh0cnVlKTsKICAgIH0sCiAgICBkZWx0YVJhdGlvOiBmdW5jdGlvbiBkZWx0YVJhdGlvKGZwcykgewogICAgICByZXR1cm4gX2RlbHRhIC8gKDEwMDAgLyAoZnBzIHx8IDYwKSk7CiAgICB9LAogICAgd2FrZTogZnVuY3Rpb24gd2FrZSgpIHsKICAgICAgaWYgKF9jb3JlUmVhZHkpIHsKICAgICAgICBpZiAoIV9jb3JlSW5pdHRlZCAmJiBfd2luZG93RXhpc3RzKCkpIHsKICAgICAgICAgIF93aW4gPSBfY29yZUluaXR0ZWQgPSB3aW5kb3c7CiAgICAgICAgICBfZG9jID0gX3dpbi5kb2N1bWVudCB8fCB7fTsKICAgICAgICAgIF9nbG9iYWxzLmdzYXAgPSBnc2FwOwogICAgICAgICAgKF93aW4uZ3NhcFZlcnNpb25zIHx8IChfd2luLmdzYXBWZXJzaW9ucyA9IFtdKSkucHVzaChnc2FwLnZlcnNpb24pOwoKICAgICAgICAgIF9pbnN0YWxsKF9pbnN0YWxsU2NvcGUgfHwgX3dpbi5HcmVlblNvY2tHbG9iYWxzIHx8ICFfd2luLmdzYXAgJiYgX3dpbiB8fCB7fSk7CgogICAgICAgICAgX3JhZiA9IF93aW4ucmVxdWVzdEFuaW1hdGlvbkZyYW1lOwogICAgICAgIH0KCiAgICAgICAgX2lkICYmIF9zZWxmLnNsZWVwKCk7CgogICAgICAgIF9yZXEgPSBfcmFmIHx8IGZ1bmN0aW9uIChmKSB7CiAgICAgICAgICByZXR1cm4gc2V0VGltZW91dChmLCBfbmV4dFRpbWUgLSBfc2VsZi50aW1lICogMTAwMCArIDEgfCAwKTsKICAgICAgICB9OwoKICAgICAgICBfdGlja2VyQWN0aXZlID0gMTsKCiAgICAgICAgX3RpY2soMik7CiAgICAgIH0KICAgIH0sCiAgICBzbGVlcDogZnVuY3Rpb24gc2xlZXAoKSB7CiAgICAgIChfcmFmID8gX3dpbi5jYW5jZWxBbmltYXRpb25GcmFtZSA6IGNsZWFyVGltZW91dCkoX2lkKTsKICAgICAgX3RpY2tlckFjdGl2ZSA9IDA7CiAgICAgIF9yZXEgPSBfZW1wdHlGdW5jOwogICAgfSwKICAgIGxhZ1Ntb290aGluZzogZnVuY3Rpb24gbGFnU21vb3RoaW5nKHRocmVzaG9sZCwgYWRqdXN0ZWRMYWcpIHsKICAgICAgX2xhZ1RocmVzaG9sZCA9IHRocmVzaG9sZCB8fCAxIC8gX3RpbnlOdW07IC8vemVybyBzaG91bGQgYmUgaW50ZXJwcmV0ZWQgYXMgYmFzaWNhbGx5IHVubGltaXRlZAoKICAgICAgX2FkanVzdGVkTGFnID0gTWF0aC5taW4oYWRqdXN0ZWRMYWcsIF9sYWdUaHJlc2hvbGQsIDApOwogICAgfSwKICAgIGZwczogZnVuY3Rpb24gZnBzKF9mcHMpIHsKICAgICAgX2dhcCA9IDEwMDAgLyAoX2ZwcyB8fCAyNDApOwogICAgICBfbmV4dFRpbWUgPSBfc2VsZi50aW1lICogMTAwMCArIF9nYXA7CiAgICB9LAogICAgYWRkOiBmdW5jdGlvbiBhZGQoY2FsbGJhY2spIHsKICAgICAgX2xpc3RlbmVycy5pbmRleE9mKGNhbGxiYWNrKSA8IDAgJiYgX2xpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTsKCiAgICAgIF93YWtlKCk7CiAgICB9LAogICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoY2FsbGJhY2ssIGkpIHsKICAgICAgfihpID0gX2xpc3RlbmVycy5pbmRleE9mKGNhbGxiYWNrKSkgJiYgX2xpc3RlbmVycy5zcGxpY2UoaSwgMSkgJiYgX2kgPj0gaSAmJiBfaS0tOwogICAgfSwKICAgIF9saXN0ZW5lcnM6IF9saXN0ZW5lcnMKICB9OwogIHJldHVybiBfc2VsZjsKfSgpLAogICAgX3dha2UgPSBmdW5jdGlvbiBfd2FrZSgpIHsKICByZXR1cm4gIV90aWNrZXJBY3RpdmUgJiYgX3RpY2tlci53YWtlKCk7Cn0sCiAgICAvL2Fsc28gZW5zdXJlcyB0aGUgY29yZSBjbGFzc2VzIGFyZSBpbml0aWFsaXplZC4KCi8qCiogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoqIEVBU0lORwoqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKi8KX2Vhc2VNYXAgPSB7fSwKICAgIF9jdXN0b21FYXNlRXhwID0gL15bXGQuXC1NXVtcZC5cLSxcc10vLAogICAgX3F1b3Rlc0V4cCA9IC9bIiddL2csCiAgICBfcGFyc2VPYmplY3RJblN0cmluZyA9IGZ1bmN0aW9uIF9wYXJzZU9iamVjdEluU3RyaW5nKHZhbHVlKSB7CiAgLy90YWtlcyBhIHN0cmluZyBsaWtlICJ7d2lnZ2xlczoxMCwgdHlwZTphbnRpY2lwYXRlfSkiIGFuZCB0dXJucyBpdCBpbnRvIGEgcmVhbCBvYmplY3QuIE5vdGljZSBpdCBlbmRzIGluICIpIiBhbmQgaW5jbHVkZXMgdGhlIHt9IHdyYXBwZXJzLiBUaGlzIGlzIGJlY2F1c2Ugd2Ugb25seSB1c2UgdGhpcyBmdW5jdGlvbiBmb3IgcGFyc2luZyBlYXNlIGNvbmZpZ3MgYW5kIHByaW9yaXRpemVkIG9wdGltaXphdGlvbiByYXRoZXIgdGhhbiByZXVzYWJpbGl0eS4KICB2YXIgb2JqID0ge30sCiAgICAgIHNwbGl0ID0gdmFsdWUuc3Vic3RyKDEsIHZhbHVlLmxlbmd0aCAtIDMpLnNwbGl0KCI6IiksCiAgICAgIGtleSA9IHNwbGl0WzBdLAogICAgICBpID0gMSwKICAgICAgbCA9IHNwbGl0Lmxlbmd0aCwKICAgICAgaW5kZXgsCiAgICAgIHZhbCwKICAgICAgcGFyc2VkVmFsOwoKICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgdmFsID0gc3BsaXRbaV07CiAgICBpbmRleCA9IGkgIT09IGwgLSAxID8gdmFsLmxhc3RJbmRleE9mKCIsIikgOiB2YWwubGVuZ3RoOwogICAgcGFyc2VkVmFsID0gdmFsLnN1YnN0cigwLCBpbmRleCk7CiAgICBvYmpba2V5XSA9IGlzTmFOKHBhcnNlZFZhbCkgPyBwYXJzZWRWYWwucmVwbGFjZShfcXVvdGVzRXhwLCAiIikudHJpbSgpIDogK3BhcnNlZFZhbDsKICAgIGtleSA9IHZhbC5zdWJzdHIoaW5kZXggKyAxKS50cmltKCk7CiAgfQoKICByZXR1cm4gb2JqOwp9LAogICAgX3ZhbHVlSW5QYXJlbnRoZXNlcyA9IGZ1bmN0aW9uIF92YWx1ZUluUGFyZW50aGVzZXModmFsdWUpIHsKICB2YXIgb3BlbiA9IHZhbHVlLmluZGV4T2YoIigiKSArIDEsCiAgICAgIGNsb3NlID0gdmFsdWUuaW5kZXhPZigiKSIpLAogICAgICBuZXN0ZWQgPSB2YWx1ZS5pbmRleE9mKCIoIiwgb3Blbik7CiAgcmV0dXJuIHZhbHVlLnN1YnN0cmluZyhvcGVuLCB+bmVzdGVkICYmIG5lc3RlZCA8IGNsb3NlID8gdmFsdWUuaW5kZXhPZigiKSIsIGNsb3NlICsgMSkgOiBjbG9zZSk7Cn0sCiAgICBfY29uZmlnRWFzZUZyb21TdHJpbmcgPSBmdW5jdGlvbiBfY29uZmlnRWFzZUZyb21TdHJpbmcobmFtZSkgewogIC8vbmFtZSBjYW4gYmUgYSBzdHJpbmcgbGlrZSAiZWxhc3RpYy5vdXQoMSwwLjUpIiwgYW5kIHBhc3MgaW4gX2Vhc2VNYXAgYXMgb2JqIGFuZCBpdCdsbCBwYXJzZSBpdCBvdXQgYW5kIGNhbGwgdGhlIGFjdHVhbCBmdW5jdGlvbiBsaWtlIF9lYXNlTWFwLkVsYXN0aWMuZWFzZU91dC5jb25maWcoMSwwLjUpLiBJdCB3aWxsIGFsc28gcGFyc2UgY3VzdG9tIGVhc2Ugc3RyaW5ncyBhcyBsb25nIGFzIEN1c3RvbUVhc2UgaXMgbG9hZGVkIGFuZCByZWdpc3RlcmVkIChpbnRlcm5hbGx5IGFzIF9lYXNlTWFwLl9DRSkuCiAgdmFyIHNwbGl0ID0gKG5hbWUgKyAiIikuc3BsaXQoIigiKSwKICAgICAgZWFzZSA9IF9lYXNlTWFwW3NwbGl0WzBdXTsKICByZXR1cm4gZWFzZSAmJiBzcGxpdC5sZW5ndGggPiAxICYmIGVhc2UuY29uZmlnID8gZWFzZS5jb25maWcuYXBwbHkobnVsbCwgfm5hbWUuaW5kZXhPZigieyIpID8gW19wYXJzZU9iamVjdEluU3RyaW5nKHNwbGl0WzFdKV0gOiBfdmFsdWVJblBhcmVudGhlc2VzKG5hbWUpLnNwbGl0KCIsIikubWFwKF9udW1lcmljSWZQb3NzaWJsZSkpIDogX2Vhc2VNYXAuX0NFICYmIF9jdXN0b21FYXNlRXhwLnRlc3QobmFtZSkgPyBfZWFzZU1hcC5fQ0UoIiIsIG5hbWUpIDogZWFzZTsKfSwKICAgIF9pbnZlcnRFYXNlID0gZnVuY3Rpb24gX2ludmVydEVhc2UoZWFzZSkgewogIHJldHVybiBmdW5jdGlvbiAocCkgewogICAgcmV0dXJuIDEgLSBlYXNlKDEgLSBwKTsKICB9Owp9LAogICAgLy8gYWxsb3cgeW95b0Vhc2UgdG8gYmUgc2V0IGluIGNoaWxkcmVuIGFuZCBoYXZlIHRob3NlIGFmZmVjdGVkIHdoZW4gdGhlIHBhcmVudC9hbmNlc3RvciB0aW1lbGluZSB5b3lvcy4KX3Byb3BhZ2F0ZVlveW9FYXNlID0gZnVuY3Rpb24gX3Byb3BhZ2F0ZVlveW9FYXNlKHRpbWVsaW5lLCBpc1lveW8pIHsKICB2YXIgY2hpbGQgPSB0aW1lbGluZS5fZmlyc3QsCiAgICAgIGVhc2U7CgogIHdoaWxlIChjaGlsZCkgewogICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgVGltZWxpbmUpIHsKICAgICAgX3Byb3BhZ2F0ZVlveW9FYXNlKGNoaWxkLCBpc1lveW8pOwogICAgfSBlbHNlIGlmIChjaGlsZC52YXJzLnlveW9FYXNlICYmICghY2hpbGQuX3lveW8gfHwgIWNoaWxkLl9yZXBlYXQpICYmIGNoaWxkLl95b3lvICE9PSBpc1lveW8pIHsKICAgICAgaWYgKGNoaWxkLnRpbWVsaW5lKSB7CiAgICAgICAgX3Byb3BhZ2F0ZVlveW9FYXNlKGNoaWxkLnRpbWVsaW5lLCBpc1lveW8pOwogICAgICB9IGVsc2UgewogICAgICAgIGVhc2UgPSBjaGlsZC5fZWFzZTsKICAgICAgICBjaGlsZC5fZWFzZSA9IGNoaWxkLl95RWFzZTsKICAgICAgICBjaGlsZC5feUVhc2UgPSBlYXNlOwogICAgICAgIGNoaWxkLl95b3lvID0gaXNZb3lvOwogICAgICB9CiAgICB9CgogICAgY2hpbGQgPSBjaGlsZC5fbmV4dDsKICB9Cn0sCiAgICBfcGFyc2VFYXNlID0gZnVuY3Rpb24gX3BhcnNlRWFzZShlYXNlLCBkZWZhdWx0RWFzZSkgewogIHJldHVybiAhZWFzZSA/IGRlZmF1bHRFYXNlIDogKF9pc0Z1bmN0aW9uKGVhc2UpID8gZWFzZSA6IF9lYXNlTWFwW2Vhc2VdIHx8IF9jb25maWdFYXNlRnJvbVN0cmluZyhlYXNlKSkgfHwgZGVmYXVsdEVhc2U7Cn0sCiAgICBfaW5zZXJ0RWFzZSA9IGZ1bmN0aW9uIF9pbnNlcnRFYXNlKG5hbWVzLCBlYXNlSW4sIGVhc2VPdXQsIGVhc2VJbk91dCkgewogIGlmIChlYXNlT3V0ID09PSB2b2lkIDApIHsKICAgIGVhc2VPdXQgPSBmdW5jdGlvbiBlYXNlT3V0KHApIHsKICAgICAgcmV0dXJuIDEgLSBlYXNlSW4oMSAtIHApOwogICAgfTsKICB9CgogIGlmIChlYXNlSW5PdXQgPT09IHZvaWQgMCkgewogICAgZWFzZUluT3V0ID0gZnVuY3Rpb24gZWFzZUluT3V0KHApIHsKICAgICAgcmV0dXJuIHAgPCAuNSA/IGVhc2VJbihwICogMikgLyAyIDogMSAtIGVhc2VJbigoMSAtIHApICogMikgLyAyOwogICAgfTsKICB9CgogIHZhciBlYXNlID0gewogICAgZWFzZUluOiBlYXNlSW4sCiAgICBlYXNlT3V0OiBlYXNlT3V0LAogICAgZWFzZUluT3V0OiBlYXNlSW5PdXQKICB9LAogICAgICBsb3dlcmNhc2VOYW1lOwoKICBfZm9yRWFjaE5hbWUobmFtZXMsIGZ1bmN0aW9uIChuYW1lKSB7CiAgICBfZWFzZU1hcFtuYW1lXSA9IF9nbG9iYWxzW25hbWVdID0gZWFzZTsKICAgIF9lYXNlTWFwW2xvd2VyY2FzZU5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCldID0gZWFzZU91dDsKCiAgICBmb3IgKHZhciBwIGluIGVhc2UpIHsKICAgICAgX2Vhc2VNYXBbbG93ZXJjYXNlTmFtZSArIChwID09PSAiZWFzZUluIiA/ICIuaW4iIDogcCA9PT0gImVhc2VPdXQiID8gIi5vdXQiIDogIi5pbk91dCIpXSA9IF9lYXNlTWFwW25hbWUgKyAiLiIgKyBwXSA9IGVhc2VbcF07CiAgICB9CiAgfSk7CgogIHJldHVybiBlYXNlOwp9LAogICAgX2Vhc2VJbk91dEZyb21PdXQgPSBmdW5jdGlvbiBfZWFzZUluT3V0RnJvbU91dChlYXNlT3V0KSB7CiAgcmV0dXJuIGZ1bmN0aW9uIChwKSB7CiAgICByZXR1cm4gcCA8IC41ID8gKDEgLSBlYXNlT3V0KDEgLSBwICogMikpIC8gMiA6IC41ICsgZWFzZU91dCgocCAtIC41KSAqIDIpIC8gMjsKICB9Owp9LAogICAgX2NvbmZpZ0VsYXN0aWMgPSBmdW5jdGlvbiBfY29uZmlnRWxhc3RpYyh0eXBlLCBhbXBsaXR1ZGUsIHBlcmlvZCkgewogIHZhciBwMSA9IGFtcGxpdHVkZSA+PSAxID8gYW1wbGl0dWRlIDogMSwKICAgICAgLy9ub3RlOiBpZiBhbXBsaXR1ZGUgaXMgPCAxLCB3ZSBzaW1wbHkgYWRqdXN0IHRoZSBwZXJpb2QgZm9yIGEgbW9yZSBuYXR1cmFsIGZlZWwuIE90aGVyd2lzZSB0aGUgbWF0aCBkb2Vzbid0IHdvcmsgcmlnaHQgYW5kIHRoZSBjdXJ2ZSBzdGFydHMgYXQgMS4KICBwMiA9IChwZXJpb2QgfHwgKHR5cGUgPyAuMyA6IC40NSkpIC8gKGFtcGxpdHVkZSA8IDEgPyBhbXBsaXR1ZGUgOiAxKSwKICAgICAgcDMgPSBwMiAvIF8yUEkgKiAoTWF0aC5hc2luKDEgLyBwMSkgfHwgMCksCiAgICAgIGVhc2VPdXQgPSBmdW5jdGlvbiBlYXNlT3V0KHApIHsKICAgIHJldHVybiBwID09PSAxID8gMSA6IHAxICogTWF0aC5wb3coMiwgLTEwICogcCkgKiBfc2luKChwIC0gcDMpICogcDIpICsgMTsKICB9LAogICAgICBlYXNlID0gdHlwZSA9PT0gIm91dCIgPyBlYXNlT3V0IDogdHlwZSA9PT0gImluIiA/IGZ1bmN0aW9uIChwKSB7CiAgICByZXR1cm4gMSAtIGVhc2VPdXQoMSAtIHApOwogIH0gOiBfZWFzZUluT3V0RnJvbU91dChlYXNlT3V0KTsKCiAgcDIgPSBfMlBJIC8gcDI7IC8vcHJlY2FsY3VsYXRlIHRvIG9wdGltaXplCgogIGVhc2UuY29uZmlnID0gZnVuY3Rpb24gKGFtcGxpdHVkZSwgcGVyaW9kKSB7CiAgICByZXR1cm4gX2NvbmZpZ0VsYXN0aWModHlwZSwgYW1wbGl0dWRlLCBwZXJpb2QpOwogIH07CgogIHJldHVybiBlYXNlOwp9LAogICAgX2NvbmZpZ0JhY2sgPSBmdW5jdGlvbiBfY29uZmlnQmFjayh0eXBlLCBvdmVyc2hvb3QpIHsKICBpZiAob3ZlcnNob290ID09PSB2b2lkIDApIHsKICAgIG92ZXJzaG9vdCA9IDEuNzAxNTg7CiAgfQoKICB2YXIgZWFzZU91dCA9IGZ1bmN0aW9uIGVhc2VPdXQocCkgewogICAgcmV0dXJuIHAgPyAtLXAgKiBwICogKChvdmVyc2hvb3QgKyAxKSAqIHAgKyBvdmVyc2hvb3QpICsgMSA6IDA7CiAgfSwKICAgICAgZWFzZSA9IHR5cGUgPT09ICJvdXQiID8gZWFzZU91dCA6IHR5cGUgPT09ICJpbiIgPyBmdW5jdGlvbiAocCkgewogICAgcmV0dXJuIDEgLSBlYXNlT3V0KDEgLSBwKTsKICB9IDogX2Vhc2VJbk91dEZyb21PdXQoZWFzZU91dCk7CgogIGVhc2UuY29uZmlnID0gZnVuY3Rpb24gKG92ZXJzaG9vdCkgewogICAgcmV0dXJuIF9jb25maWdCYWNrKHR5cGUsIG92ZXJzaG9vdCk7CiAgfTsKCiAgcmV0dXJuIGVhc2U7Cn07IC8vIGEgY2hlYXBlciAoa2IgYW5kIGNwdSkgYnV0IG1vcmUgbWlsZCB3YXkgdG8gZ2V0IGEgcGFyYW1ldGVyaXplZCB3ZWlnaHRlZCBlYXNlIGJ5IGZlZWRpbmcgaW4gYSB2YWx1ZSBiZXR3ZWVuIC0xIChlYXNlSW4pIGFuZCAxIChlYXNlT3V0KSB3aGVyZSAwIGlzIGxpbmVhci4KLy8gX3dlaWdodGVkRWFzZSA9IHJhdGlvID0+IHsKLy8gCWxldCB5ID0gMC41ICsgcmF0aW8gLyAyOwovLyAJcmV0dXJuIHAgPT4gKDIgKiAoMSAtIHApICogcCAqIHkgKyBwICogcCk7Ci8vIH0sCi8vIGEgc3Ryb25nZXIgKGJ1dCBtb3JlIGV4cGVuc2l2ZSBrYi9jcHUpIHBhcmFtZXRlcml6ZWQgd2VpZ2h0ZWQgZWFzZSB0aGF0IGxldHMgeW91IGZlZWQgaW4gYSB2YWx1ZSBiZXR3ZWVuIC0xIChlYXNlSW4pIGFuZCAxIChlYXNlT3V0KSB3aGVyZSAwIGlzIGxpbmVhci4KLy8gX3dlaWdodGVkRWFzZVN0cm9uZyA9IHJhdGlvID0+IHsKLy8gCXJhdGlvID0gLjUgKyByYXRpbyAvIDI7Ci8vIAlsZXQgbyA9IDEgLyAzICogKHJhdGlvIDwgLjUgPyByYXRpbyA6IDEgLSByYXRpbyksCi8vIAkJYiA9IHJhdGlvIC0gbywKLy8gCQljID0gcmF0aW8gKyBvOwovLyAJcmV0dXJuIHAgPT4gcCA9PT0gMSA/IHAgOiAzICogYiAqICgxIC0gcCkgKiAoMSAtIHApICogcCArIDMgKiBjICogKDEgLSBwKSAqIHAgKiBwICsgcCAqIHAgKiBwOwovLyB9OwoKCl9mb3JFYWNoTmFtZSgiTGluZWFyLFF1YWQsQ3ViaWMsUXVhcnQsUXVpbnQsU3Ryb25nIiwgZnVuY3Rpb24gKG5hbWUsIGkpIHsKICB2YXIgcG93ZXIgPSBpIDwgNSA/IGkgKyAxIDogaTsKCiAgX2luc2VydEVhc2UobmFtZSArICIsUG93ZXIiICsgKHBvd2VyIC0gMSksIGkgPyBmdW5jdGlvbiAocCkgewogICAgcmV0dXJuIE1hdGgucG93KHAsIHBvd2VyKTsKICB9IDogZnVuY3Rpb24gKHApIHsKICAgIHJldHVybiBwOwogIH0sIGZ1bmN0aW9uIChwKSB7CiAgICByZXR1cm4gMSAtIE1hdGgucG93KDEgLSBwLCBwb3dlcik7CiAgfSwgZnVuY3Rpb24gKHApIHsKICAgIHJldHVybiBwIDwgLjUgPyBNYXRoLnBvdyhwICogMiwgcG93ZXIpIC8gMiA6IDEgLSBNYXRoLnBvdygoMSAtIHApICogMiwgcG93ZXIpIC8gMjsKICB9KTsKfSk7CgpfZWFzZU1hcC5MaW5lYXIuZWFzZU5vbmUgPSBfZWFzZU1hcC5ub25lID0gX2Vhc2VNYXAuTGluZWFyLmVhc2VJbjsKCl9pbnNlcnRFYXNlKCJFbGFzdGljIiwgX2NvbmZpZ0VsYXN0aWMoImluIiksIF9jb25maWdFbGFzdGljKCJvdXQiKSwgX2NvbmZpZ0VsYXN0aWMoKSk7CgooZnVuY3Rpb24gKG4sIGMpIHsKICB2YXIgbjEgPSAxIC8gYywKICAgICAgbjIgPSAyICogbjEsCiAgICAgIG4zID0gMi41ICogbjEsCiAgICAgIGVhc2VPdXQgPSBmdW5jdGlvbiBlYXNlT3V0KHApIHsKICAgIHJldHVybiBwIDwgbjEgPyBuICogcCAqIHAgOiBwIDwgbjIgPyBuICogTWF0aC5wb3cocCAtIDEuNSAvIGMsIDIpICsgLjc1IDogcCA8IG4zID8gbiAqIChwIC09IDIuMjUgLyBjKSAqIHAgKyAuOTM3NSA6IG4gKiBNYXRoLnBvdyhwIC0gMi42MjUgLyBjLCAyKSArIC45ODQzNzU7CiAgfTsKCiAgX2luc2VydEVhc2UoIkJvdW5jZSIsIGZ1bmN0aW9uIChwKSB7CiAgICByZXR1cm4gMSAtIGVhc2VPdXQoMSAtIHApOwogIH0sIGVhc2VPdXQpOwp9KSg3LjU2MjUsIDIuNzUpOwoKX2luc2VydEVhc2UoIkV4cG8iLCBmdW5jdGlvbiAocCkgewogIHJldHVybiBwID8gTWF0aC5wb3coMiwgMTAgKiAocCAtIDEpKSA6IDA7Cn0pOwoKX2luc2VydEVhc2UoIkNpcmMiLCBmdW5jdGlvbiAocCkgewogIHJldHVybiAtKF9zcXJ0KDEgLSBwICogcCkgLSAxKTsKfSk7CgpfaW5zZXJ0RWFzZSgiU2luZSIsIGZ1bmN0aW9uIChwKSB7CiAgcmV0dXJuIHAgPT09IDEgPyAxIDogLV9jb3MocCAqIF9IQUxGX1BJKSArIDE7Cn0pOwoKX2luc2VydEVhc2UoIkJhY2siLCBfY29uZmlnQmFjaygiaW4iKSwgX2NvbmZpZ0JhY2soIm91dCIpLCBfY29uZmlnQmFjaygpKTsKCl9lYXNlTWFwLlN0ZXBwZWRFYXNlID0gX2Vhc2VNYXAuc3RlcHMgPSBfZ2xvYmFscy5TdGVwcGVkRWFzZSA9IHsKICBjb25maWc6IGZ1bmN0aW9uIGNvbmZpZyhzdGVwcywgaW1tZWRpYXRlU3RhcnQpIHsKICAgIGlmIChzdGVwcyA9PT0gdm9pZCAwKSB7CiAgICAgIHN0ZXBzID0gMTsKICAgIH0KCiAgICB2YXIgcDEgPSAxIC8gc3RlcHMsCiAgICAgICAgcDIgPSBzdGVwcyArIChpbW1lZGlhdGVTdGFydCA/IDAgOiAxKSwKICAgICAgICBwMyA9IGltbWVkaWF0ZVN0YXJ0ID8gMSA6IDAsCiAgICAgICAgbWF4ID0gMSAtIF90aW55TnVtOwogICAgcmV0dXJuIGZ1bmN0aW9uIChwKSB7CiAgICAgIHJldHVybiAoKHAyICogX2NsYW1wKDAsIG1heCwgcCkgfCAwKSArIHAzKSAqIHAxOwogICAgfTsKICB9Cn07Cl9kZWZhdWx0cy5lYXNlID0gX2Vhc2VNYXBbInF1YWQub3V0Il07CgpfZm9yRWFjaE5hbWUoIm9uQ29tcGxldGUsb25VcGRhdGUsb25TdGFydCxvblJlcGVhdCxvblJldmVyc2VDb21wbGV0ZSxvbkludGVycnVwdCIsIGZ1bmN0aW9uIChuYW1lKSB7CiAgcmV0dXJuIF9jYWxsYmFja05hbWVzICs9IG5hbWUgKyAiLCIgKyBuYW1lICsgIlBhcmFtcywiOwp9KTsKLyoKICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICogQ0FDSEUKICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICovCgoKZXhwb3J0IHZhciBHU0NhY2hlID0gZnVuY3Rpb24gR1NDYWNoZSh0YXJnZXQsIGhhcm5lc3MpIHsKICB0aGlzLmlkID0gX2dzSUQrKzsKICB0YXJnZXQuX2dzYXAgPSB0aGlzOwogIHRoaXMudGFyZ2V0ID0gdGFyZ2V0OwogIHRoaXMuaGFybmVzcyA9IGhhcm5lc3M7CiAgdGhpcy5nZXQgPSBoYXJuZXNzID8gaGFybmVzcy5nZXQgOiBfZ2V0UHJvcGVydHk7CiAgdGhpcy5zZXQgPSBoYXJuZXNzID8gaGFybmVzcy5nZXRTZXR0ZXIgOiBfZ2V0U2V0dGVyOwp9OwovKgogKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogKiBBTklNQVRJT04KICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICovCgpleHBvcnQgdmFyIEFuaW1hdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQW5pbWF0aW9uKHZhcnMpIHsKICAgIHRoaXMudmFycyA9IHZhcnM7CiAgICB0aGlzLl9kZWxheSA9ICt2YXJzLmRlbGF5IHx8IDA7CgogICAgaWYgKHRoaXMuX3JlcGVhdCA9IHZhcnMucmVwZWF0ID09PSBJbmZpbml0eSA/IC0yIDogdmFycy5yZXBlYXQgfHwgMCkgewogICAgICAvLyBUT0RPOiByZXBlYXQ6IEluZmluaXR5IG9uIGEgdGltZWxpbmUncyBjaGlsZHJlbiBtdXN0IGZsYWcgdGhhdCB0aW1lbGluZSBpbnRlcm5hbGx5IGFuZCBhZmZlY3QgaXRzIHRvdGFsRHVyYXRpb24sIG90aGVyd2lzZSBpdCdsbCBzdG9wIGluIHRoZSBuZWdhdGl2ZSBkaXJlY3Rpb24gd2hlbiByZWFjaGluZyB0aGUgc3RhcnQuCiAgICAgIHRoaXMuX3JEZWxheSA9IHZhcnMucmVwZWF0RGVsYXkgfHwgMDsKICAgICAgdGhpcy5feW95byA9ICEhdmFycy55b3lvIHx8ICEhdmFycy55b3lvRWFzZTsKICAgIH0KCiAgICB0aGlzLl90cyA9IDE7CgogICAgX3NldER1cmF0aW9uKHRoaXMsICt2YXJzLmR1cmF0aW9uLCAxLCAxKTsKCiAgICB0aGlzLmRhdGEgPSB2YXJzLmRhdGE7CiAgICBfdGlja2VyQWN0aXZlIHx8IF90aWNrZXIud2FrZSgpOwogIH0KCiAgdmFyIF9wcm90byA9IEFuaW1hdGlvbi5wcm90b3R5cGU7CgogIF9wcm90by5kZWxheSA9IGZ1bmN0aW9uIGRlbGF5KHZhbHVlKSB7CiAgICBpZiAodmFsdWUgfHwgdmFsdWUgPT09IDApIHsKICAgICAgdGhpcy5wYXJlbnQgJiYgdGhpcy5wYXJlbnQuc21vb3RoQ2hpbGRUaW1pbmcgJiYgdGhpcy5zdGFydFRpbWUodGhpcy5fc3RhcnQgKyB2YWx1ZSAtIHRoaXMuX2RlbGF5KTsKICAgICAgdGhpcy5fZGVsYXkgPSB2YWx1ZTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuX2RlbGF5OwogIH07CgogIF9wcm90by5kdXJhdGlvbiA9IGZ1bmN0aW9uIGR1cmF0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IHRoaXMudG90YWxEdXJhdGlvbih0aGlzLl9yZXBlYXQgPiAwID8gdmFsdWUgKyAodmFsdWUgKyB0aGlzLl9yRGVsYXkpICogdGhpcy5fcmVwZWF0IDogdmFsdWUpIDogdGhpcy50b3RhbER1cmF0aW9uKCkgJiYgdGhpcy5fZHVyOwogIH07CgogIF9wcm90by50b3RhbER1cmF0aW9uID0gZnVuY3Rpb24gdG90YWxEdXJhdGlvbih2YWx1ZSkgewogICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgIHJldHVybiB0aGlzLl90RHVyOwogICAgfQoKICAgIHRoaXMuX2RpcnR5ID0gMDsKICAgIHJldHVybiBfc2V0RHVyYXRpb24odGhpcywgdGhpcy5fcmVwZWF0IDwgMCA/IHZhbHVlIDogKHZhbHVlIC0gdGhpcy5fcmVwZWF0ICogdGhpcy5fckRlbGF5KSAvICh0aGlzLl9yZXBlYXQgKyAxKSk7CiAgfTsKCiAgX3Byb3RvLnRvdGFsVGltZSA9IGZ1bmN0aW9uIHRvdGFsVGltZShfdG90YWxUaW1lLCBzdXBwcmVzc0V2ZW50cykgewogICAgX3dha2UoKTsKCiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3RUaW1lOwogICAgfQoKICAgIHZhciBwYXJlbnQgPSB0aGlzLl9kcDsKCiAgICBpZiAocGFyZW50ICYmIHBhcmVudC5zbW9vdGhDaGlsZFRpbWluZyAmJiB0aGlzLl90cykgewogICAgICBfYWxpZ25QbGF5aGVhZCh0aGlzLCBfdG90YWxUaW1lKTsKCiAgICAgICFwYXJlbnQuX2RwIHx8IHBhcmVudC5wYXJlbnQgfHwgX3Bvc3RBZGRDaGVja3MocGFyZW50LCB0aGlzKTsgLy8gZWRnZSBjYXNlOiBpZiB0aGlzIGlzIGEgY2hpbGQgb2YgYSB0aW1lbGluZSB0aGF0IGFscmVhZHkgY29tcGxldGVkLCBmb3IgZXhhbXBsZSwgd2UgbXVzdCByZS1hY3RpdmF0ZSB0aGUgcGFyZW50LgogICAgICAvL2luIGNhc2UgYW55IG9mIHRoZSBhbmNlc3RvciB0aW1lbGluZXMgaGFkIGNvbXBsZXRlZCBidXQgc2hvdWxkIG5vdyBiZSBlbmFibGVkLCB3ZSBzaG91bGQgcmVzZXQgdGhlaXIgdG90YWxUaW1lKCkgd2hpY2ggd2lsbCBhbHNvIGVuc3VyZSB0aGF0IHRoZXkncmUgbGluZWQgdXAgcHJvcGVybHkgYW5kIGVuYWJsZWQuIFNraXAgZm9yIGFuaW1hdGlvbnMgdGhhdCBhcmUgb24gdGhlIHJvb3QgKHdhc3RlZnVsKS4gRXhhbXBsZTogYSBUaW1lbGluZUxpdGUuZXhwb3J0Um9vdCgpIGlzIHBlcmZvcm1lZCB3aGVuIHRoZXJlJ3MgYSBwYXVzZWQgdHdlZW4gb24gdGhlIHJvb3QsIHRoZSBleHBvcnQgd2lsbCBub3QgY29tcGxldGUgdW50aWwgdGhhdCB0d2VlbiBpcyB1bnBhdXNlZCwgYnV0IGltYWdpbmUgYSBjaGlsZCBnZXRzIHJlc3RhcnRlZCBsYXRlciwgYWZ0ZXIgYWxsIFt1bnBhdXNlZF0gdHdlZW5zIGhhdmUgY29tcGxldGVkLiBUaGUgc3RhcnQgb2YgdGhhdCBjaGlsZCB3b3VsZCBnZXQgcHVzaGVkIG91dCwgYnV0IG9uZSBvZiB0aGUgYW5jZXN0b3JzIG1heSBoYXZlIGNvbXBsZXRlZC4KCiAgICAgIHdoaWxlIChwYXJlbnQgJiYgcGFyZW50LnBhcmVudCkgewogICAgICAgIGlmIChwYXJlbnQucGFyZW50Ll90aW1lICE9PSBwYXJlbnQuX3N0YXJ0ICsgKHBhcmVudC5fdHMgPj0gMCA/IHBhcmVudC5fdFRpbWUgLyBwYXJlbnQuX3RzIDogKHBhcmVudC50b3RhbER1cmF0aW9uKCkgLSBwYXJlbnQuX3RUaW1lKSAvIC1wYXJlbnQuX3RzKSkgewogICAgICAgICAgcGFyZW50LnRvdGFsVGltZShwYXJlbnQuX3RUaW1lLCB0cnVlKTsKICAgICAgICB9CgogICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5wYXJlbnQgJiYgdGhpcy5fZHAuYXV0b1JlbW92ZUNoaWxkcmVuICYmICh0aGlzLl90cyA+IDAgJiYgX3RvdGFsVGltZSA8IHRoaXMuX3REdXIgfHwgdGhpcy5fdHMgPCAwICYmIF90b3RhbFRpbWUgPiAwIHx8ICF0aGlzLl90RHVyICYmICFfdG90YWxUaW1lKSkgewogICAgICAgIC8vaWYgdGhlIGFuaW1hdGlvbiBkb2Vzbid0IGhhdmUgYSBwYXJlbnQsIHB1dCBpdCBiYWNrIGludG8gaXRzIGxhc3QgcGFyZW50IChyZWNvcmRlZCBhcyBfZHAgZm9yIGV4YWN0bHkgY2FzZXMgbGlrZSB0aGlzKS4gTGltaXQgdG8gcGFyZW50cyB3aXRoIGF1dG9SZW1vdmVDaGlsZHJlbiAobGlrZSBnbG9iYWxUaW1lbGluZSkgc28gdGhhdCBpZiB0aGUgdXNlciBtYW51YWxseSByZW1vdmVzIGFuIGFuaW1hdGlvbiBmcm9tIGEgdGltZWxpbmUgYW5kIHRoZW4gYWx0ZXJzIGl0cyBwbGF5aGVhZCwgaXQgZG9lc24ndCBnZXQgYWRkZWQgYmFjayBpbi4KICAgICAgICBfYWRkVG9UaW1lbGluZSh0aGlzLl9kcCwgdGhpcywgdGhpcy5fc3RhcnQgLSB0aGlzLl9kZWxheSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5fdFRpbWUgIT09IF90b3RhbFRpbWUgfHwgIXRoaXMuX2R1ciAmJiAhc3VwcHJlc3NFdmVudHMgfHwgdGhpcy5faW5pdHRlZCAmJiBNYXRoLmFicyh0aGlzLl96VGltZSkgPT09IF90aW55TnVtIHx8ICFfdG90YWxUaW1lICYmICF0aGlzLl9pbml0dGVkICYmICh0aGlzLmFkZCB8fCB0aGlzLl9wdExvb2t1cCkpIHsKICAgICAgLy8gY2hlY2sgZm9yIF9wdExvb2t1cCBvbiBhIFR3ZWVuIGluc3RhbmNlIHRvIGVuc3VyZSBpdCBoYXMgYWN0dWFsbHkgZmluaXNoZWQgYmVpbmcgaW5zdGFudGlhdGVkLCBvdGhlcndpc2UgaWYgdGhpcy5yZXZlcnNlKCkgZ2V0cyBjYWxsZWQgaW4gdGhlIEFuaW1hdGlvbiBjb25zdHJ1Y3RvciwgaXQgY291bGQgdHJpZ2dlciBhIHJlbmRlcigpIGhlcmUgZXZlbiB0aG91Z2ggdGhlIF90YXJnZXRzIHdlcmVuJ3QgcG9wdWxhdGVkLCB0aHVzIHdoZW4gX2luaXQoKSBpcyBjYWxsZWQgdGhlcmUgd29uJ3QgYmUgYW55IFByb3BUd2VlbnMgKGl0J2xsIGFjdCBsaWtlIHRoZSB0d2VlbiBpcyBub24tZnVuY3Rpb25hbCkKICAgICAgdGhpcy5fdHMgfHwgKHRoaXMuX3BUaW1lID0gX3RvdGFsVGltZSk7IC8vIG90aGVyd2lzZSwgaWYgYW4gYW5pbWF0aW9uIGlzIHBhdXNlZCwgdGhlbiB0aGUgcGxheWhlYWQgaXMgbW92ZWQgYmFjayB0byB6ZXJvLCB0aGVuIHJlc3VtZWQsIGl0J2QgcmV2ZXJ0IGJhY2sgdG8gdGhlIG9yaWdpbmFsIHRpbWUgYXQgdGhlIHBhdXNlCiAgICAgIC8vaWYgKCF0aGlzLl9sb2NrKSB7IC8vIGF2b2lkIGVuZGxlc3MgcmVjdXJzaW9uIChub3Qgc3VyZSB3ZSBuZWVkIHRoaXMgeWV0IG9yIGlmIGl0J3Mgd29ydGggdGhlIHBlcmZvcm1hbmNlIGhpdCkKICAgICAgLy8gICB0aGlzLl9sb2NrID0gMTsKCiAgICAgIF9sYXp5U2FmZVJlbmRlcih0aGlzLCBfdG90YWxUaW1lLCBzdXBwcmVzc0V2ZW50cyk7IC8vICAgdGhpcy5fbG9jayA9IDA7CiAgICAgIC8vfQoKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwoKICBfcHJvdG8udGltZSA9IGZ1bmN0aW9uIHRpbWUodmFsdWUsIHN1cHByZXNzRXZlbnRzKSB7CiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IHRoaXMudG90YWxUaW1lKE1hdGgubWluKHRoaXMudG90YWxEdXJhdGlvbigpLCB2YWx1ZSArIF9lbGFwc2VkQ3ljbGVEdXJhdGlvbih0aGlzKSkgJSAodGhpcy5fZHVyICsgdGhpcy5fckRlbGF5KSB8fCAodmFsdWUgPyB0aGlzLl9kdXIgOiAwKSwgc3VwcHJlc3NFdmVudHMpIDogdGhpcy5fdGltZTsgLy8gbm90ZTogaWYgdGhlIG1vZHVsdXMgcmVzdWx0cyBpbiAwLCB0aGUgcGxheWhlYWQgY291bGQgYmUgZXhhY3RseSBhdCB0aGUgZW5kIG9yIHRoZSBiZWdpbm5pbmcsIGFuZCB3ZSBhbHdheXMgZGVmZXIgdG8gdGhlIEVORCB3aXRoIGEgbm9uLXplcm8gdmFsdWUsIG90aGVyd2lzZSBpZiB5b3Ugc2V0IHRoZSB0aW1lKCkgdG8gdGhlIHZlcnkgZW5kIChkdXJhdGlvbigpKSwgaXQgd291bGQgcmVuZGVyIGF0IHRoZSBTVEFSVCEKICB9OwoKICBfcHJvdG8udG90YWxQcm9ncmVzcyA9IGZ1bmN0aW9uIHRvdGFsUHJvZ3Jlc3ModmFsdWUsIHN1cHByZXNzRXZlbnRzKSB7CiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IHRoaXMudG90YWxUaW1lKHRoaXMudG90YWxEdXJhdGlvbigpICogdmFsdWUsIHN1cHByZXNzRXZlbnRzKSA6IHRoaXMudG90YWxEdXJhdGlvbigpID8gTWF0aC5taW4oMSwgdGhpcy5fdFRpbWUgLyB0aGlzLl90RHVyKSA6IHRoaXMucmF0aW87CiAgfTsKCiAgX3Byb3RvLnByb2dyZXNzID0gZnVuY3Rpb24gcHJvZ3Jlc3ModmFsdWUsIHN1cHByZXNzRXZlbnRzKSB7CiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IHRoaXMudG90YWxUaW1lKHRoaXMuZHVyYXRpb24oKSAqICh0aGlzLl95b3lvICYmICEodGhpcy5pdGVyYXRpb24oKSAmIDEpID8gMSAtIHZhbHVlIDogdmFsdWUpICsgX2VsYXBzZWRDeWNsZUR1cmF0aW9uKHRoaXMpLCBzdXBwcmVzc0V2ZW50cykgOiB0aGlzLmR1cmF0aW9uKCkgPyBNYXRoLm1pbigxLCB0aGlzLl90aW1lIC8gdGhpcy5fZHVyKSA6IHRoaXMucmF0aW87CiAgfTsKCiAgX3Byb3RvLml0ZXJhdGlvbiA9IGZ1bmN0aW9uIGl0ZXJhdGlvbih2YWx1ZSwgc3VwcHJlc3NFdmVudHMpIHsKICAgIHZhciBjeWNsZUR1cmF0aW9uID0gdGhpcy5kdXJhdGlvbigpICsgdGhpcy5fckRlbGF5OwoKICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gdGhpcy50b3RhbFRpbWUodGhpcy5fdGltZSArICh2YWx1ZSAtIDEpICogY3ljbGVEdXJhdGlvbiwgc3VwcHJlc3NFdmVudHMpIDogdGhpcy5fcmVwZWF0ID8gX2FuaW1hdGlvbkN5Y2xlKHRoaXMuX3RUaW1lLCBjeWNsZUR1cmF0aW9uKSArIDEgOiAxOwogIH0gLy8gcG90ZW50aWFsIGZ1dHVyZSBhZGRpdGlvbjoKICAvLyBpc1BsYXlpbmdCYWNrd2FyZHMoKSB7CiAgLy8gCWxldCBhbmltYXRpb24gPSB0aGlzLAogIC8vIAkJb3JpZW50YXRpb24gPSAxOyAvLyAxID0gZm9yd2FyZCwgLTEgPSBiYWNrd2FyZAogIC8vIAl3aGlsZSAoYW5pbWF0aW9uKSB7CiAgLy8gCQlvcmllbnRhdGlvbiAqPSBhbmltYXRpb24ucmV2ZXJzZWQoKSB8fCAoYW5pbWF0aW9uLnJlcGVhdCgpICYmICEoYW5pbWF0aW9uLml0ZXJhdGlvbigpICYgMSkpID8gLTEgOiAxOwogIC8vIAkJYW5pbWF0aW9uID0gYW5pbWF0aW9uLnBhcmVudDsKICAvLyAJfQogIC8vIAlyZXR1cm4gb3JpZW50YXRpb24gPCAwOwogIC8vIH0KICA7CgogIF9wcm90by50aW1lU2NhbGUgPSBmdW5jdGlvbiB0aW1lU2NhbGUodmFsdWUpIHsKICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgewogICAgICByZXR1cm4gdGhpcy5fcnRzID09PSAtX3RpbnlOdW0gPyAwIDogdGhpcy5fcnRzOyAvLyByZWNvcmRlZCB0aW1lU2NhbGUuIFNwZWNpYWwgY2FzZTogaWYgc29tZW9uZSBjYWxscyByZXZlcnNlKCkgb24gYW4gYW5pbWF0aW9uIHdpdGggdGltZVNjYWxlIG9mIDAsIHdlIGFzc2lnbiBpdCAtX3RpbnlOdW0gdG8gcmVtZW1iZXIgaXQncyByZXZlcnNlZC4KICAgIH0KCiAgICBpZiAodGhpcy5fcnRzID09PSB2YWx1ZSkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICB2YXIgdFRpbWUgPSB0aGlzLnBhcmVudCAmJiB0aGlzLl90cyA/IF9wYXJlbnRUb0NoaWxkVG90YWxUaW1lKHRoaXMucGFyZW50Ll90aW1lLCB0aGlzKSA6IHRoaXMuX3RUaW1lOyAvLyBtYWtlIHN1cmUgdG8gZG8gdGhlIHBhcmVudFRvQ2hpbGRUb3RhbFRpbWUoKSBCRUZPUkUgc2V0dGluZyB0aGUgbmV3IF90cyBiZWNhdXNlIHRoZSBvbGQgb25lIG11c3QgYmUgdXNlZCBpbiB0aGF0IGNhbGN1bGF0aW9uLgogICAgLy8gZnV0dXJlIGFkZGl0aW9uPyBVcCBzaWRlOiBmYXN0IGFuZCBtaW5pbWFsIGZpbGUgc2l6ZS4gRG93biBzaWRlOiBvbmx5IHdvcmtzIG9uIHRoaXMgYW5pbWF0aW9uOyBpZiBhIHRpbWVsaW5lIGlzIHJldmVyc2VkLCBmb3IgZXhhbXBsZSwgaXRzIGNoaWxkcmVucycgb25SZXZlcnNlIHdvdWxkbid0IGdldCBjYWxsZWQuCiAgICAvLygrdmFsdWUgPCAwICYmIHRoaXMuX3J0cyA+PSAwKSAmJiBfY2FsbGJhY2sodGhpcywgIm9uUmV2ZXJzZSIsIHRydWUpOwogICAgLy8gcHJpb3JpdGl6ZSByZW5kZXJpbmcgd2hlcmUgdGhlIHBhcmVudCdzIHBsYXloZWFkIGxpbmVzIHVwIGluc3RlYWQgb2YgdGhpcy5fdFRpbWUgYmVjYXVzZSB0aGVyZSBjb3VsZCBiZSBhIHR3ZWVuIHRoYXQncyBhbmltYXRpbmcgYW5vdGhlciB0d2VlbidzIHRpbWVTY2FsZSBpbiB0aGUgc2FtZSByZW5kZXJpbmcgbG9vcCAoc2FtZSBwYXJlbnQpLCB0aHVzIGlmIHRoZSB0aW1lU2NhbGUgdHdlZW4gcmVuZGVycyBmaXJzdCwgaXQgd291bGQgYWx0ZXIgX3N0YXJ0IEJFRk9SRSBfdFRpbWUgd2FzIHNldCBvbiB0aGF0IHRpY2sgKGluIHRoZSByZW5kZXJpbmcgbG9vcCksIGVmZmVjdGl2ZWx5IGZyZWV6aW5nIGl0IHVudGlsIHRoZSB0aW1lU2NhbGUgdHdlZW4gZmluaXNoZXMuCgogICAgdGhpcy5fcnRzID0gK3ZhbHVlIHx8IDA7CiAgICB0aGlzLl90cyA9IHRoaXMuX3BzIHx8IHZhbHVlID09PSAtX3RpbnlOdW0gPyAwIDogdGhpcy5fcnRzOyAvLyBfdHMgaXMgdGhlIGZ1bmN0aW9uYWwgdGltZVNjYWxlIHdoaWNoIHdvdWxkIGJlIDAgaWYgdGhlIGFuaW1hdGlvbiBpcyBwYXVzZWQuCgogICAgX3JlY2FjaGVBbmNlc3RvcnModGhpcy50b3RhbFRpbWUoX2NsYW1wKC10aGlzLl9kZWxheSwgdGhpcy5fdER1ciwgdFRpbWUpLCB0cnVlKSk7CgogICAgX3NldEVuZCh0aGlzKTsgLy8gaWYgcGFyZW50LnNtb290aENoaWxkVGltaW5nIHdhcyBmYWxzZSwgdGhlIGVuZCB0aW1lIGRpZG4ndCBnZXQgdXBkYXRlZCBpbiB0aGUgX2FsaWduUGxheWhlYWQoKSBtZXRob2QsIHNvIGRvIGl0IGhlcmUuCgoKICAgIHJldHVybiB0aGlzOwogIH07CgogIF9wcm90by5wYXVzZWQgPSBmdW5jdGlvbiBwYXVzZWQodmFsdWUpIHsKICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgewogICAgICByZXR1cm4gdGhpcy5fcHM7CiAgICB9CgogICAgaWYgKHRoaXMuX3BzICE9PSB2YWx1ZSkgewogICAgICB0aGlzLl9wcyA9IHZhbHVlOwoKICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgdGhpcy5fcFRpbWUgPSB0aGlzLl90VGltZSB8fCBNYXRoLm1heCgtdGhpcy5fZGVsYXksIHRoaXMucmF3VGltZSgpKTsgLy8gaWYgdGhlIHBhdXNlIG9jY3VycyBkdXJpbmcgdGhlIGRlbGF5IHBoYXNlLCBtYWtlIHN1cmUgdGhhdCdzIGZhY3RvcmVkIGluIHdoZW4gcmVzdW1pbmcuCgogICAgICAgIHRoaXMuX3RzID0gdGhpcy5fYWN0ID0gMDsgLy8gX3RzIGlzIHRoZSBmdW5jdGlvbmFsIHRpbWVTY2FsZSwgc28gYSBwYXVzZWQgdHdlZW4gd291bGQgZWZmZWN0aXZlbHkgaGF2ZSBhIHRpbWVTY2FsZSBvZiAwLiBXZSByZWNvcmQgdGhlICJyZWFsIiB0aW1lU2NhbGUgYXMgX3J0cyAocmVjb3JkZWQgdGltZSBzY2FsZSkKICAgICAgfSBlbHNlIHsKICAgICAgICBfd2FrZSgpOwoKICAgICAgICB0aGlzLl90cyA9IHRoaXMuX3J0czsgLy9vbmx5IGRlZmVyIHRvIF9wVGltZSAocGF1c2VUaW1lKSBpZiB0VGltZSBpcyB6ZXJvLiBSZW1lbWJlciwgc29tZW9uZSBjb3VsZCBwYXVzZSgpIGFuIGFuaW1hdGlvbiwgdGhlbiBzY3J1YiB0aGUgcGxheWhlYWQgYW5kIHJlc3VtZSgpLiBJZiB0aGUgcGFyZW50IGRvZXNuJ3QgaGF2ZSBzbW9vdGhDaGlsZFRpbWluZywgd2UgcmVuZGVyIGF0IHRoZSByYXdUaW1lKCkgYmVjYXVzZSB0aGUgc3RhcnRUaW1lIHdvbid0IGdldCB1cGRhdGVkLgoKICAgICAgICB0aGlzLnRvdGFsVGltZSh0aGlzLnBhcmVudCAmJiAhdGhpcy5wYXJlbnQuc21vb3RoQ2hpbGRUaW1pbmcgPyB0aGlzLnJhd1RpbWUoKSA6IHRoaXMuX3RUaW1lIHx8IHRoaXMuX3BUaW1lLCB0aGlzLnByb2dyZXNzKCkgPT09IDEgJiYgTWF0aC5hYnModGhpcy5felRpbWUpICE9PSBfdGlueU51bSAmJiAodGhpcy5fdFRpbWUgLT0gX3RpbnlOdW0pKTsgLy8gZWRnZSBjYXNlOiBhbmltYXRpb24ucHJvZ3Jlc3MoMSkucGF1c2UoKS5wbGF5KCkgd291bGRuJ3QgcmVuZGVyIGFnYWluIGJlY2F1c2UgdGhlIHBsYXloZWFkIGlzIGFscmVhZHkgYXQgdGhlIGVuZCwgYnV0IHRoZSBjYWxsIHRvIHRvdGFsVGltZSgpIGJlbG93IHdpbGwgYWRkIGl0IGJhY2sgdG8gaXRzIHBhcmVudC4uLmFuZCBub3QgcmVtb3ZlIGl0IGFnYWluIChzaW5jZSByZW1vdmluZyBvbmx5IGhhcHBlbnMgdXBvbiByZW5kZXJpbmcgYXQgYSBuZXcgdGltZSkuIE9mZnNldHRpbmcgdGhlIF90VGltZSBzbGlnaHRseSBpcyBkb25lIHNpbXBseSB0byBjYXVzZSB0aGUgZmluYWwgcmVuZGVyIGluIHRvdGFsVGltZSgpIHRoYXQnbGwgcG9wIGl0IG9mZiBpdHMgdGltZWxpbmUgKGlmIGF1dG9SZW1vdmVDaGlsZHJlbiBpcyB0cnVlLCBvZiBjb3Vyc2UpLiBDaGVjayB0byBtYWtlIHN1cmUgX3pUaW1lIGlzbid0IC1fdGlueU51bSB0byBhdm9pZCBhbiBlZGdlIGNhc2Ugd2hlcmUgdGhlIHBsYXloZWFkIGlzIHB1c2hlZCB0byB0aGUgZW5kIGJ1dCBJTlNJREUgYSB0d2Vlbi9jYWxsYmFjaywgdGhlIHRpbWVsaW5lIGl0c2VsZiBpcyBwYXVzZWQgdGh1cyBoYWx0aW5nIHJlbmRlcmluZyBhbmQgbGVhdmluZyBhIGZldyB1bnJlbmRlcmVkLiBXaGVuIHJlc3VtaW5nLCBpdCB3b3VsZG4ndCByZW5kZXIgdGhvc2Ugb3RoZXJ3aXNlLgogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgX3Byb3RvLnN0YXJ0VGltZSA9IGZ1bmN0aW9uIHN0YXJ0VGltZSh2YWx1ZSkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgdGhpcy5fc3RhcnQgPSB2YWx1ZTsKICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50IHx8IHRoaXMuX2RwOwogICAgICBwYXJlbnQgJiYgKHBhcmVudC5fc29ydCB8fCAhdGhpcy5wYXJlbnQpICYmIF9hZGRUb1RpbWVsaW5lKHBhcmVudCwgdGhpcywgdmFsdWUgLSB0aGlzLl9kZWxheSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHJldHVybiB0aGlzLl9zdGFydDsKICB9OwoKICBfcHJvdG8uZW5kVGltZSA9IGZ1bmN0aW9uIGVuZFRpbWUoaW5jbHVkZVJlcGVhdHMpIHsKICAgIHJldHVybiB0aGlzLl9zdGFydCArIChfaXNOb3RGYWxzZShpbmNsdWRlUmVwZWF0cykgPyB0aGlzLnRvdGFsRHVyYXRpb24oKSA6IHRoaXMuZHVyYXRpb24oKSkgLyBNYXRoLmFicyh0aGlzLl90cyB8fCAxKTsKICB9OwoKICBfcHJvdG8ucmF3VGltZSA9IGZ1bmN0aW9uIHJhd1RpbWUod3JhcFJlcGVhdHMpIHsKICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudCB8fCB0aGlzLl9kcDsgLy8gX2RwID0gZGV0YWNoZWQgcGFyZW50CgogICAgcmV0dXJuICFwYXJlbnQgPyB0aGlzLl90VGltZSA6IHdyYXBSZXBlYXRzICYmICghdGhpcy5fdHMgfHwgdGhpcy5fcmVwZWF0ICYmIHRoaXMuX3RpbWUgJiYgdGhpcy50b3RhbFByb2dyZXNzKCkgPCAxKSA/IHRoaXMuX3RUaW1lICUgKHRoaXMuX2R1ciArIHRoaXMuX3JEZWxheSkgOiAhdGhpcy5fdHMgPyB0aGlzLl90VGltZSA6IF9wYXJlbnRUb0NoaWxkVG90YWxUaW1lKHBhcmVudC5yYXdUaW1lKHdyYXBSZXBlYXRzKSwgdGhpcyk7CiAgfTsKCiAgX3Byb3RvLmdsb2JhbFRpbWUgPSBmdW5jdGlvbiBnbG9iYWxUaW1lKHJhd1RpbWUpIHsKICAgIHZhciBhbmltYXRpb24gPSB0aGlzLAogICAgICAgIHRpbWUgPSBhcmd1bWVudHMubGVuZ3RoID8gcmF3VGltZSA6IGFuaW1hdGlvbi5yYXdUaW1lKCk7CgogICAgd2hpbGUgKGFuaW1hdGlvbikgewogICAgICB0aW1lID0gYW5pbWF0aW9uLl9zdGFydCArIHRpbWUgLyAoYW5pbWF0aW9uLl90cyB8fCAxKTsKICAgICAgYW5pbWF0aW9uID0gYW5pbWF0aW9uLl9kcDsKICAgIH0KCiAgICByZXR1cm4gdGltZTsKICB9OwoKICBfcHJvdG8ucmVwZWF0ID0gZnVuY3Rpb24gcmVwZWF0KHZhbHVlKSB7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkgewogICAgICB0aGlzLl9yZXBlYXQgPSB2YWx1ZSA9PT0gSW5maW5pdHkgPyAtMiA6IHZhbHVlOwogICAgICByZXR1cm4gX29uVXBkYXRlVG90YWxEdXJhdGlvbih0aGlzKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5fcmVwZWF0ID09PSAtMiA/IEluZmluaXR5IDogdGhpcy5fcmVwZWF0OwogIH07CgogIF9wcm90by5yZXBlYXREZWxheSA9IGZ1bmN0aW9uIHJlcGVhdERlbGF5KHZhbHVlKSB7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkgewogICAgICB2YXIgdGltZSA9IHRoaXMuX3RpbWU7CiAgICAgIHRoaXMuX3JEZWxheSA9IHZhbHVlOwoKICAgICAgX29uVXBkYXRlVG90YWxEdXJhdGlvbih0aGlzKTsKCiAgICAgIHJldHVybiB0aW1lID8gdGhpcy50aW1lKHRpbWUpIDogdGhpczsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5fckRlbGF5OwogIH07CgogIF9wcm90by55b3lvID0gZnVuY3Rpb24geW95byh2YWx1ZSkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgdGhpcy5feW95byA9IHZhbHVlOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5feW95bzsKICB9OwoKICBfcHJvdG8uc2VlayA9IGZ1bmN0aW9uIHNlZWsocG9zaXRpb24sIHN1cHByZXNzRXZlbnRzKSB7CiAgICByZXR1cm4gdGhpcy50b3RhbFRpbWUoX3BhcnNlUG9zaXRpb24odGhpcywgcG9zaXRpb24pLCBfaXNOb3RGYWxzZShzdXBwcmVzc0V2ZW50cykpOwogIH07CgogIF9wcm90by5yZXN0YXJ0ID0gZnVuY3Rpb24gcmVzdGFydChpbmNsdWRlRGVsYXksIHN1cHByZXNzRXZlbnRzKSB7CiAgICByZXR1cm4gdGhpcy5wbGF5KCkudG90YWxUaW1lKGluY2x1ZGVEZWxheSA/IC10aGlzLl9kZWxheSA6IDAsIF9pc05vdEZhbHNlKHN1cHByZXNzRXZlbnRzKSk7CiAgfTsKCiAgX3Byb3RvLnBsYXkgPSBmdW5jdGlvbiBwbGF5KGZyb20sIHN1cHByZXNzRXZlbnRzKSB7CiAgICBmcm9tICE9IG51bGwgJiYgdGhpcy5zZWVrKGZyb20sIHN1cHByZXNzRXZlbnRzKTsKICAgIHJldHVybiB0aGlzLnJldmVyc2VkKGZhbHNlKS5wYXVzZWQoZmFsc2UpOwogIH07CgogIF9wcm90by5yZXZlcnNlID0gZnVuY3Rpb24gcmV2ZXJzZShmcm9tLCBzdXBwcmVzc0V2ZW50cykgewogICAgZnJvbSAhPSBudWxsICYmIHRoaXMuc2Vlayhmcm9tIHx8IHRoaXMudG90YWxEdXJhdGlvbigpLCBzdXBwcmVzc0V2ZW50cyk7CiAgICByZXR1cm4gdGhpcy5yZXZlcnNlZCh0cnVlKS5wYXVzZWQoZmFsc2UpOwogIH07CgogIF9wcm90by5wYXVzZSA9IGZ1bmN0aW9uIHBhdXNlKGF0VGltZSwgc3VwcHJlc3NFdmVudHMpIHsKICAgIGF0VGltZSAhPSBudWxsICYmIHRoaXMuc2VlayhhdFRpbWUsIHN1cHByZXNzRXZlbnRzKTsKICAgIHJldHVybiB0aGlzLnBhdXNlZCh0cnVlKTsKICB9OwoKICBfcHJvdG8ucmVzdW1lID0gZnVuY3Rpb24gcmVzdW1lKCkgewogICAgcmV0dXJuIHRoaXMucGF1c2VkKGZhbHNlKTsKICB9OwoKICBfcHJvdG8ucmV2ZXJzZWQgPSBmdW5jdGlvbiByZXZlcnNlZCh2YWx1ZSkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgISF2YWx1ZSAhPT0gdGhpcy5yZXZlcnNlZCgpICYmIHRoaXMudGltZVNjYWxlKC10aGlzLl9ydHMgfHwgKHZhbHVlID8gLV90aW55TnVtIDogMCkpOyAvLyBpbiBjYXNlIHRpbWVTY2FsZSBpcyB6ZXJvLCByZXZlcnNpbmcgd291bGQgaGF2ZSBubyBlZmZlY3Qgc28gd2UgdXNlIF90aW55TnVtLgoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuX3J0cyA8IDA7CiAgfTsKCiAgX3Byb3RvLmludmFsaWRhdGUgPSBmdW5jdGlvbiBpbnZhbGlkYXRlKCkgewogICAgdGhpcy5faW5pdHRlZCA9IHRoaXMuX2FjdCA9IDA7CiAgICB0aGlzLl96VGltZSA9IC1fdGlueU51bTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIF9wcm90by5pc0FjdGl2ZSA9IGZ1bmN0aW9uIGlzQWN0aXZlKCkgewogICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50IHx8IHRoaXMuX2RwLAogICAgICAgIHN0YXJ0ID0gdGhpcy5fc3RhcnQsCiAgICAgICAgcmF3VGltZTsKICAgIHJldHVybiAhISghcGFyZW50IHx8IHRoaXMuX3RzICYmIHRoaXMuX2luaXR0ZWQgJiYgcGFyZW50LmlzQWN0aXZlKCkgJiYgKHJhd1RpbWUgPSBwYXJlbnQucmF3VGltZSh0cnVlKSkgPj0gc3RhcnQgJiYgcmF3VGltZSA8IHRoaXMuZW5kVGltZSh0cnVlKSAtIF90aW55TnVtKTsKICB9OwoKICBfcHJvdG8uZXZlbnRDYWxsYmFjayA9IGZ1bmN0aW9uIGV2ZW50Q2FsbGJhY2sodHlwZSwgY2FsbGJhY2ssIHBhcmFtcykgewogICAgdmFyIHZhcnMgPSB0aGlzLnZhcnM7CgogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7CiAgICAgIGlmICghY2FsbGJhY2spIHsKICAgICAgICBkZWxldGUgdmFyc1t0eXBlXTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXJzW3R5cGVdID0gY2FsbGJhY2s7CiAgICAgICAgcGFyYW1zICYmICh2YXJzW3R5cGUgKyAiUGFyYW1zIl0gPSBwYXJhbXMpOwogICAgICAgIHR5cGUgPT09ICJvblVwZGF0ZSIgJiYgKHRoaXMuX29uVXBkYXRlID0gY2FsbGJhY2spOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICByZXR1cm4gdmFyc1t0eXBlXTsKICB9OwoKICBfcHJvdG8udGhlbiA9IGZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsZWQpIHsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICB2YXIgZiA9IF9pc0Z1bmN0aW9uKG9uRnVsZmlsbGVkKSA/IG9uRnVsZmlsbGVkIDogX3Bhc3NUaHJvdWdoLAogICAgICAgICAgX3Jlc29sdmUgPSBmdW5jdGlvbiBfcmVzb2x2ZSgpIHsKICAgICAgICB2YXIgX3RoZW4gPSBzZWxmLnRoZW47CiAgICAgICAgc2VsZi50aGVuID0gbnVsbDsgLy8gdGVtcG9yYXJpbHkgbnVsbCB0aGUgdGhlbigpIG1ldGhvZCB0byBhdm9pZCBhbiBpbmZpbml0ZSBsb29wIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL2dyZWVuc29jay9HU0FQL2lzc3Vlcy8zMjIpCgogICAgICAgIF9pc0Z1bmN0aW9uKGYpICYmIChmID0gZihzZWxmKSkgJiYgKGYudGhlbiB8fCBmID09PSBzZWxmKSAmJiAoc2VsZi50aGVuID0gX3RoZW4pOwogICAgICAgIHJlc29sdmUoZik7CiAgICAgICAgc2VsZi50aGVuID0gX3RoZW47CiAgICAgIH07CgogICAgICBpZiAoc2VsZi5faW5pdHRlZCAmJiBzZWxmLnRvdGFsUHJvZ3Jlc3MoKSA9PT0gMSAmJiBzZWxmLl90cyA+PSAwIHx8ICFzZWxmLl90VGltZSAmJiBzZWxmLl90cyA8IDApIHsKICAgICAgICBfcmVzb2x2ZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGYuX3Byb20gPSBfcmVzb2x2ZTsKICAgICAgfQogICAgfSk7CiAgfTsKCiAgX3Byb3RvLmtpbGwgPSBmdW5jdGlvbiBraWxsKCkgewogICAgX2ludGVycnVwdCh0aGlzKTsKICB9OwoKICByZXR1cm4gQW5pbWF0aW9uOwp9KCk7Cgpfc2V0RGVmYXVsdHMoQW5pbWF0aW9uLnByb3RvdHlwZSwgewogIF90aW1lOiAwLAogIF9zdGFydDogMCwKICBfZW5kOiAwLAogIF90VGltZTogMCwKICBfdER1cjogMCwKICBfZGlydHk6IDAsCiAgX3JlcGVhdDogMCwKICBfeW95bzogZmFsc2UsCiAgcGFyZW50OiBudWxsLAogIF9pbml0dGVkOiBmYWxzZSwKICBfckRlbGF5OiAwLAogIF90czogMSwKICBfZHA6IDAsCiAgcmF0aW86IDAsCiAgX3pUaW1lOiAtX3RpbnlOdW0sCiAgX3Byb206IDAsCiAgX3BzOiBmYWxzZSwKICBfcnRzOiAxCn0pOwovKgogKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqIFRJTUVMSU5FCiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICovCgoKZXhwb3J0IHZhciBUaW1lbGluZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0FuaW1hdGlvbikgewogIF9pbmhlcml0c0xvb3NlKFRpbWVsaW5lLCBfQW5pbWF0aW9uKTsKCiAgZnVuY3Rpb24gVGltZWxpbmUodmFycywgcG9zaXRpb24pIHsKICAgIHZhciBfdGhpczsKCiAgICBpZiAodmFycyA9PT0gdm9pZCAwKSB7CiAgICAgIHZhcnMgPSB7fTsKICAgIH0KCiAgICBfdGhpcyA9IF9BbmltYXRpb24uY2FsbCh0aGlzLCB2YXJzKSB8fCB0aGlzOwogICAgX3RoaXMubGFiZWxzID0ge307CiAgICBfdGhpcy5zbW9vdGhDaGlsZFRpbWluZyA9ICEhdmFycy5zbW9vdGhDaGlsZFRpbWluZzsKICAgIF90aGlzLmF1dG9SZW1vdmVDaGlsZHJlbiA9ICEhdmFycy5hdXRvUmVtb3ZlQ2hpbGRyZW47CiAgICBfdGhpcy5fc29ydCA9IF9pc05vdEZhbHNlKHZhcnMuc29ydENoaWxkcmVuKTsKICAgIF9nbG9iYWxUaW1lbGluZSAmJiBfYWRkVG9UaW1lbGluZSh2YXJzLnBhcmVudCB8fCBfZ2xvYmFsVGltZWxpbmUsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCBwb3NpdGlvbik7CiAgICB2YXJzLnJldmVyc2VkICYmIF90aGlzLnJldmVyc2UoKTsKICAgIHZhcnMucGF1c2VkICYmIF90aGlzLnBhdXNlZCh0cnVlKTsKICAgIHZhcnMuc2Nyb2xsVHJpZ2dlciAmJiBfc2Nyb2xsVHJpZ2dlcihfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgdmFycy5zY3JvbGxUcmlnZ2VyKTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIHZhciBfcHJvdG8yID0gVGltZWxpbmUucHJvdG90eXBlOwoKICBfcHJvdG8yLnRvID0gZnVuY3Rpb24gdG8odGFyZ2V0cywgdmFycywgcG9zaXRpb24pIHsKICAgIF9jcmVhdGVUd2VlblR5cGUoMCwgYXJndW1lbnRzLCB0aGlzKTsKCiAgICByZXR1cm4gdGhpczsKICB9OwoKICBfcHJvdG8yLmZyb20gPSBmdW5jdGlvbiBmcm9tKHRhcmdldHMsIHZhcnMsIHBvc2l0aW9uKSB7CiAgICBfY3JlYXRlVHdlZW5UeXBlKDEsIGFyZ3VtZW50cywgdGhpcyk7CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgX3Byb3RvMi5mcm9tVG8gPSBmdW5jdGlvbiBmcm9tVG8odGFyZ2V0cywgZnJvbVZhcnMsIHRvVmFycywgcG9zaXRpb24pIHsKICAgIF9jcmVhdGVUd2VlblR5cGUoMiwgYXJndW1lbnRzLCB0aGlzKTsKCiAgICByZXR1cm4gdGhpczsKICB9OwoKICBfcHJvdG8yLnNldCA9IGZ1bmN0aW9uIHNldCh0YXJnZXRzLCB2YXJzLCBwb3NpdGlvbikgewogICAgdmFycy5kdXJhdGlvbiA9IDA7CiAgICB2YXJzLnBhcmVudCA9IHRoaXM7CiAgICBfaW5oZXJpdERlZmF1bHRzKHZhcnMpLnJlcGVhdERlbGF5IHx8ICh2YXJzLnJlcGVhdCA9IDApOwogICAgdmFycy5pbW1lZGlhdGVSZW5kZXIgPSAhIXZhcnMuaW1tZWRpYXRlUmVuZGVyOwogICAgbmV3IFR3ZWVuKHRhcmdldHMsIHZhcnMsIF9wYXJzZVBvc2l0aW9uKHRoaXMsIHBvc2l0aW9uKSwgMSk7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICBfcHJvdG8yLmNhbGwgPSBmdW5jdGlvbiBjYWxsKGNhbGxiYWNrLCBwYXJhbXMsIHBvc2l0aW9uKSB7CiAgICByZXR1cm4gX2FkZFRvVGltZWxpbmUodGhpcywgVHdlZW4uZGVsYXllZENhbGwoMCwgY2FsbGJhY2ssIHBhcmFtcyksIHBvc2l0aW9uKTsKICB9IC8vT05MWSBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSEgTWF5YmUgZGVsZXRlPwogIDsKCiAgX3Byb3RvMi5zdGFnZ2VyVG8gPSBmdW5jdGlvbiBzdGFnZ2VyVG8odGFyZ2V0cywgZHVyYXRpb24sIHZhcnMsIHN0YWdnZXIsIHBvc2l0aW9uLCBvbkNvbXBsZXRlQWxsLCBvbkNvbXBsZXRlQWxsUGFyYW1zKSB7CiAgICB2YXJzLmR1cmF0aW9uID0gZHVyYXRpb247CiAgICB2YXJzLnN0YWdnZXIgPSB2YXJzLnN0YWdnZXIgfHwgc3RhZ2dlcjsKICAgIHZhcnMub25Db21wbGV0ZSA9IG9uQ29tcGxldGVBbGw7CiAgICB2YXJzLm9uQ29tcGxldGVQYXJhbXMgPSBvbkNvbXBsZXRlQWxsUGFyYW1zOwogICAgdmFycy5wYXJlbnQgPSB0aGlzOwogICAgbmV3IFR3ZWVuKHRhcmdldHMsIHZhcnMsIF9wYXJzZVBvc2l0aW9uKHRoaXMsIHBvc2l0aW9uKSk7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICBfcHJvdG8yLnN0YWdnZXJGcm9tID0gZnVuY3Rpb24gc3RhZ2dlckZyb20odGFyZ2V0cywgZHVyYXRpb24sIHZhcnMsIHN0YWdnZXIsIHBvc2l0aW9uLCBvbkNvbXBsZXRlQWxsLCBvbkNvbXBsZXRlQWxsUGFyYW1zKSB7CiAgICB2YXJzLnJ1bkJhY2t3YXJkcyA9IDE7CiAgICBfaW5oZXJpdERlZmF1bHRzKHZhcnMpLmltbWVkaWF0ZVJlbmRlciA9IF9pc05vdEZhbHNlKHZhcnMuaW1tZWRpYXRlUmVuZGVyKTsKICAgIHJldHVybiB0aGlzLnN0YWdnZXJUbyh0YXJnZXRzLCBkdXJhdGlvbiwgdmFycywgc3RhZ2dlciwgcG9zaXRpb24sIG9uQ29tcGxldGVBbGwsIG9uQ29tcGxldGVBbGxQYXJhbXMpOwogIH07CgogIF9wcm90bzIuc3RhZ2dlckZyb21UbyA9IGZ1bmN0aW9uIHN0YWdnZXJGcm9tVG8odGFyZ2V0cywgZHVyYXRpb24sIGZyb21WYXJzLCB0b1ZhcnMsIHN0YWdnZXIsIHBvc2l0aW9uLCBvbkNvbXBsZXRlQWxsLCBvbkNvbXBsZXRlQWxsUGFyYW1zKSB7CiAgICB0b1ZhcnMuc3RhcnRBdCA9IGZyb21WYXJzOwogICAgX2luaGVyaXREZWZhdWx0cyh0b1ZhcnMpLmltbWVkaWF0ZVJlbmRlciA9IF9pc05vdEZhbHNlKHRvVmFycy5pbW1lZGlhdGVSZW5kZXIpOwogICAgcmV0dXJuIHRoaXMuc3RhZ2dlclRvKHRhcmdldHMsIGR1cmF0aW9uLCB0b1ZhcnMsIHN0YWdnZXIsIHBvc2l0aW9uLCBvbkNvbXBsZXRlQWxsLCBvbkNvbXBsZXRlQWxsUGFyYW1zKTsKICB9OwoKICBfcHJvdG8yLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlcih0b3RhbFRpbWUsIHN1cHByZXNzRXZlbnRzLCBmb3JjZSkgewogICAgdmFyIHByZXZUaW1lID0gdGhpcy5fdGltZSwKICAgICAgICB0RHVyID0gdGhpcy5fZGlydHkgPyB0aGlzLnRvdGFsRHVyYXRpb24oKSA6IHRoaXMuX3REdXIsCiAgICAgICAgZHVyID0gdGhpcy5fZHVyLAogICAgICAgIHRUaW1lID0gdG90YWxUaW1lIDw9IDAgPyAwIDogX3JvdW5kUHJlY2lzZSh0b3RhbFRpbWUpLAogICAgICAgIC8vIGlmIGEgcGF1c2VkIHRpbWVsaW5lIGlzIHJlc3VtZWQgKG9yIGl0cyBfc3RhcnQgaXMgdXBkYXRlZCBmb3IgYW5vdGhlciByZWFzb24uLi53aGljaCByb3VuZHMgaXQpLCB0aGF0IGNvdWxkIHJlc3VsdCBpbiB0aGUgcGxheWhlYWQgc2hpZnRpbmcgYSAqKnRpbnkqKiBhbW91bnQgYW5kIGEgemVyby1kdXJhdGlvbiBjaGlsZCBhdCB0aGF0IHNwb3QgbWF5IGdldCByZW5kZXJlZCBhdCBhIGRpZmZlcmVudCByYXRpbywgbGlrZSBpdHMgdG90YWxUaW1lIGluIHJlbmRlcigpIG1heSBiZSAxZS0xNyBpbnN0ZWFkIG9mIDAsIGZvciBleGFtcGxlLgogICAgY3Jvc3NpbmdTdGFydCA9IHRoaXMuX3pUaW1lIDwgMCAhPT0gdG90YWxUaW1lIDwgMCAmJiAodGhpcy5faW5pdHRlZCB8fCAhZHVyKSwKICAgICAgICB0aW1lLAogICAgICAgIGNoaWxkLAogICAgICAgIG5leHQsCiAgICAgICAgaXRlcmF0aW9uLAogICAgICAgIGN5Y2xlRHVyYXRpb24sCiAgICAgICAgcHJldlBhdXNlZCwKICAgICAgICBwYXVzZVR3ZWVuLAogICAgICAgIHRpbWVTY2FsZSwKICAgICAgICBwcmV2U3RhcnQsCiAgICAgICAgcHJldkl0ZXJhdGlvbiwKICAgICAgICB5b3lvLAogICAgICAgIGlzWW95bzsKICAgIHRoaXMgIT09IF9nbG9iYWxUaW1lbGluZSAmJiB0VGltZSA+IHREdXIgJiYgdG90YWxUaW1lID49IDAgJiYgKHRUaW1lID0gdER1cik7CgogICAgaWYgKHRUaW1lICE9PSB0aGlzLl90VGltZSB8fCBmb3JjZSB8fCBjcm9zc2luZ1N0YXJ0KSB7CiAgICAgIGlmIChwcmV2VGltZSAhPT0gdGhpcy5fdGltZSAmJiBkdXIpIHsKICAgICAgICAvL2lmIHRvdGFsRHVyYXRpb24oKSBmaW5kcyBhIGNoaWxkIHdpdGggYSBuZWdhdGl2ZSBzdGFydFRpbWUgYW5kIHNtb290aENoaWxkVGltaW5nIGlzIHRydWUsIHRoaW5ncyBnZXQgc2hpZnRlZCBhcm91bmQgaW50ZXJuYWxseSBzbyB3ZSBuZWVkIHRvIGFkanVzdCB0aGUgdGltZSBhY2NvcmRpbmdseS4gRm9yIGV4YW1wbGUsIGlmIGEgdHdlZW4gc3RhcnRzIGF0IC0zMCB3ZSBtdXN0IHNoaWZ0IEVWRVJZVEhJTkcgZm9yd2FyZCAzMCBzZWNvbmRzIGFuZCBtb3ZlIHRoaXMgdGltZWxpbmUncyBzdGFydFRpbWUgYmFja3dhcmQgYnkgMzAgc2Vjb25kcyBzbyB0aGF0IHRoaW5ncyBhbGlnbiB3aXRoIHRoZSBwbGF5aGVhZCAobm8ganVtcCkuCiAgICAgICAgdFRpbWUgKz0gdGhpcy5fdGltZSAtIHByZXZUaW1lOwogICAgICAgIHRvdGFsVGltZSArPSB0aGlzLl90aW1lIC0gcHJldlRpbWU7CiAgICAgIH0KCiAgICAgIHRpbWUgPSB0VGltZTsKICAgICAgcHJldlN0YXJ0ID0gdGhpcy5fc3RhcnQ7CiAgICAgIHRpbWVTY2FsZSA9IHRoaXMuX3RzOwogICAgICBwcmV2UGF1c2VkID0gIXRpbWVTY2FsZTsKCiAgICAgIGlmIChjcm9zc2luZ1N0YXJ0KSB7CiAgICAgICAgZHVyIHx8IChwcmV2VGltZSA9IHRoaXMuX3pUaW1lKTsgLy93aGVuIHRoZSBwbGF5aGVhZCBhcnJpdmVzIGF0IEVYQUNUTFkgdGltZSAwIChyaWdodCBvbiB0b3ApIG9mIGEgemVyby1kdXJhdGlvbiB0aW1lbGluZSwgd2UgbmVlZCB0byBkaXNjZXJuIGlmIGV2ZW50cyBhcmUgc3VwcHJlc3NlZCBzbyB0aGF0IHdoZW4gdGhlIHBsYXloZWFkIG1vdmVzIGFnYWluIChuZXh0IHRpbWUpLCBpdCdsbCB0cmlnZ2VyIHRoZSBjYWxsYmFjay4gSWYgZXZlbnRzIGFyZSBOT1Qgc3VwcHJlc3NlZCwgb2J2aW91c2x5IHRoZSBjYWxsYmFjayB3b3VsZCBiZSB0cmlnZ2VyZWQgaW4gdGhpcyByZW5kZXIuIEJhc2ljYWxseSwgdGhlIGNhbGxiYWNrIHNob3VsZCBmaXJlIGVpdGhlciB3aGVuIHRoZSBwbGF5aGVhZCBBUlJJVkVTIG9yIExFQVZFUyB0aGlzIGV4YWN0IHNwb3QsIG5vdCBib3RoLiBJbWFnaW5lIGRvaW5nIGEgdGltZWxpbmUuc2VlaygwKSBhbmQgdGhlcmUncyBhIGNhbGxiYWNrIHRoYXQgc2l0cyBhdCAwLiBTaW5jZSBldmVudHMgYXJlIHN1cHByZXNzZWQgb24gdGhhdCBzZWVrKCkgYnkgZGVmYXVsdCwgbm90aGluZyB3aWxsIGZpcmUsIGJ1dCB3aGVuIHRoZSBwbGF5aGVhZCBtb3ZlcyBvZmYgb2YgdGhhdCBwb3NpdGlvbiwgdGhlIGNhbGxiYWNrIHNob3VsZCBmaXJlLiBUaGlzIGJlaGF2aW9yIGlzIHdoYXQgcGVvcGxlIGludHVpdGl2ZWx5IGV4cGVjdC4KCiAgICAgICAgKHRvdGFsVGltZSB8fCAhc3VwcHJlc3NFdmVudHMpICYmICh0aGlzLl96VGltZSA9IHRvdGFsVGltZSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLl9yZXBlYXQpIHsKICAgICAgICAvL2FkanVzdCB0aGUgdGltZSBmb3IgcmVwZWF0cyBhbmQgeW95b3MKICAgICAgICB5b3lvID0gdGhpcy5feW95bzsKICAgICAgICBjeWNsZUR1cmF0aW9uID0gZHVyICsgdGhpcy5fckRlbGF5OwoKICAgICAgICBpZiAodGhpcy5fcmVwZWF0IDwgLTEgJiYgdG90YWxUaW1lIDwgMCkgewogICAgICAgICAgcmV0dXJuIHRoaXMudG90YWxUaW1lKGN5Y2xlRHVyYXRpb24gKiAxMDAgKyB0b3RhbFRpbWUsIHN1cHByZXNzRXZlbnRzLCBmb3JjZSk7CiAgICAgICAgfQoKICAgICAgICB0aW1lID0gX3JvdW5kUHJlY2lzZSh0VGltZSAlIGN5Y2xlRHVyYXRpb24pOyAvL3JvdW5kIHRvIGF2b2lkIGZsb2F0aW5nIHBvaW50IGVycm9ycy4gKDQgJSAwLjggc2hvdWxkIGJlIDAgYnV0IHNvbWUgYnJvd3NlcnMgcmVwb3J0IGl0IGFzIDAuNzk5OTk5OTkhKQoKICAgICAgICBpZiAodFRpbWUgPT09IHREdXIpIHsKICAgICAgICAgIC8vIHRoZSB0RHVyID09PSB0VGltZSBpcyBmb3IgZWRnZSBjYXNlcyB3aGVyZSB0aGVyZSdzIGEgbGVuZ3RoeSBkZWNpbWFsIG9uIHRoZSBkdXJhdGlvbiBhbmQgaXQgbWF5IHJlYWNoIHRoZSB2ZXJ5IGVuZCBidXQgdGhlIHRpbWUgaXMgcmVuZGVyZWQgYXMgbm90LXF1aXRlLXRoZXJlIChyZW1lbWJlciwgdER1ciBpcyByb3VuZGVkIHRvIDQgZGVjaW1hbHMgd2hlcmVhcyBkdXIgaXNuJ3QpCiAgICAgICAgICBpdGVyYXRpb24gPSB0aGlzLl9yZXBlYXQ7CiAgICAgICAgICB0aW1lID0gZHVyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpdGVyYXRpb24gPSB+fih0VGltZSAvIGN5Y2xlRHVyYXRpb24pOwoKICAgICAgICAgIGlmIChpdGVyYXRpb24gJiYgaXRlcmF0aW9uID09PSB0VGltZSAvIGN5Y2xlRHVyYXRpb24pIHsKICAgICAgICAgICAgdGltZSA9IGR1cjsKICAgICAgICAgICAgaXRlcmF0aW9uLS07CiAgICAgICAgICB9CgogICAgICAgICAgdGltZSA+IGR1ciAmJiAodGltZSA9IGR1cik7CiAgICAgICAgfQoKICAgICAgICBwcmV2SXRlcmF0aW9uID0gX2FuaW1hdGlvbkN5Y2xlKHRoaXMuX3RUaW1lLCBjeWNsZUR1cmF0aW9uKTsKICAgICAgICAhcHJldlRpbWUgJiYgdGhpcy5fdFRpbWUgJiYgcHJldkl0ZXJhdGlvbiAhPT0gaXRlcmF0aW9uICYmIChwcmV2SXRlcmF0aW9uID0gaXRlcmF0aW9uKTsgLy8gZWRnZSBjYXNlIC0gaWYgc29tZW9uZSBkb2VzIGFkZFBhdXNlKCkgYXQgdGhlIHZlcnkgYmVnaW5uaW5nIG9mIGEgcmVwZWF0aW5nIHRpbWVsaW5lLCB0aGF0IHBhdXNlIGlzIHRlY2huaWNhbGx5IGF0IHRoZSBzYW1lIHNwb3QgYXMgdGhlIGVuZCB3aGljaCBjYXVzZXMgdGhpcy5fdGltZSB0byBnZXQgc2V0IHRvIDAgd2hlbiB0aGUgdG90YWxUaW1lIHdvdWxkIG5vcm1hbGx5IHBsYWNlIHRoZSBwbGF5aGVhZCBhdCB0aGUgZW5kLiBTZWUgaHR0cHM6Ly9ncmVlbnNvY2suY29tL2ZvcnVtcy90b3BpYy8yMzgyMy1jbG9zaW5nLW5hdi1hbmltYXRpb24tbm90LXdvcmtpbmctb24taWUtYW5kLWlwaG9uZS02LW1heWJlLW90aGVyLW9sZGVyLWJyb3dzZXIvP3RhYj1jb21tZW50cyNjb21tZW50LTExMzAwNQoKICAgICAgICBpZiAoeW95byAmJiBpdGVyYXRpb24gJiAxKSB7CiAgICAgICAgICB0aW1lID0gZHVyIC0gdGltZTsKICAgICAgICAgIGlzWW95byA9IDE7CiAgICAgICAgfQogICAgICAgIC8qCiAgICAgICAgbWFrZSBzdXJlIGNoaWxkcmVuIGF0IHRoZSBlbmQvYmVnaW5uaW5nIG9mIHRoZSB0aW1lbGluZSBhcmUgcmVuZGVyZWQgcHJvcGVybHkuIElmLCBmb3IgZXhhbXBsZSwKICAgICAgICBhIDMtc2Vjb25kIGxvbmcgdGltZWxpbmUgcmVuZGVyZWQgYXQgMi45IHNlY29uZHMgcHJldmlvdXNseSwgYW5kIG5vdyByZW5kZXJzIGF0IDMuMiBzZWNvbmRzICh3aGljaAogICAgICAgIHdvdWxkIGdldCB0cmFuc2xhdGVkIHRvIDIuOCBzZWNvbmRzIGlmIHRoZSB0aW1lbGluZSB5b3lvcyBvciAwLjIgc2Vjb25kcyBpZiBpdCBqdXN0IHJlcGVhdHMpLCB0aGVyZQogICAgICAgIGNvdWxkIGJlIGEgY2FsbGJhY2sgb3IgYSBzaG9ydCB0d2VlbiB0aGF0J3MgYXQgMi45NSBvciAzIHNlY29uZHMgaW4gd2hpY2ggd291bGRuJ3QgcmVuZGVyLiBTbwogICAgICAgIHdlIG5lZWQgdG8gcHVzaCB0aGUgdGltZWxpbmUgdG8gdGhlIGVuZCAoYW5kL29yIGJlZ2lubmluZyBkZXBlbmRpbmcgb24gaXRzIHlveW8gdmFsdWUpLiBBbHNvIHdlIG11c3QKICAgICAgICBlbnN1cmUgdGhhdCB6ZXJvLWR1cmF0aW9uIHR3ZWVucyBhdCB0aGUgdmVyeSBiZWdpbm5pbmcgb3IgZW5kIG9mIHRoZSBUaW1lbGluZSB3b3JrLgogICAgICAgICovCgoKICAgICAgICBpZiAoaXRlcmF0aW9uICE9PSBwcmV2SXRlcmF0aW9uICYmICF0aGlzLl9sb2NrKSB7CiAgICAgICAgICB2YXIgcmV3aW5kaW5nID0geW95byAmJiBwcmV2SXRlcmF0aW9uICYgMSwKICAgICAgICAgICAgICBkb2VzV3JhcCA9IHJld2luZGluZyA9PT0gKHlveW8gJiYgaXRlcmF0aW9uICYgMSk7CiAgICAgICAgICBpdGVyYXRpb24gPCBwcmV2SXRlcmF0aW9uICYmIChyZXdpbmRpbmcgPSAhcmV3aW5kaW5nKTsKICAgICAgICAgIHByZXZUaW1lID0gcmV3aW5kaW5nID8gMCA6IGR1cjsKICAgICAgICAgIHRoaXMuX2xvY2sgPSAxOwogICAgICAgICAgdGhpcy5yZW5kZXIocHJldlRpbWUgfHwgKGlzWW95byA/IDAgOiBfcm91bmRQcmVjaXNlKGl0ZXJhdGlvbiAqIGN5Y2xlRHVyYXRpb24pKSwgc3VwcHJlc3NFdmVudHMsICFkdXIpLl9sb2NrID0gMDsKICAgICAgICAgIHRoaXMuX3RUaW1lID0gdFRpbWU7IC8vIGlmIGEgdXNlciBnZXRzIHRoZSBpdGVyYXRpb24oKSBpbnNpZGUgdGhlIG9uUmVwZWF0LCBmb3IgZXhhbXBsZSwgaXQgc2hvdWxkIGJlIGFjY3VyYXRlLgoKICAgICAgICAgICFzdXBwcmVzc0V2ZW50cyAmJiB0aGlzLnBhcmVudCAmJiBfY2FsbGJhY2sodGhpcywgIm9uUmVwZWF0Iik7CiAgICAgICAgICB0aGlzLnZhcnMucmVwZWF0UmVmcmVzaCAmJiAhaXNZb3lvICYmICh0aGlzLmludmFsaWRhdGUoKS5fbG9jayA9IDEpOwoKICAgICAgICAgIGlmIChwcmV2VGltZSAmJiBwcmV2VGltZSAhPT0gdGhpcy5fdGltZSB8fCBwcmV2UGF1c2VkICE9PSAhdGhpcy5fdHMgfHwgdGhpcy52YXJzLm9uUmVwZWF0ICYmICF0aGlzLnBhcmVudCAmJiAhdGhpcy5fYWN0KSB7CiAgICAgICAgICAgIC8vIGlmIHByZXZUaW1lIGlzIDAgYW5kIHdlIHJlbmRlciBhdCB0aGUgdmVyeSBlbmQsIF90aW1lIHdpbGwgYmUgdGhlIGVuZCwgdGh1cyB3b24ndCBtYXRjaC4gU28gaW4gdGhpcyBlZGdlIGNhc2UsIHByZXZUaW1lIHdvbid0IG1hdGNoIF90aW1lIGJ1dCB0aGF0J3Mgb2theS4gSWYgaXQgZ2V0cyBraWxsZWQgaW4gdGhlIG9uUmVwZWF0LCBlamVjdCBhcyB3ZWxsLgogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgIH0KCiAgICAgICAgICBkdXIgPSB0aGlzLl9kdXI7IC8vIGluIGNhc2UgdGhlIGR1cmF0aW9uIGNoYW5nZWQgaW4gdGhlIG9uUmVwZWF0CgogICAgICAgICAgdER1ciA9IHRoaXMuX3REdXI7CgogICAgICAgICAgaWYgKGRvZXNXcmFwKSB7CiAgICAgICAgICAgIHRoaXMuX2xvY2sgPSAyOwogICAgICAgICAgICBwcmV2VGltZSA9IHJld2luZGluZyA/IGR1ciA6IC0wLjAwMDE7CiAgICAgICAgICAgIHRoaXMucmVuZGVyKHByZXZUaW1lLCB0cnVlKTsKICAgICAgICAgICAgdGhpcy52YXJzLnJlcGVhdFJlZnJlc2ggJiYgIWlzWW95byAmJiB0aGlzLmludmFsaWRhdGUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLl9sb2NrID0gMDsKCiAgICAgICAgICBpZiAoIXRoaXMuX3RzICYmICFwcmV2UGF1c2VkKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgfSAvL2luIG9yZGVyIGZvciB5b3lvRWFzZSB0byB3b3JrIHByb3Blcmx5IHdoZW4gdGhlcmUncyBhIHN0YWdnZXIsIHdlIG11c3Qgc3dhcCBvdXQgdGhlIGVhc2UgaW4gZWFjaCBzdWItdHdlZW4uCgoKICAgICAgICAgIF9wcm9wYWdhdGVZb3lvRWFzZSh0aGlzLCBpc1lveW8pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuX2hhc1BhdXNlICYmICF0aGlzLl9mb3JjaW5nICYmIHRoaXMuX2xvY2sgPCAyKSB7CiAgICAgICAgcGF1c2VUd2VlbiA9IF9maW5kTmV4dFBhdXNlVHdlZW4odGhpcywgX3JvdW5kUHJlY2lzZShwcmV2VGltZSksIF9yb3VuZFByZWNpc2UodGltZSkpOwoKICAgICAgICBpZiAocGF1c2VUd2VlbikgewogICAgICAgICAgdFRpbWUgLT0gdGltZSAtICh0aW1lID0gcGF1c2VUd2Vlbi5fc3RhcnQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fdFRpbWUgPSB0VGltZTsKICAgICAgdGhpcy5fdGltZSA9IHRpbWU7CiAgICAgIHRoaXMuX2FjdCA9ICF0aW1lU2NhbGU7IC8vYXMgbG9uZyBhcyBpdCdzIG5vdCBwYXVzZWQsIGZvcmNlIGl0IHRvIGJlIGFjdGl2ZSBzbyB0aGF0IGlmIHRoZSB1c2VyIHJlbmRlcnMgaW5kZXBlbmRlbnQgb2YgdGhlIHBhcmVudCB0aW1lbGluZSwgaXQnbGwgYmUgZm9yY2VkIHRvIHJlLXJlbmRlciBvbiB0aGUgbmV4dCB0aWNrLgoKICAgICAgaWYgKCF0aGlzLl9pbml0dGVkKSB7CiAgICAgICAgdGhpcy5fb25VcGRhdGUgPSB0aGlzLnZhcnMub25VcGRhdGU7CiAgICAgICAgdGhpcy5faW5pdHRlZCA9IDE7CiAgICAgICAgdGhpcy5felRpbWUgPSB0b3RhbFRpbWU7CiAgICAgICAgcHJldlRpbWUgPSAwOyAvLyB1cG9uIGluaXQsIHRoZSBwbGF5aGVhZCBzaG91bGQgYWx3YXlzIGdvIGZvcndhcmQ7IHNvbWVvbmUgY291bGQgaW52YWxpZGF0ZSgpIGEgY29tcGxldGVkIHRpbWVsaW5lIGFuZCB0aGVuIGlmIHRoZXkgcmVzdGFydCgpLCB0aGF0IHdvdWxkIG1ha2UgY2hpbGQgdHdlZW5zIHJlbmRlciBpbiByZXZlcnNlIG9yZGVyIHdoaWNoIGNvdWxkIGxvY2sgaW4gdGhlIHdyb25nIHN0YXJ0aW5nIHZhbHVlcyBpZiB0aGV5IGJ1aWxkIG9uIGVhY2ggb3RoZXIsIGxpa2UgdGwudG8ob2JqLCB7eDogMTAwfSkudG8ob2JqLCB7eDogMH0pLgogICAgICB9CgogICAgICBpZiAoIXByZXZUaW1lICYmIHRpbWUgJiYgIXN1cHByZXNzRXZlbnRzKSB7CiAgICAgICAgX2NhbGxiYWNrKHRoaXMsICJvblN0YXJ0Iik7CgogICAgICAgIGlmICh0aGlzLl90VGltZSAhPT0gdFRpbWUpIHsKICAgICAgICAgIC8vIGluIGNhc2UgdGhlIG9uU3RhcnQgdHJpZ2dlcmVkIGEgcmVuZGVyIGF0IGEgZGlmZmVyZW50IHNwb3QsIGVqZWN0LiBMaWtlIGlmIHNvbWVvbmUgZGlkIGFuaW1hdGlvbi5wYXVzZSgwLjUpIG9yIHNvbWV0aGluZyBpbnNpZGUgdGhlIG9uU3RhcnQuCiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aW1lID49IHByZXZUaW1lICYmIHRvdGFsVGltZSA+PSAwKSB7CiAgICAgICAgY2hpbGQgPSB0aGlzLl9maXJzdDsKCiAgICAgICAgd2hpbGUgKGNoaWxkKSB7CiAgICAgICAgICBuZXh0ID0gY2hpbGQuX25leHQ7CgogICAgICAgICAgaWYgKChjaGlsZC5fYWN0IHx8IHRpbWUgPj0gY2hpbGQuX3N0YXJ0KSAmJiBjaGlsZC5fdHMgJiYgcGF1c2VUd2VlbiAhPT0gY2hpbGQpIHsKICAgICAgICAgICAgaWYgKGNoaWxkLnBhcmVudCAhPT0gdGhpcykgewogICAgICAgICAgICAgIC8vIGFuIGV4dHJlbWUgZWRnZSBjYXNlIC0gdGhlIGNoaWxkJ3MgcmVuZGVyIGNvdWxkIGRvIHNvbWV0aGluZyBsaWtlIGtpbGwoKSB0aGUgIm5leHQiIG9uZSBpbiB0aGUgbGlua2VkIGxpc3QsIG9yIHJlcGFyZW50IGl0LiBJbiB0aGF0IGNhc2Ugd2UgbXVzdCByZS1pbml0aWF0ZSB0aGUgd2hvbGUgcmVuZGVyIHRvIGJlIHNhZmUuCiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyKHRvdGFsVGltZSwgc3VwcHJlc3NFdmVudHMsIGZvcmNlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2hpbGQucmVuZGVyKGNoaWxkLl90cyA+IDAgPyAodGltZSAtIGNoaWxkLl9zdGFydCkgKiBjaGlsZC5fdHMgOiAoY2hpbGQuX2RpcnR5ID8gY2hpbGQudG90YWxEdXJhdGlvbigpIDogY2hpbGQuX3REdXIpICsgKHRpbWUgLSBjaGlsZC5fc3RhcnQpICogY2hpbGQuX3RzLCBzdXBwcmVzc0V2ZW50cywgZm9yY2UpOwoKICAgICAgICAgICAgaWYgKHRpbWUgIT09IHRoaXMuX3RpbWUgfHwgIXRoaXMuX3RzICYmICFwcmV2UGF1c2VkKSB7CiAgICAgICAgICAgICAgLy9pbiBjYXNlIGEgdHdlZW4gcGF1c2VzIG9yIHNlZWtzIHRoZSB0aW1lbGluZSB3aGVuIHJlbmRlcmluZywgbGlrZSBpbnNpZGUgb2YgYW4gb25VcGRhdGUvb25Db21wbGV0ZQogICAgICAgICAgICAgIHBhdXNlVHdlZW4gPSAwOwogICAgICAgICAgICAgIG5leHQgJiYgKHRUaW1lICs9IHRoaXMuX3pUaW1lID0gLV90aW55TnVtKTsgLy8gaXQgZGlkbid0IGZpbmlzaCByZW5kZXJpbmcsIHNvIGZsYWcgelRpbWUgYXMgbmVnYXRpdmUgc28gdGhhdCBzbyB0aGF0IHRoZSBuZXh0IHRpbWUgcmVuZGVyKCkgaXMgY2FsbGVkIGl0J2xsIGJlIGZvcmNlZCAodG8gcmVuZGVyIGFueSByZW1haW5pbmcgY2hpbGRyZW4pCgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgY2hpbGQgPSBuZXh0OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjaGlsZCA9IHRoaXMuX2xhc3Q7CiAgICAgICAgdmFyIGFkanVzdGVkVGltZSA9IHRvdGFsVGltZSA8IDAgPyB0b3RhbFRpbWUgOiB0aW1lOyAvL3doZW4gdGhlIHBsYXloZWFkIGdvZXMgYmFja3dhcmQgYmV5b25kIHRoZSBzdGFydCBvZiB0aGlzIHRpbWVsaW5lLCB3ZSBtdXN0IHBhc3MgdGhhdCBpbmZvcm1hdGlvbiBkb3duIHRvIHRoZSBjaGlsZCBhbmltYXRpb25zIHNvIHRoYXQgemVyby1kdXJhdGlvbiB0d2VlbnMga25vdyB3aGV0aGVyIHRvIHJlbmRlciB0aGVpciBzdGFydGluZyBvciBlbmRpbmcgdmFsdWVzLgoKICAgICAgICB3aGlsZSAoY2hpbGQpIHsKICAgICAgICAgIG5leHQgPSBjaGlsZC5fcHJldjsKCiAgICAgICAgICBpZiAoKGNoaWxkLl9hY3QgfHwgYWRqdXN0ZWRUaW1lIDw9IGNoaWxkLl9lbmQpICYmIGNoaWxkLl90cyAmJiBwYXVzZVR3ZWVuICE9PSBjaGlsZCkgewogICAgICAgICAgICBpZiAoY2hpbGQucGFyZW50ICE9PSB0aGlzKSB7CiAgICAgICAgICAgICAgLy8gYW4gZXh0cmVtZSBlZGdlIGNhc2UgLSB0aGUgY2hpbGQncyByZW5kZXIgY291bGQgZG8gc29tZXRoaW5nIGxpa2Uga2lsbCgpIHRoZSAibmV4dCIgb25lIGluIHRoZSBsaW5rZWQgbGlzdCwgb3IgcmVwYXJlbnQgaXQuIEluIHRoYXQgY2FzZSB3ZSBtdXN0IHJlLWluaXRpYXRlIHRoZSB3aG9sZSByZW5kZXIgdG8gYmUgc2FmZS4KICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXIodG90YWxUaW1lLCBzdXBwcmVzc0V2ZW50cywgZm9yY2UpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjaGlsZC5yZW5kZXIoY2hpbGQuX3RzID4gMCA/IChhZGp1c3RlZFRpbWUgLSBjaGlsZC5fc3RhcnQpICogY2hpbGQuX3RzIDogKGNoaWxkLl9kaXJ0eSA/IGNoaWxkLnRvdGFsRHVyYXRpb24oKSA6IGNoaWxkLl90RHVyKSArIChhZGp1c3RlZFRpbWUgLSBjaGlsZC5fc3RhcnQpICogY2hpbGQuX3RzLCBzdXBwcmVzc0V2ZW50cywgZm9yY2UpOwoKICAgICAgICAgICAgaWYgKHRpbWUgIT09IHRoaXMuX3RpbWUgfHwgIXRoaXMuX3RzICYmICFwcmV2UGF1c2VkKSB7CiAgICAgICAgICAgICAgLy9pbiBjYXNlIGEgdHdlZW4gcGF1c2VzIG9yIHNlZWtzIHRoZSB0aW1lbGluZSB3aGVuIHJlbmRlcmluZywgbGlrZSBpbnNpZGUgb2YgYW4gb25VcGRhdGUvb25Db21wbGV0ZQogICAgICAgICAgICAgIHBhdXNlVHdlZW4gPSAwOwogICAgICAgICAgICAgIG5leHQgJiYgKHRUaW1lICs9IHRoaXMuX3pUaW1lID0gYWRqdXN0ZWRUaW1lID8gLV90aW55TnVtIDogX3RpbnlOdW0pOyAvLyBpdCBkaWRuJ3QgZmluaXNoIHJlbmRlcmluZywgc28gYWRqdXN0IHpUaW1lIHNvIHRoYXQgc28gdGhhdCB0aGUgbmV4dCB0aW1lIHJlbmRlcigpIGlzIGNhbGxlZCBpdCdsbCBiZSBmb3JjZWQgKHRvIHJlbmRlciBhbnkgcmVtYWluaW5nIGNoaWxkcmVuKQoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGNoaWxkID0gbmV4dDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChwYXVzZVR3ZWVuICYmICFzdXBwcmVzc0V2ZW50cykgewogICAgICAgIHRoaXMucGF1c2UoKTsKICAgICAgICBwYXVzZVR3ZWVuLnJlbmRlcih0aW1lID49IHByZXZUaW1lID8gMCA6IC1fdGlueU51bSkuX3pUaW1lID0gdGltZSA+PSBwcmV2VGltZSA/IDEgOiAtMTsKCiAgICAgICAgaWYgKHRoaXMuX3RzKSB7CiAgICAgICAgICAvL3RoZSBjYWxsYmFjayByZXN1bWVkIHBsYXliYWNrISBTbyBzaW5jZSB3ZSBtYXkgaGF2ZSBoZWxkIGJhY2sgdGhlIHBsYXloZWFkIGR1ZSB0byB3aGVyZSB0aGUgcGF1c2UgaXMgcG9zaXRpb25lZCwgZ28gYWhlYWQgYW5kIGp1bXAgdG8gd2hlcmUgaXQncyBTVVBQT1NFRCB0byBiZSAoaWYgbm8gcGF1c2UgaGFwcGVuZWQpLgogICAgICAgICAgdGhpcy5fc3RhcnQgPSBwcmV2U3RhcnQ7IC8vaWYgdGhlIHBhdXNlIHdhcyBhdCBhbiBlYXJsaWVyIHRpbWUgYW5kIHRoZSB1c2VyIHJlc3VtZWQgaW4gdGhlIGNhbGxiYWNrLCBpdCBjb3VsZCByZXBvc2l0aW9uIHRoZSB0aW1lbGluZSAoY2hhbmdpbmcgaXRzIHN0YXJ0VGltZSksIHRocm93aW5nIHRoaW5ncyBvZmYgc2xpZ2h0bHksIHNvIHdlIG1ha2Ugc3VyZSB0aGUgX3N0YXJ0IGRvZXNuJ3Qgc2hpZnQuCgogICAgICAgICAgX3NldEVuZCh0aGlzKTsKCiAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXIodG90YWxUaW1lLCBzdXBwcmVzc0V2ZW50cywgZm9yY2UpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fb25VcGRhdGUgJiYgIXN1cHByZXNzRXZlbnRzICYmIF9jYWxsYmFjayh0aGlzLCAib25VcGRhdGUiLCB0cnVlKTsKICAgICAgaWYgKHRUaW1lID09PSB0RHVyICYmIHREdXIgPj0gdGhpcy50b3RhbER1cmF0aW9uKCkgfHwgIXRUaW1lICYmIHByZXZUaW1lKSBpZiAocHJldlN0YXJ0ID09PSB0aGlzLl9zdGFydCB8fCBNYXRoLmFicyh0aW1lU2NhbGUpICE9PSBNYXRoLmFicyh0aGlzLl90cykpIGlmICghdGhpcy5fbG9jaykgewogICAgICAgICh0b3RhbFRpbWUgfHwgIWR1cikgJiYgKHRUaW1lID09PSB0RHVyICYmIHRoaXMuX3RzID4gMCB8fCAhdFRpbWUgJiYgdGhpcy5fdHMgPCAwKSAmJiBfcmVtb3ZlRnJvbVBhcmVudCh0aGlzLCAxKTsgLy8gZG9uJ3QgcmVtb3ZlIGlmIHRoZSB0aW1lbGluZSBpcyByZXZlcnNlZCBhbmQgdGhlIHBsYXloZWFkIGlzbid0IGF0IDAsIG90aGVyd2lzZSB0bC5wcm9ncmVzcygxKS5yZXZlcnNlKCkgd29uJ3Qgd29yay4gT25seSByZW1vdmUgaWYgdGhlIHBsYXloZWFkIGlzIGF0IHRoZSBlbmQgYW5kIHRpbWVTY2FsZSBpcyBwb3NpdGl2ZSwgb3IgaWYgdGhlIHBsYXloZWFkIGlzIGF0IDAgYW5kIHRoZSB0aW1lU2NhbGUgaXMgbmVnYXRpdmUuCgogICAgICAgIGlmICghc3VwcHJlc3NFdmVudHMgJiYgISh0b3RhbFRpbWUgPCAwICYmICFwcmV2VGltZSkgJiYgKHRUaW1lIHx8IHByZXZUaW1lIHx8ICF0RHVyKSkgewogICAgICAgICAgX2NhbGxiYWNrKHRoaXMsIHRUaW1lID09PSB0RHVyICYmIHRvdGFsVGltZSA+PSAwID8gIm9uQ29tcGxldGUiIDogIm9uUmV2ZXJzZUNvbXBsZXRlIiwgdHJ1ZSk7CgogICAgICAgICAgdGhpcy5fcHJvbSAmJiAhKHRUaW1lIDwgdER1ciAmJiB0aGlzLnRpbWVTY2FsZSgpID4gMCkgJiYgdGhpcy5fcHJvbSgpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH07CgogIF9wcm90bzIuYWRkID0gZnVuY3Rpb24gYWRkKGNoaWxkLCBwb3NpdGlvbikgewogICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgX2lzTnVtYmVyKHBvc2l0aW9uKSB8fCAocG9zaXRpb24gPSBfcGFyc2VQb3NpdGlvbih0aGlzLCBwb3NpdGlvbiwgY2hpbGQpKTsKCiAgICBpZiAoIShjaGlsZCBpbnN0YW5jZW9mIEFuaW1hdGlvbikpIHsKICAgICAgaWYgKF9pc0FycmF5KGNoaWxkKSkgewogICAgICAgIGNoaWxkLmZvckVhY2goZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5hZGQob2JqLCBwb3NpdGlvbik7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGlmIChfaXNTdHJpbmcoY2hpbGQpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYWRkTGFiZWwoY2hpbGQsIHBvc2l0aW9uKTsKICAgICAgfQoKICAgICAgaWYgKF9pc0Z1bmN0aW9uKGNoaWxkKSkgewogICAgICAgIGNoaWxkID0gVHdlZW4uZGVsYXllZENhbGwoMCwgY2hpbGQpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRoaXMgIT09IGNoaWxkID8gX2FkZFRvVGltZWxpbmUodGhpcywgY2hpbGQsIHBvc2l0aW9uKSA6IHRoaXM7IC8vZG9uJ3QgYWxsb3cgYSB0aW1lbGluZSB0byBiZSBhZGRlZCB0byBpdHNlbGYgYXMgYSBjaGlsZCEKICB9OwoKICBfcHJvdG8yLmdldENoaWxkcmVuID0gZnVuY3Rpb24gZ2V0Q2hpbGRyZW4obmVzdGVkLCB0d2VlbnMsIHRpbWVsaW5lcywgaWdub3JlQmVmb3JlVGltZSkgewogICAgaWYgKG5lc3RlZCA9PT0gdm9pZCAwKSB7CiAgICAgIG5lc3RlZCA9IHRydWU7CiAgICB9CgogICAgaWYgKHR3ZWVucyA9PT0gdm9pZCAwKSB7CiAgICAgIHR3ZWVucyA9IHRydWU7CiAgICB9CgogICAgaWYgKHRpbWVsaW5lcyA9PT0gdm9pZCAwKSB7CiAgICAgIHRpbWVsaW5lcyA9IHRydWU7CiAgICB9CgogICAgaWYgKGlnbm9yZUJlZm9yZVRpbWUgPT09IHZvaWQgMCkgewogICAgICBpZ25vcmVCZWZvcmVUaW1lID0gLV9iaWdOdW07CiAgICB9CgogICAgdmFyIGEgPSBbXSwKICAgICAgICBjaGlsZCA9IHRoaXMuX2ZpcnN0OwoKICAgIHdoaWxlIChjaGlsZCkgewogICAgICBpZiAoY2hpbGQuX3N0YXJ0ID49IGlnbm9yZUJlZm9yZVRpbWUpIHsKICAgICAgICBpZiAoY2hpbGQgaW5zdGFuY2VvZiBUd2VlbikgewogICAgICAgICAgdHdlZW5zICYmIGEucHVzaChjaGlsZCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRpbWVsaW5lcyAmJiBhLnB1c2goY2hpbGQpOwogICAgICAgICAgbmVzdGVkICYmIGEucHVzaC5hcHBseShhLCBjaGlsZC5nZXRDaGlsZHJlbih0cnVlLCB0d2VlbnMsIHRpbWVsaW5lcykpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY2hpbGQgPSBjaGlsZC5fbmV4dDsKICAgIH0KCiAgICByZXR1cm4gYTsKICB9OwoKICBfcHJvdG8yLmdldEJ5SWQgPSBmdW5jdGlvbiBnZXRCeUlkKGlkKSB7CiAgICB2YXIgYW5pbWF0aW9ucyA9IHRoaXMuZ2V0Q2hpbGRyZW4oMSwgMSwgMSksCiAgICAgICAgaSA9IGFuaW1hdGlvbnMubGVuZ3RoOwoKICAgIHdoaWxlIChpLS0pIHsKICAgICAgaWYgKGFuaW1hdGlvbnNbaV0udmFycy5pZCA9PT0gaWQpIHsKICAgICAgICByZXR1cm4gYW5pbWF0aW9uc1tpXTsKICAgICAgfQogICAgfQogIH07CgogIF9wcm90bzIucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKGNoaWxkKSB7CiAgICBpZiAoX2lzU3RyaW5nKGNoaWxkKSkgewogICAgICByZXR1cm4gdGhpcy5yZW1vdmVMYWJlbChjaGlsZCk7CiAgICB9CgogICAgaWYgKF9pc0Z1bmN0aW9uKGNoaWxkKSkgewogICAgICByZXR1cm4gdGhpcy5raWxsVHdlZW5zT2YoY2hpbGQpOwogICAgfQoKICAgIF9yZW1vdmVMaW5rZWRMaXN0SXRlbSh0aGlzLCBjaGlsZCk7CgogICAgaWYgKGNoaWxkID09PSB0aGlzLl9yZWNlbnQpIHsKICAgICAgdGhpcy5fcmVjZW50ID0gdGhpcy5fbGFzdDsKICAgIH0KCiAgICByZXR1cm4gX3VuY2FjaGUodGhpcyk7CiAgfTsKCiAgX3Byb3RvMi50b3RhbFRpbWUgPSBmdW5jdGlvbiB0b3RhbFRpbWUoX3RvdGFsVGltZTIsIHN1cHByZXNzRXZlbnRzKSB7CiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3RUaW1lOwogICAgfQoKICAgIHRoaXMuX2ZvcmNpbmcgPSAxOwoKICAgIGlmICghdGhpcy5fZHAgJiYgdGhpcy5fdHMpIHsKICAgICAgLy9zcGVjaWFsIGNhc2UgZm9yIHRoZSBnbG9iYWwgdGltZWxpbmUgKG9yIGFueSBvdGhlciB0aGF0IGhhcyBubyBwYXJlbnQgb3IgZGV0YWNoZWQgcGFyZW50KS4KICAgICAgdGhpcy5fc3RhcnQgPSBfcm91bmRQcmVjaXNlKF90aWNrZXIudGltZSAtICh0aGlzLl90cyA+IDAgPyBfdG90YWxUaW1lMiAvIHRoaXMuX3RzIDogKHRoaXMudG90YWxEdXJhdGlvbigpIC0gX3RvdGFsVGltZTIpIC8gLXRoaXMuX3RzKSk7CiAgICB9CgogICAgX0FuaW1hdGlvbi5wcm90b3R5cGUudG90YWxUaW1lLmNhbGwodGhpcywgX3RvdGFsVGltZTIsIHN1cHByZXNzRXZlbnRzKTsKCiAgICB0aGlzLl9mb3JjaW5nID0gMDsKICAgIHJldHVybiB0aGlzOwogIH07CgogIF9wcm90bzIuYWRkTGFiZWwgPSBmdW5jdGlvbiBhZGRMYWJlbChsYWJlbCwgcG9zaXRpb24pIHsKICAgIHRoaXMubGFiZWxzW2xhYmVsXSA9IF9wYXJzZVBvc2l0aW9uKHRoaXMsIHBvc2l0aW9uKTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIF9wcm90bzIucmVtb3ZlTGFiZWwgPSBmdW5jdGlvbiByZW1vdmVMYWJlbChsYWJlbCkgewogICAgZGVsZXRlIHRoaXMubGFiZWxzW2xhYmVsXTsKICAgIHJldHVybiB0aGlzOwogIH07CgogIF9wcm90bzIuYWRkUGF1c2UgPSBmdW5jdGlvbiBhZGRQYXVzZShwb3NpdGlvbiwgY2FsbGJhY2ssIHBhcmFtcykgewogICAgdmFyIHQgPSBUd2Vlbi5kZWxheWVkQ2FsbCgwLCBjYWxsYmFjayB8fCBfZW1wdHlGdW5jLCBwYXJhbXMpOwogICAgdC5kYXRhID0gImlzUGF1c2UiOwogICAgdGhpcy5faGFzUGF1c2UgPSAxOwogICAgcmV0dXJuIF9hZGRUb1RpbWVsaW5lKHRoaXMsIHQsIF9wYXJzZVBvc2l0aW9uKHRoaXMsIHBvc2l0aW9uKSk7CiAgfTsKCiAgX3Byb3RvMi5yZW1vdmVQYXVzZSA9IGZ1bmN0aW9uIHJlbW92ZVBhdXNlKHBvc2l0aW9uKSB7CiAgICB2YXIgY2hpbGQgPSB0aGlzLl9maXJzdDsKICAgIHBvc2l0aW9uID0gX3BhcnNlUG9zaXRpb24odGhpcywgcG9zaXRpb24pOwoKICAgIHdoaWxlIChjaGlsZCkgewogICAgICBpZiAoY2hpbGQuX3N0YXJ0ID09PSBwb3NpdGlvbiAmJiBjaGlsZC5kYXRhID09PSAiaXNQYXVzZSIpIHsKICAgICAgICBfcmVtb3ZlRnJvbVBhcmVudChjaGlsZCk7CiAgICAgIH0KCiAgICAgIGNoaWxkID0gY2hpbGQuX25leHQ7CiAgICB9CiAgfTsKCiAgX3Byb3RvMi5raWxsVHdlZW5zT2YgPSBmdW5jdGlvbiBraWxsVHdlZW5zT2YodGFyZ2V0cywgcHJvcHMsIG9ubHlBY3RpdmUpIHsKICAgIHZhciB0d2VlbnMgPSB0aGlzLmdldFR3ZWVuc09mKHRhcmdldHMsIG9ubHlBY3RpdmUpLAogICAgICAgIGkgPSB0d2VlbnMubGVuZ3RoOwoKICAgIHdoaWxlIChpLS0pIHsKICAgICAgX292ZXJ3cml0aW5nVHdlZW4gIT09IHR3ZWVuc1tpXSAmJiB0d2VlbnNbaV0ua2lsbCh0YXJnZXRzLCBwcm9wcyk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgX3Byb3RvMi5nZXRUd2VlbnNPZiA9IGZ1bmN0aW9uIGdldFR3ZWVuc09mKHRhcmdldHMsIG9ubHlBY3RpdmUpIHsKICAgIHZhciBhID0gW10sCiAgICAgICAgcGFyc2VkVGFyZ2V0cyA9IHRvQXJyYXkodGFyZ2V0cyksCiAgICAgICAgY2hpbGQgPSB0aGlzLl9maXJzdCwKICAgICAgICBpc0dsb2JhbFRpbWUgPSBfaXNOdW1iZXIob25seUFjdGl2ZSksCiAgICAgICAgLy8gYSBudW1iZXIgaXMgaW50ZXJwcmV0ZWQgYXMgYSBnbG9iYWwgdGltZS4gSWYgdGhlIGFuaW1hdGlvbiBzcGFucwogICAgY2hpbGRyZW47CgogICAgd2hpbGUgKGNoaWxkKSB7CiAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIFR3ZWVuKSB7CiAgICAgICAgaWYgKF9hcnJheUNvbnRhaW5zQW55KGNoaWxkLl90YXJnZXRzLCBwYXJzZWRUYXJnZXRzKSAmJiAoaXNHbG9iYWxUaW1lID8gKCFfb3ZlcndyaXRpbmdUd2VlbiB8fCBjaGlsZC5faW5pdHRlZCAmJiBjaGlsZC5fdHMpICYmIGNoaWxkLmdsb2JhbFRpbWUoMCkgPD0gb25seUFjdGl2ZSAmJiBjaGlsZC5nbG9iYWxUaW1lKGNoaWxkLnRvdGFsRHVyYXRpb24oKSkgPiBvbmx5QWN0aXZlIDogIW9ubHlBY3RpdmUgfHwgY2hpbGQuaXNBY3RpdmUoKSkpIHsKICAgICAgICAgIC8vIG5vdGU6IGlmIHRoaXMgaXMgZm9yIG92ZXJ3cml0aW5nLCBpdCBzaG91bGQgb25seSBiZSBmb3IgdHdlZW5zIHRoYXQgYXJlbid0IHBhdXNlZCBhbmQgYXJlIGluaXR0ZWQuCiAgICAgICAgICBhLnB1c2goY2hpbGQpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICgoY2hpbGRyZW4gPSBjaGlsZC5nZXRUd2VlbnNPZihwYXJzZWRUYXJnZXRzLCBvbmx5QWN0aXZlKSkubGVuZ3RoKSB7CiAgICAgICAgYS5wdXNoLmFwcGx5KGEsIGNoaWxkcmVuKTsKICAgICAgfQoKICAgICAgY2hpbGQgPSBjaGlsZC5fbmV4dDsKICAgIH0KCiAgICByZXR1cm4gYTsKICB9IC8vIHBvdGVudGlhbCBmdXR1cmUgZmVhdHVyZSAtIHRhcmdldHMoKSBvbiB0aW1lbGluZXMKICAvLyB0YXJnZXRzKCkgewogIC8vIAlsZXQgcmVzdWx0ID0gW107CiAgLy8gCXRoaXMuZ2V0Q2hpbGRyZW4odHJ1ZSwgdHJ1ZSwgZmFsc2UpLmZvckVhY2godCA9PiByZXN1bHQucHVzaCguLi50LnRhcmdldHMoKSkpOwogIC8vIAlyZXR1cm4gcmVzdWx0LmZpbHRlcigodiwgaSkgPT4gcmVzdWx0LmluZGV4T2YodikgPT09IGkpOwogIC8vIH0KICA7CgogIF9wcm90bzIudHdlZW5UbyA9IGZ1bmN0aW9uIHR3ZWVuVG8ocG9zaXRpb24sIHZhcnMpIHsKICAgIHZhcnMgPSB2YXJzIHx8IHt9OwoKICAgIHZhciB0bCA9IHRoaXMsCiAgICAgICAgZW5kVGltZSA9IF9wYXJzZVBvc2l0aW9uKHRsLCBwb3NpdGlvbiksCiAgICAgICAgX3ZhcnMgPSB2YXJzLAogICAgICAgIHN0YXJ0QXQgPSBfdmFycy5zdGFydEF0LAogICAgICAgIF9vblN0YXJ0ID0gX3ZhcnMub25TdGFydCwKICAgICAgICBvblN0YXJ0UGFyYW1zID0gX3ZhcnMub25TdGFydFBhcmFtcywKICAgICAgICBpbW1lZGlhdGVSZW5kZXIgPSBfdmFycy5pbW1lZGlhdGVSZW5kZXIsCiAgICAgICAgaW5pdHRlZCwKICAgICAgICB0d2VlbiA9IFR3ZWVuLnRvKHRsLCBfc2V0RGVmYXVsdHMoewogICAgICBlYXNlOiB2YXJzLmVhc2UgfHwgIm5vbmUiLAogICAgICBsYXp5OiBmYWxzZSwKICAgICAgaW1tZWRpYXRlUmVuZGVyOiBmYWxzZSwKICAgICAgdGltZTogZW5kVGltZSwKICAgICAgb3ZlcndyaXRlOiAiYXV0byIsCiAgICAgIGR1cmF0aW9uOiB2YXJzLmR1cmF0aW9uIHx8IE1hdGguYWJzKChlbmRUaW1lIC0gKHN0YXJ0QXQgJiYgInRpbWUiIGluIHN0YXJ0QXQgPyBzdGFydEF0LnRpbWUgOiB0bC5fdGltZSkpIC8gdGwudGltZVNjYWxlKCkpIHx8IF90aW55TnVtLAogICAgICBvblN0YXJ0OiBmdW5jdGlvbiBvblN0YXJ0KCkgewogICAgICAgIHRsLnBhdXNlKCk7CgogICAgICAgIGlmICghaW5pdHRlZCkgewogICAgICAgICAgdmFyIGR1cmF0aW9uID0gdmFycy5kdXJhdGlvbiB8fCBNYXRoLmFicygoZW5kVGltZSAtIChzdGFydEF0ICYmICJ0aW1lIiBpbiBzdGFydEF0ID8gc3RhcnRBdC50aW1lIDogdGwuX3RpbWUpKSAvIHRsLnRpbWVTY2FsZSgpKTsKICAgICAgICAgIHR3ZWVuLl9kdXIgIT09IGR1cmF0aW9uICYmIF9zZXREdXJhdGlvbih0d2VlbiwgZHVyYXRpb24sIDAsIDEpLnJlbmRlcih0d2Vlbi5fdGltZSwgdHJ1ZSwgdHJ1ZSk7CiAgICAgICAgICBpbml0dGVkID0gMTsKICAgICAgICB9CgogICAgICAgIF9vblN0YXJ0ICYmIF9vblN0YXJ0LmFwcGx5KHR3ZWVuLCBvblN0YXJ0UGFyYW1zIHx8IFtdKTsgLy9pbiBjYXNlIHRoZSB1c2VyIGhhZCBhbiBvblN0YXJ0IGluIHRoZSB2YXJzIC0gd2UgZG9uJ3Qgd2FudCB0byBvdmVyd3JpdGUgaXQuCiAgICAgIH0KICAgIH0sIHZhcnMpKTsKCiAgICByZXR1cm4gaW1tZWRpYXRlUmVuZGVyID8gdHdlZW4ucmVuZGVyKDApIDogdHdlZW47CiAgfTsKCiAgX3Byb3RvMi50d2VlbkZyb21UbyA9IGZ1bmN0aW9uIHR3ZWVuRnJvbVRvKGZyb21Qb3NpdGlvbiwgdG9Qb3NpdGlvbiwgdmFycykgewogICAgcmV0dXJuIHRoaXMudHdlZW5Ubyh0b1Bvc2l0aW9uLCBfc2V0RGVmYXVsdHMoewogICAgICBzdGFydEF0OiB7CiAgICAgICAgdGltZTogX3BhcnNlUG9zaXRpb24odGhpcywgZnJvbVBvc2l0aW9uKQogICAgICB9CiAgICB9LCB2YXJzKSk7CiAgfTsKCiAgX3Byb3RvMi5yZWNlbnQgPSBmdW5jdGlvbiByZWNlbnQoKSB7CiAgICByZXR1cm4gdGhpcy5fcmVjZW50OwogIH07CgogIF9wcm90bzIubmV4dExhYmVsID0gZnVuY3Rpb24gbmV4dExhYmVsKGFmdGVyVGltZSkgewogICAgaWYgKGFmdGVyVGltZSA9PT0gdm9pZCAwKSB7CiAgICAgIGFmdGVyVGltZSA9IHRoaXMuX3RpbWU7CiAgICB9CgogICAgcmV0dXJuIF9nZXRMYWJlbEluRGlyZWN0aW9uKHRoaXMsIF9wYXJzZVBvc2l0aW9uKHRoaXMsIGFmdGVyVGltZSkpOwogIH07CgogIF9wcm90bzIucHJldmlvdXNMYWJlbCA9IGZ1bmN0aW9uIHByZXZpb3VzTGFiZWwoYmVmb3JlVGltZSkgewogICAgaWYgKGJlZm9yZVRpbWUgPT09IHZvaWQgMCkgewogICAgICBiZWZvcmVUaW1lID0gdGhpcy5fdGltZTsKICAgIH0KCiAgICByZXR1cm4gX2dldExhYmVsSW5EaXJlY3Rpb24odGhpcywgX3BhcnNlUG9zaXRpb24odGhpcywgYmVmb3JlVGltZSksIDEpOwogIH07CgogIF9wcm90bzIuY3VycmVudExhYmVsID0gZnVuY3Rpb24gY3VycmVudExhYmVsKHZhbHVlKSB7CiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IHRoaXMuc2Vlayh2YWx1ZSwgdHJ1ZSkgOiB0aGlzLnByZXZpb3VzTGFiZWwodGhpcy5fdGltZSArIF90aW55TnVtKTsKICB9OwoKICBfcHJvdG8yLnNoaWZ0Q2hpbGRyZW4gPSBmdW5jdGlvbiBzaGlmdENoaWxkcmVuKGFtb3VudCwgYWRqdXN0TGFiZWxzLCBpZ25vcmVCZWZvcmVUaW1lKSB7CiAgICBpZiAoaWdub3JlQmVmb3JlVGltZSA9PT0gdm9pZCAwKSB7CiAgICAgIGlnbm9yZUJlZm9yZVRpbWUgPSAwOwogICAgfQoKICAgIHZhciBjaGlsZCA9IHRoaXMuX2ZpcnN0LAogICAgICAgIGxhYmVscyA9IHRoaXMubGFiZWxzLAogICAgICAgIHA7CgogICAgd2hpbGUgKGNoaWxkKSB7CiAgICAgIGlmIChjaGlsZC5fc3RhcnQgPj0gaWdub3JlQmVmb3JlVGltZSkgewogICAgICAgIGNoaWxkLl9zdGFydCArPSBhbW91bnQ7CiAgICAgICAgY2hpbGQuX2VuZCArPSBhbW91bnQ7CiAgICAgIH0KCiAgICAgIGNoaWxkID0gY2hpbGQuX25leHQ7CiAgICB9CgogICAgaWYgKGFkanVzdExhYmVscykgewogICAgICBmb3IgKHAgaW4gbGFiZWxzKSB7CiAgICAgICAgaWYgKGxhYmVsc1twXSA+PSBpZ25vcmVCZWZvcmVUaW1lKSB7CiAgICAgICAgICBsYWJlbHNbcF0gKz0gYW1vdW50OwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiBfdW5jYWNoZSh0aGlzKTsKICB9OwoKICBfcHJvdG8yLmludmFsaWRhdGUgPSBmdW5jdGlvbiBpbnZhbGlkYXRlKCkgewogICAgdmFyIGNoaWxkID0gdGhpcy5fZmlyc3Q7CiAgICB0aGlzLl9sb2NrID0gMDsKCiAgICB3aGlsZSAoY2hpbGQpIHsKICAgICAgY2hpbGQuaW52YWxpZGF0ZSgpOwogICAgICBjaGlsZCA9IGNoaWxkLl9uZXh0OwogICAgfQoKICAgIHJldHVybiBfQW5pbWF0aW9uLnByb3RvdHlwZS5pbnZhbGlkYXRlLmNhbGwodGhpcyk7CiAgfTsKCiAgX3Byb3RvMi5jbGVhciA9IGZ1bmN0aW9uIGNsZWFyKGluY2x1ZGVMYWJlbHMpIHsKICAgIGlmIChpbmNsdWRlTGFiZWxzID09PSB2b2lkIDApIHsKICAgICAgaW5jbHVkZUxhYmVscyA9IHRydWU7CiAgICB9CgogICAgdmFyIGNoaWxkID0gdGhpcy5fZmlyc3QsCiAgICAgICAgbmV4dDsKCiAgICB3aGlsZSAoY2hpbGQpIHsKICAgICAgbmV4dCA9IGNoaWxkLl9uZXh0OwogICAgICB0aGlzLnJlbW92ZShjaGlsZCk7CiAgICAgIGNoaWxkID0gbmV4dDsKICAgIH0KCiAgICB0aGlzLl9kcCAmJiAodGhpcy5fdGltZSA9IHRoaXMuX3RUaW1lID0gdGhpcy5fcFRpbWUgPSAwKTsKICAgIGluY2x1ZGVMYWJlbHMgJiYgKHRoaXMubGFiZWxzID0ge30pOwogICAgcmV0dXJuIF91bmNhY2hlKHRoaXMpOwogIH07CgogIF9wcm90bzIudG90YWxEdXJhdGlvbiA9IGZ1bmN0aW9uIHRvdGFsRHVyYXRpb24odmFsdWUpIHsKICAgIHZhciBtYXggPSAwLAogICAgICAgIHNlbGYgPSB0aGlzLAogICAgICAgIGNoaWxkID0gc2VsZi5fbGFzdCwKICAgICAgICBwcmV2U3RhcnQgPSBfYmlnTnVtLAogICAgICAgIHByZXYsCiAgICAgICAgc3RhcnQsCiAgICAgICAgcGFyZW50OwoKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgIHJldHVybiBzZWxmLnRpbWVTY2FsZSgoc2VsZi5fcmVwZWF0IDwgMCA/IHNlbGYuZHVyYXRpb24oKSA6IHNlbGYudG90YWxEdXJhdGlvbigpKSAvIChzZWxmLnJldmVyc2VkKCkgPyAtdmFsdWUgOiB2YWx1ZSkpOwogICAgfQoKICAgIGlmIChzZWxmLl9kaXJ0eSkgewogICAgICBwYXJlbnQgPSBzZWxmLnBhcmVudDsKCiAgICAgIHdoaWxlIChjaGlsZCkgewogICAgICAgIHByZXYgPSBjaGlsZC5fcHJldjsgLy9yZWNvcmQgaXQgaGVyZSBpbiBjYXNlIHRoZSB0d2VlbiBjaGFuZ2VzIHBvc2l0aW9uIGluIHRoZSBzZXF1ZW5jZS4uLgoKICAgICAgICBjaGlsZC5fZGlydHkgJiYgY2hpbGQudG90YWxEdXJhdGlvbigpOyAvL2NvdWxkIGNoYW5nZSB0aGUgdHdlZW4uX3N0YXJ0VGltZSwgc28gbWFrZSBzdXJlIHRoZSBhbmltYXRpb24ncyBjYWNoZSBpcyBjbGVhbiBiZWZvcmUgYW5hbHl6aW5nIGl0LgoKICAgICAgICBzdGFydCA9IGNoaWxkLl9zdGFydDsKCiAgICAgICAgaWYgKHN0YXJ0ID4gcHJldlN0YXJ0ICYmIHNlbGYuX3NvcnQgJiYgY2hpbGQuX3RzICYmICFzZWxmLl9sb2NrKSB7CiAgICAgICAgICAvL2luIGNhc2Ugb25lIG9mIHRoZSB0d2VlbnMgc2hpZnRlZCBvdXQgb2Ygb3JkZXIsIGl0IG5lZWRzIHRvIGJlIHJlLWluc2VydGVkIGludG8gdGhlIGNvcnJlY3QgcG9zaXRpb24gaW4gdGhlIHNlcXVlbmNlCiAgICAgICAgICBzZWxmLl9sb2NrID0gMTsgLy9wcmV2ZW50IGVuZGxlc3MgcmVjdXJzaXZlIGNhbGxzIC0gdGhlcmUgYXJlIG1ldGhvZHMgdGhhdCBnZXQgdHJpZ2dlcmVkIHRoYXQgY2hlY2sgZHVyYXRpb24vdG90YWxEdXJhdGlvbiB3aGVuIHdlIGFkZCgpLgoKICAgICAgICAgIF9hZGRUb1RpbWVsaW5lKHNlbGYsIGNoaWxkLCBzdGFydCAtIGNoaWxkLl9kZWxheSwgMSkuX2xvY2sgPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwcmV2U3RhcnQgPSBzdGFydDsKICAgICAgICB9CgogICAgICAgIGlmIChzdGFydCA8IDAgJiYgY2hpbGQuX3RzKSB7CiAgICAgICAgICAvL2NoaWxkcmVuIGFyZW4ndCBhbGxvd2VkIHRvIGhhdmUgbmVnYXRpdmUgc3RhcnRUaW1lcyB1bmxlc3Mgc21vb3RoQ2hpbGRUaW1pbmcgaXMgdHJ1ZSwgc28gYWRqdXN0IGhlcmUgaWYgb25lIGlzIGZvdW5kLgogICAgICAgICAgbWF4IC09IHN0YXJ0OwoKICAgICAgICAgIGlmICghcGFyZW50ICYmICFzZWxmLl9kcCB8fCBwYXJlbnQgJiYgcGFyZW50LnNtb290aENoaWxkVGltaW5nKSB7CiAgICAgICAgICAgIHNlbGYuX3N0YXJ0ICs9IHN0YXJ0IC8gc2VsZi5fdHM7CiAgICAgICAgICAgIHNlbGYuX3RpbWUgLT0gc3RhcnQ7CiAgICAgICAgICAgIHNlbGYuX3RUaW1lIC09IHN0YXJ0OwogICAgICAgICAgfQoKICAgICAgICAgIHNlbGYuc2hpZnRDaGlsZHJlbigtc3RhcnQsIGZhbHNlLCAtMWU5OTkpOwogICAgICAgICAgcHJldlN0YXJ0ID0gMDsKICAgICAgICB9CgogICAgICAgIGNoaWxkLl9lbmQgPiBtYXggJiYgY2hpbGQuX3RzICYmIChtYXggPSBjaGlsZC5fZW5kKTsKICAgICAgICBjaGlsZCA9IHByZXY7CiAgICAgIH0KCiAgICAgIF9zZXREdXJhdGlvbihzZWxmLCBzZWxmID09PSBfZ2xvYmFsVGltZWxpbmUgJiYgc2VsZi5fdGltZSA+IG1heCA/IHNlbGYuX3RpbWUgOiBtYXgsIDEsIDEpOwoKICAgICAgc2VsZi5fZGlydHkgPSAwOwogICAgfQoKICAgIHJldHVybiBzZWxmLl90RHVyOwogIH07CgogIFRpbWVsaW5lLnVwZGF0ZVJvb3QgPSBmdW5jdGlvbiB1cGRhdGVSb290KHRpbWUpIHsKICAgIGlmIChfZ2xvYmFsVGltZWxpbmUuX3RzKSB7CiAgICAgIF9sYXp5U2FmZVJlbmRlcihfZ2xvYmFsVGltZWxpbmUsIF9wYXJlbnRUb0NoaWxkVG90YWxUaW1lKHRpbWUsIF9nbG9iYWxUaW1lbGluZSkpOwoKICAgICAgX2xhc3RSZW5kZXJlZEZyYW1lID0gX3RpY2tlci5mcmFtZTsKICAgIH0KCiAgICBpZiAoX3RpY2tlci5mcmFtZSA+PSBfbmV4dEdDRnJhbWUpIHsKICAgICAgX25leHRHQ0ZyYW1lICs9IF9jb25maWcuYXV0b1NsZWVwIHx8IDEyMDsKICAgICAgdmFyIGNoaWxkID0gX2dsb2JhbFRpbWVsaW5lLl9maXJzdDsKICAgICAgaWYgKCFjaGlsZCB8fCAhY2hpbGQuX3RzKSBpZiAoX2NvbmZpZy5hdXRvU2xlZXAgJiYgX3RpY2tlci5fbGlzdGVuZXJzLmxlbmd0aCA8IDIpIHsKICAgICAgICB3aGlsZSAoY2hpbGQgJiYgIWNoaWxkLl90cykgewogICAgICAgICAgY2hpbGQgPSBjaGlsZC5fbmV4dDsKICAgICAgICB9CgogICAgICAgIGNoaWxkIHx8IF90aWNrZXIuc2xlZXAoKTsKICAgICAgfQogICAgfQogIH07CgogIHJldHVybiBUaW1lbGluZTsKfShBbmltYXRpb24pOwoKX3NldERlZmF1bHRzKFRpbWVsaW5lLnByb3RvdHlwZSwgewogIF9sb2NrOiAwLAogIF9oYXNQYXVzZTogMCwKICBfZm9yY2luZzogMAp9KTsKCnZhciBfYWRkQ29tcGxleFN0cmluZ1Byb3BUd2VlbiA9IGZ1bmN0aW9uIF9hZGRDb21wbGV4U3RyaW5nUHJvcFR3ZWVuKHRhcmdldCwgcHJvcCwgc3RhcnQsIGVuZCwgc2V0dGVyLCBzdHJpbmdGaWx0ZXIsIGZ1bmNQYXJhbSkgewogIC8vbm90ZTogd2UgY2FsbCBfYWRkQ29tcGxleFN0cmluZ1Byb3BUd2Vlbi5jYWxsKHR3ZWVuSW5zdGFuY2UuLi4pIHRvIGVuc3VyZSB0aGF0IGl0J3Mgc2NvcGVkIHByb3Blcmx5LiBXZSBtYXkgY2FsbCBpdCBmcm9tIHdpdGhpbiBhIHBsdWdpbiB0b28sIHRodXMgInRoaXMiIHdvdWxkIHJlZmVyIHRvIHRoZSBwbHVnaW4uCiAgdmFyIHB0ID0gbmV3IFByb3BUd2Vlbih0aGlzLl9wdCwgdGFyZ2V0LCBwcm9wLCAwLCAxLCBfcmVuZGVyQ29tcGxleFN0cmluZywgbnVsbCwgc2V0dGVyKSwKICAgICAgaW5kZXggPSAwLAogICAgICBtYXRjaEluZGV4ID0gMCwKICAgICAgcmVzdWx0LAogICAgICBzdGFydE51bXMsCiAgICAgIGNvbG9yLAogICAgICBlbmROdW0sCiAgICAgIGNodW5rLAogICAgICBzdGFydE51bSwKICAgICAgaGFzUmFuZG9tLAogICAgICBhOwogIHB0LmIgPSBzdGFydDsKICBwdC5lID0gZW5kOwogIHN0YXJ0ICs9ICIiOyAvL2Vuc3VyZSB2YWx1ZXMgYXJlIHN0cmluZ3MKCiAgZW5kICs9ICIiOwoKICBpZiAoaGFzUmFuZG9tID0gfmVuZC5pbmRleE9mKCJyYW5kb20oIikpIHsKICAgIGVuZCA9IF9yZXBsYWNlUmFuZG9tKGVuZCk7CiAgfQoKICBpZiAoc3RyaW5nRmlsdGVyKSB7CiAgICBhID0gW3N0YXJ0LCBlbmRdOwogICAgc3RyaW5nRmlsdGVyKGEsIHRhcmdldCwgcHJvcCk7IC8vcGFzcyBhbiBhcnJheSB3aXRoIHRoZSBzdGFydGluZyBhbmQgZW5kaW5nIHZhbHVlcyBhbmQgbGV0IHRoZSBmaWx0ZXIgZG8gd2hhdGV2ZXIgaXQgbmVlZHMgdG8gdGhlIHZhbHVlcy4KCiAgICBzdGFydCA9IGFbMF07CiAgICBlbmQgPSBhWzFdOwogIH0KCiAgc3RhcnROdW1zID0gc3RhcnQubWF0Y2goX2NvbXBsZXhTdHJpbmdOdW1FeHApIHx8IFtdOwoKICB3aGlsZSAocmVzdWx0ID0gX2NvbXBsZXhTdHJpbmdOdW1FeHAuZXhlYyhlbmQpKSB7CiAgICBlbmROdW0gPSByZXN1bHRbMF07CiAgICBjaHVuayA9IGVuZC5zdWJzdHJpbmcoaW5kZXgsIHJlc3VsdC5pbmRleCk7CgogICAgaWYgKGNvbG9yKSB7CiAgICAgIGNvbG9yID0gKGNvbG9yICsgMSkgJSA1OwogICAgfSBlbHNlIGlmIChjaHVuay5zdWJzdHIoLTUpID09PSAicmdiYSgiKSB7CiAgICAgIGNvbG9yID0gMTsKICAgIH0KCiAgICBpZiAoZW5kTnVtICE9PSBzdGFydE51bXNbbWF0Y2hJbmRleCsrXSkgewogICAgICBzdGFydE51bSA9IHBhcnNlRmxvYXQoc3RhcnROdW1zW21hdGNoSW5kZXggLSAxXSkgfHwgMDsgLy90aGVzZSBuZXN0ZWQgUHJvcFR3ZWVucyBhcmUgaGFuZGxlZCBpbiBhIHNwZWNpYWwgd2F5IC0gd2UnbGwgbmV2ZXIgYWN0dWFsbHkgY2FsbCBhIHJlbmRlciBvciBzZXR0ZXIgbWV0aG9kIG9uIHRoZW0uIFdlJ2xsIGp1c3QgbG9vcCB0aHJvdWdoIHRoZW0gaW4gdGhlIHBhcmVudCBjb21wbGV4IHN0cmluZyBQcm9wVHdlZW4ncyByZW5kZXIgbWV0aG9kLgoKICAgICAgcHQuX3B0ID0gewogICAgICAgIF9uZXh0OiBwdC5fcHQsCiAgICAgICAgcDogY2h1bmsgfHwgbWF0Y2hJbmRleCA9PT0gMSA/IGNodW5rIDogIiwiLAogICAgICAgIC8vbm90ZTogU1ZHIHNwZWMgYWxsb3dzIG9taXNzaW9uIG9mIGNvbW1hL3NwYWNlIHdoZW4gYSBuZWdhdGl2ZSBzaWduIGlzIHdlZGdlZCBiZXR3ZWVuIHR3byBudW1iZXJzLCBsaWtlIDIuNS01LjMgaW5zdGVhZCBvZiAyLjUsLTUuMyBidXQgd2hlbiB0d2VlbmluZywgdGhlIG5lZ2F0aXZlIHZhbHVlIG1heSBzd2l0Y2ggdG8gcG9zaXRpdmUsIHNvIHdlIGluc2VydCB0aGUgY29tbWEganVzdCBpbiBjYXNlLgogICAgICAgIHM6IHN0YXJ0TnVtLAogICAgICAgIGM6IGVuZE51bS5jaGFyQXQoMSkgPT09ICI9IiA/IHBhcnNlRmxvYXQoZW5kTnVtLnN1YnN0cigyKSkgKiAoZW5kTnVtLmNoYXJBdCgwKSA9PT0gIi0iID8gLTEgOiAxKSA6IHBhcnNlRmxvYXQoZW5kTnVtKSAtIHN0YXJ0TnVtLAogICAgICAgIG06IGNvbG9yICYmIGNvbG9yIDwgNCA/IE1hdGgucm91bmQgOiAwCiAgICAgIH07CiAgICAgIGluZGV4ID0gX2NvbXBsZXhTdHJpbmdOdW1FeHAubGFzdEluZGV4OwogICAgfQogIH0KCiAgcHQuYyA9IGluZGV4IDwgZW5kLmxlbmd0aCA/IGVuZC5zdWJzdHJpbmcoaW5kZXgsIGVuZC5sZW5ndGgpIDogIiI7IC8vd2UgdXNlIHRoZSAiYyIgb2YgdGhlIFByb3BUd2VlbiB0byBzdG9yZSB0aGUgZmluYWwgcGFydCBvZiB0aGUgc3RyaW5nIChhZnRlciB0aGUgbGFzdCBudW1iZXIpCgogIHB0LmZwID0gZnVuY1BhcmFtOwoKICBpZiAoX3JlbEV4cC50ZXN0KGVuZCkgfHwgaGFzUmFuZG9tKSB7CiAgICBwdC5lID0gMDsgLy9pZiB0aGUgZW5kIHN0cmluZyBjb250YWlucyByZWxhdGl2ZSB2YWx1ZXMgb3IgZHluYW1pYyByYW5kb20oLi4uKSB2YWx1ZXMsIGRlbGV0ZSB0aGUgZW5kIGl0IHNvIHRoYXQgb24gdGhlIGZpbmFsIHJlbmRlciB3ZSBkb24ndCBhY3R1YWxseSBzZXQgaXQgdG8gdGhlIHN0cmluZyB3aXRoICs9IG9yIC09IGNoYXJhY3RlcnMgKGZvcmNlcyBpdCB0byB1c2UgdGhlIGNhbGN1bGF0ZWQgdmFsdWUpLgogIH0KCiAgdGhpcy5fcHQgPSBwdDsgLy9zdGFydCB0aGUgbGlua2VkIGxpc3Qgd2l0aCB0aGlzIG5ldyBQcm9wVHdlZW4uIFJlbWVtYmVyLCB3ZSBjYWxsIF9hZGRDb21wbGV4U3RyaW5nUHJvcFR3ZWVuLmNhbGwodHdlZW5JbnN0YW5jZS4uLikgdG8gZW5zdXJlIHRoYXQgaXQncyBzY29wZWQgcHJvcGVybHkuIFdlIG1heSBjYWxsIGl0IGZyb20gd2l0aGluIGEgcGx1Z2luIHRvbywgdGh1cyAidGhpcyIgd291bGQgcmVmZXIgdG8gdGhlIHBsdWdpbi4KCiAgcmV0dXJuIHB0Owp9LAogICAgX2FkZFByb3BUd2VlbiA9IGZ1bmN0aW9uIF9hZGRQcm9wVHdlZW4odGFyZ2V0LCBwcm9wLCBzdGFydCwgZW5kLCBpbmRleCwgdGFyZ2V0cywgbW9kaWZpZXIsIHN0cmluZ0ZpbHRlciwgZnVuY1BhcmFtKSB7CiAgX2lzRnVuY3Rpb24oZW5kKSAmJiAoZW5kID0gZW5kKGluZGV4IHx8IDAsIHRhcmdldCwgdGFyZ2V0cykpOwogIHZhciBjdXJyZW50VmFsdWUgPSB0YXJnZXRbcHJvcF0sCiAgICAgIHBhcnNlZFN0YXJ0ID0gc3RhcnQgIT09ICJnZXQiID8gc3RhcnQgOiAhX2lzRnVuY3Rpb24oY3VycmVudFZhbHVlKSA/IGN1cnJlbnRWYWx1ZSA6IGZ1bmNQYXJhbSA/IHRhcmdldFtwcm9wLmluZGV4T2YoInNldCIpIHx8ICFfaXNGdW5jdGlvbih0YXJnZXRbImdldCIgKyBwcm9wLnN1YnN0cigzKV0pID8gcHJvcCA6ICJnZXQiICsgcHJvcC5zdWJzdHIoMyldKGZ1bmNQYXJhbSkgOiB0YXJnZXRbcHJvcF0oKSwKICAgICAgc2V0dGVyID0gIV9pc0Z1bmN0aW9uKGN1cnJlbnRWYWx1ZSkgPyBfc2V0dGVyUGxhaW4gOiBmdW5jUGFyYW0gPyBfc2V0dGVyRnVuY1dpdGhQYXJhbSA6IF9zZXR0ZXJGdW5jLAogICAgICBwdDsKCiAgaWYgKF9pc1N0cmluZyhlbmQpKSB7CiAgICBpZiAofmVuZC5pbmRleE9mKCJyYW5kb20oIikpIHsKICAgICAgZW5kID0gX3JlcGxhY2VSYW5kb20oZW5kKTsKICAgIH0KCiAgICBpZiAoZW5kLmNoYXJBdCgxKSA9PT0gIj0iKSB7CiAgICAgIHB0ID0gcGFyc2VGbG9hdChwYXJzZWRTdGFydCkgKyBwYXJzZUZsb2F0KGVuZC5zdWJzdHIoMikpICogKGVuZC5jaGFyQXQoMCkgPT09ICItIiA/IC0xIDogMSkgKyAoZ2V0VW5pdChwYXJzZWRTdGFydCkgfHwgMCk7CgogICAgICBpZiAocHQgfHwgcHQgPT09IDApIHsKICAgICAgICAvLyB0byBhdm9pZCBpc05hTiwgbGlrZSBpZiBzb21lb25lIHBhc3NlcyBpbiBhIHZhbHVlIGxpa2UgIiE9IHdoYXRldmVyIgogICAgICAgIGVuZCA9IHB0OwogICAgICB9CiAgICB9CiAgfQoKICBpZiAocGFyc2VkU3RhcnQgIT09IGVuZCkgewogICAgaWYgKCFpc05hTihwYXJzZWRTdGFydCAqIGVuZCkgJiYgZW5kICE9PSAiIikgewogICAgICAvLyBmdW4gZmFjdDogYW55IG51bWJlciBtdWx0aXBsaWVkIGJ5ICIiIGlzIGV2YWx1YXRlZCBhcyB0aGUgbnVtYmVyIDAhCiAgICAgIHB0ID0gbmV3IFByb3BUd2Vlbih0aGlzLl9wdCwgdGFyZ2V0LCBwcm9wLCArcGFyc2VkU3RhcnQgfHwgMCwgZW5kIC0gKHBhcnNlZFN0YXJ0IHx8IDApLCB0eXBlb2YgY3VycmVudFZhbHVlID09PSAiYm9vbGVhbiIgPyBfcmVuZGVyQm9vbGVhbiA6IF9yZW5kZXJQbGFpbiwgMCwgc2V0dGVyKTsKICAgICAgZnVuY1BhcmFtICYmIChwdC5mcCA9IGZ1bmNQYXJhbSk7CiAgICAgIG1vZGlmaWVyICYmIHB0Lm1vZGlmaWVyKG1vZGlmaWVyLCB0aGlzLCB0YXJnZXQpOwogICAgICByZXR1cm4gdGhpcy5fcHQgPSBwdDsKICAgIH0KCiAgICAhY3VycmVudFZhbHVlICYmICEocHJvcCBpbiB0YXJnZXQpICYmIF9taXNzaW5nUGx1Z2luKHByb3AsIGVuZCk7CiAgICByZXR1cm4gX2FkZENvbXBsZXhTdHJpbmdQcm9wVHdlZW4uY2FsbCh0aGlzLCB0YXJnZXQsIHByb3AsIHBhcnNlZFN0YXJ0LCBlbmQsIHNldHRlciwgc3RyaW5nRmlsdGVyIHx8IF9jb25maWcuc3RyaW5nRmlsdGVyLCBmdW5jUGFyYW0pOwogIH0KfSwKICAgIC8vY3JlYXRlcyBhIGNvcHkgb2YgdGhlIHZhcnMgb2JqZWN0IGFuZCBwcm9jZXNzZXMgYW55IGZ1bmN0aW9uLWJhc2VkIHZhbHVlcyAocHV0dGluZyB0aGUgcmVzdWx0aW5nIHZhbHVlcyBkaXJlY3RseSBpbnRvIHRoZSBjb3B5KSBhcyB3ZWxsIGFzIHN0cmluZ3Mgd2l0aCAicmFuZG9tKCkiIGluIHRoZW0uIEl0IGRvZXMgTk9UIHByb2Nlc3MgcmVsYXRpdmUgdmFsdWVzLgpfcHJvY2Vzc1ZhcnMgPSBmdW5jdGlvbiBfcHJvY2Vzc1ZhcnModmFycywgaW5kZXgsIHRhcmdldCwgdGFyZ2V0cywgdHdlZW4pIHsKICBfaXNGdW5jdGlvbih2YXJzKSAmJiAodmFycyA9IF9wYXJzZUZ1bmNPclN0cmluZyh2YXJzLCB0d2VlbiwgaW5kZXgsIHRhcmdldCwgdGFyZ2V0cykpOwoKICBpZiAoIV9pc09iamVjdCh2YXJzKSB8fCB2YXJzLnN0eWxlICYmIHZhcnMubm9kZVR5cGUgfHwgX2lzQXJyYXkodmFycykgfHwgX2lzVHlwZWRBcnJheSh2YXJzKSkgewogICAgcmV0dXJuIF9pc1N0cmluZyh2YXJzKSA/IF9wYXJzZUZ1bmNPclN0cmluZyh2YXJzLCB0d2VlbiwgaW5kZXgsIHRhcmdldCwgdGFyZ2V0cykgOiB2YXJzOwogIH0KCiAgdmFyIGNvcHkgPSB7fSwKICAgICAgcDsKCiAgZm9yIChwIGluIHZhcnMpIHsKICAgIGNvcHlbcF0gPSBfcGFyc2VGdW5jT3JTdHJpbmcodmFyc1twXSwgdHdlZW4sIGluZGV4LCB0YXJnZXQsIHRhcmdldHMpOwogIH0KCiAgcmV0dXJuIGNvcHk7Cn0sCiAgICBfY2hlY2tQbHVnaW4gPSBmdW5jdGlvbiBfY2hlY2tQbHVnaW4ocHJvcGVydHksIHZhcnMsIHR3ZWVuLCBpbmRleCwgdGFyZ2V0LCB0YXJnZXRzKSB7CiAgdmFyIHBsdWdpbiwgcHQsIHB0TG9va3VwLCBpOwoKICBpZiAoX3BsdWdpbnNbcHJvcGVydHldICYmIChwbHVnaW4gPSBuZXcgX3BsdWdpbnNbcHJvcGVydHldKCkpLmluaXQodGFyZ2V0LCBwbHVnaW4ucmF3VmFycyA/IHZhcnNbcHJvcGVydHldIDogX3Byb2Nlc3NWYXJzKHZhcnNbcHJvcGVydHldLCBpbmRleCwgdGFyZ2V0LCB0YXJnZXRzLCB0d2VlbiksIHR3ZWVuLCBpbmRleCwgdGFyZ2V0cykgIT09IGZhbHNlKSB7CiAgICB0d2Vlbi5fcHQgPSBwdCA9IG5ldyBQcm9wVHdlZW4odHdlZW4uX3B0LCB0YXJnZXQsIHByb3BlcnR5LCAwLCAxLCBwbHVnaW4ucmVuZGVyLCBwbHVnaW4sIDAsIHBsdWdpbi5wcmlvcml0eSk7CgogICAgaWYgKHR3ZWVuICE9PSBfcXVpY2tUd2VlbikgewogICAgICBwdExvb2t1cCA9IHR3ZWVuLl9wdExvb2t1cFt0d2Vlbi5fdGFyZ2V0cy5pbmRleE9mKHRhcmdldCldOyAvL25vdGU6IHdlIGNhbid0IHVzZSB0d2Vlbi5fcHRMb29rdXBbaW5kZXhdIGJlY2F1c2UgZm9yIHN0YWdnZXJlZCB0d2VlbnMsIHRoZSBpbmRleCBmcm9tIHRoZSBmdWxsVGFyZ2V0cyBhcnJheSB3b24ndCBtYXRjaCB3aGF0IGl0IGlzIGluIGVhY2ggaW5kaXZpZHVhbCB0d2VlbiB0aGF0IHNwYXducyBmcm9tIHRoZSBzdGFnZ2VyLgoKICAgICAgaSA9IHBsdWdpbi5fcHJvcHMubGVuZ3RoOwoKICAgICAgd2hpbGUgKGktLSkgewogICAgICAgIHB0TG9va3VwW3BsdWdpbi5fcHJvcHNbaV1dID0gcHQ7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiBwbHVnaW47Cn0sCiAgICBfb3ZlcndyaXRpbmdUd2VlbiwKICAgIC8vc3RvcmUgYSByZWZlcmVuY2UgdGVtcG9yYXJpbHkgc28gd2UgY2FuIGF2b2lkIG92ZXJ3cml0aW5nIGl0c2VsZi4KX2luaXRUd2VlbiA9IGZ1bmN0aW9uIF9pbml0VHdlZW4odHdlZW4sIHRpbWUpIHsKICB2YXIgdmFycyA9IHR3ZWVuLnZhcnMsCiAgICAgIGVhc2UgPSB2YXJzLmVhc2UsCiAgICAgIHN0YXJ0QXQgPSB2YXJzLnN0YXJ0QXQsCiAgICAgIGltbWVkaWF0ZVJlbmRlciA9IHZhcnMuaW1tZWRpYXRlUmVuZGVyLAogICAgICBsYXp5ID0gdmFycy5sYXp5LAogICAgICBvblVwZGF0ZSA9IHZhcnMub25VcGRhdGUsCiAgICAgIG9uVXBkYXRlUGFyYW1zID0gdmFycy5vblVwZGF0ZVBhcmFtcywKICAgICAgY2FsbGJhY2tTY29wZSA9IHZhcnMuY2FsbGJhY2tTY29wZSwKICAgICAgcnVuQmFja3dhcmRzID0gdmFycy5ydW5CYWNrd2FyZHMsCiAgICAgIHlveW9FYXNlID0gdmFycy55b3lvRWFzZSwKICAgICAga2V5ZnJhbWVzID0gdmFycy5rZXlmcmFtZXMsCiAgICAgIGF1dG9SZXZlcnQgPSB2YXJzLmF1dG9SZXZlcnQsCiAgICAgIGR1ciA9IHR3ZWVuLl9kdXIsCiAgICAgIHByZXZTdGFydEF0ID0gdHdlZW4uX3N0YXJ0QXQsCiAgICAgIHRhcmdldHMgPSB0d2Vlbi5fdGFyZ2V0cywKICAgICAgcGFyZW50ID0gdHdlZW4ucGFyZW50LAogICAgICBmdWxsVGFyZ2V0cyA9IHBhcmVudCAmJiBwYXJlbnQuZGF0YSA9PT0gIm5lc3RlZCIgPyBwYXJlbnQucGFyZW50Ll90YXJnZXRzIDogdGFyZ2V0cywKICAgICAgYXV0b092ZXJ3cml0ZSA9IHR3ZWVuLl9vdmVyd3JpdGUgPT09ICJhdXRvIiAmJiAhX3N1cHByZXNzT3ZlcndyaXRlcywKICAgICAgdGwgPSB0d2Vlbi50aW1lbGluZSwKICAgICAgY2xlYW5WYXJzLAogICAgICBpLAogICAgICBwLAogICAgICBwdCwKICAgICAgdGFyZ2V0LAogICAgICBoYXNQcmlvcml0eSwKICAgICAgZ3NEYXRhLAogICAgICBoYXJuZXNzLAogICAgICBwbHVnaW4sCiAgICAgIHB0TG9va3VwLAogICAgICBpbmRleCwKICAgICAgaGFybmVzc1ZhcnMsCiAgICAgIG92ZXJ3cml0dGVuOwogIHRsICYmICgha2V5ZnJhbWVzIHx8ICFlYXNlKSAmJiAoZWFzZSA9ICJub25lIik7CiAgdHdlZW4uX2Vhc2UgPSBfcGFyc2VFYXNlKGVhc2UsIF9kZWZhdWx0cy5lYXNlKTsKICB0d2Vlbi5feUVhc2UgPSB5b3lvRWFzZSA/IF9pbnZlcnRFYXNlKF9wYXJzZUVhc2UoeW95b0Vhc2UgPT09IHRydWUgPyBlYXNlIDogeW95b0Vhc2UsIF9kZWZhdWx0cy5lYXNlKSkgOiAwOwoKICBpZiAoeW95b0Vhc2UgJiYgdHdlZW4uX3lveW8gJiYgIXR3ZWVuLl9yZXBlYXQpIHsKICAgIC8vdGhlcmUgbXVzdCBoYXZlIGJlZW4gYSBwYXJlbnQgdGltZWxpbmUgd2l0aCB5b3lvOnRydWUgdGhhdCBpcyBjdXJyZW50bHkgaW4gaXRzIHlveW8gcGhhc2UsIHNvIGZsaXAgdGhlIGVhc2VzLgogICAgeW95b0Vhc2UgPSB0d2Vlbi5feUVhc2U7CiAgICB0d2Vlbi5feUVhc2UgPSB0d2Vlbi5fZWFzZTsKICAgIHR3ZWVuLl9lYXNlID0geW95b0Vhc2U7CiAgfQoKICB0d2Vlbi5fZnJvbSA9ICF0bCAmJiAhIXZhcnMucnVuQmFja3dhcmRzOyAvL25lc3RlZCB0aW1lbGluZXMgc2hvdWxkIG5ldmVyIHJ1biBiYWNrd2FyZHMgLSB0aGUgYmFja3dhcmRzLW5lc3MgaXMgaW4gdGhlIGNoaWxkIHR3ZWVucy4KCiAgaWYgKCF0bCB8fCBrZXlmcmFtZXMgJiYgIXZhcnMuc3RhZ2dlcikgewogICAgLy9pZiB0aGVyZSdzIGFuIGludGVybmFsIHRpbWVsaW5lLCBza2lwIGFsbCB0aGUgcGFyc2luZyBiZWNhdXNlIHdlIHBhc3NlZCB0aGF0IHRhc2sgZG93biB0aGUgY2hhaW4uCiAgICBoYXJuZXNzID0gdGFyZ2V0c1swXSA/IF9nZXRDYWNoZSh0YXJnZXRzWzBdKS5oYXJuZXNzIDogMDsKICAgIGhhcm5lc3NWYXJzID0gaGFybmVzcyAmJiB2YXJzW2hhcm5lc3MucHJvcF07IC8vc29tZW9uZSBtYXkgbmVlZCB0byBzcGVjaWZ5IENTUy1zcGVjaWZpYyB2YWx1ZXMgQU5EIG5vbi1DU1MgdmFsdWVzLCBsaWtlIGlmIHRoZSBlbGVtZW50IGhhcyBhbiAieCIgcHJvcGVydHkgcGx1cyBpdCdzIGEgc3RhbmRhcmQgRE9NIGVsZW1lbnQuIFdlIGFsbG93IHBlb3BsZSB0byBkaXN0aW5ndWlzaCBieSB3cmFwcGluZyBwbHVnaW4tc3BlY2lmaWMgc3R1ZmYgaW4gYSBjc3M6e30gb2JqZWN0IGZvciBleGFtcGxlLgoKICAgIGNsZWFuVmFycyA9IF9jb3B5RXhjbHVkaW5nKHZhcnMsIF9yZXNlcnZlZFByb3BzKTsKICAgIHByZXZTdGFydEF0ICYmIF9yZW1vdmVGcm9tUGFyZW50KHByZXZTdGFydEF0LnJlbmRlcigtMSwgdHJ1ZSkpOwoKICAgIGlmIChzdGFydEF0KSB7CiAgICAgIF9yZW1vdmVGcm9tUGFyZW50KHR3ZWVuLl9zdGFydEF0ID0gVHdlZW4uc2V0KHRhcmdldHMsIF9zZXREZWZhdWx0cyh7CiAgICAgICAgZGF0YTogImlzU3RhcnQiLAogICAgICAgIG92ZXJ3cml0ZTogZmFsc2UsCiAgICAgICAgcGFyZW50OiBwYXJlbnQsCiAgICAgICAgaW1tZWRpYXRlUmVuZGVyOiB0cnVlLAogICAgICAgIGxhenk6IF9pc05vdEZhbHNlKGxhenkpLAogICAgICAgIHN0YXJ0QXQ6IG51bGwsCiAgICAgICAgZGVsYXk6IDAsCiAgICAgICAgb25VcGRhdGU6IG9uVXBkYXRlLAogICAgICAgIG9uVXBkYXRlUGFyYW1zOiBvblVwZGF0ZVBhcmFtcywKICAgICAgICBjYWxsYmFja1Njb3BlOiBjYWxsYmFja1Njb3BlLAogICAgICAgIHN0YWdnZXI6IDAKICAgICAgfSwgc3RhcnRBdCkpKTsgLy9jb3B5IHRoZSBwcm9wZXJ0aWVzL3ZhbHVlcyBpbnRvIGEgbmV3IG9iamVjdCB0byBhdm9pZCBjb2xsaXNpb25zLCBsaWtlIHZhciB0byA9IHt4OjB9LCBmcm9tID0ge3g6NTAwfTsgdGltZWxpbmUuZnJvbVRvKGUsIGZyb20sIHRvKS5mcm9tVG8oZSwgdG8sIGZyb20pOwoKCiAgICAgIHRpbWUgPCAwICYmICFpbW1lZGlhdGVSZW5kZXIgJiYgIWF1dG9SZXZlcnQgJiYgdHdlZW4uX3N0YXJ0QXQucmVuZGVyKC0xLCB0cnVlKTsgLy8gcmFyZSBlZGdlIGNhc2UsIGxpa2UgaWYgYSByZW5kZXIgaXMgZm9yY2VkIGluIHRoZSBuZWdhdGl2ZSBkaXJlY3Rpb24gb2YgYSBub24taW5pdHRlZCB0d2Vlbi4KCiAgICAgIGlmIChpbW1lZGlhdGVSZW5kZXIpIHsKICAgICAgICB0aW1lID4gMCAmJiAhYXV0b1JldmVydCAmJiAodHdlZW4uX3N0YXJ0QXQgPSAwKTsgLy90d2VlbnMgdGhhdCByZW5kZXIgaW1tZWRpYXRlbHkgKGxpa2UgbW9zdCBmcm9tKCkgYW5kIGZyb21UbygpIHR3ZWVucykgc2hvdWxkbid0IHJldmVydCB3aGVuIHRoZWlyIHBhcmVudCB0aW1lbGluZSdzIHBsYXloZWFkIGdvZXMgYmFja3dhcmQgcGFzdCB0aGUgc3RhcnRUaW1lIGJlY2F1c2UgdGhlIGluaXRpYWwgcmVuZGVyIGNvdWxkIGhhdmUgaGFwcGVuZWQgYW55dGltZSBhbmQgaXQgc2hvdWxkbid0IGJlIGRpcmVjdGx5IGNvcnJlbGF0ZWQgdG8gdGhpcyB0d2VlbidzIHN0YXJ0VGltZS4gSW1hZ2luZSBzZXR0aW5nIHVwIGEgY29tcGxleCBhbmltYXRpb24gd2hlcmUgdGhlIGJlZ2lubmluZyBzdGF0ZXMgb2YgdmFyaW91cyBvYmplY3RzIGFyZSByZW5kZXJlZCBpbW1lZGlhdGVseSBidXQgdGhlIHR3ZWVuIGRvZXNuJ3QgaGFwcGVuIGZvciBxdWl0ZSBzb21lIHRpbWUgLSBpZiB3ZSByZXZlcnQgdG8gdGhlIHN0YXJ0aW5nIHZhbHVlcyBhcyBzb29uIGFzIHRoZSBwbGF5aGVhZCBnb2VzIGJhY2t3YXJkIHBhc3QgdGhlIHR3ZWVuJ3Mgc3RhcnRUaW1lLCBpdCB3aWxsIHRocm93IHRoaW5ncyBvZmYgdmlzdWFsbHkuIFJldmVyc2lvbiBzaG91bGQgb25seSBoYXBwZW4gaW4gVGltZWxpbmUgaW5zdGFuY2VzIHdoZXJlIGltbWVkaWF0ZVJlbmRlciB3YXMgZmFsc2Ugb3Igd2hlbiBhdXRvUmV2ZXJ0IGlzIGV4cGxpY2l0bHkgc2V0IHRvIHRydWUuCgogICAgICAgIGlmIChkdXIgJiYgdGltZSA8PSAwKSB7CiAgICAgICAgICB0aW1lICYmICh0d2Vlbi5felRpbWUgPSB0aW1lKTsKICAgICAgICAgIHJldHVybjsgLy93ZSBza2lwIGluaXRpYWxpemF0aW9uIGhlcmUgc28gdGhhdCBvdmVyd3JpdGluZyBkb2Vzbid0IG9jY3VyIHVudGlsIHRoZSB0d2VlbiBhY3R1YWxseSBiZWdpbnMuIE90aGVyd2lzZSwgaWYgeW91IGNyZWF0ZSBzZXZlcmFsIGltbWVkaWF0ZVJlbmRlcjp0cnVlIHR3ZWVucyBvZiB0aGUgc2FtZSB0YXJnZXQvcHJvcGVydGllcyB0byBkcm9wIGludG8gYSBUaW1lbGluZSwgdGhlIGxhc3Qgb25lIGNyZWF0ZWQgd291bGQgb3ZlcndyaXRlIHRoZSBmaXJzdCBvbmVzIGJlY2F1c2UgdGhleSBkaWRuJ3QgZ2V0IHBsYWNlZCBpbnRvIHRoZSB0aW1lbGluZSB5ZXQgYmVmb3JlIHRoZSBmaXJzdCByZW5kZXIgb2NjdXJzIGFuZCBraWNrcyBpbiBvdmVyd3JpdGluZy4KICAgICAgICB9IC8vIGlmICh0aW1lID4gMCkgewogICAgICAgIC8vIAlhdXRvUmV2ZXJ0IHx8ICh0d2Vlbi5fc3RhcnRBdCA9IDApOyAvL3R3ZWVucyB0aGF0IHJlbmRlciBpbW1lZGlhdGVseSAobGlrZSBtb3N0IGZyb20oKSBhbmQgZnJvbVRvKCkgdHdlZW5zKSBzaG91bGRuJ3QgcmV2ZXJ0IHdoZW4gdGhlaXIgcGFyZW50IHRpbWVsaW5lJ3MgcGxheWhlYWQgZ29lcyBiYWNrd2FyZCBwYXN0IHRoZSBzdGFydFRpbWUgYmVjYXVzZSB0aGUgaW5pdGlhbCByZW5kZXIgY291bGQgaGF2ZSBoYXBwZW5lZCBhbnl0aW1lIGFuZCBpdCBzaG91bGRuJ3QgYmUgZGlyZWN0bHkgY29ycmVsYXRlZCB0byB0aGlzIHR3ZWVuJ3Mgc3RhcnRUaW1lLiBJbWFnaW5lIHNldHRpbmcgdXAgYSBjb21wbGV4IGFuaW1hdGlvbiB3aGVyZSB0aGUgYmVnaW5uaW5nIHN0YXRlcyBvZiB2YXJpb3VzIG9iamVjdHMgYXJlIHJlbmRlcmVkIGltbWVkaWF0ZWx5IGJ1dCB0aGUgdHdlZW4gZG9lc24ndCBoYXBwZW4gZm9yIHF1aXRlIHNvbWUgdGltZSAtIGlmIHdlIHJldmVydCB0byB0aGUgc3RhcnRpbmcgdmFsdWVzIGFzIHNvb24gYXMgdGhlIHBsYXloZWFkIGdvZXMgYmFja3dhcmQgcGFzdCB0aGUgdHdlZW4ncyBzdGFydFRpbWUsIGl0IHdpbGwgdGhyb3cgdGhpbmdzIG9mZiB2aXN1YWxseS4gUmV2ZXJzaW9uIHNob3VsZCBvbmx5IGhhcHBlbiBpbiBUaW1lbGluZSBpbnN0YW5jZXMgd2hlcmUgaW1tZWRpYXRlUmVuZGVyIHdhcyBmYWxzZSBvciB3aGVuIGF1dG9SZXZlcnQgaXMgZXhwbGljaXRseSBzZXQgdG8gdHJ1ZS4KICAgICAgICAvLyB9IGVsc2UgaWYgKGR1ciAmJiAhKHRpbWUgPCAwICYmIHByZXZTdGFydEF0KSkgewogICAgICAgIC8vIAl0aW1lICYmICh0d2Vlbi5felRpbWUgPSB0aW1lKTsKICAgICAgICAvLyAJcmV0dXJuOyAvL3dlIHNraXAgaW5pdGlhbGl6YXRpb24gaGVyZSBzbyB0aGF0IG92ZXJ3cml0aW5nIGRvZXNuJ3Qgb2NjdXIgdW50aWwgdGhlIHR3ZWVuIGFjdHVhbGx5IGJlZ2lucy4gT3RoZXJ3aXNlLCBpZiB5b3UgY3JlYXRlIHNldmVyYWwgaW1tZWRpYXRlUmVuZGVyOnRydWUgdHdlZW5zIG9mIHRoZSBzYW1lIHRhcmdldC9wcm9wZXJ0aWVzIHRvIGRyb3AgaW50byBhIFRpbWVsaW5lLCB0aGUgbGFzdCBvbmUgY3JlYXRlZCB3b3VsZCBvdmVyd3JpdGUgdGhlIGZpcnN0IG9uZXMgYmVjYXVzZSB0aGV5IGRpZG4ndCBnZXQgcGxhY2VkIGludG8gdGhlIHRpbWVsaW5lIHlldCBiZWZvcmUgdGhlIGZpcnN0IHJlbmRlciBvY2N1cnMgYW5kIGtpY2tzIGluIG92ZXJ3cml0aW5nLgogICAgICAgIC8vIH0KCiAgICAgIH0gZWxzZSBpZiAoYXV0b1JldmVydCA9PT0gZmFsc2UpIHsKICAgICAgICB0d2Vlbi5fc3RhcnRBdCA9IDA7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAocnVuQmFja3dhcmRzICYmIGR1cikgewogICAgICAvL2Zyb20oKSB0d2VlbnMgbXVzdCBiZSBoYW5kbGVkIHVuaXF1ZWx5OiB0aGVpciBiZWdpbm5pbmcgdmFsdWVzIG11c3QgYmUgcmVuZGVyZWQgYnV0IHdlIGRvbid0IHdhbnQgb3ZlcndyaXRpbmcgdG8gb2NjdXIgeWV0ICh3aGVuIHRpbWUgaXMgc3RpbGwgMCkuIFdhaXQgdW50aWwgdGhlIHR3ZWVuIGFjdHVhbGx5IGJlZ2lucyBiZWZvcmUgZG9pbmcgYWxsIHRoZSByb3V0aW5lcyBsaWtlIG92ZXJ3cml0aW5nLiBBdCB0aGF0IHRpbWUsIHdlIHNob3VsZCByZW5kZXIgYXQgdGhlIEVORCBvZiB0aGUgdHdlZW4gdG8gZW5zdXJlIHRoYXQgdGhpbmdzIGluaXRpYWxpemUgY29ycmVjdGx5IChyZW1lbWJlciwgZnJvbSgpIHR3ZWVucyBnbyBiYWNrd2FyZHMpCiAgICAgIGlmIChwcmV2U3RhcnRBdCkgewogICAgICAgICFhdXRvUmV2ZXJ0ICYmICh0d2Vlbi5fc3RhcnRBdCA9IDApOwogICAgICB9IGVsc2UgewogICAgICAgIHRpbWUgJiYgKGltbWVkaWF0ZVJlbmRlciA9IGZhbHNlKTsgLy9pbiByYXJlIGNhc2VzIChsaWtlIGlmIGEgZnJvbSgpIHR3ZWVuIHJ1bnMgYW5kIHRoZW4gaXMgaW52YWxpZGF0ZSgpLWVkKSwgaW1tZWRpYXRlUmVuZGVyIGNvdWxkIGJlIHRydWUgYnV0IHRoZSBpbml0aWFsIGZvcmNlZC1yZW5kZXIgZ2V0cyBza2lwcGVkLCBzbyB0aGVyZSdzIG5vIG5lZWQgdG8gZm9yY2UgdGhlIHJlbmRlciBpbiB0aGlzIGNvbnRleHQgd2hlbiB0aGUgX3RpbWUgaXMgZ3JlYXRlciB0aGFuIDAKCiAgICAgICAgcCA9IF9zZXREZWZhdWx0cyh7CiAgICAgICAgICBvdmVyd3JpdGU6IGZhbHNlLAogICAgICAgICAgZGF0YTogImlzRnJvbVN0YXJ0IiwKICAgICAgICAgIC8vd2UgdGFnIHRoZSB0d2VlbiB3aXRoIGFzICJpc0Zyb21TdGFydCIgc28gdGhhdCBpZiBbaW5zaWRlIGEgcGx1Z2luXSB3ZSBuZWVkIHRvIG9ubHkgZG8gc29tZXRoaW5nIGF0IHRoZSB2ZXJ5IEVORCBvZiBhIHR3ZWVuLCB3ZSBoYXZlIGEgd2F5IG9mIGlkZW50aWZ5aW5nIHRoaXMgdHdlZW4gYXMgbWVyZWx5IHRoZSBvbmUgdGhhdCdzIHNldHRpbmcgdGhlIGJlZ2lubmluZyB2YWx1ZXMgZm9yIGEgImZyb20oKSIgdHdlZW4uIEZvciBleGFtcGxlLCBjbGVhclByb3BzIGluIENTU1BsdWdpbiBzaG91bGQgb25seSBnZXQgYXBwbGllZCBhdCB0aGUgdmVyeSBFTkQgb2YgYSB0d2VlbiBhbmQgd2l0aG91dCB0aGlzIHRhZywgZnJvbSguLi57aGVpZ2h0OjEwMCwgY2xlYXJQcm9wczoiaGVpZ2h0IiwgZGVsYXk6MX0pIHdvdWxkIHdpcGUgdGhlIGhlaWdodCBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSB0d2VlbiBhbmQgYWZ0ZXIgMSBzZWNvbmQsIGl0J2Qga2ljayBiYWNrIGluLgogICAgICAgICAgbGF6eTogaW1tZWRpYXRlUmVuZGVyICYmIF9pc05vdEZhbHNlKGxhenkpLAogICAgICAgICAgaW1tZWRpYXRlUmVuZGVyOiBpbW1lZGlhdGVSZW5kZXIsCiAgICAgICAgICAvL3plcm8tZHVyYXRpb24gdHdlZW5zIHJlbmRlciBpbW1lZGlhdGVseSBieSBkZWZhdWx0LCBidXQgaWYgd2UncmUgbm90IHNwZWNpZmljYWxseSBpbnN0cnVjdGVkIHRvIHJlbmRlciB0aGlzIHR3ZWVuIGltbWVkaWF0ZWx5LCB3ZSBzaG91bGQgc2tpcCB0aGlzIGFuZCBtZXJlbHkgX2luaXQoKSB0byByZWNvcmQgdGhlIHN0YXJ0aW5nIHZhbHVlcyAocmVuZGVyaW5nIHRoZW0gaW1tZWRpYXRlbHkgd291bGQgcHVzaCB0aGVtIHRvIGNvbXBsZXRpb24gd2hpY2ggaXMgd2FzdGVmdWwgaW4gdGhhdCBjYXNlIC0gd2UnZCBoYXZlIHRvIHJlbmRlcigtMSkgaW1tZWRpYXRlbHkgYWZ0ZXIpCiAgICAgICAgICBzdGFnZ2VyOiAwLAogICAgICAgICAgcGFyZW50OiBwYXJlbnQgLy9lbnN1cmVzIHRoYXQgbmVzdGVkIHR3ZWVucyB0aGF0IGhhZCBhIHN0YWdnZXIgYXJlIGhhbmRsZWQgcHJvcGVybHksIGxpa2UgZ3NhcC5mcm9tKCIuY2xhc3MiLCB7eTpnc2FwLnV0aWxzLndyYXAoWy0xMDAsMTAwXSl9KQoKICAgICAgICB9LCBjbGVhblZhcnMpOwogICAgICAgIGhhcm5lc3NWYXJzICYmIChwW2hhcm5lc3MucHJvcF0gPSBoYXJuZXNzVmFycyk7IC8vIGluIGNhc2Ugc29tZW9uZSBkb2VzIHNvbWV0aGluZyBsaWtlIC5mcm9tKC4uLiwge2Nzczp7fX0pCgogICAgICAgIF9yZW1vdmVGcm9tUGFyZW50KHR3ZWVuLl9zdGFydEF0ID0gVHdlZW4uc2V0KHRhcmdldHMsIHApKTsKCiAgICAgICAgdGltZSA8IDAgJiYgdHdlZW4uX3N0YXJ0QXQucmVuZGVyKC0xLCB0cnVlKTsgLy8gcmFyZSBlZGdlIGNhc2UsIGxpa2UgaWYgYSByZW5kZXIgaXMgZm9yY2VkIGluIHRoZSBuZWdhdGl2ZSBkaXJlY3Rpb24gb2YgYSBub24taW5pdHRlZCBmcm9tKCkgdHdlZW4uCgogICAgICAgIHR3ZWVuLl96VGltZSA9IHRpbWU7CgogICAgICAgIGlmICghaW1tZWRpYXRlUmVuZGVyKSB7CiAgICAgICAgICBfaW5pdFR3ZWVuKHR3ZWVuLl9zdGFydEF0LCBfdGlueU51bSk7IC8vZW5zdXJlcyB0aGF0IHRoZSBpbml0aWFsIHZhbHVlcyBhcmUgcmVjb3JkZWQKCiAgICAgICAgfSBlbHNlIGlmICghdGltZSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHR3ZWVuLl9wdCA9IDA7CiAgICBsYXp5ID0gZHVyICYmIF9pc05vdEZhbHNlKGxhenkpIHx8IGxhenkgJiYgIWR1cjsKCiAgICBmb3IgKGkgPSAwOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkrKykgewogICAgICB0YXJnZXQgPSB0YXJnZXRzW2ldOwogICAgICBnc0RhdGEgPSB0YXJnZXQuX2dzYXAgfHwgX2hhcm5lc3ModGFyZ2V0cylbaV0uX2dzYXA7CiAgICAgIHR3ZWVuLl9wdExvb2t1cFtpXSA9IHB0TG9va3VwID0ge307CiAgICAgIF9sYXp5TG9va3VwW2dzRGF0YS5pZF0gJiYgX2xhenlUd2VlbnMubGVuZ3RoICYmIF9sYXp5UmVuZGVyKCk7IC8vaWYgb3RoZXIgdHdlZW5zIG9mIHRoZSBzYW1lIHRhcmdldCBoYXZlIHJlY2VudGx5IGluaXR0ZWQgYnV0IGhhdmVuJ3QgcmVuZGVyZWQgeWV0LCB3ZSd2ZSBnb3QgdG8gZm9yY2UgdGhlIHJlbmRlciBzbyB0aGF0IHRoZSBzdGFydGluZyB2YWx1ZXMgYXJlIGNvcnJlY3QgKGltYWdpbmUgcG9wdWxhdGluZyBhIHRpbWVsaW5lIHdpdGggYSBidW5jaCBvZiBzZXF1ZW50aWFsIHR3ZWVucyBhbmQgdGhlbiBqdW1waW5nIHRvIHRoZSBlbmQpCgogICAgICBpbmRleCA9IGZ1bGxUYXJnZXRzID09PSB0YXJnZXRzID8gaSA6IGZ1bGxUYXJnZXRzLmluZGV4T2YodGFyZ2V0KTsKCiAgICAgIGlmIChoYXJuZXNzICYmIChwbHVnaW4gPSBuZXcgaGFybmVzcygpKS5pbml0KHRhcmdldCwgaGFybmVzc1ZhcnMgfHwgY2xlYW5WYXJzLCB0d2VlbiwgaW5kZXgsIGZ1bGxUYXJnZXRzKSAhPT0gZmFsc2UpIHsKICAgICAgICB0d2Vlbi5fcHQgPSBwdCA9IG5ldyBQcm9wVHdlZW4odHdlZW4uX3B0LCB0YXJnZXQsIHBsdWdpbi5uYW1lLCAwLCAxLCBwbHVnaW4ucmVuZGVyLCBwbHVnaW4sIDAsIHBsdWdpbi5wcmlvcml0eSk7CgogICAgICAgIHBsdWdpbi5fcHJvcHMuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkgewogICAgICAgICAgcHRMb29rdXBbbmFtZV0gPSBwdDsKICAgICAgICB9KTsKCiAgICAgICAgcGx1Z2luLnByaW9yaXR5ICYmIChoYXNQcmlvcml0eSA9IDEpOwogICAgICB9CgogICAgICBpZiAoIWhhcm5lc3MgfHwgaGFybmVzc1ZhcnMpIHsKICAgICAgICBmb3IgKHAgaW4gY2xlYW5WYXJzKSB7CiAgICAgICAgICBpZiAoX3BsdWdpbnNbcF0gJiYgKHBsdWdpbiA9IF9jaGVja1BsdWdpbihwLCBjbGVhblZhcnMsIHR3ZWVuLCBpbmRleCwgdGFyZ2V0LCBmdWxsVGFyZ2V0cykpKSB7CiAgICAgICAgICAgIHBsdWdpbi5wcmlvcml0eSAmJiAoaGFzUHJpb3JpdHkgPSAxKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHB0TG9va3VwW3BdID0gcHQgPSBfYWRkUHJvcFR3ZWVuLmNhbGwodHdlZW4sIHRhcmdldCwgcCwgImdldCIsIGNsZWFuVmFyc1twXSwgaW5kZXgsIGZ1bGxUYXJnZXRzLCAwLCB2YXJzLnN0cmluZ0ZpbHRlcik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0d2Vlbi5fb3AgJiYgdHdlZW4uX29wW2ldICYmIHR3ZWVuLmtpbGwodGFyZ2V0LCB0d2Vlbi5fb3BbaV0pOwoKICAgICAgaWYgKGF1dG9PdmVyd3JpdGUgJiYgdHdlZW4uX3B0KSB7CiAgICAgICAgX292ZXJ3cml0aW5nVHdlZW4gPSB0d2VlbjsKCiAgICAgICAgX2dsb2JhbFRpbWVsaW5lLmtpbGxUd2VlbnNPZih0YXJnZXQsIHB0TG9va3VwLCB0d2Vlbi5nbG9iYWxUaW1lKHRpbWUpKTsgLy8gbWFrZSBzdXJlIHRoZSBvdmVyd3JpdGluZyBkb2Vzbid0IG92ZXJ3cml0ZSBUSElTIHR3ZWVuISEhCgoKICAgICAgICBvdmVyd3JpdHRlbiA9ICF0d2Vlbi5wYXJlbnQ7CiAgICAgICAgX292ZXJ3cml0aW5nVHdlZW4gPSAwOwogICAgICB9CgogICAgICB0d2Vlbi5fcHQgJiYgbGF6eSAmJiAoX2xhenlMb29rdXBbZ3NEYXRhLmlkXSA9IDEpOwogICAgfQoKICAgIGhhc1ByaW9yaXR5ICYmIF9zb3J0UHJvcFR3ZWVuc0J5UHJpb3JpdHkodHdlZW4pOwogICAgdHdlZW4uX29uSW5pdCAmJiB0d2Vlbi5fb25Jbml0KHR3ZWVuKTsgLy9wbHVnaW5zIGxpa2UgUm91bmRQcm9wcyBtdXN0IHdhaXQgdW50aWwgQUxMIG9mIHRoZSBQcm9wVHdlZW5zIGFyZSBpbnN0YW50aWF0ZWQuIEluIHRoZSBwbHVnaW4ncyBpbml0KCkgZnVuY3Rpb24sIGl0IHNldHMgdGhlIF9vbkluaXQgb24gdGhlIHR3ZWVuIGluc3RhbmNlLiBNYXkgbm90IGJlIHByZXR0eS9pbnR1aXRpdmUsIGJ1dCBpdCdzIGZhc3QgYW5kIGtlZXBzIGZpbGUgc2l6ZSBkb3duLgogIH0KCiAgdHdlZW4uX29uVXBkYXRlID0gb25VcGRhdGU7CiAgdHdlZW4uX2luaXR0ZWQgPSAoIXR3ZWVuLl9vcCB8fCB0d2Vlbi5fcHQpICYmICFvdmVyd3JpdHRlbjsgLy8gaWYgb3ZlcndyaXR0ZW5Qcm9wcyByZXN1bHRlZCBpbiB0aGUgZW50aXJlIHR3ZWVuIGJlaW5nIGtpbGxlZCwgZG8gTk9UIGZsYWcgaXQgYXMgaW5pdHRlZCBvciBlbHNlIGl0IG1heSByZW5kZXIgZm9yIG9uZSB0aWNrLgoKICBrZXlmcmFtZXMgJiYgdGltZSA8PSAwICYmIHRsLnJlbmRlcihfYmlnTnVtLCB0cnVlLCB0cnVlKTsgLy8gaWYgdGhlcmUncyBhIDAlIGtleWZyYW1lLCBpdCdsbCByZW5kZXIgaW4gdGhlICJiZWZvcmUiIHN0YXRlIGZvciBhbnkgc3RhZ2dlcmVkL2RlbGF5ZWQgYW5pbWF0aW9ucyB0aHVzIHdoZW4gdGhlIGZvbGxvd2luZyB0d2VlbiBpbml0aWFsaXplcywgaXQnbGwgdXNlIHRoZSAiYmVmb3JlIiBzdGF0ZSBpbnN0ZWFkIG9mIHRoZSAiYWZ0ZXIiIHN0YXRlIGFzIHRoZSBpbml0aWFsIHZhbHVlcy4KfSwKICAgIF9hZGRBbGlhc2VzVG9WYXJzID0gZnVuY3Rpb24gX2FkZEFsaWFzZXNUb1ZhcnModGFyZ2V0cywgdmFycykgewogIHZhciBoYXJuZXNzID0gdGFyZ2V0c1swXSA/IF9nZXRDYWNoZSh0YXJnZXRzWzBdKS5oYXJuZXNzIDogMCwKICAgICAgcHJvcGVydHlBbGlhc2VzID0gaGFybmVzcyAmJiBoYXJuZXNzLmFsaWFzZXMsCiAgICAgIGNvcHksCiAgICAgIHAsCiAgICAgIGksCiAgICAgIGFsaWFzZXM7CgogIGlmICghcHJvcGVydHlBbGlhc2VzKSB7CiAgICByZXR1cm4gdmFyczsKICB9CgogIGNvcHkgPSBfbWVyZ2Uoe30sIHZhcnMpOwoKICBmb3IgKHAgaW4gcHJvcGVydHlBbGlhc2VzKSB7CiAgICBpZiAocCBpbiBjb3B5KSB7CiAgICAgIGFsaWFzZXMgPSBwcm9wZXJ0eUFsaWFzZXNbcF0uc3BsaXQoIiwiKTsKICAgICAgaSA9IGFsaWFzZXMubGVuZ3RoOwoKICAgICAgd2hpbGUgKGktLSkgewogICAgICAgIGNvcHlbYWxpYXNlc1tpXV0gPSBjb3B5W3BdOwogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4gY29weTsKfSwKICAgIC8vIHBhcnNlcyBtdWx0aXBsZSBmb3JtYXRzLCBsaWtlIHsiMCUiOiB7eDogMTAwfSwgeyI1MCUiOiB7eDogLTIwfX0gYW5kIHsgeDogeyIwJSI6IDEwMCwgIjUwJSI6IC0yMH0gfSwgYW5kIGFuICJlYXNlIiBjYW4gYmUgc2V0IG9uIGFueSBvYmplY3QuIFdlIHBvcHVsYXRlIGFuICJhbGxQcm9wcyIgb2JqZWN0IHdpdGggYW4gQXJyYXkgZm9yIGVhY2ggcHJvcGVydHksIGxpa2Uge3g6IFt7fSwge31dLCB5Olt7fSwge31dfSB3aXRoIGRhdGEgZm9yIGVhY2ggcHJvcGVydHkgdHdlZW4uIFRoZSBvYmplY3RzIGhhdmUgYSAidCIgKHRpbWUpLCAidiIsICh2YWx1ZSksIGFuZCAiZSIgKGVhc2UpIHByb3BlcnR5LiBUaGlzIGFsbG93cyB1cyB0byBwaWVjZSB0b2dldGhlciBhIHRpbWVsaW5lIGxhdGVyLgpfcGFyc2VLZXlmcmFtZSA9IGZ1bmN0aW9uIF9wYXJzZUtleWZyYW1lKHByb3AsIG9iaiwgYWxsUHJvcHMsIGVhc2VFYWNoKSB7CiAgdmFyIGVhc2UgPSBvYmouZWFzZSB8fCBlYXNlRWFjaCB8fCAicG93ZXIxLmluT3V0IiwKICAgICAgcCwKICAgICAgYTsKCiAgaWYgKF9pc0FycmF5KG9iaikpIHsKICAgIGEgPSBhbGxQcm9wc1twcm9wXSB8fCAoYWxsUHJvcHNbcHJvcF0gPSBbXSk7IC8vIHQgPSB0aW1lIChvdXQgb2YgMTAwKSwgdiA9IHZhbHVlLCBlID0gZWFzZQoKICAgIG9iai5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgaSkgewogICAgICByZXR1cm4gYS5wdXNoKHsKICAgICAgICB0OiBpIC8gKG9iai5sZW5ndGggLSAxKSAqIDEwMCwKICAgICAgICB2OiB2YWx1ZSwKICAgICAgICBlOiBlYXNlCiAgICAgIH0pOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIGZvciAocCBpbiBvYmopIHsKICAgICAgYSA9IGFsbFByb3BzW3BdIHx8IChhbGxQcm9wc1twXSA9IFtdKTsKICAgICAgcCA9PT0gImVhc2UiIHx8IGEucHVzaCh7CiAgICAgICAgdDogcGFyc2VGbG9hdChwcm9wKSwKICAgICAgICB2OiBvYmpbcF0sCiAgICAgICAgZTogZWFzZQogICAgICB9KTsKICAgIH0KICB9Cn0sCiAgICBfcGFyc2VGdW5jT3JTdHJpbmcgPSBmdW5jdGlvbiBfcGFyc2VGdW5jT3JTdHJpbmcodmFsdWUsIHR3ZWVuLCBpLCB0YXJnZXQsIHRhcmdldHMpIHsKICByZXR1cm4gX2lzRnVuY3Rpb24odmFsdWUpID8gdmFsdWUuY2FsbCh0d2VlbiwgaSwgdGFyZ2V0LCB0YXJnZXRzKSA6IF9pc1N0cmluZyh2YWx1ZSkgJiYgfnZhbHVlLmluZGV4T2YoInJhbmRvbSgiKSA/IF9yZXBsYWNlUmFuZG9tKHZhbHVlKSA6IHZhbHVlOwp9LAogICAgX3N0YWdnZXJUd2VlblByb3BzID0gX2NhbGxiYWNrTmFtZXMgKyAicmVwZWF0LHJlcGVhdERlbGF5LHlveW8scmVwZWF0UmVmcmVzaCx5b3lvRWFzZSIsCiAgICBfc3RhZ2dlclByb3BzVG9Ta2lwID0ge307CgpfZm9yRWFjaE5hbWUoX3N0YWdnZXJUd2VlblByb3BzICsgIixpZCxzdGFnZ2VyLGRlbGF5LGR1cmF0aW9uLHBhdXNlZCxzY3JvbGxUcmlnZ2VyIiwgZnVuY3Rpb24gKG5hbWUpIHsKICByZXR1cm4gX3N0YWdnZXJQcm9wc1RvU2tpcFtuYW1lXSA9IDE7Cn0pOwovKgogKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogKiBUV0VFTgogKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogKi8KCgpleHBvcnQgdmFyIFR3ZWVuID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQW5pbWF0aW9uMikgewogIF9pbmhlcml0c0xvb3NlKFR3ZWVuLCBfQW5pbWF0aW9uMik7CgogIGZ1bmN0aW9uIFR3ZWVuKHRhcmdldHMsIHZhcnMsIHBvc2l0aW9uLCBza2lwSW5oZXJpdCkgewogICAgdmFyIF90aGlzMzsKCiAgICBpZiAodHlwZW9mIHZhcnMgPT09ICJudW1iZXIiKSB7CiAgICAgIHBvc2l0aW9uLmR1cmF0aW9uID0gdmFyczsKICAgICAgdmFycyA9IHBvc2l0aW9uOwogICAgICBwb3NpdGlvbiA9IG51bGw7CiAgICB9CgogICAgX3RoaXMzID0gX0FuaW1hdGlvbjIuY2FsbCh0aGlzLCBza2lwSW5oZXJpdCA/IHZhcnMgOiBfaW5oZXJpdERlZmF1bHRzKHZhcnMpKSB8fCB0aGlzOwogICAgdmFyIF90aGlzMyR2YXJzID0gX3RoaXMzLnZhcnMsCiAgICAgICAgZHVyYXRpb24gPSBfdGhpczMkdmFycy5kdXJhdGlvbiwKICAgICAgICBkZWxheSA9IF90aGlzMyR2YXJzLmRlbGF5LAogICAgICAgIGltbWVkaWF0ZVJlbmRlciA9IF90aGlzMyR2YXJzLmltbWVkaWF0ZVJlbmRlciwKICAgICAgICBzdGFnZ2VyID0gX3RoaXMzJHZhcnMuc3RhZ2dlciwKICAgICAgICBvdmVyd3JpdGUgPSBfdGhpczMkdmFycy5vdmVyd3JpdGUsCiAgICAgICAga2V5ZnJhbWVzID0gX3RoaXMzJHZhcnMua2V5ZnJhbWVzLAogICAgICAgIGRlZmF1bHRzID0gX3RoaXMzJHZhcnMuZGVmYXVsdHMsCiAgICAgICAgc2Nyb2xsVHJpZ2dlciA9IF90aGlzMyR2YXJzLnNjcm9sbFRyaWdnZXIsCiAgICAgICAgeW95b0Vhc2UgPSBfdGhpczMkdmFycy55b3lvRWFzZSwKICAgICAgICBwYXJlbnQgPSB2YXJzLnBhcmVudCB8fCBfZ2xvYmFsVGltZWxpbmUsCiAgICAgICAgcGFyc2VkVGFyZ2V0cyA9IChfaXNBcnJheSh0YXJnZXRzKSB8fCBfaXNUeXBlZEFycmF5KHRhcmdldHMpID8gX2lzTnVtYmVyKHRhcmdldHNbMF0pIDogImxlbmd0aCIgaW4gdmFycykgPyBbdGFyZ2V0c10gOiB0b0FycmF5KHRhcmdldHMpLAogICAgICAgIHRsLAogICAgICAgIGksCiAgICAgICAgY29weSwKICAgICAgICBsLAogICAgICAgIHAsCiAgICAgICAgY3VyVGFyZ2V0LAogICAgICAgIHN0YWdnZXJGdW5jLAogICAgICAgIHN0YWdnZXJWYXJzVG9NZXJnZTsKICAgIF90aGlzMy5fdGFyZ2V0cyA9IHBhcnNlZFRhcmdldHMubGVuZ3RoID8gX2hhcm5lc3MocGFyc2VkVGFyZ2V0cykgOiBfd2FybigiR1NBUCB0YXJnZXQgIiArIHRhcmdldHMgKyAiIG5vdCBmb3VuZC4gaHR0cHM6Ly9ncmVlbnNvY2suY29tIiwgIV9jb25maWcubnVsbFRhcmdldFdhcm4pIHx8IFtdOwogICAgX3RoaXMzLl9wdExvb2t1cCA9IFtdOyAvL1Byb3BUd2VlbiBsb29rdXAuIEFuIGFycmF5IGNvbnRhaW5pbmcgYW4gb2JqZWN0IGZvciBlYWNoIHRhcmdldCwgaGF2aW5nIGtleXMgZm9yIGVhY2ggdHdlZW5pbmcgcHJvcGVydHkKCiAgICBfdGhpczMuX292ZXJ3cml0ZSA9IG92ZXJ3cml0ZTsKCiAgICBpZiAoa2V5ZnJhbWVzIHx8IHN0YWdnZXIgfHwgX2lzRnVuY09yU3RyaW5nKGR1cmF0aW9uKSB8fCBfaXNGdW5jT3JTdHJpbmcoZGVsYXkpKSB7CiAgICAgIHZhcnMgPSBfdGhpczMudmFyczsKICAgICAgdGwgPSBfdGhpczMudGltZWxpbmUgPSBuZXcgVGltZWxpbmUoewogICAgICAgIGRhdGE6ICJuZXN0ZWQiLAogICAgICAgIGRlZmF1bHRzOiBkZWZhdWx0cyB8fCB7fQogICAgICB9KTsKICAgICAgdGwua2lsbCgpOwogICAgICB0bC5wYXJlbnQgPSB0bC5fZHAgPSBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMyk7CiAgICAgIHRsLl9zdGFydCA9IDA7CgogICAgICBpZiAoc3RhZ2dlciB8fCBfaXNGdW5jT3JTdHJpbmcoZHVyYXRpb24pIHx8IF9pc0Z1bmNPclN0cmluZyhkZWxheSkpIHsKICAgICAgICBsID0gcGFyc2VkVGFyZ2V0cy5sZW5ndGg7CiAgICAgICAgc3RhZ2dlckZ1bmMgPSBzdGFnZ2VyICYmIGRpc3RyaWJ1dGUoc3RhZ2dlcik7CgogICAgICAgIGlmIChfaXNPYmplY3Qoc3RhZ2dlcikpIHsKICAgICAgICAgIC8vdXNlcnMgY2FuIHBhc3MgaW4gY2FsbGJhY2tzIGxpa2Ugb25TdGFydC9vbkNvbXBsZXRlIGluIHRoZSBzdGFnZ2VyIG9iamVjdC4gVGhlc2Ugc2hvdWxkIGZpcmUgd2l0aCBlYWNoIGluZGl2aWR1YWwgdHdlZW4uCiAgICAgICAgICBmb3IgKHAgaW4gc3RhZ2dlcikgewogICAgICAgICAgICBpZiAofl9zdGFnZ2VyVHdlZW5Qcm9wcy5pbmRleE9mKHApKSB7CiAgICAgICAgICAgICAgc3RhZ2dlclZhcnNUb01lcmdlIHx8IChzdGFnZ2VyVmFyc1RvTWVyZ2UgPSB7fSk7CiAgICAgICAgICAgICAgc3RhZ2dlclZhcnNUb01lcmdlW3BdID0gc3RhZ2dlcltwXTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZm9yIChpID0gMDsgaSA8IGw7IGkrKykgewogICAgICAgICAgY29weSA9IF9jb3B5RXhjbHVkaW5nKHZhcnMsIF9zdGFnZ2VyUHJvcHNUb1NraXApOwogICAgICAgICAgY29weS5zdGFnZ2VyID0gMDsKICAgICAgICAgIHlveW9FYXNlICYmIChjb3B5LnlveW9FYXNlID0geW95b0Vhc2UpOwogICAgICAgICAgc3RhZ2dlclZhcnNUb01lcmdlICYmIF9tZXJnZShjb3B5LCBzdGFnZ2VyVmFyc1RvTWVyZ2UpOwogICAgICAgICAgY3VyVGFyZ2V0ID0gcGFyc2VkVGFyZ2V0c1tpXTsgLy9kb24ndCBqdXN0IGNvcHkgZHVyYXRpb24gb3IgZGVsYXkgYmVjYXVzZSBpZiB0aGV5J3JlIGEgc3RyaW5nIG9yIGZ1bmN0aW9uLCB3ZSdkIGVuZCB1cCBpbiBhbiBpbmZpbml0ZSBsb29wIGJlY2F1c2UgX2lzRnVuY09yU3RyaW5nKCkgd291bGQgZXZhbHVhdGUgYXMgdHJ1ZSBpbiB0aGUgY2hpbGQgdHdlZW5zLCBlbnRlcmluZyB0aGlzIGxvb3AsIGV0Yy4gU28gd2UgcGFyc2UgdGhlIHZhbHVlIHN0cmFpZ2h0IGZyb20gdmFycyBhbmQgZGVmYXVsdCB0byAwLgoKICAgICAgICAgIGNvcHkuZHVyYXRpb24gPSArX3BhcnNlRnVuY09yU3RyaW5nKGR1cmF0aW9uLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMyksIGksIGN1clRhcmdldCwgcGFyc2VkVGFyZ2V0cyk7CiAgICAgICAgICBjb3B5LmRlbGF5ID0gKCtfcGFyc2VGdW5jT3JTdHJpbmcoZGVsYXksIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMzKSwgaSwgY3VyVGFyZ2V0LCBwYXJzZWRUYXJnZXRzKSB8fCAwKSAtIF90aGlzMy5fZGVsYXk7CgogICAgICAgICAgaWYgKCFzdGFnZ2VyICYmIGwgPT09IDEgJiYgY29weS5kZWxheSkgewogICAgICAgICAgICAvLyBpZiBzb21lb25lIGRvZXMgZGVsYXk6InJhbmRvbSgxLCA1KSIsIHJlcGVhdDotMSwgZm9yIGV4YW1wbGUsIHRoZSBkZWxheSBzaG91bGRuJ3QgYmUgaW5zaWRlIHRoZSByZXBlYXQuCiAgICAgICAgICAgIF90aGlzMy5fZGVsYXkgPSBkZWxheSA9IGNvcHkuZGVsYXk7CiAgICAgICAgICAgIF90aGlzMy5fc3RhcnQgKz0gZGVsYXk7CiAgICAgICAgICAgIGNvcHkuZGVsYXkgPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIHRsLnRvKGN1clRhcmdldCwgY29weSwgc3RhZ2dlckZ1bmMgPyBzdGFnZ2VyRnVuYyhpLCBjdXJUYXJnZXQsIHBhcnNlZFRhcmdldHMpIDogMCk7CiAgICAgICAgICB0bC5fZWFzZSA9IF9lYXNlTWFwLm5vbmU7CiAgICAgICAgfQoKICAgICAgICB0bC5kdXJhdGlvbigpID8gZHVyYXRpb24gPSBkZWxheSA9IDAgOiBfdGhpczMudGltZWxpbmUgPSAwOyAvLyBpZiB0aGUgdGltZWxpbmUncyBkdXJhdGlvbiBpcyAwLCB3ZSBkb24ndCBuZWVkIGEgdGltZWxpbmUgaW50ZXJuYWxseSEKICAgICAgfSBlbHNlIGlmIChrZXlmcmFtZXMpIHsKICAgICAgICBfaW5oZXJpdERlZmF1bHRzKF9zZXREZWZhdWx0cyh0bC52YXJzLmRlZmF1bHRzLCB7CiAgICAgICAgICBlYXNlOiAibm9uZSIKICAgICAgICB9KSk7CgogICAgICAgIHRsLl9lYXNlID0gX3BhcnNlRWFzZShrZXlmcmFtZXMuZWFzZSB8fCB2YXJzLmVhc2UgfHwgIm5vbmUiKTsKICAgICAgICB2YXIgdGltZSA9IDAsCiAgICAgICAgICAgIGEsCiAgICAgICAgICAgIGtmLAogICAgICAgICAgICB2OwoKICAgICAgICBpZiAoX2lzQXJyYXkoa2V5ZnJhbWVzKSkgewogICAgICAgICAga2V5ZnJhbWVzLmZvckVhY2goZnVuY3Rpb24gKGZyYW1lKSB7CiAgICAgICAgICAgIHJldHVybiB0bC50byhwYXJzZWRUYXJnZXRzLCBmcmFtZSwgIj4iKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb3B5ID0ge307CgogICAgICAgICAgZm9yIChwIGluIGtleWZyYW1lcykgewogICAgICAgICAgICBwID09PSAiZWFzZSIgfHwgcCA9PT0gImVhc2VFYWNoIiB8fCBfcGFyc2VLZXlmcmFtZShwLCBrZXlmcmFtZXNbcF0sIGNvcHksIGtleWZyYW1lcy5lYXNlRWFjaCk7CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChwIGluIGNvcHkpIHsKICAgICAgICAgICAgYSA9IGNvcHlbcF0uc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgIHJldHVybiBhLnQgLSBiLnQ7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aW1lID0gMDsKCiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAga2YgPSBhW2ldOwogICAgICAgICAgICAgIHYgPSB7CiAgICAgICAgICAgICAgICBlYXNlOiBrZi5lLAogICAgICAgICAgICAgICAgZHVyYXRpb246IChrZi50IC0gKGkgPyBhW2kgLSAxXS50IDogMCkpIC8gMTAwICogZHVyYXRpb24KICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIHZbcF0gPSBrZi52OwogICAgICAgICAgICAgIHRsLnRvKHBhcnNlZFRhcmdldHMsIHYsIHRpbWUpOwogICAgICAgICAgICAgIHRpbWUgKz0gdi5kdXJhdGlvbjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRsLmR1cmF0aW9uKCkgPCBkdXJhdGlvbiAmJiB0bC50byh7fSwgewogICAgICAgICAgICBkdXJhdGlvbjogZHVyYXRpb24gLSB0bC5kdXJhdGlvbigpCiAgICAgICAgICB9KTsgLy8gaW4gY2FzZSBrZXlmcmFtZXMgZGlkbid0IGdvIHRvIDEwMCUKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGR1cmF0aW9uIHx8IF90aGlzMy5kdXJhdGlvbihkdXJhdGlvbiA9IHRsLmR1cmF0aW9uKCkpOwogICAgfSBlbHNlIHsKICAgICAgX3RoaXMzLnRpbWVsaW5lID0gMDsgLy9zcGVlZCBvcHRpbWl6YXRpb24sIGZhc3RlciBsb29rdXBzIChubyBnb2luZyB1cCB0aGUgcHJvdG90eXBlIGNoYWluKQogICAgfQoKICAgIGlmIChvdmVyd3JpdGUgPT09IHRydWUgJiYgIV9zdXBwcmVzc092ZXJ3cml0ZXMpIHsKICAgICAgX292ZXJ3cml0aW5nVHdlZW4gPSBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMyk7CgogICAgICBfZ2xvYmFsVGltZWxpbmUua2lsbFR3ZWVuc09mKHBhcnNlZFRhcmdldHMpOwoKICAgICAgX292ZXJ3cml0aW5nVHdlZW4gPSAwOwogICAgfQoKICAgIF9hZGRUb1RpbWVsaW5lKHBhcmVudCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczMpLCBwb3NpdGlvbik7CgogICAgdmFycy5yZXZlcnNlZCAmJiBfdGhpczMucmV2ZXJzZSgpOwogICAgdmFycy5wYXVzZWQgJiYgX3RoaXMzLnBhdXNlZCh0cnVlKTsKCiAgICBpZiAoaW1tZWRpYXRlUmVuZGVyIHx8ICFkdXJhdGlvbiAmJiAha2V5ZnJhbWVzICYmIF90aGlzMy5fc3RhcnQgPT09IF9yb3VuZFByZWNpc2UocGFyZW50Ll90aW1lKSAmJiBfaXNOb3RGYWxzZShpbW1lZGlhdGVSZW5kZXIpICYmIF9oYXNOb1BhdXNlZEFuY2VzdG9ycyhfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMykpICYmIHBhcmVudC5kYXRhICE9PSAibmVzdGVkIikgewogICAgICBfdGhpczMuX3RUaW1lID0gLV90aW55TnVtOyAvL2ZvcmNlcyBhIHJlbmRlciB3aXRob3V0IGhhdmluZyB0byBzZXQgdGhlIHJlbmRlcigpICJmb3JjZSIgcGFyYW1ldGVyIHRvIHRydWUgYmVjYXVzZSB3ZSB3YW50IHRvIGFsbG93IGxhenlpbmcgYnkgZGVmYXVsdCAodXNpbmcgdGhlICJmb3JjZSIgcGFyYW1ldGVyIGFsd2F5cyBmb3JjZXMgYW4gaW1tZWRpYXRlIGZ1bGwgcmVuZGVyKQoKICAgICAgX3RoaXMzLnJlbmRlcihNYXRoLm1heCgwLCAtZGVsYXkpKTsgLy9pbiBjYXNlIGRlbGF5IGlzIG5lZ2F0aXZlCgogICAgfQoKICAgIHNjcm9sbFRyaWdnZXIgJiYgX3Njcm9sbFRyaWdnZXIoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczMpLCBzY3JvbGxUcmlnZ2VyKTsKICAgIHJldHVybiBfdGhpczM7CiAgfQoKICB2YXIgX3Byb3RvMyA9IFR3ZWVuLnByb3RvdHlwZTsKCiAgX3Byb3RvMy5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIodG90YWxUaW1lLCBzdXBwcmVzc0V2ZW50cywgZm9yY2UpIHsKICAgIHZhciBwcmV2VGltZSA9IHRoaXMuX3RpbWUsCiAgICAgICAgdER1ciA9IHRoaXMuX3REdXIsCiAgICAgICAgZHVyID0gdGhpcy5fZHVyLAogICAgICAgIHRUaW1lID0gdG90YWxUaW1lID4gdER1ciAtIF90aW55TnVtICYmIHRvdGFsVGltZSA+PSAwID8gdER1ciA6IHRvdGFsVGltZSA8IF90aW55TnVtID8gMCA6IHRvdGFsVGltZSwKICAgICAgICB0aW1lLAogICAgICAgIHB0LAogICAgICAgIGl0ZXJhdGlvbiwKICAgICAgICBjeWNsZUR1cmF0aW9uLAogICAgICAgIHByZXZJdGVyYXRpb24sCiAgICAgICAgaXNZb3lvLAogICAgICAgIHJhdGlvLAogICAgICAgIHRpbWVsaW5lLAogICAgICAgIHlveW9FYXNlOwoKICAgIGlmICghZHVyKSB7CiAgICAgIF9yZW5kZXJaZXJvRHVyYXRpb25Ud2Vlbih0aGlzLCB0b3RhbFRpbWUsIHN1cHByZXNzRXZlbnRzLCBmb3JjZSk7CiAgICB9IGVsc2UgaWYgKHRUaW1lICE9PSB0aGlzLl90VGltZSB8fCAhdG90YWxUaW1lIHx8IGZvcmNlIHx8ICF0aGlzLl9pbml0dGVkICYmIHRoaXMuX3RUaW1lIHx8IHRoaXMuX3N0YXJ0QXQgJiYgdGhpcy5felRpbWUgPCAwICE9PSB0b3RhbFRpbWUgPCAwKSB7CiAgICAgIC8vdGhpcyBzZW5zZXMgaWYgd2UncmUgY3Jvc3Npbmcgb3ZlciB0aGUgc3RhcnQgdGltZSwgaW4gd2hpY2ggY2FzZSB3ZSBtdXN0IHJlY29yZCBfelRpbWUgYW5kIGZvcmNlIHRoZSByZW5kZXIsIGJ1dCB3ZSBkbyBpdCBpbiB0aGlzIGxlbmd0aHkgY29uZGl0aW9uYWwgd2F5IGZvciBwZXJmb3JtYW5jZSByZWFzb25zICh1c3VhbGx5IHdlIGNhbiBza2lwIHRoZSBjYWxjdWxhdGlvbnMpOiB0aGlzLl9pbml0dGVkICYmICh0aGlzLl96VGltZSA8IDApICE9PSAodG90YWxUaW1lIDwgMCkKICAgICAgdGltZSA9IHRUaW1lOwogICAgICB0aW1lbGluZSA9IHRoaXMudGltZWxpbmU7CgogICAgICBpZiAodGhpcy5fcmVwZWF0KSB7CiAgICAgICAgLy9hZGp1c3QgdGhlIHRpbWUgZm9yIHJlcGVhdHMgYW5kIHlveW9zCiAgICAgICAgY3ljbGVEdXJhdGlvbiA9IGR1ciArIHRoaXMuX3JEZWxheTsKCiAgICAgICAgaWYgKHRoaXMuX3JlcGVhdCA8IC0xICYmIHRvdGFsVGltZSA8IDApIHsKICAgICAgICAgIHJldHVybiB0aGlzLnRvdGFsVGltZShjeWNsZUR1cmF0aW9uICogMTAwICsgdG90YWxUaW1lLCBzdXBwcmVzc0V2ZW50cywgZm9yY2UpOwogICAgICAgIH0KCiAgICAgICAgdGltZSA9IF9yb3VuZFByZWNpc2UodFRpbWUgJSBjeWNsZUR1cmF0aW9uKTsgLy9yb3VuZCB0byBhdm9pZCBmbG9hdGluZyBwb2ludCBlcnJvcnMuICg0ICUgMC44IHNob3VsZCBiZSAwIGJ1dCBzb21lIGJyb3dzZXJzIHJlcG9ydCBpdCBhcyAwLjc5OTk5OTk5ISkKCiAgICAgICAgaWYgKHRUaW1lID09PSB0RHVyKSB7CiAgICAgICAgICAvLyB0aGUgdER1ciA9PT0gdFRpbWUgaXMgZm9yIGVkZ2UgY2FzZXMgd2hlcmUgdGhlcmUncyBhIGxlbmd0aHkgZGVjaW1hbCBvbiB0aGUgZHVyYXRpb24gYW5kIGl0IG1heSByZWFjaCB0aGUgdmVyeSBlbmQgYnV0IHRoZSB0aW1lIGlzIHJlbmRlcmVkIGFzIG5vdC1xdWl0ZS10aGVyZSAocmVtZW1iZXIsIHREdXIgaXMgcm91bmRlZCB0byA0IGRlY2ltYWxzIHdoZXJlYXMgZHVyIGlzbid0KQogICAgICAgICAgaXRlcmF0aW9uID0gdGhpcy5fcmVwZWF0OwogICAgICAgICAgdGltZSA9IGR1cjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaXRlcmF0aW9uID0gfn4odFRpbWUgLyBjeWNsZUR1cmF0aW9uKTsKCiAgICAgICAgICBpZiAoaXRlcmF0aW9uICYmIGl0ZXJhdGlvbiA9PT0gdFRpbWUgLyBjeWNsZUR1cmF0aW9uKSB7CiAgICAgICAgICAgIHRpbWUgPSBkdXI7CiAgICAgICAgICAgIGl0ZXJhdGlvbi0tOwogICAgICAgICAgfQoKICAgICAgICAgIHRpbWUgPiBkdXIgJiYgKHRpbWUgPSBkdXIpOwogICAgICAgIH0KCiAgICAgICAgaXNZb3lvID0gdGhpcy5feW95byAmJiBpdGVyYXRpb24gJiAxOwoKICAgICAgICBpZiAoaXNZb3lvKSB7CiAgICAgICAgICB5b3lvRWFzZSA9IHRoaXMuX3lFYXNlOwogICAgICAgICAgdGltZSA9IGR1ciAtIHRpbWU7CiAgICAgICAgfQoKICAgICAgICBwcmV2SXRlcmF0aW9uID0gX2FuaW1hdGlvbkN5Y2xlKHRoaXMuX3RUaW1lLCBjeWNsZUR1cmF0aW9uKTsKCiAgICAgICAgaWYgKHRpbWUgPT09IHByZXZUaW1lICYmICFmb3JjZSAmJiB0aGlzLl9pbml0dGVkKSB7CiAgICAgICAgICAvL2NvdWxkIGJlIGR1cmluZyB0aGUgcmVwZWF0RGVsYXkgcGFydC4gTm8gbmVlZCB0byByZW5kZXIgYW5kIGZpcmUgY2FsbGJhY2tzLgogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQoKICAgICAgICBpZiAoaXRlcmF0aW9uICE9PSBwcmV2SXRlcmF0aW9uKSB7CiAgICAgICAgICB0aW1lbGluZSAmJiB0aGlzLl95RWFzZSAmJiBfcHJvcGFnYXRlWW95b0Vhc2UodGltZWxpbmUsIGlzWW95byk7IC8vcmVwZWF0UmVmcmVzaCBmdW5jdGlvbmFsaXR5CgogICAgICAgICAgaWYgKHRoaXMudmFycy5yZXBlYXRSZWZyZXNoICYmICFpc1lveW8gJiYgIXRoaXMuX2xvY2spIHsKICAgICAgICAgICAgdGhpcy5fbG9jayA9IGZvcmNlID0gMTsgLy9mb3JjZSwgb3RoZXJ3aXNlIGlmIGxhenkgaXMgdHJ1ZSwgdGhlIF9hdHRlbXB0SW5pdFR3ZWVuKCkgd2lsbCByZXR1cm4gYW5kIHdlJ2xsIGp1bXAgb3V0IGFuZCBnZXQgY2F1Z2h0IGJvdW5jaW5nIG9uIGVhY2ggdGljay4KCiAgICAgICAgICAgIHRoaXMucmVuZGVyKF9yb3VuZFByZWNpc2UoY3ljbGVEdXJhdGlvbiAqIGl0ZXJhdGlvbiksIHRydWUpLmludmFsaWRhdGUoKS5fbG9jayA9IDA7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRoaXMuX2luaXR0ZWQpIHsKICAgICAgICBpZiAoX2F0dGVtcHRJbml0VHdlZW4odGhpcywgdG90YWxUaW1lIDwgMCA/IHRvdGFsVGltZSA6IHRpbWUsIGZvcmNlLCBzdXBwcmVzc0V2ZW50cykpIHsKICAgICAgICAgIHRoaXMuX3RUaW1lID0gMDsgLy8gaW4gY29uc3RydWN0b3IgaWYgaW1tZWRpYXRlUmVuZGVyIGlzIHRydWUsIHdlIHNldCBfdFRpbWUgdG8gLV90aW55TnVtIHRvIGhhdmUgdGhlIHBsYXloZWFkIGNyb3NzIHRoZSBzdGFydGluZyBwb2ludCBidXQgd2UgY2FuJ3QgbGVhdmUgX3RUaW1lIGFzIGEgbmVnYXRpdmUgbnVtYmVyLgoKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAgICAgICAgaWYgKGR1ciAhPT0gdGhpcy5fZHVyKSB7CiAgICAgICAgICAvLyB3aGlsZSBpbml0dGluZywgYSBwbHVnaW4gbGlrZSBJbmVydGlhUGx1Z2luIG1pZ2h0IGFsdGVyIHRoZSBkdXJhdGlvbiwgc28gcmVydW4gZnJvbSB0aGUgc3RhcnQgdG8gZW5zdXJlIGV2ZXJ5dGhpbmcgcmVuZGVycyBhcyBpdCBzaG91bGQuCiAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXIodG90YWxUaW1lLCBzdXBwcmVzc0V2ZW50cywgZm9yY2UpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fdFRpbWUgPSB0VGltZTsKICAgICAgdGhpcy5fdGltZSA9IHRpbWU7CgogICAgICBpZiAoIXRoaXMuX2FjdCAmJiB0aGlzLl90cykgewogICAgICAgIHRoaXMuX2FjdCA9IDE7IC8vYXMgbG9uZyBhcyBpdCdzIG5vdCBwYXVzZWQsIGZvcmNlIGl0IHRvIGJlIGFjdGl2ZSBzbyB0aGF0IGlmIHRoZSB1c2VyIHJlbmRlcnMgaW5kZXBlbmRlbnQgb2YgdGhlIHBhcmVudCB0aW1lbGluZSwgaXQnbGwgYmUgZm9yY2VkIHRvIHJlLXJlbmRlciBvbiB0aGUgbmV4dCB0aWNrLgoKICAgICAgICB0aGlzLl9sYXp5ID0gMDsKICAgICAgfQoKICAgICAgdGhpcy5yYXRpbyA9IHJhdGlvID0gKHlveW9FYXNlIHx8IHRoaXMuX2Vhc2UpKHRpbWUgLyBkdXIpOwoKICAgICAgaWYgKHRoaXMuX2Zyb20pIHsKICAgICAgICB0aGlzLnJhdGlvID0gcmF0aW8gPSAxIC0gcmF0aW87CiAgICAgIH0KCiAgICAgIGlmICh0aW1lICYmICFwcmV2VGltZSAmJiAhc3VwcHJlc3NFdmVudHMpIHsKICAgICAgICBfY2FsbGJhY2sodGhpcywgIm9uU3RhcnQiKTsKCiAgICAgICAgaWYgKHRoaXMuX3RUaW1lICE9PSB0VGltZSkgewogICAgICAgICAgLy8gaW4gY2FzZSB0aGUgb25TdGFydCB0cmlnZ2VyZWQgYSByZW5kZXIgYXQgYSBkaWZmZXJlbnQgc3BvdCwgZWplY3QuIExpa2UgaWYgc29tZW9uZSBkaWQgYW5pbWF0aW9uLnBhdXNlKDAuNSkgb3Igc29tZXRoaW5nIGluc2lkZSB0aGUgb25TdGFydC4KICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcHQgPSB0aGlzLl9wdDsKCiAgICAgIHdoaWxlIChwdCkgewogICAgICAgIHB0LnIocmF0aW8sIHB0LmQpOwogICAgICAgIHB0ID0gcHQuX25leHQ7CiAgICAgIH0KCiAgICAgIHRpbWVsaW5lICYmIHRpbWVsaW5lLnJlbmRlcih0b3RhbFRpbWUgPCAwID8gdG90YWxUaW1lIDogIXRpbWUgJiYgaXNZb3lvID8gLV90aW55TnVtIDogdGltZWxpbmUuX2R1ciAqIHRpbWVsaW5lLl9lYXNlKHRpbWUgLyB0aGlzLl9kdXIpLCBzdXBwcmVzc0V2ZW50cywgZm9yY2UpIHx8IHRoaXMuX3N0YXJ0QXQgJiYgKHRoaXMuX3pUaW1lID0gdG90YWxUaW1lKTsKCiAgICAgIGlmICh0aGlzLl9vblVwZGF0ZSAmJiAhc3VwcHJlc3NFdmVudHMpIHsKICAgICAgICB0b3RhbFRpbWUgPCAwICYmIHRoaXMuX3N0YXJ0QXQgJiYgdGhpcy5fc3RhcnRBdC5yZW5kZXIodG90YWxUaW1lLCB0cnVlLCBmb3JjZSk7IC8vbm90ZTogZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMsIHdlIHR1Y2sgdGhpcyBjb25kaXRpb25hbCBsb2dpYyBpbnNpZGUgbGVzcyB0cmF2ZWxlZCBhcmVhcyAobW9zdCB0d2VlbnMgZG9uJ3QgaGF2ZSBhbiBvblVwZGF0ZSkuIFdlJ2QganVzdCBoYXZlIGl0IGF0IHRoZSBlbmQgYmVmb3JlIHRoZSBvbkNvbXBsZXRlLCBidXQgdGhlIHZhbHVlcyBzaG91bGQgYmUgdXBkYXRlZCBiZWZvcmUgYW55IG9uVXBkYXRlIGlzIGNhbGxlZCwgc28gd2UgQUxTTyBwdXQgaXQgaGVyZSBhbmQgdGhlbiBpZiBpdCdzIG5vdCBjYWxsZWQsIHdlIGRvIHNvIGxhdGVyIG5lYXIgdGhlIG9uQ29tcGxldGUuCgogICAgICAgIF9jYWxsYmFjayh0aGlzLCAib25VcGRhdGUiKTsKICAgICAgfQoKICAgICAgdGhpcy5fcmVwZWF0ICYmIGl0ZXJhdGlvbiAhPT0gcHJldkl0ZXJhdGlvbiAmJiB0aGlzLnZhcnMub25SZXBlYXQgJiYgIXN1cHByZXNzRXZlbnRzICYmIHRoaXMucGFyZW50ICYmIF9jYWxsYmFjayh0aGlzLCAib25SZXBlYXQiKTsKCiAgICAgIGlmICgodFRpbWUgPT09IHRoaXMuX3REdXIgfHwgIXRUaW1lKSAmJiB0aGlzLl90VGltZSA9PT0gdFRpbWUpIHsKICAgICAgICB0b3RhbFRpbWUgPCAwICYmIHRoaXMuX3N0YXJ0QXQgJiYgIXRoaXMuX29uVXBkYXRlICYmIHRoaXMuX3N0YXJ0QXQucmVuZGVyKHRvdGFsVGltZSwgdHJ1ZSwgdHJ1ZSk7CiAgICAgICAgKHRvdGFsVGltZSB8fCAhZHVyKSAmJiAodFRpbWUgPT09IHRoaXMuX3REdXIgJiYgdGhpcy5fdHMgPiAwIHx8ICF0VGltZSAmJiB0aGlzLl90cyA8IDApICYmIF9yZW1vdmVGcm9tUGFyZW50KHRoaXMsIDEpOyAvLyBkb24ndCByZW1vdmUgaWYgd2UncmUgcmVuZGVyaW5nIGF0IGV4YWN0bHkgYSB0aW1lIG9mIDAsIGFzIHRoZXJlIGNvdWxkIGJlIGF1dG9SZXZlcnQgdmFsdWVzIHRoYXQgc2hvdWxkIGdldCBzZXQgb24gdGhlIG5leHQgdGljayAoaWYgdGhlIHBsYXloZWFkIGdvZXMgYmFja3dhcmQgYmV5b25kIHRoZSBzdGFydFRpbWUsIG5lZ2F0aXZlIHRvdGFsVGltZSkuIERvbid0IHJlbW92ZSBpZiB0aGUgdGltZWxpbmUgaXMgcmV2ZXJzZWQgYW5kIHRoZSBwbGF5aGVhZCBpc24ndCBhdCAwLCBvdGhlcndpc2UgdGwucHJvZ3Jlc3MoMSkucmV2ZXJzZSgpIHdvbid0IHdvcmsuIE9ubHkgcmVtb3ZlIGlmIHRoZSBwbGF5aGVhZCBpcyBhdCB0aGUgZW5kIGFuZCB0aW1lU2NhbGUgaXMgcG9zaXRpdmUsIG9yIGlmIHRoZSBwbGF5aGVhZCBpcyBhdCAwIGFuZCB0aGUgdGltZVNjYWxlIGlzIG5lZ2F0aXZlLgoKICAgICAgICBpZiAoIXN1cHByZXNzRXZlbnRzICYmICEodG90YWxUaW1lIDwgMCAmJiAhcHJldlRpbWUpICYmICh0VGltZSB8fCBwcmV2VGltZSkpIHsKICAgICAgICAgIC8vIGlmIHByZXZUaW1lIGFuZCB0VGltZSBhcmUgemVybywgd2Ugc2hvdWxkbid0IGZpcmUgdGhlIG9uUmV2ZXJzZUNvbXBsZXRlLiBUaGlzIGNvdWxkIGhhcHBlbiBpZiB5b3UgZ3NhcC50byguLi4ge3BhdXNlZDp0cnVlfSkucGxheSgpOwogICAgICAgICAgX2NhbGxiYWNrKHRoaXMsIHRUaW1lID09PSB0RHVyID8gIm9uQ29tcGxldGUiIDogIm9uUmV2ZXJzZUNvbXBsZXRlIiwgdHJ1ZSk7CgogICAgICAgICAgdGhpcy5fcHJvbSAmJiAhKHRUaW1lIDwgdER1ciAmJiB0aGlzLnRpbWVTY2FsZSgpID4gMCkgJiYgdGhpcy5fcHJvbSgpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH07CgogIF9wcm90bzMudGFyZ2V0cyA9IGZ1bmN0aW9uIHRhcmdldHMoKSB7CiAgICByZXR1cm4gdGhpcy5fdGFyZ2V0czsKICB9OwoKICBfcHJvdG8zLmludmFsaWRhdGUgPSBmdW5jdGlvbiBpbnZhbGlkYXRlKCkgewogICAgdGhpcy5fcHQgPSB0aGlzLl9vcCA9IHRoaXMuX3N0YXJ0QXQgPSB0aGlzLl9vblVwZGF0ZSA9IHRoaXMuX2xhenkgPSB0aGlzLnJhdGlvID0gMDsKICAgIHRoaXMuX3B0TG9va3VwID0gW107CiAgICB0aGlzLnRpbWVsaW5lICYmIHRoaXMudGltZWxpbmUuaW52YWxpZGF0ZSgpOwogICAgcmV0dXJuIF9BbmltYXRpb24yLnByb3RvdHlwZS5pbnZhbGlkYXRlLmNhbGwodGhpcyk7CiAgfTsKCiAgX3Byb3RvMy5raWxsID0gZnVuY3Rpb24ga2lsbCh0YXJnZXRzLCB2YXJzKSB7CiAgICBpZiAodmFycyA9PT0gdm9pZCAwKSB7CiAgICAgIHZhcnMgPSAiYWxsIjsKICAgIH0KCiAgICBpZiAoIXRhcmdldHMgJiYgKCF2YXJzIHx8IHZhcnMgPT09ICJhbGwiKSkgewogICAgICB0aGlzLl9sYXp5ID0gdGhpcy5fcHQgPSAwOwogICAgICByZXR1cm4gdGhpcy5wYXJlbnQgPyBfaW50ZXJydXB0KHRoaXMpIDogdGhpczsKICAgIH0KCiAgICBpZiAodGhpcy50aW1lbGluZSkgewogICAgICB2YXIgdER1ciA9IHRoaXMudGltZWxpbmUudG90YWxEdXJhdGlvbigpOwogICAgICB0aGlzLnRpbWVsaW5lLmtpbGxUd2VlbnNPZih0YXJnZXRzLCB2YXJzLCBfb3ZlcndyaXRpbmdUd2VlbiAmJiBfb3ZlcndyaXRpbmdUd2Vlbi52YXJzLm92ZXJ3cml0ZSAhPT0gdHJ1ZSkuX2ZpcnN0IHx8IF9pbnRlcnJ1cHQodGhpcyk7IC8vIGlmIG5vdGhpbmcgaXMgbGVmdCB0d2VlbmluZywgaW50ZXJydXB0LgoKICAgICAgdGhpcy5wYXJlbnQgJiYgdER1ciAhPT0gdGhpcy50aW1lbGluZS50b3RhbER1cmF0aW9uKCkgJiYgX3NldER1cmF0aW9uKHRoaXMsIHRoaXMuX2R1ciAqIHRoaXMudGltZWxpbmUuX3REdXIgLyB0RHVyLCAwLCAxKTsgLy8gaWYgYSBuZXN0ZWQgdHdlZW4gaXMga2lsbGVkIHRoYXQgY2hhbmdlcyB0aGUgZHVyYXRpb24sIGl0IHNob3VsZCBhZmZlY3QgdGhpcyB0d2VlbidzIGR1cmF0aW9uLiBXZSBtdXN0IHVzZSB0aGUgcmF0aW8sIHRob3VnaCwgYmVjYXVzZSBzb21ldGltZXMgdGhlIGludGVybmFsIHRpbWVsaW5lIGlzIHN0cmV0Y2hlZCBsaWtlIGZvciBrZXlmcmFtZXMgd2hlcmUgdGhleSBkb24ndCBhbGwgYWRkIHVwIHRvIHdoYXRldmVyIHRoZSBwYXJlbnQgdHdlZW4ncyBkdXJhdGlvbiB3YXMgc2V0IHRvLgoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgdmFyIHBhcnNlZFRhcmdldHMgPSB0aGlzLl90YXJnZXRzLAogICAgICAgIGtpbGxpbmdUYXJnZXRzID0gdGFyZ2V0cyA/IHRvQXJyYXkodGFyZ2V0cykgOiBwYXJzZWRUYXJnZXRzLAogICAgICAgIHByb3BUd2Vlbkxvb2t1cCA9IHRoaXMuX3B0TG9va3VwLAogICAgICAgIGZpcnN0UFQgPSB0aGlzLl9wdCwKICAgICAgICBvdmVyd3JpdHRlblByb3BzLAogICAgICAgIGN1ckxvb2t1cCwKICAgICAgICBjdXJPdmVyd3JpdGVQcm9wcywKICAgICAgICBwcm9wcywKICAgICAgICBwLAogICAgICAgIHB0LAogICAgICAgIGk7CgogICAgaWYgKCghdmFycyB8fCB2YXJzID09PSAiYWxsIikgJiYgX2FycmF5c01hdGNoKHBhcnNlZFRhcmdldHMsIGtpbGxpbmdUYXJnZXRzKSkgewogICAgICB2YXJzID09PSAiYWxsIiAmJiAodGhpcy5fcHQgPSAwKTsKICAgICAgcmV0dXJuIF9pbnRlcnJ1cHQodGhpcyk7CiAgICB9CgogICAgb3ZlcndyaXR0ZW5Qcm9wcyA9IHRoaXMuX29wID0gdGhpcy5fb3AgfHwgW107CgogICAgaWYgKHZhcnMgIT09ICJhbGwiKSB7CiAgICAgIC8vc28gcGVvcGxlIGNhbiBwYXNzIGluIGEgY29tbWEtZGVsaW1pdGVkIGxpc3Qgb2YgcHJvcGVydHkgbmFtZXMKICAgICAgaWYgKF9pc1N0cmluZyh2YXJzKSkgewogICAgICAgIHAgPSB7fTsKCiAgICAgICAgX2ZvckVhY2hOYW1lKHZhcnMsIGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgICByZXR1cm4gcFtuYW1lXSA9IDE7CiAgICAgICAgfSk7CgogICAgICAgIHZhcnMgPSBwOwogICAgICB9CgogICAgICB2YXJzID0gX2FkZEFsaWFzZXNUb1ZhcnMocGFyc2VkVGFyZ2V0cywgdmFycyk7CiAgICB9CgogICAgaSA9IHBhcnNlZFRhcmdldHMubGVuZ3RoOwoKICAgIHdoaWxlIChpLS0pIHsKICAgICAgaWYgKH5raWxsaW5nVGFyZ2V0cy5pbmRleE9mKHBhcnNlZFRhcmdldHNbaV0pKSB7CiAgICAgICAgY3VyTG9va3VwID0gcHJvcFR3ZWVuTG9va3VwW2ldOwoKICAgICAgICBpZiAodmFycyA9PT0gImFsbCIpIHsKICAgICAgICAgIG92ZXJ3cml0dGVuUHJvcHNbaV0gPSB2YXJzOwogICAgICAgICAgcHJvcHMgPSBjdXJMb29rdXA7CiAgICAgICAgICBjdXJPdmVyd3JpdGVQcm9wcyA9IHt9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXJPdmVyd3JpdGVQcm9wcyA9IG92ZXJ3cml0dGVuUHJvcHNbaV0gPSBvdmVyd3JpdHRlblByb3BzW2ldIHx8IHt9OwogICAgICAgICAgcHJvcHMgPSB2YXJzOwogICAgICAgIH0KCiAgICAgICAgZm9yIChwIGluIHByb3BzKSB7CiAgICAgICAgICBwdCA9IGN1ckxvb2t1cCAmJiBjdXJMb29rdXBbcF07CgogICAgICAgICAgaWYgKHB0KSB7CiAgICAgICAgICAgIGlmICghKCJraWxsIiBpbiBwdC5kKSB8fCBwdC5kLmtpbGwocCkgPT09IHRydWUpIHsKICAgICAgICAgICAgICBfcmVtb3ZlTGlua2VkTGlzdEl0ZW0odGhpcywgcHQsICJfcHQiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGVsZXRlIGN1ckxvb2t1cFtwXTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY3VyT3ZlcndyaXRlUHJvcHMgIT09ICJhbGwiKSB7CiAgICAgICAgICAgIGN1ck92ZXJ3cml0ZVByb3BzW3BdID0gMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLl9pbml0dGVkICYmICF0aGlzLl9wdCAmJiBmaXJzdFBUICYmIF9pbnRlcnJ1cHQodGhpcyk7IC8vaWYgYWxsIHR3ZWVuaW5nIHByb3BlcnRpZXMgYXJlIGtpbGxlZCwga2lsbCB0aGUgdHdlZW4uIFdpdGhvdXQgdGhpcyBsaW5lLCBpZiB0aGVyZSdzIGEgdHdlZW4gd2l0aCBtdWx0aXBsZSB0YXJnZXRzIGFuZCB0aGVuIHlvdSBraWxsVHdlZW5zT2YoKSBlYWNoIHRhcmdldCBpbmRpdmlkdWFsbHksIHRoZSB0d2VlbiB3b3VsZCB0ZWNobmljYWxseSBzdGlsbCByZW1haW4gYWN0aXZlIGFuZCBmaXJlIGl0cyBvbkNvbXBsZXRlIGV2ZW4gdGhvdWdoIHRoZXJlIGFyZW4ndCBhbnkgbW9yZSBwcm9wZXJ0aWVzIHR3ZWVuaW5nLgoKICAgIHJldHVybiB0aGlzOwogIH07CgogIFR3ZWVuLnRvID0gZnVuY3Rpb24gdG8odGFyZ2V0cywgdmFycykgewogICAgcmV0dXJuIG5ldyBUd2Vlbih0YXJnZXRzLCB2YXJzLCBhcmd1bWVudHNbMl0pOwogIH07CgogIFR3ZWVuLmZyb20gPSBmdW5jdGlvbiBmcm9tKHRhcmdldHMsIHZhcnMpIHsKICAgIHJldHVybiBfY3JlYXRlVHdlZW5UeXBlKDEsIGFyZ3VtZW50cyk7CiAgfTsKCiAgVHdlZW4uZGVsYXllZENhbGwgPSBmdW5jdGlvbiBkZWxheWVkQ2FsbChkZWxheSwgY2FsbGJhY2ssIHBhcmFtcywgc2NvcGUpIHsKICAgIHJldHVybiBuZXcgVHdlZW4oY2FsbGJhY2ssIDAsIHsKICAgICAgaW1tZWRpYXRlUmVuZGVyOiBmYWxzZSwKICAgICAgbGF6eTogZmFsc2UsCiAgICAgIG92ZXJ3cml0ZTogZmFsc2UsCiAgICAgIGRlbGF5OiBkZWxheSwKICAgICAgb25Db21wbGV0ZTogY2FsbGJhY2ssCiAgICAgIG9uUmV2ZXJzZUNvbXBsZXRlOiBjYWxsYmFjaywKICAgICAgb25Db21wbGV0ZVBhcmFtczogcGFyYW1zLAogICAgICBvblJldmVyc2VDb21wbGV0ZVBhcmFtczogcGFyYW1zLAogICAgICBjYWxsYmFja1Njb3BlOiBzY29wZQogICAgfSk7CiAgfTsKCiAgVHdlZW4uZnJvbVRvID0gZnVuY3Rpb24gZnJvbVRvKHRhcmdldHMsIGZyb21WYXJzLCB0b1ZhcnMpIHsKICAgIHJldHVybiBfY3JlYXRlVHdlZW5UeXBlKDIsIGFyZ3VtZW50cyk7CiAgfTsKCiAgVHdlZW4uc2V0ID0gZnVuY3Rpb24gc2V0KHRhcmdldHMsIHZhcnMpIHsKICAgIHZhcnMuZHVyYXRpb24gPSAwOwogICAgdmFycy5yZXBlYXREZWxheSB8fCAodmFycy5yZXBlYXQgPSAwKTsKICAgIHJldHVybiBuZXcgVHdlZW4odGFyZ2V0cywgdmFycyk7CiAgfTsKCiAgVHdlZW4ua2lsbFR3ZWVuc09mID0gZnVuY3Rpb24ga2lsbFR3ZWVuc09mKHRhcmdldHMsIHByb3BzLCBvbmx5QWN0aXZlKSB7CiAgICByZXR1cm4gX2dsb2JhbFRpbWVsaW5lLmtpbGxUd2VlbnNPZih0YXJnZXRzLCBwcm9wcywgb25seUFjdGl2ZSk7CiAgfTsKCiAgcmV0dXJuIFR3ZWVuOwp9KEFuaW1hdGlvbik7Cgpfc2V0RGVmYXVsdHMoVHdlZW4ucHJvdG90eXBlLCB7CiAgX3RhcmdldHM6IFtdLAogIF9sYXp5OiAwLAogIF9zdGFydEF0OiAwLAogIF9vcDogMCwKICBfb25Jbml0OiAwCn0pOyAvL2FkZCB0aGUgcGVydGluZW50IHRpbWVsaW5lIG1ldGhvZHMgdG8gVHdlZW4gaW5zdGFuY2VzIHNvIHRoYXQgdXNlcnMgY2FuIGNoYWluIGNvbnZlbmllbnRseSBhbmQgY3JlYXRlIGEgdGltZWxpbmUgYXV0b21hdGljYWxseS4gKHJlbW92ZWQgZHVlIHRvIGNvbmNlcm5zIHRoYXQgaXQnZCB1bHRpbWF0ZWx5IGFkZCB0byBtb3JlIGNvbmZ1c2lvbiBlc3BlY2lhbGx5IGZvciBiZWdpbm5lcnMpCi8vIF9mb3JFYWNoTmFtZSgidG8sZnJvbSxmcm9tVG8sc2V0LGNhbGwsYWRkLGFkZExhYmVsLGFkZFBhdXNlIiwgbmFtZSA9PiB7Ci8vIAlUd2Vlbi5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHsKLy8gCQlsZXQgdGwgPSBuZXcgVGltZWxpbmUoKTsKLy8gCQlyZXR1cm4gX2FkZFRvVGltZWxpbmUodGwsIHRoaXMpW25hbWVdLmFwcGx5KHRsLCB0b0FycmF5KGFyZ3VtZW50cykpOwovLyAJfQovLyB9KTsKLy9mb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eS4gTGV2ZXJhZ2UgdGhlIHRpbWVsaW5lIGNhbGxzLgoKCl9mb3JFYWNoTmFtZSgic3RhZ2dlclRvLHN0YWdnZXJGcm9tLHN0YWdnZXJGcm9tVG8iLCBmdW5jdGlvbiAobmFtZSkgewogIFR3ZWVuW25hbWVdID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHRsID0gbmV3IFRpbWVsaW5lKCksCiAgICAgICAgcGFyYW1zID0gX3NsaWNlLmNhbGwoYXJndW1lbnRzLCAwKTsKCiAgICBwYXJhbXMuc3BsaWNlKG5hbWUgPT09ICJzdGFnZ2VyRnJvbVRvIiA/IDUgOiA0LCAwLCAwKTsKICAgIHJldHVybiB0bFtuYW1lXS5hcHBseSh0bCwgcGFyYW1zKTsKICB9Owp9KTsKLyoKICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICogUFJPUFRXRUVOCiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqLwoKCnZhciBfc2V0dGVyUGxhaW4gPSBmdW5jdGlvbiBfc2V0dGVyUGxhaW4odGFyZ2V0LCBwcm9wZXJ0eSwgdmFsdWUpIHsKICByZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOwp9LAogICAgX3NldHRlckZ1bmMgPSBmdW5jdGlvbiBfc2V0dGVyRnVuYyh0YXJnZXQsIHByb3BlcnR5LCB2YWx1ZSkgewogIHJldHVybiB0YXJnZXRbcHJvcGVydHldKHZhbHVlKTsKfSwKICAgIF9zZXR0ZXJGdW5jV2l0aFBhcmFtID0gZnVuY3Rpb24gX3NldHRlckZ1bmNXaXRoUGFyYW0odGFyZ2V0LCBwcm9wZXJ0eSwgdmFsdWUsIGRhdGEpIHsKICByZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XShkYXRhLmZwLCB2YWx1ZSk7Cn0sCiAgICBfc2V0dGVyQXR0cmlidXRlID0gZnVuY3Rpb24gX3NldHRlckF0dHJpYnV0ZSh0YXJnZXQsIHByb3BlcnR5LCB2YWx1ZSkgewogIHJldHVybiB0YXJnZXQuc2V0QXR0cmlidXRlKHByb3BlcnR5LCB2YWx1ZSk7Cn0sCiAgICBfZ2V0U2V0dGVyID0gZnVuY3Rpb24gX2dldFNldHRlcih0YXJnZXQsIHByb3BlcnR5KSB7CiAgcmV0dXJuIF9pc0Z1bmN0aW9uKHRhcmdldFtwcm9wZXJ0eV0pID8gX3NldHRlckZ1bmMgOiBfaXNVbmRlZmluZWQodGFyZ2V0W3Byb3BlcnR5XSkgJiYgdGFyZ2V0LnNldEF0dHJpYnV0ZSA/IF9zZXR0ZXJBdHRyaWJ1dGUgOiBfc2V0dGVyUGxhaW47Cn0sCiAgICBfcmVuZGVyUGxhaW4gPSBmdW5jdGlvbiBfcmVuZGVyUGxhaW4ocmF0aW8sIGRhdGEpIHsKICByZXR1cm4gZGF0YS5zZXQoZGF0YS50LCBkYXRhLnAsIE1hdGgucm91bmQoKGRhdGEucyArIGRhdGEuYyAqIHJhdGlvKSAqIDEwMDAwMDApIC8gMTAwMDAwMCwgZGF0YSk7Cn0sCiAgICBfcmVuZGVyQm9vbGVhbiA9IGZ1bmN0aW9uIF9yZW5kZXJCb29sZWFuKHJhdGlvLCBkYXRhKSB7CiAgcmV0dXJuIGRhdGEuc2V0KGRhdGEudCwgZGF0YS5wLCAhIShkYXRhLnMgKyBkYXRhLmMgKiByYXRpbyksIGRhdGEpOwp9LAogICAgX3JlbmRlckNvbXBsZXhTdHJpbmcgPSBmdW5jdGlvbiBfcmVuZGVyQ29tcGxleFN0cmluZyhyYXRpbywgZGF0YSkgewogIHZhciBwdCA9IGRhdGEuX3B0LAogICAgICBzID0gIiI7CgogIGlmICghcmF0aW8gJiYgZGF0YS5iKSB7CiAgICAvL2IgPSBiZWdpbm5pbmcgc3RyaW5nCiAgICBzID0gZGF0YS5iOwogIH0gZWxzZSBpZiAocmF0aW8gPT09IDEgJiYgZGF0YS5lKSB7CiAgICAvL2UgPSBlbmRpbmcgc3RyaW5nCiAgICBzID0gZGF0YS5lOwogIH0gZWxzZSB7CiAgICB3aGlsZSAocHQpIHsKICAgICAgcyA9IHB0LnAgKyAocHQubSA/IHB0Lm0ocHQucyArIHB0LmMgKiByYXRpbykgOiBNYXRoLnJvdW5kKChwdC5zICsgcHQuYyAqIHJhdGlvKSAqIDEwMDAwKSAvIDEwMDAwKSArIHM7IC8vd2UgdXNlIHRoZSAicCIgcHJvcGVydHkgZm9yIHRoZSB0ZXh0IGluYmV0d2VlbiAobGlrZSBhIHN1ZmZpeCkuIEFuZCBpbiB0aGUgY29udGV4dCBvZiBhIGNvbXBsZXggc3RyaW5nLCB0aGUgbW9kaWZpZXIgKG0pIGlzIHR5cGljYWxseSBqdXN0IE1hdGgucm91bmQoKSwgbGlrZSBmb3IgUkdCIGNvbG9ycy4KCiAgICAgIHB0ID0gcHQuX25leHQ7CiAgICB9CgogICAgcyArPSBkYXRhLmM7IC8vd2UgdXNlIHRoZSAiYyIgb2YgdGhlIFByb3BUd2VlbiB0byBzdG9yZSB0aGUgZmluYWwgY2h1bmsgb2Ygbm9uLW51bWVyaWMgdGV4dC4KICB9CgogIGRhdGEuc2V0KGRhdGEudCwgZGF0YS5wLCBzLCBkYXRhKTsKfSwKICAgIF9yZW5kZXJQcm9wVHdlZW5zID0gZnVuY3Rpb24gX3JlbmRlclByb3BUd2VlbnMocmF0aW8sIGRhdGEpIHsKICB2YXIgcHQgPSBkYXRhLl9wdDsKCiAgd2hpbGUgKHB0KSB7CiAgICBwdC5yKHJhdGlvLCBwdC5kKTsKICAgIHB0ID0gcHQuX25leHQ7CiAgfQp9LAogICAgX2FkZFBsdWdpbk1vZGlmaWVyID0gZnVuY3Rpb24gX2FkZFBsdWdpbk1vZGlmaWVyKG1vZGlmaWVyLCB0d2VlbiwgdGFyZ2V0LCBwcm9wZXJ0eSkgewogIHZhciBwdCA9IHRoaXMuX3B0LAogICAgICBuZXh0OwoKICB3aGlsZSAocHQpIHsKICAgIG5leHQgPSBwdC5fbmV4dDsKICAgIHB0LnAgPT09IHByb3BlcnR5ICYmIHB0Lm1vZGlmaWVyKG1vZGlmaWVyLCB0d2VlbiwgdGFyZ2V0KTsKICAgIHB0ID0gbmV4dDsKICB9Cn0sCiAgICBfa2lsbFByb3BUd2VlbnNPZiA9IGZ1bmN0aW9uIF9raWxsUHJvcFR3ZWVuc09mKHByb3BlcnR5KSB7CiAgdmFyIHB0ID0gdGhpcy5fcHQsCiAgICAgIGhhc05vbkRlcGVuZGVudFJlbWFpbmluZywKICAgICAgbmV4dDsKCiAgd2hpbGUgKHB0KSB7CiAgICBuZXh0ID0gcHQuX25leHQ7CgogICAgaWYgKHB0LnAgPT09IHByb3BlcnR5ICYmICFwdC5vcCB8fCBwdC5vcCA9PT0gcHJvcGVydHkpIHsKICAgICAgX3JlbW92ZUxpbmtlZExpc3RJdGVtKHRoaXMsIHB0LCAiX3B0Iik7CiAgICB9IGVsc2UgaWYgKCFwdC5kZXApIHsKICAgICAgaGFzTm9uRGVwZW5kZW50UmVtYWluaW5nID0gMTsKICAgIH0KCiAgICBwdCA9IG5leHQ7CiAgfQoKICByZXR1cm4gIWhhc05vbkRlcGVuZGVudFJlbWFpbmluZzsKfSwKICAgIF9zZXR0ZXJXaXRoTW9kaWZpZXIgPSBmdW5jdGlvbiBfc2V0dGVyV2l0aE1vZGlmaWVyKHRhcmdldCwgcHJvcGVydHksIHZhbHVlLCBkYXRhKSB7CiAgZGF0YS5tU2V0KHRhcmdldCwgcHJvcGVydHksIGRhdGEubS5jYWxsKGRhdGEudHdlZW4sIHZhbHVlLCBkYXRhLm10KSwgZGF0YSk7Cn0sCiAgICBfc29ydFByb3BUd2VlbnNCeVByaW9yaXR5ID0gZnVuY3Rpb24gX3NvcnRQcm9wVHdlZW5zQnlQcmlvcml0eShwYXJlbnQpIHsKICB2YXIgcHQgPSBwYXJlbnQuX3B0LAogICAgICBuZXh0LAogICAgICBwdDIsCiAgICAgIGZpcnN0LAogICAgICBsYXN0OyAvL3NvcnRzIHRoZSBQcm9wVHdlZW4gbGlua2VkIGxpc3QgaW4gb3JkZXIgb2YgcHJpb3JpdHkgYmVjYXVzZSBzb21lIHBsdWdpbnMgbmVlZCB0byBkbyB0aGVpciB3b3JrIGFmdGVyIEFMTCBvZiB0aGUgUHJvcFR3ZWVucyB3ZXJlIGNyZWF0ZWQgKGxpa2UgUm91bmRQcm9wc1BsdWdpbiBhbmQgTW9kaWZpZXJzUGx1Z2luKQoKICB3aGlsZSAocHQpIHsKICAgIG5leHQgPSBwdC5fbmV4dDsKICAgIHB0MiA9IGZpcnN0OwoKICAgIHdoaWxlIChwdDIgJiYgcHQyLnByID4gcHQucHIpIHsKICAgICAgcHQyID0gcHQyLl9uZXh0OwogICAgfQoKICAgIGlmIChwdC5fcHJldiA9IHB0MiA/IHB0Mi5fcHJldiA6IGxhc3QpIHsKICAgICAgcHQuX3ByZXYuX25leHQgPSBwdDsKICAgIH0gZWxzZSB7CiAgICAgIGZpcnN0ID0gcHQ7CiAgICB9CgogICAgaWYgKHB0Ll9uZXh0ID0gcHQyKSB7CiAgICAgIHB0Mi5fcHJldiA9IHB0OwogICAgfSBlbHNlIHsKICAgICAgbGFzdCA9IHB0OwogICAgfQoKICAgIHB0ID0gbmV4dDsKICB9CgogIHBhcmVudC5fcHQgPSBmaXJzdDsKfTsgLy9Qcm9wVHdlZW4ga2V5OiB0ID0gdGFyZ2V0LCBwID0gcHJvcCwgciA9IHJlbmRlcmVyLCBkID0gZGF0YSwgcyA9IHN0YXJ0LCBjID0gY2hhbmdlLCBvcCA9IG92ZXJ3cml0ZVByb3BlcnR5IChPTkxZIHBvcHVsYXRlZCB3aGVuIGl0J3MgZGlmZmVyZW50IHRoYW4gcCksIHByID0gcHJpb3JpdHksIF9uZXh0L19wcmV2IGZvciB0aGUgbGlua2VkIGxpc3Qgc2libGluZ3MsIHNldCA9IHNldHRlciwgbSA9IG1vZGlmaWVyLCBtU2V0ID0gbW9kaWZpZXJTZXR0ZXIgKHRoZSBvcmlnaW5hbCBzZXR0ZXIsIGJlZm9yZSBhIG1vZGlmaWVyIHdhcyBhZGRlZCkKCgpleHBvcnQgdmFyIFByb3BUd2VlbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUHJvcFR3ZWVuKG5leHQsIHRhcmdldCwgcHJvcCwgc3RhcnQsIGNoYW5nZSwgcmVuZGVyZXIsIGRhdGEsIHNldHRlciwgcHJpb3JpdHkpIHsKICAgIHRoaXMudCA9IHRhcmdldDsKICAgIHRoaXMucyA9IHN0YXJ0OwogICAgdGhpcy5jID0gY2hhbmdlOwogICAgdGhpcy5wID0gcHJvcDsKICAgIHRoaXMuciA9IHJlbmRlcmVyIHx8IF9yZW5kZXJQbGFpbjsKICAgIHRoaXMuZCA9IGRhdGEgfHwgdGhpczsKICAgIHRoaXMuc2V0ID0gc2V0dGVyIHx8IF9zZXR0ZXJQbGFpbjsKICAgIHRoaXMucHIgPSBwcmlvcml0eSB8fCAwOwogICAgdGhpcy5fbmV4dCA9IG5leHQ7CgogICAgaWYgKG5leHQpIHsKICAgICAgbmV4dC5fcHJldiA9IHRoaXM7CiAgICB9CiAgfQoKICB2YXIgX3Byb3RvNCA9IFByb3BUd2Vlbi5wcm90b3R5cGU7CgogIF9wcm90bzQubW9kaWZpZXIgPSBmdW5jdGlvbiBtb2RpZmllcihmdW5jLCB0d2VlbiwgdGFyZ2V0KSB7CiAgICB0aGlzLm1TZXQgPSB0aGlzLm1TZXQgfHwgdGhpcy5zZXQ7IC8vaW4gY2FzZSBpdCB3YXMgYWxyZWFkeSBzZXQgKGEgUHJvcFR3ZWVuIGNhbiBvbmx5IGhhdmUgb25lIG1vZGlmaWVyKQoKICAgIHRoaXMuc2V0ID0gX3NldHRlcldpdGhNb2RpZmllcjsKICAgIHRoaXMubSA9IGZ1bmM7CiAgICB0aGlzLm10ID0gdGFyZ2V0OyAvL21vZGlmaWVyIHRhcmdldAoKICAgIHRoaXMudHdlZW4gPSB0d2VlbjsKICB9OwoKICByZXR1cm4gUHJvcFR3ZWVuOwp9KCk7IC8vSW5pdGlhbGl6YXRpb24gdGFza3MKCl9mb3JFYWNoTmFtZShfY2FsbGJhY2tOYW1lcyArICJwYXJlbnQsZHVyYXRpb24sZWFzZSxkZWxheSxvdmVyd3JpdGUscnVuQmFja3dhcmRzLHN0YXJ0QXQseW95byxpbW1lZGlhdGVSZW5kZXIscmVwZWF0LHJlcGVhdERlbGF5LGRhdGEscGF1c2VkLHJldmVyc2VkLGxhenksY2FsbGJhY2tTY29wZSxzdHJpbmdGaWx0ZXIsaWQseW95b0Vhc2Usc3RhZ2dlcixpbmhlcml0LHJlcGVhdFJlZnJlc2gsa2V5ZnJhbWVzLGF1dG9SZXZlcnQsc2Nyb2xsVHJpZ2dlciIsIGZ1bmN0aW9uIChuYW1lKSB7CiAgcmV0dXJuIF9yZXNlcnZlZFByb3BzW25hbWVdID0gMTsKfSk7CgpfZ2xvYmFscy5Ud2Vlbk1heCA9IF9nbG9iYWxzLlR3ZWVuTGl0ZSA9IFR3ZWVuOwpfZ2xvYmFscy5UaW1lbGluZUxpdGUgPSBfZ2xvYmFscy5UaW1lbGluZU1heCA9IFRpbWVsaW5lOwpfZ2xvYmFsVGltZWxpbmUgPSBuZXcgVGltZWxpbmUoewogIHNvcnRDaGlsZHJlbjogZmFsc2UsCiAgZGVmYXVsdHM6IF9kZWZhdWx0cywKICBhdXRvUmVtb3ZlQ2hpbGRyZW46IHRydWUsCiAgaWQ6ICJyb290IiwKICBzbW9vdGhDaGlsZFRpbWluZzogdHJ1ZQp9KTsKX2NvbmZpZy5zdHJpbmdGaWx0ZXIgPSBfY29sb3JTdHJpbmdGaWx0ZXI7Ci8qCiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqIEdTQVAKICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICovCgp2YXIgX2dzYXAgPSB7CiAgcmVnaXN0ZXJQbHVnaW46IGZ1bmN0aW9uIHJlZ2lzdGVyUGx1Z2luKCkgewogICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7CiAgICAgIGFyZ3NbX2tleTJdID0gYXJndW1lbnRzW19rZXkyXTsKICAgIH0KCiAgICBhcmdzLmZvckVhY2goZnVuY3Rpb24gKGNvbmZpZykgewogICAgICByZXR1cm4gX2NyZWF0ZVBsdWdpbihjb25maWcpOwogICAgfSk7CiAgfSwKICB0aW1lbGluZTogZnVuY3Rpb24gdGltZWxpbmUodmFycykgewogICAgcmV0dXJuIG5ldyBUaW1lbGluZSh2YXJzKTsKICB9LAogIGdldFR3ZWVuc09mOiBmdW5jdGlvbiBnZXRUd2VlbnNPZih0YXJnZXRzLCBvbmx5QWN0aXZlKSB7CiAgICByZXR1cm4gX2dsb2JhbFRpbWVsaW5lLmdldFR3ZWVuc09mKHRhcmdldHMsIG9ubHlBY3RpdmUpOwogIH0sCiAgZ2V0UHJvcGVydHk6IGZ1bmN0aW9uIGdldFByb3BlcnR5KHRhcmdldCwgcHJvcGVydHksIHVuaXQsIHVuY2FjaGUpIHsKICAgIF9pc1N0cmluZyh0YXJnZXQpICYmICh0YXJnZXQgPSB0b0FycmF5KHRhcmdldClbMF0pOyAvL2luIGNhc2Ugc2VsZWN0b3IgdGV4dCBvciBhbiBhcnJheSBpcyBwYXNzZWQgaW4KCiAgICB2YXIgZ2V0dGVyID0gX2dldENhY2hlKHRhcmdldCB8fCB7fSkuZ2V0LAogICAgICAgIGZvcm1hdCA9IHVuaXQgPyBfcGFzc1Rocm91Z2ggOiBfbnVtZXJpY0lmUG9zc2libGU7CgogICAgdW5pdCA9PT0gIm5hdGl2ZSIgJiYgKHVuaXQgPSAiIik7CiAgICByZXR1cm4gIXRhcmdldCA/IHRhcmdldCA6ICFwcm9wZXJ0eSA/IGZ1bmN0aW9uIChwcm9wZXJ0eSwgdW5pdCwgdW5jYWNoZSkgewogICAgICByZXR1cm4gZm9ybWF0KChfcGx1Z2luc1twcm9wZXJ0eV0gJiYgX3BsdWdpbnNbcHJvcGVydHldLmdldCB8fCBnZXR0ZXIpKHRhcmdldCwgcHJvcGVydHksIHVuaXQsIHVuY2FjaGUpKTsKICAgIH0gOiBmb3JtYXQoKF9wbHVnaW5zW3Byb3BlcnR5XSAmJiBfcGx1Z2luc1twcm9wZXJ0eV0uZ2V0IHx8IGdldHRlcikodGFyZ2V0LCBwcm9wZXJ0eSwgdW5pdCwgdW5jYWNoZSkpOwogIH0sCiAgcXVpY2tTZXR0ZXI6IGZ1bmN0aW9uIHF1aWNrU2V0dGVyKHRhcmdldCwgcHJvcGVydHksIHVuaXQpIHsKICAgIHRhcmdldCA9IHRvQXJyYXkodGFyZ2V0KTsKCiAgICBpZiAodGFyZ2V0Lmxlbmd0aCA+IDEpIHsKICAgICAgdmFyIHNldHRlcnMgPSB0YXJnZXQubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgcmV0dXJuIGdzYXAucXVpY2tTZXR0ZXIodCwgcHJvcGVydHksIHVuaXQpOwogICAgICB9KSwKICAgICAgICAgIGwgPSBzZXR0ZXJzLmxlbmd0aDsKICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIHZhciBpID0gbDsKCiAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgc2V0dGVyc1tpXSh2YWx1ZSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQoKICAgIHRhcmdldCA9IHRhcmdldFswXSB8fCB7fTsKCiAgICB2YXIgUGx1Z2luID0gX3BsdWdpbnNbcHJvcGVydHldLAogICAgICAgIGNhY2hlID0gX2dldENhY2hlKHRhcmdldCksCiAgICAgICAgcCA9IGNhY2hlLmhhcm5lc3MgJiYgKGNhY2hlLmhhcm5lc3MuYWxpYXNlcyB8fCB7fSlbcHJvcGVydHldIHx8IHByb3BlcnR5LAogICAgICAgIC8vIGluIGNhc2UgaXQncyBhbiBhbGlhcywgbGlrZSAicm90YXRlIiBmb3IgInJvdGF0aW9uIi4KICAgIHNldHRlciA9IFBsdWdpbiA/IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICB2YXIgcCA9IG5ldyBQbHVnaW4oKTsKICAgICAgX3F1aWNrVHdlZW4uX3B0ID0gMDsKICAgICAgcC5pbml0KHRhcmdldCwgdW5pdCA/IHZhbHVlICsgdW5pdCA6IHZhbHVlLCBfcXVpY2tUd2VlbiwgMCwgW3RhcmdldF0pOwogICAgICBwLnJlbmRlcigxLCBwKTsKICAgICAgX3F1aWNrVHdlZW4uX3B0ICYmIF9yZW5kZXJQcm9wVHdlZW5zKDEsIF9xdWlja1R3ZWVuKTsKICAgIH0gOiBjYWNoZS5zZXQodGFyZ2V0LCBwKTsKCiAgICByZXR1cm4gUGx1Z2luID8gc2V0dGVyIDogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIHJldHVybiBzZXR0ZXIodGFyZ2V0LCBwLCB1bml0ID8gdmFsdWUgKyB1bml0IDogdmFsdWUsIGNhY2hlLCAxKTsKICAgIH07CiAgfSwKICBpc1R3ZWVuaW5nOiBmdW5jdGlvbiBpc1R3ZWVuaW5nKHRhcmdldHMpIHsKICAgIHJldHVybiBfZ2xvYmFsVGltZWxpbmUuZ2V0VHdlZW5zT2YodGFyZ2V0cywgdHJ1ZSkubGVuZ3RoID4gMDsKICB9LAogIGRlZmF1bHRzOiBmdW5jdGlvbiBkZWZhdWx0cyh2YWx1ZSkgewogICAgdmFsdWUgJiYgdmFsdWUuZWFzZSAmJiAodmFsdWUuZWFzZSA9IF9wYXJzZUVhc2UodmFsdWUuZWFzZSwgX2RlZmF1bHRzLmVhc2UpKTsKICAgIHJldHVybiBfbWVyZ2VEZWVwKF9kZWZhdWx0cywgdmFsdWUgfHwge30pOwogIH0sCiAgY29uZmlnOiBmdW5jdGlvbiBjb25maWcodmFsdWUpIHsKICAgIHJldHVybiBfbWVyZ2VEZWVwKF9jb25maWcsIHZhbHVlIHx8IHt9KTsKICB9LAogIHJlZ2lzdGVyRWZmZWN0OiBmdW5jdGlvbiByZWdpc3RlckVmZmVjdChfcmVmMykgewogICAgdmFyIG5hbWUgPSBfcmVmMy5uYW1lLAogICAgICAgIGVmZmVjdCA9IF9yZWYzLmVmZmVjdCwKICAgICAgICBwbHVnaW5zID0gX3JlZjMucGx1Z2lucywKICAgICAgICBkZWZhdWx0cyA9IF9yZWYzLmRlZmF1bHRzLAogICAgICAgIGV4dGVuZFRpbWVsaW5lID0gX3JlZjMuZXh0ZW5kVGltZWxpbmU7CiAgICAocGx1Z2lucyB8fCAiIikuc3BsaXQoIiwiKS5mb3JFYWNoKGZ1bmN0aW9uIChwbHVnaW5OYW1lKSB7CiAgICAgIHJldHVybiBwbHVnaW5OYW1lICYmICFfcGx1Z2luc1twbHVnaW5OYW1lXSAmJiAhX2dsb2JhbHNbcGx1Z2luTmFtZV0gJiYgX3dhcm4obmFtZSArICIgZWZmZWN0IHJlcXVpcmVzICIgKyBwbHVnaW5OYW1lICsgIiBwbHVnaW4uIik7CiAgICB9KTsKCiAgICBfZWZmZWN0c1tuYW1lXSA9IGZ1bmN0aW9uICh0YXJnZXRzLCB2YXJzLCB0bCkgewogICAgICByZXR1cm4gZWZmZWN0KHRvQXJyYXkodGFyZ2V0cyksIF9zZXREZWZhdWx0cyh2YXJzIHx8IHt9LCBkZWZhdWx0cyksIHRsKTsKICAgIH07CgogICAgaWYgKGV4dGVuZFRpbWVsaW5lKSB7CiAgICAgIFRpbWVsaW5lLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uICh0YXJnZXRzLCB2YXJzLCBwb3NpdGlvbikgewogICAgICAgIHJldHVybiB0aGlzLmFkZChfZWZmZWN0c1tuYW1lXSh0YXJnZXRzLCBfaXNPYmplY3QodmFycykgPyB2YXJzIDogKHBvc2l0aW9uID0gdmFycykgJiYge30sIHRoaXMpLCBwb3NpdGlvbik7CiAgICAgIH07CiAgICB9CiAgfSwKICByZWdpc3RlckVhc2U6IGZ1bmN0aW9uIHJlZ2lzdGVyRWFzZShuYW1lLCBlYXNlKSB7CiAgICBfZWFzZU1hcFtuYW1lXSA9IF9wYXJzZUVhc2UoZWFzZSk7CiAgfSwKICBwYXJzZUVhc2U6IGZ1bmN0aW9uIHBhcnNlRWFzZShlYXNlLCBkZWZhdWx0RWFzZSkgewogICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyBfcGFyc2VFYXNlKGVhc2UsIGRlZmF1bHRFYXNlKSA6IF9lYXNlTWFwOwogIH0sCiAgZ2V0QnlJZDogZnVuY3Rpb24gZ2V0QnlJZChpZCkgewogICAgcmV0dXJuIF9nbG9iYWxUaW1lbGluZS5nZXRCeUlkKGlkKTsKICB9LAogIGV4cG9ydFJvb3Q6IGZ1bmN0aW9uIGV4cG9ydFJvb3QodmFycywgaW5jbHVkZURlbGF5ZWRDYWxscykgewogICAgaWYgKHZhcnMgPT09IHZvaWQgMCkgewogICAgICB2YXJzID0ge307CiAgICB9CgogICAgdmFyIHRsID0gbmV3IFRpbWVsaW5lKHZhcnMpLAogICAgICAgIGNoaWxkLAogICAgICAgIG5leHQ7CiAgICB0bC5zbW9vdGhDaGlsZFRpbWluZyA9IF9pc05vdEZhbHNlKHZhcnMuc21vb3RoQ2hpbGRUaW1pbmcpOwoKICAgIF9nbG9iYWxUaW1lbGluZS5yZW1vdmUodGwpOwoKICAgIHRsLl9kcCA9IDA7IC8vb3RoZXJ3aXNlIGl0J2xsIGdldCByZS1hY3RpdmF0ZWQgd2hlbiBhZGRpbmcgY2hpbGRyZW4gYW5kIGJlIHJlLWludHJvZHVjZWQgaW50byBfZ2xvYmFsVGltZWxpbmUncyBsaW5rZWQgbGlzdCAodGhlbiBhZGRlZCB0byBpdHNlbGYpLgoKICAgIHRsLl90aW1lID0gdGwuX3RUaW1lID0gX2dsb2JhbFRpbWVsaW5lLl90aW1lOwogICAgY2hpbGQgPSBfZ2xvYmFsVGltZWxpbmUuX2ZpcnN0OwoKICAgIHdoaWxlIChjaGlsZCkgewogICAgICBuZXh0ID0gY2hpbGQuX25leHQ7CgogICAgICBpZiAoaW5jbHVkZURlbGF5ZWRDYWxscyB8fCAhKCFjaGlsZC5fZHVyICYmIGNoaWxkIGluc3RhbmNlb2YgVHdlZW4gJiYgY2hpbGQudmFycy5vbkNvbXBsZXRlID09PSBjaGlsZC5fdGFyZ2V0c1swXSkpIHsKICAgICAgICBfYWRkVG9UaW1lbGluZSh0bCwgY2hpbGQsIGNoaWxkLl9zdGFydCAtIGNoaWxkLl9kZWxheSk7CiAgICAgIH0KCiAgICAgIGNoaWxkID0gbmV4dDsKICAgIH0KCiAgICBfYWRkVG9UaW1lbGluZShfZ2xvYmFsVGltZWxpbmUsIHRsLCAwKTsKCiAgICByZXR1cm4gdGw7CiAgfSwKICB1dGlsczogewogICAgd3JhcDogd3JhcCwKICAgIHdyYXBZb3lvOiB3cmFwWW95bywKICAgIGRpc3RyaWJ1dGU6IGRpc3RyaWJ1dGUsCiAgICByYW5kb206IHJhbmRvbSwKICAgIHNuYXA6IHNuYXAsCiAgICBub3JtYWxpemU6IG5vcm1hbGl6ZSwKICAgIGdldFVuaXQ6IGdldFVuaXQsCiAgICBjbGFtcDogY2xhbXAsCiAgICBzcGxpdENvbG9yOiBzcGxpdENvbG9yLAogICAgdG9BcnJheTogdG9BcnJheSwKICAgIHNlbGVjdG9yOiBzZWxlY3RvciwKICAgIG1hcFJhbmdlOiBtYXBSYW5nZSwKICAgIHBpcGU6IHBpcGUsCiAgICB1bml0aXplOiB1bml0aXplLAogICAgaW50ZXJwb2xhdGU6IGludGVycG9sYXRlLAogICAgc2h1ZmZsZTogc2h1ZmZsZQogIH0sCiAgaW5zdGFsbDogX2luc3RhbGwsCiAgZWZmZWN0czogX2VmZmVjdHMsCiAgdGlja2VyOiBfdGlja2VyLAogIHVwZGF0ZVJvb3Q6IFRpbWVsaW5lLnVwZGF0ZVJvb3QsCiAgcGx1Z2luczogX3BsdWdpbnMsCiAgZ2xvYmFsVGltZWxpbmU6IF9nbG9iYWxUaW1lbGluZSwKICBjb3JlOiB7CiAgICBQcm9wVHdlZW46IFByb3BUd2VlbiwKICAgIGdsb2JhbHM6IF9hZGRHbG9iYWwsCiAgICBUd2VlbjogVHdlZW4sCiAgICBUaW1lbGluZTogVGltZWxpbmUsCiAgICBBbmltYXRpb246IEFuaW1hdGlvbiwKICAgIGdldENhY2hlOiBfZ2V0Q2FjaGUsCiAgICBfcmVtb3ZlTGlua2VkTGlzdEl0ZW06IF9yZW1vdmVMaW5rZWRMaXN0SXRlbSwKICAgIHN1cHByZXNzT3ZlcndyaXRlczogZnVuY3Rpb24gc3VwcHJlc3NPdmVyd3JpdGVzKHZhbHVlKSB7CiAgICAgIHJldHVybiBfc3VwcHJlc3NPdmVyd3JpdGVzID0gdmFsdWU7CiAgICB9CiAgfQp9OwoKX2ZvckVhY2hOYW1lKCJ0byxmcm9tLGZyb21UbyxkZWxheWVkQ2FsbCxzZXQsa2lsbFR3ZWVuc09mIiwgZnVuY3Rpb24gKG5hbWUpIHsKICByZXR1cm4gX2dzYXBbbmFtZV0gPSBUd2VlbltuYW1lXTsKfSk7CgpfdGlja2VyLmFkZChUaW1lbGluZS51cGRhdGVSb290KTsKCl9xdWlja1R3ZWVuID0gX2dzYXAudG8oe30sIHsKICBkdXJhdGlvbjogMAp9KTsgLy8gLS0tLSBFWFRSQSBQTFVHSU5TIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgp2YXIgX2dldFBsdWdpblByb3BUd2VlbiA9IGZ1bmN0aW9uIF9nZXRQbHVnaW5Qcm9wVHdlZW4ocGx1Z2luLCBwcm9wKSB7CiAgdmFyIHB0ID0gcGx1Z2luLl9wdDsKCiAgd2hpbGUgKHB0ICYmIHB0LnAgIT09IHByb3AgJiYgcHQub3AgIT09IHByb3AgJiYgcHQuZnAgIT09IHByb3ApIHsKICAgIHB0ID0gcHQuX25leHQ7CiAgfQoKICByZXR1cm4gcHQ7Cn0sCiAgICBfYWRkTW9kaWZpZXJzID0gZnVuY3Rpb24gX2FkZE1vZGlmaWVycyh0d2VlbiwgbW9kaWZpZXJzKSB7CiAgdmFyIHRhcmdldHMgPSB0d2Vlbi5fdGFyZ2V0cywKICAgICAgcCwKICAgICAgaSwKICAgICAgcHQ7CgogIGZvciAocCBpbiBtb2RpZmllcnMpIHsKICAgIGkgPSB0YXJnZXRzLmxlbmd0aDsKCiAgICB3aGlsZSAoaS0tKSB7CiAgICAgIHB0ID0gdHdlZW4uX3B0TG9va3VwW2ldW3BdOwoKICAgICAgaWYgKHB0ICYmIChwdCA9IHB0LmQpKSB7CiAgICAgICAgaWYgKHB0Ll9wdCkgewogICAgICAgICAgLy8gaXMgYSBwbHVnaW4KICAgICAgICAgIHB0ID0gX2dldFBsdWdpblByb3BUd2VlbihwdCwgcCk7CiAgICAgICAgfQoKICAgICAgICBwdCAmJiBwdC5tb2RpZmllciAmJiBwdC5tb2RpZmllcihtb2RpZmllcnNbcF0sIHR3ZWVuLCB0YXJnZXRzW2ldLCBwKTsKICAgICAgfQogICAgfQogIH0KfSwKICAgIF9idWlsZE1vZGlmaWVyUGx1Z2luID0gZnVuY3Rpb24gX2J1aWxkTW9kaWZpZXJQbHVnaW4obmFtZSwgbW9kaWZpZXIpIHsKICByZXR1cm4gewogICAgbmFtZTogbmFtZSwKICAgIHJhd1ZhcnM6IDEsCiAgICAvL2Rvbid0IHByZS1wcm9jZXNzIGZ1bmN0aW9uLWJhc2VkIHZhbHVlcyBvciAicmFuZG9tKCkiIHN0cmluZ3MuCiAgICBpbml0OiBmdW5jdGlvbiBpbml0KHRhcmdldCwgdmFycywgdHdlZW4pIHsKICAgICAgdHdlZW4uX29uSW5pdCA9IGZ1bmN0aW9uICh0d2VlbikgewogICAgICAgIHZhciB0ZW1wLCBwOwoKICAgICAgICBpZiAoX2lzU3RyaW5nKHZhcnMpKSB7CiAgICAgICAgICB0ZW1wID0ge307CgogICAgICAgICAgX2ZvckVhY2hOYW1lKHZhcnMsIGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgICAgIHJldHVybiB0ZW1wW25hbWVdID0gMTsKICAgICAgICAgIH0pOyAvL2lmIHRoZSB1c2VyIHBhc3NlcyBpbiBhIGNvbW1hLWRlbGltaXRlZCBsaXN0IG9mIHByb3BlcnR5IG5hbWVzIHRvIHJvdW5kUHJvcHMsIGxpa2UgIngseSIsIHdlIHJvdW5kIHRvIHdob2xlIG51bWJlcnMuCgoKICAgICAgICAgIHZhcnMgPSB0ZW1wOwogICAgICAgIH0KCiAgICAgICAgaWYgKG1vZGlmaWVyKSB7CiAgICAgICAgICB0ZW1wID0ge307CgogICAgICAgICAgZm9yIChwIGluIHZhcnMpIHsKICAgICAgICAgICAgdGVtcFtwXSA9IG1vZGlmaWVyKHZhcnNbcF0pOwogICAgICAgICAgfQoKICAgICAgICAgIHZhcnMgPSB0ZW1wOwogICAgICAgIH0KCiAgICAgICAgX2FkZE1vZGlmaWVycyh0d2VlbiwgdmFycyk7CiAgICAgIH07CiAgICB9CiAgfTsKfTsgLy9yZWdpc3RlciBjb3JlIHBsdWdpbnMKCgpleHBvcnQgdmFyIGdzYXAgPSBfZ3NhcC5yZWdpc3RlclBsdWdpbih7CiAgbmFtZTogImF0dHIiLAogIGluaXQ6IGZ1bmN0aW9uIGluaXQodGFyZ2V0LCB2YXJzLCB0d2VlbiwgaW5kZXgsIHRhcmdldHMpIHsKICAgIHZhciBwLCBwdDsKCiAgICBmb3IgKHAgaW4gdmFycykgewogICAgICBwdCA9IHRoaXMuYWRkKHRhcmdldCwgInNldEF0dHJpYnV0ZSIsICh0YXJnZXQuZ2V0QXR0cmlidXRlKHApIHx8IDApICsgIiIsIHZhcnNbcF0sIGluZGV4LCB0YXJnZXRzLCAwLCAwLCBwKTsKICAgICAgcHQgJiYgKHB0Lm9wID0gcCk7CgogICAgICB0aGlzLl9wcm9wcy5wdXNoKHApOwogICAgfQogIH0KfSwgewogIG5hbWU6ICJlbmRBcnJheSIsCiAgaW5pdDogZnVuY3Rpb24gaW5pdCh0YXJnZXQsIHZhbHVlKSB7CiAgICB2YXIgaSA9IHZhbHVlLmxlbmd0aDsKCiAgICB3aGlsZSAoaS0tKSB7CiAgICAgIHRoaXMuYWRkKHRhcmdldCwgaSwgdGFyZ2V0W2ldIHx8IDAsIHZhbHVlW2ldKTsKICAgIH0KICB9Cn0sIF9idWlsZE1vZGlmaWVyUGx1Z2luKCJyb3VuZFByb3BzIiwgX3JvdW5kTW9kaWZpZXIpLCBfYnVpbGRNb2RpZmllclBsdWdpbigibW9kaWZpZXJzIiksIF9idWlsZE1vZGlmaWVyUGx1Z2luKCJzbmFwIiwgc25hcCkpIHx8IF9nc2FwOyAvL3RvIHByZXZlbnQgdGhlIGNvcmUgcGx1Z2lucyBmcm9tIGJlaW5nIGRyb3BwZWQgdmlhIGFnZ3Jlc3NpdmUgdHJlZSBzaGFraW5nLCB3ZSBtdXN0IGluY2x1ZGUgdGhlbSBpbiB0aGUgdmFyaWFibGUgZGVjbGFyYXRpb24gaW4gdGhpcyB3YXkuCgpUd2Vlbi52ZXJzaW9uID0gVGltZWxpbmUudmVyc2lvbiA9IGdzYXAudmVyc2lvbiA9ICIzLjkuMSI7Cl9jb3JlUmVhZHkgPSAxOwpfd2luZG93RXhpc3RzKCkgJiYgX3dha2UoKTsKdmFyIFBvd2VyMCA9IF9lYXNlTWFwLlBvd2VyMCwKICAgIFBvd2VyMSA9IF9lYXNlTWFwLlBvd2VyMSwKICAgIFBvd2VyMiA9IF9lYXNlTWFwLlBvd2VyMiwKICAgIFBvd2VyMyA9IF9lYXNlTWFwLlBvd2VyMywKICAgIFBvd2VyNCA9IF9lYXNlTWFwLlBvd2VyNCwKICAgIExpbmVhciA9IF9lYXNlTWFwLkxpbmVhciwKICAgIFF1YWQgPSBfZWFzZU1hcC5RdWFkLAogICAgQ3ViaWMgPSBfZWFzZU1hcC5DdWJpYywKICAgIFF1YXJ0ID0gX2Vhc2VNYXAuUXVhcnQsCiAgICBRdWludCA9IF9lYXNlTWFwLlF1aW50LAogICAgU3Ryb25nID0gX2Vhc2VNYXAuU3Ryb25nLAogICAgRWxhc3RpYyA9IF9lYXNlTWFwLkVsYXN0aWMsCiAgICBCYWNrID0gX2Vhc2VNYXAuQmFjaywKICAgIFN0ZXBwZWRFYXNlID0gX2Vhc2VNYXAuU3RlcHBlZEVhc2UsCiAgICBCb3VuY2UgPSBfZWFzZU1hcC5Cb3VuY2UsCiAgICBTaW5lID0gX2Vhc2VNYXAuU2luZSwKICAgIEV4cG8gPSBfZWFzZU1hcC5FeHBvLAogICAgQ2lyYyA9IF9lYXNlTWFwLkNpcmM7CmV4cG9ydCB7IFBvd2VyMCwgUG93ZXIxLCBQb3dlcjIsIFBvd2VyMywgUG93ZXI0LCBMaW5lYXIsIFF1YWQsIEN1YmljLCBRdWFydCwgUXVpbnQsIFN0cm9uZywgRWxhc3RpYywgQmFjaywgU3RlcHBlZEVhc2UsIEJvdW5jZSwgU2luZSwgRXhwbywgQ2lyYyB9OwpleHBvcnQgeyBUd2VlbiBhcyBUd2Vlbk1heCwgVHdlZW4gYXMgVHdlZW5MaXRlLCBUaW1lbGluZSBhcyBUaW1lbGluZU1heCwgVGltZWxpbmUgYXMgVGltZWxpbmVMaXRlLCBnc2FwIGFzIGRlZmF1bHQsIHdyYXAsIHdyYXBZb3lvLCBkaXN0cmlidXRlLCByYW5kb20sIHNuYXAsIG5vcm1hbGl6ZSwgZ2V0VW5pdCwgY2xhbXAsIHNwbGl0Q29sb3IsIHRvQXJyYXksIHNlbGVjdG9yLCBtYXBSYW5nZSwgcGlwZSwgdW5pdGl6ZSwgaW50ZXJwb2xhdGUsIHNodWZmbGUgfTsgLy9leHBvcnQgc29tZSBpbnRlcm5hbCBtZXRob2RzL29yb2plY3RzIGZvciB1c2UgaW4gQ1NTUGx1Z2luIHNvIHRoYXQgd2UgY2FuIGV4dGVybmFsaXplIHRoYXQgZmlsZSBhbmQgYWxsb3cgY3VzdG9tIGJ1aWxkcyB0aGF0IGV4Y2x1ZGUgaXQuCgpleHBvcnQgeyBfZ2V0UHJvcGVydHksIF9udW1FeHAsIF9udW1XaXRoVW5pdEV4cCwgX2lzU3RyaW5nLCBfaXNVbmRlZmluZWQsIF9yZW5kZXJDb21wbGV4U3RyaW5nLCBfcmVsRXhwLCBfc2V0RGVmYXVsdHMsIF9yZW1vdmVMaW5rZWRMaXN0SXRlbSwgX2ZvckVhY2hOYW1lLCBfc29ydFByb3BUd2VlbnNCeVByaW9yaXR5LCBfY29sb3JTdHJpbmdGaWx0ZXIsIF9yZXBsYWNlUmFuZG9tLCBfY2hlY2tQbHVnaW4sIF9wbHVnaW5zLCBfdGlja2VyLCBfY29uZmlnLCBfcm91bmRNb2RpZmllciwgX3JvdW5kLCBfbWlzc2luZ1BsdWdpbiwgX2dldFNldHRlciwgX2dldENhY2hlLCBfY29sb3JFeHAgfTs="},{"version":3,"sources":["/app/app/src/js/gsapPackage/gsap-core.js"],"names":["_assertThisInitialized","self","ReferenceError","_inheritsLoose","subClass","superClass","prototype","Object","create","constructor","__proto__","_config","autoSleep","force3D","nullTargetWarn","units","lineHeight","_defaults","duration","overwrite","delay","_suppressOverwrites","_bigNum","_tinyNum","_2PI","Math","PI","_HALF_PI","_gsID","_sqrt","sqrt","_cos","cos","_sin","sin","_isString","value","_isFunction","_isNumber","_isUndefined","_isObject","_isNotFalse","_windowExists","window","_isFuncOrString","_isTypedArray","ArrayBuffer","isView","_isArray","Array","isArray","_strictNumExp","_numExp","_numWithUnitExp","_complexStringNumExp","_relExp","_delimitedValueExp","_unitExp","_globalTimeline","_win","_coreInitted","_doc","_globals","_installScope","_coreReady","_install","scope","_merge","gsap","_missingPlugin","property","console","warn","_warn","message","suppress","_addGlobal","name","obj","_emptyFunc","_reservedProps","_lazyTweens","_lazyLookup","_lastRenderedFrame","_plugins","_effects","_nextGCFrame","_harnessPlugins","_callbackNames","_harness","targets","target","harnessPlugin","i","_gsap","harness","length","targetTest","GSCache","splice","_getCache","toArray","_getProperty","v","getAttribute","_forEachName","names","func","split","forEach","_round","round","_roundPrecise","_arrayContainsAny","toSearch","toFind","l","indexOf","_lazyRender","a","slice","tween","_lazy","render","_lazySafeRender","animation","time","suppressEvents","force","_numericIfPossible","n","parseFloat","match","trim","_passThrough","p","_setDefaults","defaults","_setKeyframeDefaults","excludeDuration","base","toMerge","_mergeDeep","_copyExcluding","excluding","copy","_inheritDefaults","vars","parent","keyframes","inherit","_dp","_arraysMatch","a1","a2","_addLinkedListItem","child","firstProp","lastProp","sortBy","prev","t","_prev","_next","_removeLinkedListItem","next","_removeFromParent","onlyIfParentHasAutoRemove","autoRemoveChildren","remove","_act","_uncache","_end","_dur","_start","_dirty","_recacheAncestors","totalDuration","_hasNoPausedAncestors","_ts","_elapsedCycleDuration","_repeat","_animationCycle","_tTime","_rDelay","tTime","cycleDuration","whole","floor","_parentToChildTotalTime","parentTime","_tDur","_setEnd","abs","_rts","_alignPlayhead","totalTime","smoothChildTiming","_time","_postAddChecks","timeline","_initted","rawTime","_clamp","_zTime","_addToTimeline","position","skipChecks","_parsePosition","_delay","timeScale","_sort","_isFromOrFromStart","_recent","_scrollTrigger","trigger","ScrollTrigger","_attemptInitTween","_initTween","_pt","lazy","_ticker","frame","push","_parentPlayheadIsBeforeStart","_ref","_lock","_ref2","data","_renderZeroDurationTween","prevRatio","ratio","repeatDelay","pt","iteration","prevIteration","_yoyo","repeatRefresh","invalidate","_from","r","d","_startAt","_onUpdate","_callback","_prom","_findNextPauseTween","prevTime","_first","_last","_setDuration","skipUncache","leavePlayhead","repeat","dur","totalProgress","_onUpdateTotalDuration","Timeline","_zeroPosition","endTime","percentAnimation","labels","recent","clippedDuration","offset","isPercent","isNaN","charAt","substr","replace","_createTweenType","type","params","isLegacy","varsIndex","irVars","immediateRender","runBackwards","startAt","Tween","_conditionalReturn","min","max","getUnit","exec","index","clamp","_slice","_isArrayLike","nonEmpty","nodeType","_flatten","ar","leaveStrings","accumulator","_accumulator","apply","_wake","call","querySelectorAll","selector","el","current","nativeElement","createElement","shuffle","sort","random","distribute","each","ease","_parseEase","from","cache","isDecimal","ratios","axis","ratioX","ratioY","center","edges","end","distances","originX","originY","x","y","j","wrapAt","grid","getBoundingClientRect","left","amount","b","u","_invertEase","_roundModifier","pow","raw","snap","snapTo","radius","is2D","values","increment","closest","dx","dy","roundingIncrement","returnFunction","pipe","_len","arguments","functions","_key","reduce","f","unitize","unit","normalize","mapRange","_wrapArray","wrapper","wrap","range","wrapYoyo","total","_replaceRandom","s","nums","inMin","inMax","outMin","outMax","inRange","outRange","interpolate","start","progress","mutate","isString","master","interpolators","il","_addPropTween","_renderPropTweens","_getLabelInDirection","fromTime","backward","distance","label","executeLazyFirst","callback","callbackScope","_interrupt","scrollTrigger","kill","_quickTween","_createPlugin","config","isFunc","Plugin","init","_props","instanceDefaults","add","_killPropTweensOf","modifier","_addPluginModifier","rawVars","statics","get","getSetter","_getSetter","aliases","register","prop","toUpperCase","PropTween","_255","_colorLookup","aqua","lime","silver","black","maroon","teal","blue","navy","white","olive","yellow","orange","gray","purple","green","red","pink","cyan","transparent","_hue","h","m1","m2","splitColor","toHSL","forceAlpha","g","wasHSL","parseInt","map","Number","_colorOrderData","c","_colorExp","_formatColors","orderMatchData","result","colors","shell","color","join","shift","RegExp","_hslExp","_colorStringFilter","combined","lastIndex","test","_tickerActive","_getTime","Date","now","_lagThreshold","_adjustedLag","_startTime","_lastUpdate","_gap","_nextTime","_listeners","_id","_req","_raf","_self","_delta","_i","_tick","elapsed","manual","overlap","dispatch","tick","deltaRatio","fps","wake","document","gsapVersions","version","GreenSockGlobals","requestAnimationFrame","sleep","setTimeout","cancelAnimationFrame","clearTimeout","lagSmoothing","threshold","adjustedLag","_fps","_easeMap","_customEaseExp","_quotesExp","_parseObjectInString","key","val","parsedVal","lastIndexOf","_valueInParentheses","open","close","nested","substring","_configEaseFromString","_CE","_propagateYoyoEase","isYoyo","yoyoEase","_ease","_yEase","defaultEase","_insertEase","easeIn","easeOut","easeInOut","lowercaseName","toLowerCase","_easeInOutFromOut","_configElastic","amplitude","period","p1","p2","p3","asin","_configBack","overshoot","power","Linear","easeNone","none","n1","n2","n3","SteppedEase","steps","immediateStart","id","set","Animation","Infinity","yoyo","_proto","startTime","_totalTime","_ptLookup","_pTime","_ps","paused","includeRepeats","wrapRepeats","globalTime","seek","restart","includeDelay","play","reversed","reverse","pause","atTime","resume","isActive","eventCallback","then","onFulfilled","Promise","resolve","_resolve","_then","_Animation","_this","sortChildren","_proto2","to","fromTo","fromVars","toVars","delayedCall","staggerTo","stagger","onCompleteAll","onCompleteAllParams","onComplete","onCompleteParams","staggerFrom","staggerFromTo","tDur","crossingStart","prevPaused","pauseTween","prevStart","rewinding","doesWrap","onRepeat","_hasPause","_forcing","onUpdate","adjustedTime","_this2","addLabel","getChildren","tweens","timelines","ignoreBeforeTime","getById","animations","removeLabel","killTweensOf","_totalTime2","addPause","removePause","props","onlyActive","getTweensOf","_overwritingTween","parsedTargets","isGlobalTime","children","_targets","tweenTo","tl","_vars","_onStart","onStart","onStartParams","initted","tweenFromTo","fromPosition","toPosition","nextLabel","afterTime","previousLabel","beforeTime","currentLabel","shiftChildren","adjustLabels","clear","includeLabels","updateRoot","_addComplexStringPropTween","setter","stringFilter","funcParam","_renderComplexString","matchIndex","startNums","endNum","chunk","startNum","hasRandom","e","m","fp","currentValue","parsedStart","_setterPlain","_setterFuncWithParam","_setterFunc","_renderBoolean","_renderPlain","_processVars","_parseFuncOrString","style","_checkPlugin","plugin","ptLookup","priority","onUpdateParams","autoRevert","prevStartAt","fullTargets","autoOverwrite","_overwrite","cleanVars","hasPriority","gsData","harnessVars","overwritten","_op","_sortPropTweensByPriority","_onInit","_addAliasesToVars","propertyAliases","_parseKeyframe","allProps","easeEach","_staggerTweenProps","_staggerPropsToSkip","_Animation2","skipInherit","_this3","_this3$vars","curTarget","staggerFunc","staggerVarsToMerge","kf","_proto3","killingTargets","propTweenLookup","firstPT","overwrittenProps","curLookup","curOverwriteProps","onReverseComplete","onReverseCompleteParams","_setterAttribute","setAttribute","hasNonDependentRemaining","op","dep","_setterWithModifier","mSet","mt","pt2","first","last","pr","change","renderer","_proto4","TweenMax","TweenLite","TimelineLite","TimelineMax","registerPlugin","_len2","args","_key2","getProperty","uncache","getter","format","quickSetter","setters","isTweening","registerEffect","_ref3","effect","plugins","extendTimeline","pluginName","registerEase","parseEase","exportRoot","includeDelayedCalls","utils","install","effects","ticker","globalTimeline","core","globals","getCache","suppressOverwrites","_getPluginPropTween","_addModifiers","modifiers","_buildModifierPlugin","temp","Power0","Power1","Power2","Power3","Power4","Quad","Cubic","Quart","Quint","Strong","Elastic","Back","Bounce","Sine","Expo","Circ","default"],"mappings":"AAAA,SAASA,sBAAT,CAAgCC,IAAhC,EAAsC;AAAE,MAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAE,UAAM,IAAIC,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOD,IAAP;AAAc;;AAEtK,SAASE,cAAT,CAAwBC,QAAxB,EAAkCC,UAAlC,EAA8C;AAAED,EAAAA,QAAQ,CAACE,SAAT,GAAqBC,MAAM,CAACC,MAAP,CAAcH,UAAU,CAACC,SAAzB,CAArB;AAA0DF,EAAAA,QAAQ,CAACE,SAAT,CAAmBG,WAAnB,GAAiCL,QAAjC;AAA2CA,EAAAA,QAAQ,CAACM,SAAT,GAAqBL,UAArB;AAAkC;AAEvL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AACA,IAAIM,OAAO,GAAG;AACZC,EAAAA,SAAS,EAAE,GADC;AAEZC,EAAAA,OAAO,EAAE,MAFG;AAGZC,EAAAA,cAAc,EAAE,CAHJ;AAIZC,EAAAA,KAAK,EAAE;AACLC,IAAAA,UAAU,EAAE;AADP;AAJK,CAAd;AAAA,IAQIC,SAAS,GAAG;AACdC,EAAAA,QAAQ,EAAE,EADI;AAEdC,EAAAA,SAAS,EAAE,KAFG;AAGdC,EAAAA,KAAK,EAAE;AAHO,CARhB;AAAA,IAaIC,mBAbJ;AAAA,IAcIC,OAAO,GAAG,GAdd;AAAA,IAeIC,QAAQ,GAAG,IAAID,OAfnB;AAAA,IAgBIE,IAAI,GAAGC,IAAI,CAACC,EAAL,GAAU,CAhBrB;AAAA,IAiBIC,QAAQ,GAAGH,IAAI,GAAG,CAjBtB;AAAA,IAkBII,KAAK,GAAG,CAlBZ;AAAA,IAmBIC,KAAK,GAAGJ,IAAI,CAACK,IAnBjB;AAAA,IAoBIC,IAAI,GAAGN,IAAI,CAACO,GApBhB;AAAA,IAqBIC,IAAI,GAAGR,IAAI,CAACS,GArBhB;AAAA,IAsBIC,SAAS,GAAG,SAASA,SAAT,CAAmBC,KAAnB,EAA0B;AACxC,SAAO,OAAOA,KAAP,KAAiB,QAAxB;AACD,CAxBD;AAAA,IAyBIC,WAAW,GAAG,SAASA,WAAT,CAAqBD,KAArB,EAA4B;AAC5C,SAAO,OAAOA,KAAP,KAAiB,UAAxB;AACD,CA3BD;AAAA,IA4BIE,SAAS,GAAG,SAASA,SAAT,CAAmBF,KAAnB,EAA0B;AACxC,SAAO,OAAOA,KAAP,KAAiB,QAAxB;AACD,CA9BD;AAAA,IA+BIG,YAAY,GAAG,SAASA,YAAT,CAAsBH,KAAtB,EAA6B;AAC9C,SAAO,OAAOA,KAAP,KAAiB,WAAxB;AACD,CAjCD;AAAA,IAkCII,SAAS,GAAG,SAASA,SAAT,CAAmBJ,KAAnB,EAA0B;AACxC,SAAO,OAAOA,KAAP,KAAiB,QAAxB;AACD,CApCD;AAAA,IAqCIK,WAAW,GAAG,SAASA,WAAT,CAAqBL,KAArB,EAA4B;AAC5C,SAAOA,KAAK,KAAK,KAAjB;AACD,CAvCD;AAAA,IAwCIM,aAAa,GAAG,SAASA,aAAT,GAAyB;AAC3C,SAAO,OAAOC,MAAP,KAAkB,WAAzB;AACD,CA1CD;AAAA,IA2CIC,eAAe,GAAG,SAASA,eAAT,CAAyBR,KAAzB,EAAgC;AACpD,SAAOC,WAAW,CAACD,KAAD,CAAX,IAAsBD,SAAS,CAACC,KAAD,CAAtC;AACD,CA7CD;AAAA,IA8CIS,aAAa,GAAG,OAAOC,WAAP,KAAuB,UAAvB,IAAqCA,WAAW,CAACC,MAAjD,IAA2D,YAAY,CAAE,CA9C7F;AAAA,IA+CI;AACJC,QAAQ,GAAGC,KAAK,CAACC,OAhDjB;AAAA,IAiDIC,aAAa,GAAG,mBAjDpB;AAAA,IAkDI;AACJC,OAAO,GAAG,kCAnDV;AAAA,IAoDI;AACJC,eAAe,GAAG,6BArDlB;AAAA,IAsDIC,oBAAoB,GAAG,kCAtD3B;AAAA,IAuDI;AACJC,OAAO,GAAG,eAxDV;AAAA,IAyDIC,kBAAkB,GAAG,iBAzDzB;AAAA,IA0DI;AACJC,QAAQ,GAAG,0BA3DX;AAAA,IA4DIC,eA5DJ;AAAA,IA6DIC,IA7DJ;AAAA,IA8DIC,YA9DJ;AAAA,IA+DIC,IA/DJ;AAAA,IAgEIC,QAAQ,GAAG,EAhEf;AAAA,IAiEIC,aAAa,GAAG,EAjEpB;AAAA,IAkEIC,UAlEJ;AAAA,IAmEIC,QAAQ,GAAG,SAASA,QAAT,CAAkBC,KAAlB,EAAyB;AACtC,SAAO,CAACH,aAAa,GAAGI,MAAM,CAACD,KAAD,EAAQJ,QAAR,CAAvB,KAA6CM,IAApD;AACD,CArED;AAAA,IAsEIC,cAAc,GAAG,SAASA,cAAT,CAAwBC,QAAxB,EAAkClC,KAAlC,EAAyC;AAC5D,SAAOmC,OAAO,CAACC,IAAR,CAAa,kBAAb,EAAiCF,QAAjC,EAA2C,QAA3C,EAAqDlC,KAArD,EAA4D,uCAA5D,CAAP;AACD,CAxED;AAAA,IAyEIqC,KAAK,GAAG,SAASA,KAAT,CAAeC,OAAf,EAAwBC,QAAxB,EAAkC;AAC5C,SAAO,CAACA,QAAD,IAAaJ,OAAO,CAACC,IAAR,CAAaE,OAAb,CAApB;AACD,CA3ED;AAAA,IA4EIE,UAAU,GAAG,SAASA,UAAT,CAAoBC,IAApB,EAA0BC,GAA1B,EAA+B;AAC9C,SAAOD,IAAI,KAAKf,QAAQ,CAACe,IAAD,CAAR,GAAiBC,GAAtB,CAAJ,IAAkCf,aAAlC,KAAoDA,aAAa,CAACc,IAAD,CAAb,GAAsBC,GAA1E,KAAkFhB,QAAzF;AACD,CA9ED;AAAA,IA+EIiB,UAAU,GAAG,SAASA,UAAT,GAAsB;AACrC,SAAO,CAAP;AACD,CAjFD;AAAA,IAkFIC,cAAc,GAAG,EAlFrB;AAAA,IAmFIC,WAAW,GAAG,EAnFlB;AAAA,IAoFIC,WAAW,GAAG,EApFlB;AAAA,IAqFIC,kBArFJ;AAAA,IAsFIC,QAAQ,GAAG,EAtFf;AAAA,IAuFIC,QAAQ,GAAG,EAvFf;AAAA,IAwFIC,YAAY,GAAG,EAxFnB;AAAA,IAyFIC,eAAe,GAAG,EAzFtB;AAAA,IA0FIC,cAAc,GAAG,EA1FrB;AAAA,IA2FIC,QAAQ,GAAG,SAASA,QAAT,CAAkBC,OAAlB,EAA2B;AACxC,MAAIC,MAAM,GAAGD,OAAO,CAAC,CAAD,CAApB;AAAA,MACIE,aADJ;AAAA,MAEIC,CAFJ;AAGArD,EAAAA,SAAS,CAACmD,MAAD,CAAT,IAAqBtD,WAAW,CAACsD,MAAD,CAAhC,KAA6CD,OAAO,GAAG,CAACA,OAAD,CAAvD;;AAEA,MAAI,EAAEE,aAAa,GAAG,CAACD,MAAM,CAACG,KAAP,IAAgB,EAAjB,EAAqBC,OAAvC,CAAJ,EAAqD;AACnD;AACAF,IAAAA,CAAC,GAAGN,eAAe,CAACS,MAApB;;AAEA,WAAOH,CAAC,MAAM,CAACN,eAAe,CAACM,CAAD,CAAf,CAAmBI,UAAnB,CAA8BN,MAA9B,CAAf,EAAsD,CAAE;;AAExDC,IAAAA,aAAa,GAAGL,eAAe,CAACM,CAAD,CAA/B;AACD;;AAEDA,EAAAA,CAAC,GAAGH,OAAO,CAACM,MAAZ;;AAEA,SAAOH,CAAC,EAAR,EAAY;AACVH,IAAAA,OAAO,CAACG,CAAD,CAAP,KAAeH,OAAO,CAACG,CAAD,CAAP,CAAWC,KAAX,KAAqBJ,OAAO,CAACG,CAAD,CAAP,CAAWC,KAAX,GAAmB,IAAII,OAAJ,CAAYR,OAAO,CAACG,CAAD,CAAnB,EAAwBD,aAAxB,CAAxC,CAAf,KAAmGF,OAAO,CAACS,MAAR,CAAeN,CAAf,EAAkB,CAAlB,CAAnG;AACD;;AAED,SAAOH,OAAP;AACD,CAjHD;AAAA,IAkHIU,SAAS,GAAG,SAASA,SAAT,CAAmBT,MAAnB,EAA2B;AACzC,SAAOA,MAAM,CAACG,KAAP,IAAgBL,QAAQ,CAACY,OAAO,CAACV,MAAD,CAAR,CAAR,CAA0B,CAA1B,EAA6BG,KAApD;AACD,CApHD;AAAA,IAqHIQ,YAAY,GAAG,SAASA,YAAT,CAAsBX,MAAtB,EAA8BrB,QAA9B,EAAwCiC,CAAxC,EAA2C;AAC5D,SAAO,CAACA,CAAC,GAAGZ,MAAM,CAACrB,QAAD,CAAX,KAA0BjC,WAAW,CAACkE,CAAD,CAArC,GAA2CZ,MAAM,CAACrB,QAAD,CAAN,EAA3C,GAAgE/B,YAAY,CAACgE,CAAD,CAAZ,IAAmBZ,MAAM,CAACa,YAA1B,IAA0Cb,MAAM,CAACa,YAAP,CAAoBlC,QAApB,CAA1C,IAA2EiC,CAAlJ;AACD,CAvHD;AAAA,IAwHIE,YAAY,GAAG,SAASA,YAAT,CAAsBC,KAAtB,EAA6BC,IAA7B,EAAmC;AACpD,SAAO,CAACD,KAAK,GAAGA,KAAK,CAACE,KAAN,CAAY,GAAZ,CAAT,EAA2BC,OAA3B,CAAmCF,IAAnC,KAA4CD,KAAnD;AACD,CA1HD;AAAA,IA2HI;AACJI,MAAM,GAAG,SAASA,MAAT,CAAgB1E,KAAhB,EAAuB;AAC9B,SAAOX,IAAI,CAACsF,KAAL,CAAW3E,KAAK,GAAG,MAAnB,IAA6B,MAA7B,IAAuC,CAA9C;AACD,CA9HD;AAAA,IA+HI4E,aAAa,GAAG,SAASA,aAAT,CAAuB5E,KAAvB,EAA8B;AAChD,SAAOX,IAAI,CAACsF,KAAL,CAAW3E,KAAK,GAAG,QAAnB,IAA+B,QAA/B,IAA2C,CAAlD;AACD,CAjID;AAAA,IAkII;AACJ6E,iBAAiB,GAAG,SAASA,iBAAT,CAA2BC,QAA3B,EAAqCC,MAArC,EAA6C;AAC/D;AACA,MAAIC,CAAC,GAAGD,MAAM,CAACnB,MAAf;AAAA,MACIH,CAAC,GAAG,CADR;;AAGA,SAAOqB,QAAQ,CAACG,OAAT,CAAiBF,MAAM,CAACtB,CAAD,CAAvB,IAA8B,CAA9B,IAAmC,EAAEA,CAAF,GAAMuB,CAAhD,GAAoD,CAAE;;AAEtD,SAAOvB,CAAC,GAAGuB,CAAX;AACD,CA3ID;AAAA,IA4IIE,WAAW,GAAG,SAASA,WAAT,GAAuB;AACvC,MAAIF,CAAC,GAAGnC,WAAW,CAACe,MAApB;AAAA,MACIuB,CAAC,GAAGtC,WAAW,CAACuC,KAAZ,CAAkB,CAAlB,CADR;AAAA,MAEI3B,CAFJ;AAAA,MAGI4B,KAHJ;;AAKAvC,EAAAA,WAAW,GAAG,EAAd;AACAD,EAAAA,WAAW,CAACe,MAAZ,GAAqB,CAArB;;AAEA,OAAKH,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGuB,CAAhB,EAAmBvB,CAAC,EAApB,EAAwB;AACtB4B,IAAAA,KAAK,GAAGF,CAAC,CAAC1B,CAAD,CAAT;AACA4B,IAAAA,KAAK,IAAIA,KAAK,CAACC,KAAf,KAAyBD,KAAK,CAACE,MAAN,CAAaF,KAAK,CAACC,KAAN,CAAY,CAAZ,CAAb,EAA6BD,KAAK,CAACC,KAAN,CAAY,CAAZ,CAA7B,EAA6C,IAA7C,EAAmDA,KAAnD,GAA2D,CAApF;AACD;AACF,CAzJD;AAAA,IA0JIE,eAAe,GAAG,SAASA,eAAT,CAAyBC,SAAzB,EAAoCC,IAApC,EAA0CC,cAA1C,EAA0DC,KAA1D,EAAiE;AACrF/C,EAAAA,WAAW,CAACe,MAAZ,IAAsBsB,WAAW,EAAjC;AACAO,EAAAA,SAAS,CAACF,MAAV,CAAiBG,IAAjB,EAAuBC,cAAvB,EAAuCC,KAAvC;AACA/C,EAAAA,WAAW,CAACe,MAAZ,IAAsBsB,WAAW,EAAjC,CAHqF,CAGhD;AACtC,CA9JD;AAAA,IA+JIW,kBAAkB,GAAG,SAASA,kBAAT,CAA4B7F,KAA5B,EAAmC;AAC1D,MAAI8F,CAAC,GAAGC,UAAU,CAAC/F,KAAD,CAAlB;AACA,SAAO,CAAC8F,CAAC,IAAIA,CAAC,KAAK,CAAZ,KAAkB,CAAC9F,KAAK,GAAG,EAAT,EAAagG,KAAb,CAAmB5E,kBAAnB,EAAuCwC,MAAvC,GAAgD,CAAlE,GAAsEkC,CAAtE,GAA0E/F,SAAS,CAACC,KAAD,CAAT,GAAmBA,KAAK,CAACiG,IAAN,EAAnB,GAAkCjG,KAAnH;AACD,CAlKD;AAAA,IAmKIkG,YAAY,GAAG,SAASA,YAAT,CAAsBC,CAAtB,EAAyB;AAC1C,SAAOA,CAAP;AACD,CArKD;AAAA,IAsKIC,YAAY,GAAG,SAASA,YAAT,CAAsB1D,GAAtB,EAA2B2D,QAA3B,EAAqC;AACtD,OAAK,IAAIF,CAAT,IAAcE,QAAd,EAAwB;AACtBF,IAAAA,CAAC,IAAIzD,GAAL,KAAaA,GAAG,CAACyD,CAAD,CAAH,GAASE,QAAQ,CAACF,CAAD,CAA9B;AACD;;AAED,SAAOzD,GAAP;AACD,CA5KD;AAAA,IA6KI4D,oBAAoB,GAAG,SAASA,oBAAT,CAA8BC,eAA9B,EAA+C;AACxE,SAAO,UAAU7D,GAAV,EAAe2D,QAAf,EAAyB;AAC9B,SAAK,IAAIF,CAAT,IAAcE,QAAd,EAAwB;AACtBF,MAAAA,CAAC,IAAIzD,GAAL,IAAYyD,CAAC,KAAK,UAAN,IAAoBI,eAAhC,IAAmDJ,CAAC,KAAK,MAAzD,KAAoEzD,GAAG,CAACyD,CAAD,CAAH,GAASE,QAAQ,CAACF,CAAD,CAArF;AACD;AACF,GAJD;AAKD,CAnLD;AAAA,IAoLIpE,MAAM,GAAG,SAASA,MAAT,CAAgByE,IAAhB,EAAsBC,OAAtB,EAA+B;AAC1C,OAAK,IAAIN,CAAT,IAAcM,OAAd,EAAuB;AACrBD,IAAAA,IAAI,CAACL,CAAD,CAAJ,GAAUM,OAAO,CAACN,CAAD,CAAjB;AACD;;AAED,SAAOK,IAAP;AACD,CA1LD;AAAA,IA2LIE,UAAU,GAAG,SAASA,UAAT,CAAoBF,IAApB,EAA0BC,OAA1B,EAAmC;AAClD,OAAK,IAAIN,CAAT,IAAcM,OAAd,EAAuB;AACrBN,IAAAA,CAAC,KAAK,WAAN,IAAqBA,CAAC,KAAK,aAA3B,IAA4CA,CAAC,KAAK,WAAlD,KAAkEK,IAAI,CAACL,CAAD,CAAJ,GAAU/F,SAAS,CAACqG,OAAO,CAACN,CAAD,CAAR,CAAT,GAAwBO,UAAU,CAACF,IAAI,CAACL,CAAD,CAAJ,KAAYK,IAAI,CAACL,CAAD,CAAJ,GAAU,EAAtB,CAAD,EAA4BM,OAAO,CAACN,CAAD,CAAnC,CAAlC,GAA4EM,OAAO,CAACN,CAAD,CAA/J;AACD;;AAED,SAAOK,IAAP;AACD,CAjMD;AAAA,IAkMIG,cAAc,GAAG,SAASA,cAAT,CAAwBjE,GAAxB,EAA6BkE,SAA7B,EAAwC;AAC3D,MAAIC,IAAI,GAAG,EAAX;AAAA,MACIV,CADJ;;AAGA,OAAKA,CAAL,IAAUzD,GAAV,EAAe;AACbyD,IAAAA,CAAC,IAAIS,SAAL,KAAmBC,IAAI,CAACV,CAAD,CAAJ,GAAUzD,GAAG,CAACyD,CAAD,CAAhC;AACD;;AAED,SAAOU,IAAP;AACD,CA3MD;AAAA,IA4MIC,gBAAgB,GAAG,SAASA,gBAAT,CAA0BC,IAA1B,EAAgC;AACrD,MAAIC,MAAM,GAAGD,IAAI,CAACC,MAAL,IAAe1F,eAA5B;AAAA,MACIiD,IAAI,GAAGwC,IAAI,CAACE,SAAL,GAAiBX,oBAAoB,CAAC1F,QAAQ,CAACmG,IAAI,CAACE,SAAN,CAAT,CAArC,GAAkEb,YAD7E;;AAGA,MAAI/F,WAAW,CAAC0G,IAAI,CAACG,OAAN,CAAf,EAA+B;AAC7B,WAAOF,MAAP,EAAe;AACbzC,MAAAA,IAAI,CAACwC,IAAD,EAAOC,MAAM,CAACD,IAAP,CAAYV,QAAnB,CAAJ;AACAW,MAAAA,MAAM,GAAGA,MAAM,CAACA,MAAP,IAAiBA,MAAM,CAACG,GAAjC;AACD;AACF;;AAED,SAAOJ,IAAP;AACD,CAxND;AAAA,IAyNIK,YAAY,GAAG,SAASA,YAAT,CAAsBC,EAAtB,EAA0BC,EAA1B,EAA8B;AAC/C,MAAI7D,CAAC,GAAG4D,EAAE,CAACzD,MAAX;AAAA,MACIoC,KAAK,GAAGvC,CAAC,KAAK6D,EAAE,CAAC1D,MADrB;;AAGA,SAAOoC,KAAK,IAAIvC,CAAC,EAAV,IAAgB4D,EAAE,CAAC5D,CAAD,CAAF,KAAU6D,EAAE,CAAC7D,CAAD,CAAnC,EAAwC,CAAE;;AAE1C,SAAOA,CAAC,GAAG,CAAX;AACD,CAhOD;AAAA,IAiOI8D,kBAAkB,GAAG,SAASA,kBAAT,CAA4BP,MAA5B,EAAoCQ,KAApC,EAA2CC,SAA3C,EAAsDC,QAAtD,EAAgEC,MAAhE,EAAwE;AAC/F,MAAIF,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,IAAAA,SAAS,GAAG,QAAZ;AACD;;AAED,MAAIC,QAAQ,KAAK,KAAK,CAAtB,EAAyB;AACvBA,IAAAA,QAAQ,GAAG,OAAX;AACD;;AAED,MAAIE,IAAI,GAAGZ,MAAM,CAACU,QAAD,CAAjB;AAAA,MACIG,CADJ;;AAGA,MAAIF,MAAJ,EAAY;AACVE,IAAAA,CAAC,GAAGL,KAAK,CAACG,MAAD,CAAT;;AAEA,WAAOC,IAAI,IAAIA,IAAI,CAACD,MAAD,CAAJ,GAAeE,CAA9B,EAAiC;AAC/BD,MAAAA,IAAI,GAAGA,IAAI,CAACE,KAAZ;AACD;AACF;;AAED,MAAIF,IAAJ,EAAU;AACRJ,IAAAA,KAAK,CAACO,KAAN,GAAcH,IAAI,CAACG,KAAnB;AACAH,IAAAA,IAAI,CAACG,KAAL,GAAaP,KAAb;AACD,GAHD,MAGO;AACLA,IAAAA,KAAK,CAACO,KAAN,GAAcf,MAAM,CAACS,SAAD,CAApB;AACAT,IAAAA,MAAM,CAACS,SAAD,CAAN,GAAoBD,KAApB;AACD;;AAED,MAAIA,KAAK,CAACO,KAAV,EAAiB;AACfP,IAAAA,KAAK,CAACO,KAAN,CAAYD,KAAZ,GAAoBN,KAApB;AACD,GAFD,MAEO;AACLR,IAAAA,MAAM,CAACU,QAAD,CAAN,GAAmBF,KAAnB;AACD;;AAEDA,EAAAA,KAAK,CAACM,KAAN,GAAcF,IAAd;AACAJ,EAAAA,KAAK,CAACR,MAAN,GAAeQ,KAAK,CAACL,GAAN,GAAYH,MAA3B;AACA,SAAOQ,KAAP;AACD,CAtQD;AAAA,IAuQIQ,qBAAqB,GAAG,SAASA,qBAAT,CAA+BhB,MAA/B,EAAuCQ,KAAvC,EAA8CC,SAA9C,EAAyDC,QAAzD,EAAmE;AAC7F,MAAID,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,IAAAA,SAAS,GAAG,QAAZ;AACD;;AAED,MAAIC,QAAQ,KAAK,KAAK,CAAtB,EAAyB;AACvBA,IAAAA,QAAQ,GAAG,OAAX;AACD;;AAED,MAAIE,IAAI,GAAGJ,KAAK,CAACM,KAAjB;AAAA,MACIG,IAAI,GAAGT,KAAK,CAACO,KADjB;;AAGA,MAAIH,IAAJ,EAAU;AACRA,IAAAA,IAAI,CAACG,KAAL,GAAaE,IAAb;AACD,GAFD,MAEO,IAAIjB,MAAM,CAACS,SAAD,CAAN,KAAsBD,KAA1B,EAAiC;AACtCR,IAAAA,MAAM,CAACS,SAAD,CAAN,GAAoBQ,IAApB;AACD;;AAED,MAAIA,IAAJ,EAAU;AACRA,IAAAA,IAAI,CAACH,KAAL,GAAaF,IAAb;AACD,GAFD,MAEO,IAAIZ,MAAM,CAACU,QAAD,CAAN,KAAqBF,KAAzB,EAAgC;AACrCR,IAAAA,MAAM,CAACU,QAAD,CAAN,GAAmBE,IAAnB;AACD;;AAEDJ,EAAAA,KAAK,CAACO,KAAN,GAAcP,KAAK,CAACM,KAAN,GAAcN,KAAK,CAACR,MAAN,GAAe,IAA3C,CAxB6F,CAwB5C;AAClD,CAhSD;AAAA,IAiSIkB,iBAAiB,GAAG,SAASA,iBAAT,CAA2BV,KAA3B,EAAkCW,yBAAlC,EAA6D;AACnFX,EAAAA,KAAK,CAACR,MAAN,KAAiB,CAACmB,yBAAD,IAA8BX,KAAK,CAACR,MAAN,CAAaoB,kBAA5D,KAAmFZ,KAAK,CAACR,MAAN,CAAaqB,MAAb,CAAoBb,KAApB,CAAnF;AACAA,EAAAA,KAAK,CAACc,IAAN,GAAa,CAAb;AACD,CApSD;AAAA,IAqSIC,QAAQ,GAAG,SAASA,QAAT,CAAkB9C,SAAlB,EAA6B+B,KAA7B,EAAoC;AACjD,MAAI/B,SAAS,KAAK,CAAC+B,KAAD,IAAUA,KAAK,CAACgB,IAAN,GAAa/C,SAAS,CAACgD,IAAjC,IAAyCjB,KAAK,CAACkB,MAAN,GAAe,CAA7D,CAAb,EAA8E;AAC5E;AACA,QAAIvD,CAAC,GAAGM,SAAR;;AAEA,WAAON,CAAP,EAAU;AACRA,MAAAA,CAAC,CAACwD,MAAF,GAAW,CAAX;AACAxD,MAAAA,CAAC,GAAGA,CAAC,CAAC6B,MAAN;AACD;AACF;;AAED,SAAOvB,SAAP;AACD,CAjTD;AAAA,IAkTImD,iBAAiB,GAAG,SAASA,iBAAT,CAA2BnD,SAA3B,EAAsC;AAC5D,MAAIuB,MAAM,GAAGvB,SAAS,CAACuB,MAAvB;;AAEA,SAAOA,MAAM,IAAIA,MAAM,CAACA,MAAxB,EAAgC;AAC9B;AACAA,IAAAA,MAAM,CAAC2B,MAAP,GAAgB,CAAhB;AACA3B,IAAAA,MAAM,CAAC6B,aAAP;AACA7B,IAAAA,MAAM,GAAGA,MAAM,CAACA,MAAhB;AACD;;AAED,SAAOvB,SAAP;AACD,CA7TD;AAAA,IA8TIqD,qBAAqB,GAAG,SAASA,qBAAT,CAA+BrD,SAA/B,EAA0C;AACpE,SAAO,CAACA,SAAD,IAAcA,SAAS,CAACsD,GAAV,IAAiBD,qBAAqB,CAACrD,SAAS,CAACuB,MAAX,CAA3D;AACD,CAhUD;AAAA,IAiUIgC,qBAAqB,GAAG,SAASA,qBAAT,CAA+BvD,SAA/B,EAA0C;AACpE,SAAOA,SAAS,CAACwD,OAAV,GAAoBC,eAAe,CAACzD,SAAS,CAAC0D,MAAX,EAAmB1D,SAAS,GAAGA,SAAS,CAAC3G,QAAV,KAAuB2G,SAAS,CAAC2D,OAAhE,CAAf,GAA0F3D,SAA9G,GAA0H,CAAjI;AACD,CAnUD;AAAA,IAoUI;AACJyD,eAAe,GAAG,SAASA,eAAT,CAAyBG,KAAzB,EAAgCC,aAAhC,EAA+C;AAC/D,MAAIC,KAAK,GAAGlK,IAAI,CAACmK,KAAL,CAAWH,KAAK,IAAIC,aAApB,CAAZ;AACA,SAAOD,KAAK,IAAIE,KAAK,KAAKF,KAAnB,GAA2BE,KAAK,GAAG,CAAnC,GAAuCA,KAA9C;AACD,CAxUD;AAAA,IAyUIE,uBAAuB,GAAG,SAASA,uBAAT,CAAiCC,UAAjC,EAA6ClC,KAA7C,EAAoD;AAChF,SAAO,CAACkC,UAAU,GAAGlC,KAAK,CAACkB,MAApB,IAA8BlB,KAAK,CAACuB,GAApC,IAA2CvB,KAAK,CAACuB,GAAN,IAAa,CAAb,GAAiB,CAAjB,GAAqBvB,KAAK,CAACmB,MAAN,GAAenB,KAAK,CAACqB,aAAN,EAAf,GAAuCrB,KAAK,CAACmC,KAA7G,CAAP;AACD,CA3UD;AAAA,IA4UIC,OAAO,GAAG,SAASA,OAAT,CAAiBnE,SAAjB,EAA4B;AACxC,SAAOA,SAAS,CAAC+C,IAAV,GAAiB5D,aAAa,CAACa,SAAS,CAACiD,MAAV,IAAoBjD,SAAS,CAACkE,KAAV,GAAkBtK,IAAI,CAACwK,GAAL,CAASpE,SAAS,CAACsD,GAAV,IAAiBtD,SAAS,CAACqE,IAA3B,IAAmC3K,QAA5C,CAAlB,IAA2E,CAA/F,CAAD,CAArC;AACD,CA9UD;AAAA,IA+UI4K,cAAc,GAAG,SAASA,cAAT,CAAwBtE,SAAxB,EAAmCuE,SAAnC,EAA8C;AACjE;AACA,MAAIhD,MAAM,GAAGvB,SAAS,CAAC0B,GAAvB;;AAEA,MAAIH,MAAM,IAAIA,MAAM,CAACiD,iBAAjB,IAAsCxE,SAAS,CAACsD,GAApD,EAAyD;AACvDtD,IAAAA,SAAS,CAACiD,MAAV,GAAmB9D,aAAa,CAACoC,MAAM,CAACkD,KAAP,IAAgBzE,SAAS,CAACsD,GAAV,GAAgB,CAAhB,GAAoBiB,SAAS,GAAGvE,SAAS,CAACsD,GAA1C,GAAgD,CAAC,CAACtD,SAAS,CAACkD,MAAV,GAAmBlD,SAAS,CAACoD,aAAV,EAAnB,GAA+CpD,SAAS,CAACkE,KAA1D,IAAmEK,SAApE,IAAiF,CAACvE,SAAS,CAACsD,GAA5J,CAAD,CAAhC;;AAEAa,IAAAA,OAAO,CAACnE,SAAD,CAAP;;AAEAuB,IAAAA,MAAM,CAAC2B,MAAP,IAAiBJ,QAAQ,CAACvB,MAAD,EAASvB,SAAT,CAAzB,CALuD,CAKT;AAC/C;;AAED,SAAOA,SAAP;AACD,CA5VD;;AA8VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA0E,cAAc,GAAG,SAASA,cAAT,CAAwBC,QAAxB,EAAkC5C,KAAlC,EAAyC;AACxD,MAAIK,CAAJ;;AAEA,MAAIL,KAAK,CAAC0C,KAAN,IAAe1C,KAAK,CAAC6C,QAAN,IAAkB,CAAC7C,KAAK,CAACiB,IAA5C,EAAkD;AAChD;AACAZ,IAAAA,CAAC,GAAG4B,uBAAuB,CAACW,QAAQ,CAACE,OAAT,EAAD,EAAqB9C,KAArB,CAA3B;;AAEA,QAAI,CAACA,KAAK,CAACiB,IAAP,IAAe8B,MAAM,CAAC,CAAD,EAAI/C,KAAK,CAACqB,aAAN,EAAJ,EAA2BhB,CAA3B,CAAN,GAAsCL,KAAK,CAAC2B,MAA5C,GAAqDhK,QAAxE,EAAkF;AAChFqI,MAAAA,KAAK,CAACjC,MAAN,CAAasC,CAAb,EAAgB,IAAhB;AACD;AACF,GAVuD,CAUtD;;;AAGF,MAAIU,QAAQ,CAAC6B,QAAD,EAAW5C,KAAX,CAAR,CAA0BL,GAA1B,IAAiCiD,QAAQ,CAACC,QAA1C,IAAsDD,QAAQ,CAACF,KAAT,IAAkBE,QAAQ,CAAC3B,IAAjF,IAAyF2B,QAAQ,CAACrB,GAAtG,EAA2G;AACzG;AACA,QAAIqB,QAAQ,CAAC3B,IAAT,GAAgB2B,QAAQ,CAACtL,QAAT,EAApB,EAAyC;AACvC+I,MAAAA,CAAC,GAAGuC,QAAJ;;AAEA,aAAOvC,CAAC,CAACV,GAAT,EAAc;AACZU,QAAAA,CAAC,CAACyC,OAAF,MAAe,CAAf,IAAoBzC,CAAC,CAACmC,SAAF,CAAYnC,CAAC,CAACsB,MAAd,CAApB,CADY,CAC+B;;AAE3CtB,QAAAA,CAAC,GAAGA,CAAC,CAACV,GAAN;AACD;AACF;;AAEDiD,IAAAA,QAAQ,CAACI,MAAT,GAAkB,CAACrL,QAAnB,CAZyG,CAY5E;AAC9B;AACF,CAnYD;AAAA,IAoYIsL,cAAc,GAAG,SAASA,cAAT,CAAwBL,QAAxB,EAAkC5C,KAAlC,EAAyCkD,QAAzC,EAAmDC,UAAnD,EAA+D;AAClFnD,EAAAA,KAAK,CAACR,MAAN,IAAgBkB,iBAAiB,CAACV,KAAD,CAAjC;AACAA,EAAAA,KAAK,CAACkB,MAAN,GAAe9D,aAAa,CAAC,CAAC1E,SAAS,CAACwK,QAAD,CAAT,GAAsBA,QAAtB,GAAiCA,QAAQ,IAAIN,QAAQ,KAAK9I,eAAzB,GAA2CsJ,cAAc,CAACR,QAAD,EAAWM,QAAX,EAAqBlD,KAArB,CAAzD,GAAuF4C,QAAQ,CAACF,KAAlI,IAA2I1C,KAAK,CAACqD,MAAlJ,CAA5B;AACArD,EAAAA,KAAK,CAACgB,IAAN,GAAa5D,aAAa,CAAC4C,KAAK,CAACkB,MAAN,IAAgBlB,KAAK,CAACqB,aAAN,KAAwBxJ,IAAI,CAACwK,GAAL,CAASrC,KAAK,CAACsD,SAAN,EAAT,CAAxB,IAAuD,CAAvE,CAAD,CAA1B;;AAEAvD,EAAAA,kBAAkB,CAAC6C,QAAD,EAAW5C,KAAX,EAAkB,QAAlB,EAA4B,OAA5B,EAAqC4C,QAAQ,CAACW,KAAT,GAAiB,QAAjB,GAA4B,CAAjE,CAAlB;;AAEAC,EAAAA,kBAAkB,CAACxD,KAAD,CAAlB,KAA8B4C,QAAQ,CAACa,OAAT,GAAmBzD,KAAjD;AACAmD,EAAAA,UAAU,IAAIR,cAAc,CAACC,QAAD,EAAW5C,KAAX,CAA5B;AACA,SAAO4C,QAAP;AACD,CA9YD;AAAA,IA+YIc,cAAc,GAAG,SAASA,cAAT,CAAwBzF,SAAxB,EAAmC0F,OAAnC,EAA4C;AAC/D,SAAO,CAACzJ,QAAQ,CAAC0J,aAAT,IAA0BnJ,cAAc,CAAC,eAAD,EAAkBkJ,OAAlB,CAAzC,KAAwEzJ,QAAQ,CAAC0J,aAAT,CAAuBhN,MAAvB,CAA8B+M,OAA9B,EAAuC1F,SAAvC,CAA/E;AACD,CAjZD;AAAA,IAkZI4F,iBAAiB,GAAG,SAASA,iBAAT,CAA2BhG,KAA3B,EAAkC2E,SAAlC,EAA6CpE,KAA7C,EAAoDD,cAApD,EAAoE;AAC1F2F,EAAAA,UAAU,CAACjG,KAAD,EAAQ2E,SAAR,CAAV;;AAEA,MAAI,CAAC3E,KAAK,CAACgF,QAAX,EAAqB;AACnB,WAAO,CAAP;AACD;;AAED,MAAI,CAACzE,KAAD,IAAUP,KAAK,CAACkG,GAAhB,KAAwBlG,KAAK,CAACoD,IAAN,IAAcpD,KAAK,CAAC0B,IAAN,CAAWyE,IAAX,KAAoB,KAAlC,IAA2C,CAACnG,KAAK,CAACoD,IAAP,IAAepD,KAAK,CAAC0B,IAAN,CAAWyE,IAA7F,KAAsGzI,kBAAkB,KAAK0I,OAAO,CAACC,KAAzI,EAAgJ;AAC9I7I,IAAAA,WAAW,CAAC8I,IAAZ,CAAiBtG,KAAjB;;AAEAA,IAAAA,KAAK,CAACC,KAAN,GAAc,CAAC0E,SAAD,EAAYrE,cAAZ,CAAd;AACA,WAAO,CAAP;AACD;AACF,CA/ZD;AAAA,IAgaIiG,4BAA4B,GAAG,SAASA,4BAAT,CAAsCC,IAAtC,EAA4C;AAC7E,MAAI7E,MAAM,GAAG6E,IAAI,CAAC7E,MAAlB;AACA,SAAOA,MAAM,IAAIA,MAAM,CAAC+B,GAAjB,IAAwB/B,MAAM,CAACqD,QAA/B,IAA2C,CAACrD,MAAM,CAAC8E,KAAnD,KAA6D9E,MAAM,CAACsD,OAAP,KAAmB,CAAnB,IAAwBsB,4BAA4B,CAAC5E,MAAD,CAAjH,CAAP;AACD,CAnaD;AAAA,IAoaI;AACJgE,kBAAkB,GAAG,SAASA,kBAAT,CAA4Be,KAA5B,EAAmC;AACtD,MAAIC,IAAI,GAAGD,KAAK,CAACC,IAAjB;AACA,SAAOA,IAAI,KAAK,aAAT,IAA0BA,IAAI,KAAK,SAA1C;AACD,CAxaD;AAAA,IAyaIC,wBAAwB,GAAG,SAASA,wBAAT,CAAkC5G,KAAlC,EAAyC2E,SAAzC,EAAoDrE,cAApD,EAAoEC,KAApE,EAA2E;AACxG,MAAIsG,SAAS,GAAG7G,KAAK,CAAC8G,KAAtB;AAAA,MACIA,KAAK,GAAGnC,SAAS,GAAG,CAAZ,IAAiB,CAACA,SAAD,KAAe,CAAC3E,KAAK,CAACqD,MAAP,IAAiBkD,4BAA4B,CAACvG,KAAD,CAA7C,IAAwD,EAAE,CAACA,KAAK,CAACgF,QAAP,IAAmBW,kBAAkB,CAAC3F,KAAD,CAAvC,CAAxD,IAA2G,CAACA,KAAK,CAAC0D,GAAN,GAAY,CAAZ,IAAiB1D,KAAK,CAAC8B,GAAN,CAAU4B,GAAV,GAAgB,CAAlC,KAAwC,CAACiC,kBAAkB,CAAC3F,KAAD,CAArL,CAAjB,GAAiN,CAAjN,GAAqN,CADjO;AAAA,MAEI;AACJ+G,EAAAA,WAAW,GAAG/G,KAAK,CAAC+D,OAHpB;AAAA,MAIIC,KAAK,GAAG,CAJZ;AAAA,MAKIgD,EALJ;AAAA,MAMIC,SANJ;AAAA,MAOIC,aAPJ;;AASA,MAAIH,WAAW,IAAI/G,KAAK,CAAC4D,OAAzB,EAAkC;AAChC;AACAI,IAAAA,KAAK,GAAGkB,MAAM,CAAC,CAAD,EAAIlF,KAAK,CAACsE,KAAV,EAAiBK,SAAjB,CAAd;AACAsC,IAAAA,SAAS,GAAGpD,eAAe,CAACG,KAAD,EAAQ+C,WAAR,CAA3B;AACA/G,IAAAA,KAAK,CAACmH,KAAN,IAAeF,SAAS,GAAG,CAA3B,KAAiCH,KAAK,GAAG,IAAIA,KAA7C;;AAEA,QAAIG,SAAS,KAAKpD,eAAe,CAAC7D,KAAK,CAAC8D,MAAP,EAAeiD,WAAf,CAAjC,EAA8D;AAC5D;AACAF,MAAAA,SAAS,GAAG,IAAIC,KAAhB;AACA9G,MAAAA,KAAK,CAAC0B,IAAN,CAAW0F,aAAX,IAA4BpH,KAAK,CAACgF,QAAlC,IAA8ChF,KAAK,CAACqH,UAAN,EAA9C;AACD;AACF;;AAED,MAAIP,KAAK,KAAKD,SAAV,IAAuBtG,KAAvB,IAAgCP,KAAK,CAACmF,MAAN,KAAiBrL,QAAjD,IAA6D,CAAC6K,SAAD,IAAc3E,KAAK,CAACmF,MAArF,EAA6F;AAC3F,QAAI,CAACnF,KAAK,CAACgF,QAAP,IAAmBgB,iBAAiB,CAAChG,KAAD,EAAQ2E,SAAR,EAAmBpE,KAAnB,EAA0BD,cAA1B,CAAxC,EAAmF;AACjF;AACA;AACD;;AAED4G,IAAAA,aAAa,GAAGlH,KAAK,CAACmF,MAAtB;AACAnF,IAAAA,KAAK,CAACmF,MAAN,GAAeR,SAAS,KAAKrE,cAAc,GAAGxG,QAAH,GAAc,CAAjC,CAAxB,CAP2F,CAO9B;;AAE7DwG,IAAAA,cAAc,KAAKA,cAAc,GAAGqE,SAAS,IAAI,CAACuC,aAApC,CAAd,CAT2F,CASzB;;AAElElH,IAAAA,KAAK,CAAC8G,KAAN,GAAcA,KAAd;AACA9G,IAAAA,KAAK,CAACsH,KAAN,KAAgBR,KAAK,GAAG,IAAIA,KAA5B;AACA9G,IAAAA,KAAK,CAAC6E,KAAN,GAAc,CAAd;AACA7E,IAAAA,KAAK,CAAC8D,MAAN,GAAeE,KAAf;AACAgD,IAAAA,EAAE,GAAGhH,KAAK,CAACkG,GAAX;;AAEA,WAAOc,EAAP,EAAW;AACTA,MAAAA,EAAE,CAACO,CAAH,CAAKT,KAAL,EAAYE,EAAE,CAACQ,CAAf;AACAR,MAAAA,EAAE,GAAGA,EAAE,CAACtE,KAAR;AACD;;AAED1C,IAAAA,KAAK,CAACyH,QAAN,IAAkB9C,SAAS,GAAG,CAA9B,IAAmC3E,KAAK,CAACyH,QAAN,CAAevH,MAAf,CAAsByE,SAAtB,EAAiC,IAAjC,EAAuC,IAAvC,CAAnC;AACA3E,IAAAA,KAAK,CAAC0H,SAAN,IAAmB,CAACpH,cAApB,IAAsCqH,SAAS,CAAC3H,KAAD,EAAQ,UAAR,CAA/C;AACAgE,IAAAA,KAAK,IAAIhE,KAAK,CAAC4D,OAAf,IAA0B,CAACtD,cAA3B,IAA6CN,KAAK,CAAC2B,MAAnD,IAA6DgG,SAAS,CAAC3H,KAAD,EAAQ,UAAR,CAAtE;;AAEA,QAAI,CAAC2E,SAAS,IAAI3E,KAAK,CAACsE,KAAnB,IAA4BK,SAAS,GAAG,CAAzC,KAA+C3E,KAAK,CAAC8G,KAAN,KAAgBA,KAAnE,EAA0E;AACxEA,MAAAA,KAAK,IAAIjE,iBAAiB,CAAC7C,KAAD,EAAQ,CAAR,CAA1B;;AAEA,UAAI,CAACM,cAAL,EAAqB;AACnBqH,QAAAA,SAAS,CAAC3H,KAAD,EAAQ8G,KAAK,GAAG,YAAH,GAAkB,mBAA/B,EAAoD,IAApD,CAAT;;AAEA9G,QAAAA,KAAK,CAAC4H,KAAN,IAAe5H,KAAK,CAAC4H,KAAN,EAAf;AACD;AACF;AACF,GAnCD,MAmCO,IAAI,CAAC5H,KAAK,CAACmF,MAAX,EAAmB;AACxBnF,IAAAA,KAAK,CAACmF,MAAN,GAAeR,SAAf;AACD;AACF,CAteD;AAAA,IAueIkD,mBAAmB,GAAG,SAASA,mBAAT,CAA6BzH,SAA7B,EAAwC0H,QAAxC,EAAkDzH,IAAlD,EAAwD;AAChF,MAAI8B,KAAJ;;AAEA,MAAI9B,IAAI,GAAGyH,QAAX,EAAqB;AACnB3F,IAAAA,KAAK,GAAG/B,SAAS,CAAC2H,MAAlB;;AAEA,WAAO5F,KAAK,IAAIA,KAAK,CAACkB,MAAN,IAAgBhD,IAAhC,EAAsC;AACpC,UAAI8B,KAAK,CAACwE,IAAN,KAAe,SAAf,IAA4BxE,KAAK,CAACkB,MAAN,GAAeyE,QAA/C,EAAyD;AACvD,eAAO3F,KAAP;AACD;;AAEDA,MAAAA,KAAK,GAAGA,KAAK,CAACO,KAAd;AACD;AACF,GAVD,MAUO;AACLP,IAAAA,KAAK,GAAG/B,SAAS,CAAC4H,KAAlB;;AAEA,WAAO7F,KAAK,IAAIA,KAAK,CAACkB,MAAN,IAAgBhD,IAAhC,EAAsC;AACpC,UAAI8B,KAAK,CAACwE,IAAN,KAAe,SAAf,IAA4BxE,KAAK,CAACkB,MAAN,GAAeyE,QAA/C,EAAyD;AACvD,eAAO3F,KAAP;AACD;;AAEDA,MAAAA,KAAK,GAAGA,KAAK,CAACM,KAAd;AACD;AACF;AACF,CA/fD;AAAA,IAggBIwF,YAAY,GAAG,SAASA,YAAT,CAAsB7H,SAAtB,EAAiC3G,QAAjC,EAA2CyO,WAA3C,EAAwDC,aAAxD,EAAuE;AACxF,MAAIC,MAAM,GAAGhI,SAAS,CAACwD,OAAvB;AAAA,MACIyE,GAAG,GAAG9I,aAAa,CAAC9F,QAAD,CAAb,IAA2B,CADrC;AAAA,MAEI6O,aAAa,GAAGlI,SAAS,CAAC0D,MAAV,GAAmB1D,SAAS,CAACkE,KAFjD;AAGAgE,EAAAA,aAAa,IAAI,CAACH,aAAlB,KAAoC/H,SAAS,CAACyE,KAAV,IAAmBwD,GAAG,GAAGjI,SAAS,CAACgD,IAAvE;AACAhD,EAAAA,SAAS,CAACgD,IAAV,GAAiBiF,GAAjB;AACAjI,EAAAA,SAAS,CAACkE,KAAV,GAAkB,CAAC8D,MAAD,GAAUC,GAAV,GAAgBD,MAAM,GAAG,CAAT,GAAa,IAAb,GAAoB7I,aAAa,CAAC8I,GAAG,IAAID,MAAM,GAAG,CAAb,CAAH,GAAqBhI,SAAS,CAAC2D,OAAV,GAAoBqE,MAA1C,CAAnE;AACAE,EAAAA,aAAa,GAAG,CAAhB,IAAqB,CAACH,aAAtB,GAAsCzD,cAAc,CAACtE,SAAD,EAAYA,SAAS,CAAC0D,MAAV,GAAmB1D,SAAS,CAACkE,KAAV,GAAkBgE,aAAjD,CAApD,GAAsHlI,SAAS,CAACuB,MAAV,IAAoB4C,OAAO,CAACnE,SAAD,CAAjJ;AACA8H,EAAAA,WAAW,IAAIhF,QAAQ,CAAC9C,SAAS,CAACuB,MAAX,EAAmBvB,SAAnB,CAAvB;AACA,SAAOA,SAAP;AACD,CA1gBD;AAAA,IA2gBImI,sBAAsB,GAAG,SAASA,sBAAT,CAAgCnI,SAAhC,EAA2C;AACtE,SAAOA,SAAS,YAAYoI,QAArB,GAAgCtF,QAAQ,CAAC9C,SAAD,CAAxC,GAAsD6H,YAAY,CAAC7H,SAAD,EAAYA,SAAS,CAACgD,IAAtB,CAAzE;AACD,CA7gBD;AAAA,IA8gBIqF,aAAa,GAAG;AAClBpF,EAAAA,MAAM,EAAE,CADU;AAElBqF,EAAAA,OAAO,EAAEpL,UAFS;AAGlBkG,EAAAA,aAAa,EAAElG;AAHG,CA9gBpB;AAAA,IAmhBIiI,cAAc,GAAG,SAASA,cAAT,CAAwBnF,SAAxB,EAAmCiF,QAAnC,EAA6CsD,gBAA7C,EAA+D;AAClF,MAAIC,MAAM,GAAGxI,SAAS,CAACwI,MAAvB;AAAA,MACIC,MAAM,GAAGzI,SAAS,CAACwF,OAAV,IAAqB6C,aADlC;AAAA,MAEIK,eAAe,GAAG1I,SAAS,CAAC3G,QAAV,MAAwBI,OAAxB,GAAkCgP,MAAM,CAACH,OAAP,CAAe,KAAf,CAAlC,GAA0DtI,SAAS,CAACgD,IAF1F;AAAA,MAGI;AACJhF,EAAAA,CAJA;AAAA,MAKI2K,MALJ;AAAA,MAMIC,SANJ;;AAQA,MAAItO,SAAS,CAAC2K,QAAD,CAAT,KAAwB4D,KAAK,CAAC5D,QAAD,CAAL,IAAmBA,QAAQ,IAAIuD,MAAvD,CAAJ,EAAoE;AAClE;AACAG,IAAAA,MAAM,GAAG1D,QAAQ,CAAC6D,MAAT,CAAgB,CAAhB,CAAT;AACAF,IAAAA,SAAS,GAAG3D,QAAQ,CAAC8D,MAAT,CAAgB,CAAC,CAAjB,MAAwB,GAApC;AACA/K,IAAAA,CAAC,GAAGiH,QAAQ,CAACzF,OAAT,CAAiB,GAAjB,CAAJ;;AAEA,QAAImJ,MAAM,KAAK,GAAX,IAAkBA,MAAM,KAAK,GAAjC,EAAsC;AACpC3K,MAAAA,CAAC,IAAI,CAAL,KAAWiH,QAAQ,GAAGA,QAAQ,CAAC+D,OAAT,CAAiB,GAAjB,EAAsB,EAAtB,CAAtB;AACA,aAAO,CAACL,MAAM,KAAK,GAAX,GAAiBF,MAAM,CAACxF,MAAxB,GAAiCwF,MAAM,CAACH,OAAP,CAAeG,MAAM,CAACjF,OAAP,IAAkB,CAAjC,CAAlC,IAAyE,CAAClD,UAAU,CAAC2E,QAAQ,CAAC8D,MAAT,CAAgB,CAAhB,CAAD,CAAV,IAAkC,CAAnC,KAAyCH,SAAS,GAAG,CAAC5K,CAAC,GAAG,CAAJ,GAAQyK,MAAR,GAAiBF,gBAAlB,EAAoCnF,aAApC,KAAsD,GAAzD,GAA+D,CAAjH,CAAhF;AACD;;AAED,QAAIpF,CAAC,GAAG,CAAR,EAAW;AACTiH,MAAAA,QAAQ,IAAIuD,MAAZ,KAAuBA,MAAM,CAACvD,QAAD,CAAN,GAAmByD,eAA1C;AACA,aAAOF,MAAM,CAACvD,QAAD,CAAb;AACD;;AAED0D,IAAAA,MAAM,GAAGrI,UAAU,CAAC2E,QAAQ,CAAC6D,MAAT,CAAgB9K,CAAC,GAAG,CAApB,IAAyBiH,QAAQ,CAAC8D,MAAT,CAAgB/K,CAAC,GAAG,CAApB,CAA1B,CAAnB;;AAEA,QAAI4K,SAAS,IAAIL,gBAAjB,EAAmC;AACjCI,MAAAA,MAAM,GAAGA,MAAM,GAAG,GAAT,GAAe,CAACxN,QAAQ,CAACoN,gBAAD,CAAR,GAA6BA,gBAAgB,CAAC,CAAD,CAA7C,GAAmDA,gBAApD,EAAsEnF,aAAtE,EAAxB;AACD;;AAED,WAAOpF,CAAC,GAAG,CAAJ,GAAQmH,cAAc,CAACnF,SAAD,EAAYiF,QAAQ,CAAC8D,MAAT,CAAgB,CAAhB,EAAmB/K,CAAC,GAAG,CAAvB,CAAZ,EAAuCuK,gBAAvC,CAAd,GAAyEI,MAAjF,GAA0FD,eAAe,GAAGC,MAAnH;AACD;;AAED,SAAO1D,QAAQ,IAAI,IAAZ,GAAmByD,eAAnB,GAAqC,CAACzD,QAA7C;AACD,CAtjBD;AAAA,IAujBIgE,gBAAgB,GAAG,SAASA,gBAAT,CAA0BC,IAA1B,EAAgCC,MAAhC,EAAwCxE,QAAxC,EAAkD;AACvE,MAAIyE,QAAQ,GAAG3O,SAAS,CAAC0O,MAAM,CAAC,CAAD,CAAP,CAAxB;AAAA,MACIE,SAAS,GAAG,CAACD,QAAQ,GAAG,CAAH,GAAO,CAAhB,KAAsBF,IAAI,GAAG,CAAP,GAAW,CAAX,GAAe,CAArC,CADhB;AAAA,MAEI5H,IAAI,GAAG6H,MAAM,CAACE,SAAD,CAFjB;AAAA,MAGIC,MAHJ;AAAA,MAII/H,MAJJ;;AAMA6H,EAAAA,QAAQ,KAAK9H,IAAI,CAACjI,QAAL,GAAgB8P,MAAM,CAAC,CAAD,CAA3B,CAAR;AACA7H,EAAAA,IAAI,CAACC,MAAL,GAAcoD,QAAd;;AAEA,MAAIuE,IAAJ,EAAU;AACRI,IAAAA,MAAM,GAAGhI,IAAT;AACAC,IAAAA,MAAM,GAAGoD,QAAT;;AAEA,WAAOpD,MAAM,IAAI,EAAE,qBAAqB+H,MAAvB,CAAjB,EAAiD;AAC/C;AACAA,MAAAA,MAAM,GAAG/H,MAAM,CAACD,IAAP,CAAYV,QAAZ,IAAwB,EAAjC;AACAW,MAAAA,MAAM,GAAG3G,WAAW,CAAC2G,MAAM,CAACD,IAAP,CAAYG,OAAb,CAAX,IAAoCF,MAAM,CAACA,MAApD;AACD;;AAEDD,IAAAA,IAAI,CAACiI,eAAL,GAAuB3O,WAAW,CAAC0O,MAAM,CAACC,eAAR,CAAlC;AACAL,IAAAA,IAAI,GAAG,CAAP,GAAW5H,IAAI,CAACkI,YAAL,GAAoB,CAA/B,GAAmClI,IAAI,CAACmI,OAAL,GAAeN,MAAM,CAACE,SAAS,GAAG,CAAb,CAAxD,CAXQ,CAWiE;AAC1E;;AAED,SAAO,IAAIK,KAAJ,CAAUP,MAAM,CAAC,CAAD,CAAhB,EAAqB7H,IAArB,EAA2B6H,MAAM,CAACE,SAAS,GAAG,CAAb,CAAjC,CAAP;AACD,CAhlBD;AAAA,IAilBIM,kBAAkB,GAAG,SAASA,kBAAT,CAA4BpP,KAA5B,EAAmCuE,IAAnC,EAAyC;AAChE,SAAOvE,KAAK,IAAIA,KAAK,KAAK,CAAnB,GAAuBuE,IAAI,CAACvE,KAAD,CAA3B,GAAqCuE,IAA5C;AACD,CAnlBD;AAAA,IAolBIgG,MAAM,GAAG,SAASA,MAAT,CAAgB8E,GAAhB,EAAqBC,GAArB,EAA0BtP,KAA1B,EAAiC;AAC5C,SAAOA,KAAK,GAAGqP,GAAR,GAAcA,GAAd,GAAoBrP,KAAK,GAAGsP,GAAR,GAAcA,GAAd,GAAoBtP,KAA/C;AACD,CAtlBD;AAAA,IAulBIuP,OAAO,GAAG,SAASA,OAAT,CAAiBvP,KAAjB,EAAwBmE,CAAxB,EAA2B;AACvC,SAAO,CAACpE,SAAS,CAACC,KAAD,CAAV,IAAqB,EAAEmE,CAAC,GAAG9C,QAAQ,CAACmO,IAAT,CAAcxP,KAAd,CAAN,CAArB,GAAmD,EAAnD,GAAwDA,KAAK,CAACwO,MAAN,CAAarK,CAAC,CAACsL,KAAF,GAAUtL,CAAC,CAAC,CAAD,CAAD,CAAKP,MAA5B,CAA/D;AACD,CAzlBD;AAAA,IA0lBI;AACJ8L,KAAK,GAAG,SAASA,KAAT,CAAeL,GAAf,EAAoBC,GAApB,EAAyBtP,KAAzB,EAAgC;AACtC,SAAOoP,kBAAkB,CAACpP,KAAD,EAAQ,UAAUmE,CAAV,EAAa;AAC5C,WAAOoG,MAAM,CAAC8E,GAAD,EAAMC,GAAN,EAAWnL,CAAX,CAAb;AACD,GAFwB,CAAzB;AAGD,CA/lBD;AAAA,IAgmBIwL,MAAM,GAAG,GAAGvK,KAhmBhB;AAAA,IAimBIwK,YAAY,GAAG,SAASA,YAAT,CAAsB5P,KAAtB,EAA6B6P,QAA7B,EAAuC;AACxD,SAAO7P,KAAK,IAAII,SAAS,CAACJ,KAAD,CAAlB,IAA6B,YAAYA,KAAzC,KAAmD,CAAC6P,QAAD,IAAa,CAAC7P,KAAK,CAAC4D,MAApB,IAA8B5D,KAAK,CAAC4D,MAAN,GAAe,CAAf,IAAoB5D,KAApB,IAA6BI,SAAS,CAACJ,KAAK,CAAC,CAAD,CAAN,CAAvH,KAAsI,CAACA,KAAK,CAAC8P,QAA7I,IAAyJ9P,KAAK,KAAKuB,IAA1K;AACD,CAnmBD;AAAA,IAomBIwO,QAAQ,GAAG,SAASA,QAAT,CAAkBC,EAAlB,EAAsBC,YAAtB,EAAoCC,WAApC,EAAiD;AAC9D,MAAIA,WAAW,KAAK,KAAK,CAAzB,EAA4B;AAC1BA,IAAAA,WAAW,GAAG,EAAd;AACD;;AAED,SAAOF,EAAE,CAACvL,OAAH,CAAW,UAAUzE,KAAV,EAAiB;AACjC,QAAImQ,YAAJ;;AAEA,WAAOpQ,SAAS,CAACC,KAAD,CAAT,IAAoB,CAACiQ,YAArB,IAAqCL,YAAY,CAAC5P,KAAD,EAAQ,CAAR,CAAjD,GAA8D,CAACmQ,YAAY,GAAGD,WAAhB,EAA6BvE,IAA7B,CAAkCyE,KAAlC,CAAwCD,YAAxC,EAAsDlM,OAAO,CAACjE,KAAD,CAA7D,CAA9D,GAAsIkQ,WAAW,CAACvE,IAAZ,CAAiB3L,KAAjB,CAA7I;AACD,GAJM,KAIDkQ,WAJN;AAKD,CA9mBD;AAAA,IA+mBI;AACJjM,OAAO,GAAG,SAASA,OAAT,CAAiBjE,KAAjB,EAAwB8B,KAAxB,EAA+BmO,YAA/B,EAA6C;AACrD,SAAOlQ,SAAS,CAACC,KAAD,CAAT,IAAoB,CAACiQ,YAArB,KAAsCzO,YAAY,IAAI,CAAC6O,KAAK,EAA5D,IAAkEV,MAAM,CAACW,IAAP,CAAY,CAACxO,KAAK,IAAIL,IAAV,EAAgB8O,gBAAhB,CAAiCvQ,KAAjC,CAAZ,EAAqD,CAArD,CAAlE,GAA4HY,QAAQ,CAACZ,KAAD,CAAR,GAAkB+P,QAAQ,CAAC/P,KAAD,EAAQiQ,YAAR,CAA1B,GAAkDL,YAAY,CAAC5P,KAAD,CAAZ,GAAsB2P,MAAM,CAACW,IAAP,CAAYtQ,KAAZ,EAAmB,CAAnB,CAAtB,GAA8CA,KAAK,GAAG,CAACA,KAAD,CAAH,GAAa,EAArP;AACD,CAlnBD;AAAA,IAmnBIwQ,QAAQ,GAAG,SAASA,QAAT,CAAkBxQ,KAAlB,EAAyB;AACtCA,EAAAA,KAAK,GAAGiE,OAAO,CAACjE,KAAD,CAAP,CAAe,CAAf,KAAqBqC,KAAK,CAAC,eAAD,CAA1B,IAA+C,EAAvD;AACA,SAAO,UAAU8B,CAAV,EAAa;AAClB,QAAIsM,EAAE,GAAGzQ,KAAK,CAAC0Q,OAAN,IAAiB1Q,KAAK,CAAC2Q,aAAvB,IAAwC3Q,KAAjD;AACA,WAAOiE,OAAO,CAACE,CAAD,EAAIsM,EAAE,CAACF,gBAAH,GAAsBE,EAAtB,GAA2BA,EAAE,KAAKzQ,KAAP,GAAeqC,KAAK,CAAC,eAAD,CAAL,IAA0BZ,IAAI,CAACmP,aAAL,CAAmB,KAAnB,CAAzC,GAAqE5Q,KAApG,CAAd;AACD,GAHD;AAID,CAznBD;AAAA,IA0nBI6Q,OAAO,GAAG,SAASA,OAAT,CAAiB1L,CAAjB,EAAoB;AAChC,SAAOA,CAAC,CAAC2L,IAAF,CAAO,YAAY;AACxB,WAAO,KAAKzR,IAAI,CAAC0R,MAAL,EAAZ;AACD,GAFM,CAAP;AAGD,CA9nBD;AAAA,IA+nBI;AACJ;AACAC,UAAU,GAAG,SAASA,UAAT,CAAoB7M,CAApB,EAAuB;AAClC,MAAIlE,WAAW,CAACkE,CAAD,CAAf,EAAoB;AAClB,WAAOA,CAAP;AACD;;AAED,MAAI4C,IAAI,GAAG3G,SAAS,CAAC+D,CAAD,CAAT,GAAeA,CAAf,GAAmB;AAC5B8M,IAAAA,IAAI,EAAE9M;AADsB,GAA9B;AAAA,MAGI;AACJ+M,EAAAA,IAAI,GAAGC,UAAU,CAACpK,IAAI,CAACmK,IAAN,CAJjB;AAAA,MAKIE,IAAI,GAAGrK,IAAI,CAACqK,IAAL,IAAa,CALxB;AAAA,MAMI5K,IAAI,GAAGT,UAAU,CAACgB,IAAI,CAACP,IAAN,CAAV,IAAyB,CANpC;AAAA,MAOI6K,KAAK,GAAG,EAPZ;AAAA,MAQIC,SAAS,GAAGF,IAAI,GAAG,CAAP,IAAYA,IAAI,GAAG,CARnC;AAAA,MASIG,MAAM,GAAGjD,KAAK,CAAC8C,IAAD,CAAL,IAAeE,SAT5B;AAAA,MAUIE,IAAI,GAAGzK,IAAI,CAACyK,IAVhB;AAAA,MAWIC,MAAM,GAAGL,IAXb;AAAA,MAYIM,MAAM,GAAGN,IAZb;;AAcA,MAAIrR,SAAS,CAACqR,IAAD,CAAb,EAAqB;AACnBK,IAAAA,MAAM,GAAGC,MAAM,GAAG;AAChBC,MAAAA,MAAM,EAAE,EADQ;AAEhBC,MAAAA,KAAK,EAAE,EAFS;AAGhBC,MAAAA,GAAG,EAAE;AAHW,MAIhBT,IAJgB,KAIP,CAJX;AAKD,GAND,MAMO,IAAI,CAACE,SAAD,IAAcC,MAAlB,EAA0B;AAC/BE,IAAAA,MAAM,GAAGL,IAAI,CAAC,CAAD,CAAb;AACAM,IAAAA,MAAM,GAAGN,IAAI,CAAC,CAAD,CAAb;AACD;;AAED,SAAO,UAAU3N,CAAV,EAAaF,MAAb,EAAqB4B,CAArB,EAAwB;AAC7B,QAAIH,CAAC,GAAG,CAACG,CAAC,IAAI4B,IAAN,EAAYnD,MAApB;AAAA,QACIkO,SAAS,GAAGT,KAAK,CAACrM,CAAD,CADrB;AAAA,QAEI+M,OAFJ;AAAA,QAGIC,OAHJ;AAAA,QAIIC,CAJJ;AAAA,QAKIC,CALJ;AAAA,QAMIrF,CANJ;AAAA,QAOIsF,CAPJ;AAAA,QAQI7C,GARJ;AAAA,QASID,GATJ;AAAA,QAUI+C,MAVJ;;AAYA,QAAI,CAACN,SAAL,EAAgB;AACdM,MAAAA,MAAM,GAAGrL,IAAI,CAACsL,IAAL,KAAc,MAAd,GAAuB,CAAvB,GAA2B,CAACtL,IAAI,CAACsL,IAAL,IAAa,CAAC,CAAD,EAAInT,OAAJ,CAAd,EAA4B,CAA5B,CAApC;;AAEA,UAAI,CAACkT,MAAL,EAAa;AACX9C,QAAAA,GAAG,GAAG,CAACpQ,OAAP;;AAEA,eAAOoQ,GAAG,IAAIA,GAAG,GAAGnK,CAAC,CAACiN,MAAM,EAAP,CAAD,CAAYE,qBAAZ,GAAoCC,IAA9C,CAAH,IAA0DH,MAAM,GAAGpN,CAA1E,EAA6E,CAAE;;AAE/EoN,QAAAA,MAAM;AACP;;AAEDN,MAAAA,SAAS,GAAGT,KAAK,CAACrM,CAAD,CAAL,GAAW,EAAvB;AACA+M,MAAAA,OAAO,GAAGR,MAAM,GAAGlS,IAAI,CAACgQ,GAAL,CAAS+C,MAAT,EAAiBpN,CAAjB,IAAsByM,MAAtB,GAA+B,EAAlC,GAAuCL,IAAI,GAAGgB,MAA9D;AACAJ,MAAAA,OAAO,GAAGI,MAAM,KAAKlT,OAAX,GAAqB,CAArB,GAAyBqS,MAAM,GAAGvM,CAAC,GAAG0M,MAAJ,GAAaU,MAAb,GAAsB,EAAzB,GAA8BhB,IAAI,GAAGgB,MAAP,GAAgB,CAAvF;AACA9C,MAAAA,GAAG,GAAG,CAAN;AACAD,MAAAA,GAAG,GAAGnQ,OAAN;;AAEA,WAAKiT,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGnN,CAAhB,EAAmBmN,CAAC,EAApB,EAAwB;AACtBF,QAAAA,CAAC,GAAGE,CAAC,GAAGC,MAAJ,GAAaL,OAAjB;AACAG,QAAAA,CAAC,GAAGF,OAAO,IAAIG,CAAC,GAAGC,MAAJ,GAAa,CAAjB,CAAX;AACAN,QAAAA,SAAS,CAACK,CAAD,CAAT,GAAetF,CAAC,GAAG,CAAC2E,IAAD,GAAQ/R,KAAK,CAACwS,CAAC,GAAGA,CAAJ,GAAQC,CAAC,GAAGA,CAAb,CAAb,GAA+B7S,IAAI,CAACwK,GAAL,CAAS2H,IAAI,KAAK,GAAT,GAAeU,CAAf,GAAmBD,CAA5B,CAAlD;AACApF,QAAAA,CAAC,GAAGyC,GAAJ,KAAYA,GAAG,GAAGzC,CAAlB;AACAA,QAAAA,CAAC,GAAGwC,GAAJ,KAAYA,GAAG,GAAGxC,CAAlB;AACD;;AAEDuE,MAAAA,IAAI,KAAK,QAAT,IAAqBP,OAAO,CAACiB,SAAD,CAA5B;AACAA,MAAAA,SAAS,CAACxC,GAAV,GAAgBA,GAAG,GAAGD,GAAtB;AACAyC,MAAAA,SAAS,CAACzC,GAAV,GAAgBA,GAAhB;AACAyC,MAAAA,SAAS,CAAC3N,CAAV,GAAca,CAAC,GAAG,CAACe,UAAU,CAACgB,IAAI,CAACyL,MAAN,CAAV,IAA2BzM,UAAU,CAACgB,IAAI,CAACkK,IAAN,CAAV,IAAyBmB,MAAM,GAAGpN,CAAT,GAAaA,CAAC,GAAG,CAAjB,GAAqB,CAACwM,IAAD,GAAQnS,IAAI,CAACiQ,GAAL,CAAS8C,MAAT,EAAiBpN,CAAC,GAAGoN,MAArB,CAAR,GAAuCZ,IAAI,KAAK,GAAT,GAAexM,CAAC,GAAGoN,MAAnB,GAA4BA,MAAjH,CAA3B,IAAuJ,CAAxJ,KAA8JhB,IAAI,KAAK,OAAT,GAAmB,CAAC,CAApB,GAAwB,CAAtL,CAAlB;AACAU,MAAAA,SAAS,CAACW,CAAV,GAAczN,CAAC,GAAG,CAAJ,GAAQwB,IAAI,GAAGxB,CAAf,GAAmBwB,IAAjC;AACAsL,MAAAA,SAAS,CAACY,CAAV,GAAcnD,OAAO,CAACxI,IAAI,CAACyL,MAAL,IAAezL,IAAI,CAACkK,IAArB,CAAP,IAAqC,CAAnD,CA9Bc,CA8BwC;;AAEtDC,MAAAA,IAAI,GAAGA,IAAI,IAAIlM,CAAC,GAAG,CAAZ,GAAgB2N,WAAW,CAACzB,IAAD,CAA3B,GAAoCA,IAA3C;AACD;;AAEDlM,IAAAA,CAAC,GAAG,CAAC8M,SAAS,CAACrO,CAAD,CAAT,GAAeqO,SAAS,CAACzC,GAA1B,IAAiCyC,SAAS,CAACxC,GAA3C,IAAkD,CAAtD;AACA,WAAO1K,aAAa,CAACkN,SAAS,CAACW,CAAV,GAAc,CAACvB,IAAI,GAAGA,IAAI,CAAClM,CAAD,CAAP,GAAaA,CAAlB,IAAuB8M,SAAS,CAAC3N,CAAhD,CAAb,GAAkE2N,SAAS,CAACY,CAAnF,CAjD6B,CAiDyD;AACvF,GAlDD;AAmDD,CAltBD;AAAA,IAmtBIE,cAAc,GAAG,SAASA,cAAT,CAAwBzO,CAAxB,EAA2B;AAC9C;AACA,MAAIgC,CAAC,GAAG9G,IAAI,CAACwT,GAAL,CAAS,EAAT,EAAa,CAAC,CAAC1O,CAAC,GAAG,EAAL,EAASK,KAAT,CAAe,GAAf,EAAoB,CAApB,KAA0B,EAA3B,EAA+BZ,MAA5C,CAAR,CAF8C,CAEe;;AAE7D,SAAO,UAAUkP,GAAV,EAAe;AACpB,QAAIhN,CAAC,GAAGzG,IAAI,CAACsF,KAAL,CAAWoB,UAAU,CAAC+M,GAAD,CAAV,GAAkB3O,CAA7B,IAAkCA,CAAlC,GAAsCgC,CAA9C;AACA,WAAO,CAACL,CAAC,GAAGA,CAAC,GAAG,CAAT,IAAcK,CAAd,IAAmBjG,SAAS,CAAC4S,GAAD,CAAT,GAAiB,CAAjB,GAAqBvD,OAAO,CAACuD,GAAD,CAA/C,CAAP,CAFoB,CAE0C;AAC/D,GAHD;AAID,CA3tBD;AAAA,IA4tBIC,IAAI,GAAG,SAASA,IAAT,CAAcC,MAAd,EAAsBhT,KAAtB,EAA6B;AACtC,MAAIc,OAAO,GAAGF,QAAQ,CAACoS,MAAD,CAAtB;AAAA,MACIC,MADJ;AAAA,MAEIC,IAFJ;;AAIA,MAAI,CAACpS,OAAD,IAAYV,SAAS,CAAC4S,MAAD,CAAzB,EAAmC;AACjCC,IAAAA,MAAM,GAAGnS,OAAO,GAAGkS,MAAM,CAACC,MAAP,IAAiB/T,OAApC;;AAEA,QAAI8T,MAAM,CAACG,MAAX,EAAmB;AACjBH,MAAAA,MAAM,GAAG/O,OAAO,CAAC+O,MAAM,CAACG,MAAR,CAAhB;;AAEA,UAAID,IAAI,GAAG,CAAChT,SAAS,CAAC8S,MAAM,CAAC,CAAD,CAAP,CAArB,EAAkC;AAChCC,QAAAA,MAAM,IAAIA,MAAV,CADgC,CACd;AACnB;AACF,KAND,MAMO;AACLD,MAAAA,MAAM,GAAGJ,cAAc,CAACI,MAAM,CAACI,SAAR,CAAvB;AACD;AACF;;AAED,SAAOhE,kBAAkB,CAACpP,KAAD,EAAQ,CAACc,OAAD,GAAW8R,cAAc,CAACI,MAAD,CAAzB,GAAoC/S,WAAW,CAAC+S,MAAD,CAAX,GAAsB,UAAUF,GAAV,EAAe;AACxGI,IAAAA,IAAI,GAAGF,MAAM,CAACF,GAAD,CAAb;AACA,WAAOzT,IAAI,CAACwK,GAAL,CAASqJ,IAAI,GAAGJ,GAAhB,KAAwBG,MAAxB,GAAiCC,IAAjC,GAAwCJ,GAA/C;AACD,GAHoE,GAGjE,UAAUA,GAAV,EAAe;AACjB,QAAIb,CAAC,GAAGlM,UAAU,CAACmN,IAAI,GAAGJ,GAAG,CAACb,CAAP,GAAWa,GAAhB,CAAlB;AAAA,QACIZ,CAAC,GAAGnM,UAAU,CAACmN,IAAI,GAAGJ,GAAG,CAACZ,CAAP,GAAW,CAAhB,CADlB;AAAA,QAEI7C,GAAG,GAAGnQ,OAFV;AAAA,QAGImU,OAAO,GAAG,CAHd;AAAA,QAII5P,CAAC,GAAGuP,MAAM,CAACpP,MAJf;AAAA,QAKI0P,EALJ;AAAA,QAMIC,EANJ;;AAQA,WAAO9P,CAAC,EAAR,EAAY;AACV,UAAIyP,IAAJ,EAAU;AACRI,QAAAA,EAAE,GAAGN,MAAM,CAACvP,CAAD,CAAN,CAAUwO,CAAV,GAAcA,CAAnB;AACAsB,QAAAA,EAAE,GAAGP,MAAM,CAACvP,CAAD,CAAN,CAAUyO,CAAV,GAAcA,CAAnB;AACAoB,QAAAA,EAAE,GAAGA,EAAE,GAAGA,EAAL,GAAUC,EAAE,GAAGA,EAApB;AACD,OAJD,MAIO;AACLD,QAAAA,EAAE,GAAGjU,IAAI,CAACwK,GAAL,CAASmJ,MAAM,CAACvP,CAAD,CAAN,GAAYwO,CAArB,CAAL;AACD;;AAED,UAAIqB,EAAE,GAAGjE,GAAT,EAAc;AACZA,QAAAA,GAAG,GAAGiE,EAAN;AACAD,QAAAA,OAAO,GAAG5P,CAAV;AACD;AACF;;AAED4P,IAAAA,OAAO,GAAG,CAACJ,MAAD,IAAW5D,GAAG,IAAI4D,MAAlB,GAA2BD,MAAM,CAACK,OAAD,CAAjC,GAA6CP,GAAvD;AACA,WAAOI,IAAI,IAAIG,OAAO,KAAKP,GAApB,IAA2B5S,SAAS,CAAC4S,GAAD,CAApC,GAA4CO,OAA5C,GAAsDA,OAAO,GAAG9D,OAAO,CAACuD,GAAD,CAA9E;AACD,GA7BwB,CAAzB;AA8BD,CA7wBD;AAAA,IA8wBI/B,MAAM,GAAG,SAASA,MAAT,CAAgB1B,GAAhB,EAAqBC,GAArB,EAA0BkE,iBAA1B,EAA6CC,cAA7C,EAA6D;AACxE,SAAOrE,kBAAkB,CAACxO,QAAQ,CAACyO,GAAD,CAAR,GAAgB,CAACC,GAAjB,GAAuBkE,iBAAiB,KAAK,IAAtB,GAA6B,CAAC,EAAEA,iBAAiB,GAAG,CAAtB,CAA9B,GAAyD,CAACC,cAAlF,EAAkG,YAAY;AACrI,WAAO7S,QAAQ,CAACyO,GAAD,CAAR,GAAgBA,GAAG,CAAC,CAAC,EAAEhQ,IAAI,CAAC0R,MAAL,KAAgB1B,GAAG,CAACzL,MAAtB,CAAF,CAAnB,GAAsD,CAAC4P,iBAAiB,GAAGA,iBAAiB,IAAI,IAA1C,MAAoDC,cAAc,GAAGD,iBAAiB,GAAG,CAApB,GAAwBnU,IAAI,CAACwT,GAAL,CAAS,EAAT,EAAa,CAACW,iBAAiB,GAAG,EAArB,EAAyB5P,MAAzB,GAAkC,CAA/C,CAAxB,GAA4E,CAAjJ,KAAuJvE,IAAI,CAACmK,KAAL,CAAWnK,IAAI,CAACsF,KAAL,CAAW,CAAC0K,GAAG,GAAGmE,iBAAiB,GAAG,CAA1B,GAA8BnU,IAAI,CAAC0R,MAAL,MAAiBzB,GAAG,GAAGD,GAAN,GAAYmE,iBAAiB,GAAG,GAAjD,CAA/B,IAAwFA,iBAAnG,IAAwHA,iBAAxH,GAA4IC,cAAvJ,IAAyKA,cAA7X;AACD,GAFwB,CAAzB;AAGD,CAlxBD;AAAA,IAmxBIC,IAAI,GAAG,SAASA,IAAT,GAAgB;AACzB,OAAK,IAAIC,IAAI,GAAGC,SAAS,CAAChQ,MAArB,EAA6BiQ,SAAS,GAAG,IAAIhT,KAAJ,CAAU8S,IAAV,CAAzC,EAA0DG,IAAI,GAAG,CAAtE,EAAyEA,IAAI,GAAGH,IAAhF,EAAsFG,IAAI,EAA1F,EAA8F;AAC5FD,IAAAA,SAAS,CAACC,IAAD,CAAT,GAAkBF,SAAS,CAACE,IAAD,CAA3B;AACD;;AAED,SAAO,UAAU9T,KAAV,EAAiB;AACtB,WAAO6T,SAAS,CAACE,MAAV,CAAiB,UAAU5P,CAAV,EAAa6P,CAAb,EAAgB;AACtC,aAAOA,CAAC,CAAC7P,CAAD,CAAR;AACD,KAFM,EAEJnE,KAFI,CAAP;AAGD,GAJD;AAKD,CA7xBD;AAAA,IA8xBIiU,OAAO,GAAG,SAASA,OAAT,CAAiB1P,IAAjB,EAAuB2P,IAAvB,EAA6B;AACzC,SAAO,UAAUlU,KAAV,EAAiB;AACtB,WAAOuE,IAAI,CAACwB,UAAU,CAAC/F,KAAD,CAAX,CAAJ,IAA2BkU,IAAI,IAAI3E,OAAO,CAACvP,KAAD,CAA1C,CAAP;AACD,GAFD;AAGD,CAlyBD;AAAA,IAmyBImU,SAAS,GAAG,SAASA,SAAT,CAAmB9E,GAAnB,EAAwBC,GAAxB,EAA6BtP,KAA7B,EAAoC;AAClD,SAAOoU,QAAQ,CAAC/E,GAAD,EAAMC,GAAN,EAAW,CAAX,EAAc,CAAd,EAAiBtP,KAAjB,CAAf;AACD,CAryBD;AAAA,IAsyBIqU,UAAU,GAAG,SAASA,UAAT,CAAoBlP,CAApB,EAAuBmP,OAAvB,EAAgCtU,KAAhC,EAAuC;AACtD,SAAOoP,kBAAkB,CAACpP,KAAD,EAAQ,UAAUyP,KAAV,EAAiB;AAChD,WAAOtK,CAAC,CAAC,CAAC,CAACmP,OAAO,CAAC7E,KAAD,CAAV,CAAR;AACD,GAFwB,CAAzB;AAGD,CA1yBD;AAAA,IA2yBI8E,IAAI,GAAG,SAASA,IAAT,CAAclF,GAAd,EAAmBC,GAAnB,EAAwBtP,KAAxB,EAA+B;AACxC;AACA,MAAIwU,KAAK,GAAGlF,GAAG,GAAGD,GAAlB;AACA,SAAOzO,QAAQ,CAACyO,GAAD,CAAR,GAAgBgF,UAAU,CAAChF,GAAD,EAAMkF,IAAI,CAAC,CAAD,EAAIlF,GAAG,CAACzL,MAAR,CAAV,EAA2B0L,GAA3B,CAA1B,GAA4DF,kBAAkB,CAACpP,KAAD,EAAQ,UAAUA,KAAV,EAAiB;AAC5G,WAAO,CAACwU,KAAK,GAAG,CAACxU,KAAK,GAAGqP,GAAT,IAAgBmF,KAAzB,IAAkCA,KAAlC,GAA0CnF,GAAjD;AACD,GAFoF,CAArF;AAGD,CAjzBD;AAAA,IAkzBIoF,QAAQ,GAAG,SAASA,QAAT,CAAkBpF,GAAlB,EAAuBC,GAAvB,EAA4BtP,KAA5B,EAAmC;AAChD,MAAIwU,KAAK,GAAGlF,GAAG,GAAGD,GAAlB;AAAA,MACIqF,KAAK,GAAGF,KAAK,GAAG,CADpB;AAEA,SAAO5T,QAAQ,CAACyO,GAAD,CAAR,GAAgBgF,UAAU,CAAChF,GAAD,EAAMoF,QAAQ,CAAC,CAAD,EAAIpF,GAAG,CAACzL,MAAJ,GAAa,CAAjB,CAAd,EAAmC0L,GAAnC,CAA1B,GAAoEF,kBAAkB,CAACpP,KAAD,EAAQ,UAAUA,KAAV,EAAiB;AACpHA,IAAAA,KAAK,GAAG,CAAC0U,KAAK,GAAG,CAAC1U,KAAK,GAAGqP,GAAT,IAAgBqF,KAAzB,IAAkCA,KAAlC,IAA2C,CAAnD;AACA,WAAOrF,GAAG,IAAIrP,KAAK,GAAGwU,KAAR,GAAgBE,KAAK,GAAG1U,KAAxB,GAAgCA,KAApC,CAAV;AACD,GAH4F,CAA7F;AAID,CAzzBD;AAAA,IA0zBI2U,cAAc,GAAG,SAASA,cAAT,CAAwB3U,KAAxB,EAA+B;AAClD;AACA,MAAI4H,IAAI,GAAG,CAAX;AAAA,MACIgN,CAAC,GAAG,EADR;AAAA,MAEInR,CAFJ;AAAA,MAGIoR,IAHJ;AAAA,MAIIhD,GAJJ;AAAA,MAKI/Q,OALJ;;AAOA,SAAO,EAAE2C,CAAC,GAAGzD,KAAK,CAACiF,OAAN,CAAc,SAAd,EAAyB2C,IAAzB,CAAN,CAAP,EAA8C;AAC5CiK,IAAAA,GAAG,GAAG7R,KAAK,CAACiF,OAAN,CAAc,GAAd,EAAmBxB,CAAnB,CAAN;AACA3C,IAAAA,OAAO,GAAGd,KAAK,CAACuO,MAAN,CAAa9K,CAAC,GAAG,CAAjB,MAAwB,GAAlC;AACAoR,IAAAA,IAAI,GAAG7U,KAAK,CAACwO,MAAN,CAAa/K,CAAC,GAAG,CAAjB,EAAoBoO,GAAG,GAAGpO,CAAN,GAAU,CAA9B,EAAiCuC,KAAjC,CAAuClF,OAAO,GAAGM,kBAAH,GAAwBL,aAAtE,CAAP;AACA6T,IAAAA,CAAC,IAAI5U,KAAK,CAACwO,MAAN,CAAa5G,IAAb,EAAmBnE,CAAC,GAAGmE,IAAvB,IAA+BmJ,MAAM,CAACjQ,OAAO,GAAG+T,IAAH,GAAU,CAACA,IAAI,CAAC,CAAD,CAAvB,EAA4B/T,OAAO,GAAG,CAAH,GAAO,CAAC+T,IAAI,CAAC,CAAD,CAA/C,EAAoD,CAACA,IAAI,CAAC,CAAD,CAAL,IAAY,IAAhE,CAA1C;AACAjN,IAAAA,IAAI,GAAGiK,GAAG,GAAG,CAAb;AACD;;AAED,SAAO+C,CAAC,GAAG5U,KAAK,CAACwO,MAAN,CAAa5G,IAAb,EAAmB5H,KAAK,CAAC4D,MAAN,GAAegE,IAAlC,CAAX;AACD,CA50BD;AAAA,IA60BIwM,QAAQ,GAAG,SAASA,QAAT,CAAkBU,KAAlB,EAAyBC,KAAzB,EAAgCC,MAAhC,EAAwCC,MAAxC,EAAgDjV,KAAhD,EAAuD;AACpE,MAAIkV,OAAO,GAAGH,KAAK,GAAGD,KAAtB;AAAA,MACIK,QAAQ,GAAGF,MAAM,GAAGD,MADxB;AAEA,SAAO5F,kBAAkB,CAACpP,KAAD,EAAQ,UAAUA,KAAV,EAAiB;AAChD,WAAOgV,MAAM,IAAI,CAAChV,KAAK,GAAG8U,KAAT,IAAkBI,OAAlB,GAA4BC,QAA5B,IAAwC,CAA5C,CAAb;AACD,GAFwB,CAAzB;AAGD,CAn1BD;AAAA,IAo1BIC,WAAW,GAAG,SAASA,WAAT,CAAqBC,KAArB,EAA4BxD,GAA5B,EAAiCyD,QAAjC,EAA2CC,MAA3C,EAAmD;AACnE,MAAIhR,IAAI,GAAG+J,KAAK,CAAC+G,KAAK,GAAGxD,GAAT,CAAL,GAAqB,CAArB,GAAyB,UAAU1L,CAAV,EAAa;AAC/C,WAAO,CAAC,IAAIA,CAAL,IAAUkP,KAAV,GAAkBlP,CAAC,GAAG0L,GAA7B;AACD,GAFD;;AAIA,MAAI,CAACtN,IAAL,EAAW;AACT,QAAIiR,QAAQ,GAAGzV,SAAS,CAACsV,KAAD,CAAxB;AAAA,QACII,MAAM,GAAG,EADb;AAAA,QAEItP,CAFJ;AAAA,QAGI1C,CAHJ;AAAA,QAIIiS,aAJJ;AAAA,QAKI1Q,CALJ;AAAA,QAMI2Q,EANJ;;AAQAL,IAAAA,QAAQ,KAAK,IAAb,KAAsBC,MAAM,GAAG,CAA/B,MAAsCD,QAAQ,GAAG,IAAjD;;AAEA,QAAIE,QAAJ,EAAc;AACZH,MAAAA,KAAK,GAAG;AACNlP,QAAAA,CAAC,EAAEkP;AADG,OAAR;AAGAxD,MAAAA,GAAG,GAAG;AACJ1L,QAAAA,CAAC,EAAE0L;AADC,OAAN;AAGD,KAPD,MAOO,IAAIjR,QAAQ,CAACyU,KAAD,CAAR,IAAmB,CAACzU,QAAQ,CAACiR,GAAD,CAAhC,EAAuC;AAC5C6D,MAAAA,aAAa,GAAG,EAAhB;AACA1Q,MAAAA,CAAC,GAAGqQ,KAAK,CAACzR,MAAV;AACA+R,MAAAA,EAAE,GAAG3Q,CAAC,GAAG,CAAT;;AAEA,WAAKvB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGuB,CAAhB,EAAmBvB,CAAC,EAApB,EAAwB;AACtBiS,QAAAA,aAAa,CAAC/J,IAAd,CAAmByJ,WAAW,CAACC,KAAK,CAAC5R,CAAC,GAAG,CAAL,CAAN,EAAe4R,KAAK,CAAC5R,CAAD,CAApB,CAA9B,EADsB,CACmC;AAC1D;;AAEDuB,MAAAA,CAAC;;AAEDT,MAAAA,IAAI,GAAG,SAASA,IAAT,CAAc4B,CAAd,EAAiB;AACtBA,QAAAA,CAAC,IAAInB,CAAL;AACA,YAAIvB,CAAC,GAAGpE,IAAI,CAACgQ,GAAL,CAASsG,EAAT,EAAa,CAAC,CAACxP,CAAf,CAAR;AACA,eAAOuP,aAAa,CAACjS,CAAD,CAAb,CAAiB0C,CAAC,GAAG1C,CAArB,CAAP;AACD,OAJD;;AAMA6R,MAAAA,QAAQ,GAAGzD,GAAX;AACD,KAlBM,MAkBA,IAAI,CAAC0D,MAAL,EAAa;AAClBF,MAAAA,KAAK,GAAGtT,MAAM,CAACnB,QAAQ,CAACyU,KAAD,CAAR,GAAkB,EAAlB,GAAuB,EAAxB,EAA4BA,KAA5B,CAAd;AACD;;AAED,QAAI,CAACK,aAAL,EAAoB;AAClB,WAAKvP,CAAL,IAAU0L,GAAV,EAAe;AACb+D,QAAAA,aAAa,CAACtF,IAAd,CAAmBmF,MAAnB,EAA2BJ,KAA3B,EAAkClP,CAAlC,EAAqC,KAArC,EAA4C0L,GAAG,CAAC1L,CAAD,CAA/C;AACD;;AAED5B,MAAAA,IAAI,GAAG,SAASA,IAAT,CAAc4B,CAAd,EAAiB;AACtB,eAAO0P,iBAAiB,CAAC1P,CAAD,EAAIsP,MAAJ,CAAjB,KAAiCD,QAAQ,GAAGH,KAAK,CAAClP,CAAT,GAAakP,KAAtD,CAAP;AACD,OAFD;AAGD;AACF;;AAED,SAAOjG,kBAAkB,CAACkG,QAAD,EAAW/Q,IAAX,CAAzB;AACD,CA74BD;AAAA,IA84BIuR,oBAAoB,GAAG,SAASA,oBAAT,CAA8B1L,QAA9B,EAAwC2L,QAAxC,EAAkDC,QAAlD,EAA4D;AACrF;AACA,MAAI/H,MAAM,GAAG7D,QAAQ,CAAC6D,MAAtB;AAAA,MACIoB,GAAG,GAAGnQ,OADV;AAAA,MAEIiH,CAFJ;AAAA,MAGI8P,QAHJ;AAAA,MAIIC,KAJJ;;AAMA,OAAK/P,CAAL,IAAU8H,MAAV,EAAkB;AAChBgI,IAAAA,QAAQ,GAAGhI,MAAM,CAAC9H,CAAD,CAAN,GAAY4P,QAAvB;;AAEA,QAAIE,QAAQ,GAAG,CAAX,KAAiB,CAAC,CAACD,QAAnB,IAA+BC,QAA/B,IAA2C5G,GAAG,IAAI4G,QAAQ,GAAG5W,IAAI,CAACwK,GAAL,CAASoM,QAAT,CAAf,CAAlD,EAAsF;AACpFC,MAAAA,KAAK,GAAG/P,CAAR;AACAkJ,MAAAA,GAAG,GAAG4G,QAAN;AACD;AACF;;AAED,SAAOC,KAAP;AACD,CAh6BD;AAAA,IAi6BIlJ,SAAS,GAAG,SAASA,SAAT,CAAmBvH,SAAnB,EAA8BkJ,IAA9B,EAAoCwH,gBAApC,EAAsD;AACpE,MAAIhS,CAAC,GAAGsB,SAAS,CAACsB,IAAlB;AAAA,MACIqP,QAAQ,GAAGjS,CAAC,CAACwK,IAAD,CADhB;AAAA,MAEIC,MAFJ;AAAA,MAGI9M,KAHJ;;AAKA,MAAI,CAACsU,QAAL,EAAe;AACb;AACD;;AAEDxH,EAAAA,MAAM,GAAGzK,CAAC,CAACwK,IAAI,GAAG,QAAR,CAAV;AACA7M,EAAAA,KAAK,GAAGqC,CAAC,CAACkS,aAAF,IAAmB5Q,SAA3B;AACA0Q,EAAAA,gBAAgB,IAAItT,WAAW,CAACe,MAAhC,IAA0CsB,WAAW,EAArD,CAZoE,CAYX;;AAEzD,SAAO0J,MAAM,GAAGwH,QAAQ,CAAChG,KAAT,CAAetO,KAAf,EAAsB8M,MAAtB,CAAH,GAAmCwH,QAAQ,CAAC9F,IAAT,CAAcxO,KAAd,CAAhD;AACD,CAh7BD;AAAA,IAi7BIwU,UAAU,GAAG,SAASA,UAAT,CAAoB7Q,SAApB,EAA+B;AAC9CyC,EAAAA,iBAAiB,CAACzC,SAAD,CAAjB;;AAEAA,EAAAA,SAAS,CAAC8Q,aAAV,IAA2B9Q,SAAS,CAAC8Q,aAAV,CAAwBC,IAAxB,CAA6B,KAA7B,CAA3B;AACA/Q,EAAAA,SAAS,CAAC6P,QAAV,KAAuB,CAAvB,IAA4BtI,SAAS,CAACvH,SAAD,EAAY,aAAZ,CAArC;AACA,SAAOA,SAAP;AACD,CAv7BD;AAAA,IAw7BIgR,WAx7BJ;AAAA,IAy7BIC,aAAa,GAAG,SAASA,aAAT,CAAuBC,MAAvB,EAA+B;AACjDA,EAAAA,MAAM,GAAG,CAACA,MAAM,CAAClU,IAAR,IAAgBkU,MAAM,CAAC,SAAD,CAAtB,IAAqCA,MAA9C,CADiD,CACK;;AAEtD,MAAIlU,IAAI,GAAGkU,MAAM,CAAClU,IAAlB;AAAA,MACImU,MAAM,GAAG3W,WAAW,CAAC0W,MAAD,CADxB;AAAA,MAEIE,MAAM,GAAGpU,IAAI,IAAI,CAACmU,MAAT,IAAmBD,MAAM,CAACG,IAA1B,GAAiC,YAAY;AACxD,SAAKC,MAAL,GAAc,EAAd;AACD,GAFY,GAETJ,MAJJ;AAAA,MAKI;AACJK,EAAAA,gBAAgB,GAAG;AACjBF,IAAAA,IAAI,EAAEnU,UADW;AAEjB4C,IAAAA,MAAM,EAAEsQ,iBAFS;AAGjBoB,IAAAA,GAAG,EAAErB,aAHY;AAIjBY,IAAAA,IAAI,EAAEU,iBAJW;AAKjBC,IAAAA,QAAQ,EAAEC,kBALO;AAMjBC,IAAAA,OAAO,EAAE;AANQ,GANnB;AAAA,MAcIC,OAAO,GAAG;AACZzT,IAAAA,UAAU,EAAE,CADA;AAEZ0T,IAAAA,GAAG,EAAE,CAFO;AAGZC,IAAAA,SAAS,EAAEC,UAHC;AAIZC,IAAAA,OAAO,EAAE,EAJG;AAKZC,IAAAA,QAAQ,EAAE;AALE,GAdd;;AAsBAtH,EAAAA,KAAK;;AAEL,MAAIsG,MAAM,KAAKE,MAAf,EAAuB;AACrB,QAAI7T,QAAQ,CAACP,IAAD,CAAZ,EAAoB;AAClB;AACD;;AAED2D,IAAAA,YAAY,CAACyQ,MAAD,EAASzQ,YAAY,CAACO,cAAc,CAACgQ,MAAD,EAASK,gBAAT,CAAf,EAA2CM,OAA3C,CAArB,CAAZ,CALqB,CAKkE;;;AAGvFvV,IAAAA,MAAM,CAAC8U,MAAM,CAAC3Y,SAAR,EAAmB6D,MAAM,CAACiV,gBAAD,EAAmBrQ,cAAc,CAACgQ,MAAD,EAASW,OAAT,CAAjC,CAAzB,CAAN,CARqB,CAQgE;;;AAGrFtU,IAAAA,QAAQ,CAAC6T,MAAM,CAACe,IAAP,GAAcnV,IAAf,CAAR,GAA+BoU,MAA/B;;AAEA,QAAIF,MAAM,CAAC9S,UAAX,EAAuB;AACrBV,MAAAA,eAAe,CAACwI,IAAhB,CAAqBkL,MAArB;;AAEAjU,MAAAA,cAAc,CAACH,IAAD,CAAd,GAAuB,CAAvB;AACD;;AAEDA,IAAAA,IAAI,GAAG,CAACA,IAAI,KAAK,KAAT,GAAiB,KAAjB,GAAyBA,IAAI,CAAC8L,MAAL,CAAY,CAAZ,EAAesJ,WAAf,KAA+BpV,IAAI,CAAC+L,MAAL,CAAY,CAAZ,CAAzD,IAA2E,QAAlF,CAnBqB,CAmBuE;AAC7F;;AAEDhM,EAAAA,UAAU,CAACC,IAAD,EAAOoU,MAAP,CAAV;;AAEAF,EAAAA,MAAM,CAACgB,QAAP,IAAmBhB,MAAM,CAACgB,QAAP,CAAgB3V,IAAhB,EAAsB6U,MAAtB,EAA8BiB,SAA9B,CAAnB;AACD,CA7+BD;;AA++BA;AACA;AACA;AACA;AACA;AACAC,IAAI,GAAG,GAp/BP;AAAA,IAq/BIC,YAAY,GAAG;AACjBC,EAAAA,IAAI,EAAE,CAAC,CAAD,EAAIF,IAAJ,EAAUA,IAAV,CADW;AAEjBG,EAAAA,IAAI,EAAE,CAAC,CAAD,EAAIH,IAAJ,EAAU,CAAV,CAFW;AAGjBI,EAAAA,MAAM,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAHS;AAIjBC,EAAAA,KAAK,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAJU;AAKjBC,EAAAA,MAAM,EAAE,CAAC,GAAD,EAAM,CAAN,EAAS,CAAT,CALS;AAMjBC,EAAAA,IAAI,EAAE,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,CANW;AAOjBC,EAAAA,IAAI,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAOR,IAAP,CAPW;AAQjBS,EAAAA,IAAI,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,GAAP,CARW;AASjBC,EAAAA,KAAK,EAAE,CAACV,IAAD,EAAOA,IAAP,EAAaA,IAAb,CATU;AAUjBW,EAAAA,KAAK,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX,CAVU;AAWjBC,EAAAA,MAAM,EAAE,CAACZ,IAAD,EAAOA,IAAP,EAAa,CAAb,CAXS;AAYjBa,EAAAA,MAAM,EAAE,CAACb,IAAD,EAAO,GAAP,EAAY,CAAZ,CAZS;AAajBc,EAAAA,IAAI,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAbW;AAcjBC,EAAAA,MAAM,EAAE,CAAC,GAAD,EAAM,CAAN,EAAS,GAAT,CAdS;AAejBC,EAAAA,KAAK,EAAE,CAAC,CAAD,EAAI,GAAJ,EAAS,CAAT,CAfU;AAgBjBC,EAAAA,GAAG,EAAE,CAACjB,IAAD,EAAO,CAAP,EAAU,CAAV,CAhBY;AAiBjBkB,EAAAA,IAAI,EAAE,CAAClB,IAAD,EAAO,GAAP,EAAY,GAAZ,CAjBW;AAkBjBmB,EAAAA,IAAI,EAAE,CAAC,CAAD,EAAInB,IAAJ,EAAUA,IAAV,CAlBW;AAmBjBoB,EAAAA,WAAW,EAAE,CAACpB,IAAD,EAAOA,IAAP,EAAaA,IAAb,EAAmB,CAAnB;AAnBI,CAr/BnB;AAAA,IA0gCI;AACJ;AACA;AACAqB,IAAI,GAAG,SAASA,IAAT,CAAcC,CAAd,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyB;AAC9BF,EAAAA,CAAC,IAAIA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYA,CAAC,GAAG,CAAJ,GAAQ,CAAC,CAAT,GAAa,CAA9B;AACA,SAAO,CAACA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYC,EAAE,GAAG,CAACC,EAAE,GAAGD,EAAN,IAAYD,CAAZ,GAAgB,CAAjC,GAAqCA,CAAC,GAAG,EAAJ,GAASE,EAAT,GAAcF,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYC,EAAE,GAAG,CAACC,EAAE,GAAGD,EAAN,KAAa,IAAI,CAAJ,GAAQD,CAArB,IAA0B,CAA3C,GAA+CC,EAAnG,IAAyGvB,IAAzG,GAAgH,EAAhH,GAAqH,CAA5H;AACD,CAhhCD;AAAA,IAihCIyB,UAAU,GAAG,SAASA,UAAT,CAAoBrV,CAApB,EAAuBsV,KAAvB,EAA8BC,UAA9B,EAA0C;AACzD,MAAIvU,CAAC,GAAG,CAAChB,CAAD,GAAK6T,YAAY,CAACI,KAAlB,GAA0BlY,SAAS,CAACiE,CAAD,CAAT,GAAe,CAACA,CAAC,IAAI,EAAN,EAAUA,CAAC,IAAI,CAAL,GAAS4T,IAAnB,EAAyB5T,CAAC,GAAG4T,IAA7B,CAAf,GAAoD,CAAtF;AAAA,MACInL,CADJ;AAAA,MAEI+M,CAFJ;AAAA,MAGIlH,CAHJ;AAAA,MAII4G,CAJJ;AAAA,MAKIzE,CALJ;AAAA,MAMI5P,CANJ;AAAA,MAOIsK,GAPJ;AAAA,MAQID,GARJ;AAAA,MASIxC,CATJ;AAAA,MAUI+M,MAVJ;;AAYA,MAAI,CAACzU,CAAL,EAAQ;AACN,QAAIhB,CAAC,CAACqK,MAAF,CAAS,CAAC,CAAV,MAAiB,GAArB,EAA0B;AACxB;AACArK,MAAAA,CAAC,GAAGA,CAAC,CAACqK,MAAF,CAAS,CAAT,EAAYrK,CAAC,CAACP,MAAF,GAAW,CAAvB,CAAJ;AACD;;AAED,QAAIoU,YAAY,CAAC7T,CAAD,CAAhB,EAAqB;AACnBgB,MAAAA,CAAC,GAAG6S,YAAY,CAAC7T,CAAD,CAAhB;AACD,KAFD,MAEO,IAAIA,CAAC,CAACoK,MAAF,CAAS,CAAT,MAAgB,GAApB,EAAyB;AAC9B,UAAIpK,CAAC,CAACP,MAAF,GAAW,CAAf,EAAkB;AAChB;AACAgJ,QAAAA,CAAC,GAAGzI,CAAC,CAACoK,MAAF,CAAS,CAAT,CAAJ;AACAoL,QAAAA,CAAC,GAAGxV,CAAC,CAACoK,MAAF,CAAS,CAAT,CAAJ;AACAkE,QAAAA,CAAC,GAAGtO,CAAC,CAACoK,MAAF,CAAS,CAAT,CAAJ;AACApK,QAAAA,CAAC,GAAG,MAAMyI,CAAN,GAAUA,CAAV,GAAc+M,CAAd,GAAkBA,CAAlB,GAAsBlH,CAAtB,GAA0BA,CAA1B,IAA+BtO,CAAC,CAACP,MAAF,KAAa,CAAb,GAAiBO,CAAC,CAACoK,MAAF,CAAS,CAAT,IAAcpK,CAAC,CAACoK,MAAF,CAAS,CAAT,CAA/B,GAA6C,EAA5E,CAAJ;AACD;;AAED,UAAIpK,CAAC,CAACP,MAAF,KAAa,CAAjB,EAAoB;AAClB;AACAuB,QAAAA,CAAC,GAAG0U,QAAQ,CAAC1V,CAAC,CAACqK,MAAF,CAAS,CAAT,EAAY,CAAZ,CAAD,EAAiB,EAAjB,CAAZ;AACA,eAAO,CAACrJ,CAAC,IAAI,EAAN,EAAUA,CAAC,IAAI,CAAL,GAAS4S,IAAnB,EAAyB5S,CAAC,GAAG4S,IAA7B,EAAmC8B,QAAQ,CAAC1V,CAAC,CAACqK,MAAF,CAAS,CAAT,CAAD,EAAc,EAAd,CAAR,GAA4B,GAA/D,CAAP;AACD;;AAEDrK,MAAAA,CAAC,GAAG0V,QAAQ,CAAC1V,CAAC,CAACqK,MAAF,CAAS,CAAT,CAAD,EAAc,EAAd,CAAZ;AACArJ,MAAAA,CAAC,GAAG,CAAChB,CAAC,IAAI,EAAN,EAAUA,CAAC,IAAI,CAAL,GAAS4T,IAAnB,EAAyB5T,CAAC,GAAG4T,IAA7B,CAAJ;AACD,KAjBM,MAiBA,IAAI5T,CAAC,CAACqK,MAAF,CAAS,CAAT,EAAY,CAAZ,MAAmB,KAAvB,EAA8B;AACnCrJ,MAAAA,CAAC,GAAGyU,MAAM,GAAGzV,CAAC,CAAC6B,KAAF,CAAQjF,aAAR,CAAb;;AAEA,UAAI,CAAC0Y,KAAL,EAAY;AACVJ,QAAAA,CAAC,GAAG,CAAClU,CAAC,CAAC,CAAD,CAAF,GAAQ,GAAR,GAAc,GAAlB;AACAyP,QAAAA,CAAC,GAAG,CAACzP,CAAC,CAAC,CAAD,CAAF,GAAQ,GAAZ;AACAH,QAAAA,CAAC,GAAG,CAACG,CAAC,CAAC,CAAD,CAAF,GAAQ,GAAZ;AACAwU,QAAAA,CAAC,GAAG3U,CAAC,IAAI,EAAL,GAAUA,CAAC,IAAI4P,CAAC,GAAG,CAAR,CAAX,GAAwB5P,CAAC,GAAG4P,CAAJ,GAAQ5P,CAAC,GAAG4P,CAAxC;AACAhI,QAAAA,CAAC,GAAG5H,CAAC,GAAG,CAAJ,GAAQ2U,CAAZ;AACAxU,QAAAA,CAAC,CAACvB,MAAF,GAAW,CAAX,KAAiBuB,CAAC,CAAC,CAAD,CAAD,IAAQ,CAAzB,EANU,CAMmB;;AAE7BA,QAAAA,CAAC,CAAC,CAAD,CAAD,GAAOiU,IAAI,CAACC,CAAC,GAAG,IAAI,CAAT,EAAYzM,CAAZ,EAAe+M,CAAf,CAAX;AACAxU,QAAAA,CAAC,CAAC,CAAD,CAAD,GAAOiU,IAAI,CAACC,CAAD,EAAIzM,CAAJ,EAAO+M,CAAP,CAAX;AACAxU,QAAAA,CAAC,CAAC,CAAD,CAAD,GAAOiU,IAAI,CAACC,CAAC,GAAG,IAAI,CAAT,EAAYzM,CAAZ,EAAe+M,CAAf,CAAX;AACD,OAXD,MAWO,IAAI,CAACxV,CAAC,CAACc,OAAF,CAAU,GAAV,CAAL,EAAqB;AAC1B;AACAE,QAAAA,CAAC,GAAGhB,CAAC,CAAC6B,KAAF,CAAQhF,OAAR,CAAJ;AACA0Y,QAAAA,UAAU,IAAIvU,CAAC,CAACvB,MAAF,GAAW,CAAzB,KAA+BuB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAtC;AACA,eAAOA,CAAP;AACD;AACF,KApBM,MAoBA;AACLA,MAAAA,CAAC,GAAGhB,CAAC,CAAC6B,KAAF,CAAQjF,aAAR,KAA0BiX,YAAY,CAACmB,WAA3C;AACD;;AAEDhU,IAAAA,CAAC,GAAGA,CAAC,CAAC2U,GAAF,CAAMC,MAAN,CAAJ;AACD;;AAED,MAAIN,KAAK,IAAI,CAACG,MAAd,EAAsB;AACpBhN,IAAAA,CAAC,GAAGzH,CAAC,CAAC,CAAD,CAAD,GAAO4S,IAAX;AACA4B,IAAAA,CAAC,GAAGxU,CAAC,CAAC,CAAD,CAAD,GAAO4S,IAAX;AACAtF,IAAAA,CAAC,GAAGtN,CAAC,CAAC,CAAD,CAAD,GAAO4S,IAAX;AACAzI,IAAAA,GAAG,GAAGjQ,IAAI,CAACiQ,GAAL,CAAS1C,CAAT,EAAY+M,CAAZ,EAAelH,CAAf,CAAN;AACApD,IAAAA,GAAG,GAAGhQ,IAAI,CAACgQ,GAAL,CAASzC,CAAT,EAAY+M,CAAZ,EAAelH,CAAf,CAAN;AACAzN,IAAAA,CAAC,GAAG,CAACsK,GAAG,GAAGD,GAAP,IAAc,CAAlB;;AAEA,QAAIC,GAAG,KAAKD,GAAZ,EAAiB;AACfgK,MAAAA,CAAC,GAAGzE,CAAC,GAAG,CAAR;AACD,KAFD,MAEO;AACL/H,MAAAA,CAAC,GAAGyC,GAAG,GAAGD,GAAV;AACAuF,MAAAA,CAAC,GAAG5P,CAAC,GAAG,GAAJ,GAAU6H,CAAC,IAAI,IAAIyC,GAAJ,GAAUD,GAAd,CAAX,GAAgCxC,CAAC,IAAIyC,GAAG,GAAGD,GAAV,CAArC;AACAgK,MAAAA,CAAC,GAAG/J,GAAG,KAAK1C,CAAR,GAAY,CAAC+M,CAAC,GAAGlH,CAAL,IAAU5F,CAAV,IAAe8M,CAAC,GAAGlH,CAAJ,GAAQ,CAAR,GAAY,CAA3B,CAAZ,GAA4CnD,GAAG,KAAKqK,CAAR,GAAY,CAAClH,CAAC,GAAG7F,CAAL,IAAUC,CAAV,GAAc,CAA1B,GAA8B,CAACD,CAAC,GAAG+M,CAAL,IAAU9M,CAAV,GAAc,CAA5F;AACAwM,MAAAA,CAAC,IAAI,EAAL;AACD;;AAEDlU,IAAAA,CAAC,CAAC,CAAD,CAAD,GAAO,CAAC,EAAEkU,CAAC,GAAG,EAAN,CAAR;AACAlU,IAAAA,CAAC,CAAC,CAAD,CAAD,GAAO,CAAC,EAAEyP,CAAC,GAAG,GAAJ,GAAU,EAAZ,CAAR;AACAzP,IAAAA,CAAC,CAAC,CAAD,CAAD,GAAO,CAAC,EAAEH,CAAC,GAAG,GAAJ,GAAU,EAAZ,CAAR;AACD;;AAED0U,EAAAA,UAAU,IAAIvU,CAAC,CAACvB,MAAF,GAAW,CAAzB,KAA+BuB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAtC;AACA,SAAOA,CAAP;AACD,CA1mCD;AAAA,IA2mCI6U,eAAe,GAAG,SAASA,eAAT,CAAyB7V,CAAzB,EAA4B;AAChD;AACA,MAAIgP,MAAM,GAAG,EAAb;AAAA,MACI8G,CAAC,GAAG,EADR;AAAA,MAEIxW,CAAC,GAAG,CAAC,CAFT;AAGAU,EAAAA,CAAC,CAACK,KAAF,CAAQ0V,SAAR,EAAmBzV,OAAnB,CAA2B,UAAUN,CAAV,EAAa;AACtC,QAAIgB,CAAC,GAAGhB,CAAC,CAAC6B,KAAF,CAAQ/E,eAAR,KAA4B,EAApC;AACAkS,IAAAA,MAAM,CAACxH,IAAP,CAAYyE,KAAZ,CAAkB+C,MAAlB,EAA0BhO,CAA1B;AACA8U,IAAAA,CAAC,CAACtO,IAAF,CAAOlI,CAAC,IAAI0B,CAAC,CAACvB,MAAF,GAAW,CAAvB;AACD,GAJD;AAKAuP,EAAAA,MAAM,CAAC8G,CAAP,GAAWA,CAAX;AACA,SAAO9G,MAAP;AACD,CAvnCD;AAAA,IAwnCIgH,aAAa,GAAG,SAASA,aAAT,CAAuBvF,CAAvB,EAA0B6E,KAA1B,EAAiCW,cAAjC,EAAiD;AACnE,MAAIC,MAAM,GAAG,EAAb;AAAA,MACIC,MAAM,GAAG,CAAC1F,CAAC,GAAGyF,MAAL,EAAarU,KAAb,CAAmBkU,SAAnB,CADb;AAAA,MAEIvL,IAAI,GAAG8K,KAAK,GAAG,OAAH,GAAa,OAF7B;AAAA,MAGIhW,CAAC,GAAG,CAHR;AAAA,MAIIwW,CAJJ;AAAA,MAKIM,KALJ;AAAA,MAMI1N,CANJ;AAAA,MAOI7H,CAPJ;;AASA,MAAI,CAACsV,MAAL,EAAa;AACX,WAAO1F,CAAP;AACD;;AAED0F,EAAAA,MAAM,GAAGA,MAAM,CAACR,GAAP,CAAW,UAAUU,KAAV,EAAiB;AACnC,WAAO,CAACA,KAAK,GAAGhB,UAAU,CAACgB,KAAD,EAAQf,KAAR,EAAe,CAAf,CAAnB,KAAyC9K,IAAI,IAAI8K,KAAK,GAAGe,KAAK,CAAC,CAAD,CAAL,GAAW,GAAX,GAAiBA,KAAK,CAAC,CAAD,CAAtB,GAA4B,IAA5B,GAAmCA,KAAK,CAAC,CAAD,CAAxC,GAA8C,IAA9C,GAAqDA,KAAK,CAAC,CAAD,CAA7D,GAAmEA,KAAK,CAACC,IAAN,CAAW,GAAX,CAA5E,CAAJ,GAAmG,GAAnJ;AACD,GAFQ,CAAT;;AAIA,MAAIL,cAAJ,EAAoB;AAClBvN,IAAAA,CAAC,GAAGmN,eAAe,CAACpF,CAAD,CAAnB;AACAqF,IAAAA,CAAC,GAAGG,cAAc,CAACH,CAAnB;;AAEA,QAAIA,CAAC,CAACQ,IAAF,CAAOJ,MAAP,MAAmBxN,CAAC,CAACoN,CAAF,CAAIQ,IAAJ,CAASJ,MAAT,CAAvB,EAAyC;AACvCE,MAAAA,KAAK,GAAG3F,CAAC,CAACnG,OAAF,CAAUyL,SAAV,EAAqB,GAArB,EAA0B1V,KAA1B,CAAgCvD,eAAhC,CAAR;AACA+D,MAAAA,CAAC,GAAGuV,KAAK,CAAC3W,MAAN,GAAe,CAAnB;;AAEA,aAAOH,CAAC,GAAGuB,CAAX,EAAcvB,CAAC,EAAf,EAAmB;AACjB4W,QAAAA,MAAM,IAAIE,KAAK,CAAC9W,CAAD,CAAL,IAAY,CAACwW,CAAC,CAAChV,OAAF,CAAUxB,CAAV,CAAD,GAAgB6W,MAAM,CAACI,KAAP,MAAkB/L,IAAI,GAAG,UAAzC,GAAsD,CAAC9B,CAAC,CAACjJ,MAAF,GAAWiJ,CAAX,GAAeyN,MAAM,CAAC1W,MAAP,GAAgB0W,MAAhB,GAAyBF,cAAzC,EAAyDM,KAAzD,EAAlE,CAAV;AACD;AACF;AACF;;AAED,MAAI,CAACH,KAAL,EAAY;AACVA,IAAAA,KAAK,GAAG3F,CAAC,CAACpQ,KAAF,CAAQ0V,SAAR,CAAR;AACAlV,IAAAA,CAAC,GAAGuV,KAAK,CAAC3W,MAAN,GAAe,CAAnB;;AAEA,WAAOH,CAAC,GAAGuB,CAAX,EAAcvB,CAAC,EAAf,EAAmB;AACjB4W,MAAAA,MAAM,IAAIE,KAAK,CAAC9W,CAAD,CAAL,GAAW6W,MAAM,CAAC7W,CAAD,CAA3B;AACD;AACF;;AAED,SAAO4W,MAAM,GAAGE,KAAK,CAACvV,CAAD,CAArB;AACD,CAlqCD;AAAA,IAmqCIkV,SAAS,GAAG,YAAY;AAC1B,MAAItF,CAAC,GAAG,wEAAR;AAAA,MACI;AACJzO,EAAAA,CAFA;;AAIA,OAAKA,CAAL,IAAU6R,YAAV,EAAwB;AACtBpD,IAAAA,CAAC,IAAI,MAAMzO,CAAN,GAAU,KAAf;AACD;;AAED,SAAO,IAAIwU,MAAJ,CAAW/F,CAAC,GAAG,GAAf,EAAoB,IAApB,CAAP;AACD,CAVe,EAnqChB;AAAA,IA8qCIgG,OAAO,GAAG,WA9qCd;AAAA,IA+qCIC,kBAAkB,GAAG,SAASA,kBAAT,CAA4B1V,CAA5B,EAA+B;AACtD,MAAI2V,QAAQ,GAAG3V,CAAC,CAACsV,IAAF,CAAO,GAAP,CAAf;AAAA,MACIhB,KADJ;AAEAS,EAAAA,SAAS,CAACa,SAAV,GAAsB,CAAtB;;AAEA,MAAIb,SAAS,CAACc,IAAV,CAAeF,QAAf,CAAJ,EAA8B;AAC5BrB,IAAAA,KAAK,GAAGmB,OAAO,CAACI,IAAR,CAAaF,QAAb,CAAR;AACA3V,IAAAA,CAAC,CAAC,CAAD,CAAD,GAAOgV,aAAa,CAAChV,CAAC,CAAC,CAAD,CAAF,EAAOsU,KAAP,CAApB;AACAtU,IAAAA,CAAC,CAAC,CAAD,CAAD,GAAOgV,aAAa,CAAChV,CAAC,CAAC,CAAD,CAAF,EAAOsU,KAAP,EAAcO,eAAe,CAAC7U,CAAC,CAAC,CAAD,CAAF,CAA7B,CAApB,CAH4B,CAG8B;;AAE1D,WAAO,IAAP;AACD;AACF,CA3rCD;;AA6rCA;AACA;AACA;AACA;AACA;AACA8V,aAlsCA;AAAA,IAmsCIxP,OAAO,GAAG,YAAY;AACxB,MAAIyP,QAAQ,GAAGC,IAAI,CAACC,GAApB;AAAA,MACIC,aAAa,GAAG,GADpB;AAAA,MAEIC,YAAY,GAAG,EAFnB;AAAA,MAGIC,UAAU,GAAGL,QAAQ,EAHzB;AAAA,MAIIM,WAAW,GAAGD,UAJlB;AAAA,MAKIE,IAAI,GAAG,OAAO,GALlB;AAAA,MAMIC,SAAS,GAAGD,IANhB;AAAA,MAOIE,UAAU,GAAG,EAPjB;AAAA,MAQIC,GARJ;AAAA,MASIC,IATJ;AAAA,MAUIC,IAVJ;AAAA,MAWIC,KAXJ;AAAA,MAYIC,MAZJ;AAAA,MAaIC,EAbJ;AAAA,MAcIC,KAAK,GAAG,SAASA,KAAT,CAAe/X,CAAf,EAAkB;AAC5B,QAAIgY,OAAO,GAAGjB,QAAQ,KAAKM,WAA3B;AAAA,QACIY,MAAM,GAAGjY,CAAC,KAAK,IADnB;AAAA,QAEIkY,OAFJ;AAAA,QAGIC,QAHJ;AAAA,QAII5W,IAJJ;AAAA,QAKIgG,KALJ;;AAOAyQ,IAAAA,OAAO,GAAGd,aAAV,KAA4BE,UAAU,IAAIY,OAAO,GAAGb,YAApD;AACAE,IAAAA,WAAW,IAAIW,OAAf;AACAzW,IAAAA,IAAI,GAAG8V,WAAW,GAAGD,UAArB;AACAc,IAAAA,OAAO,GAAG3W,IAAI,GAAGgW,SAAjB;;AAEA,QAAIW,OAAO,GAAG,CAAV,IAAeD,MAAnB,EAA2B;AACzB1Q,MAAAA,KAAK,GAAG,EAAEqQ,KAAK,CAACrQ,KAAhB;AACAsQ,MAAAA,MAAM,GAAGtW,IAAI,GAAGqW,KAAK,CAACrW,IAAN,GAAa,IAA7B;AACAqW,MAAAA,KAAK,CAACrW,IAAN,GAAaA,IAAI,GAAGA,IAAI,GAAG,IAA3B;AACAgW,MAAAA,SAAS,IAAIW,OAAO,IAAIA,OAAO,IAAIZ,IAAX,GAAkB,CAAlB,GAAsBA,IAAI,GAAGY,OAAjC,CAApB;AACAC,MAAAA,QAAQ,GAAG,CAAX;AACD;;AAEDF,IAAAA,MAAM,KAAKR,GAAG,GAAGC,IAAI,CAACK,KAAD,CAAf,CAAN,CArB4B,CAqBG;;AAE/B,QAAII,QAAJ,EAAc;AACZ,WAAKL,EAAE,GAAG,CAAV,EAAaA,EAAE,GAAGN,UAAU,CAAC/X,MAA7B,EAAqCqY,EAAE,EAAvC,EAA2C;AACzC;AACAN,QAAAA,UAAU,CAACM,EAAD,CAAV,CAAevW,IAAf,EAAqBsW,MAArB,EAA6BtQ,KAA7B,EAAoCvH,CAApC;AACD;AACF;AACF,GA3CD;;AA6CA4X,EAAAA,KAAK,GAAG;AACNrW,IAAAA,IAAI,EAAE,CADA;AAENgG,IAAAA,KAAK,EAAE,CAFD;AAGN6Q,IAAAA,IAAI,EAAE,SAASA,IAAT,GAAgB;AACpBL,MAAAA,KAAK,CAAC,IAAD,CAAL;AACD,KALK;AAMNM,IAAAA,UAAU,EAAE,SAASA,UAAT,CAAoBC,GAApB,EAAyB;AACnC,aAAOT,MAAM,IAAI,QAAQS,GAAG,IAAI,EAAf,CAAJ,CAAb;AACD,KARK;AASNC,IAAAA,IAAI,EAAE,SAASA,IAAT,GAAgB;AACpB,UAAI9a,UAAJ,EAAgB;AACd,YAAI,CAACJ,YAAD,IAAiBlB,aAAa,EAAlC,EAAsC;AACpCiB,UAAAA,IAAI,GAAGC,YAAY,GAAGjB,MAAtB;AACAkB,UAAAA,IAAI,GAAGF,IAAI,CAACob,QAAL,IAAiB,EAAxB;AACAjb,UAAAA,QAAQ,CAACM,IAAT,GAAgBA,IAAhB;AACA,WAACT,IAAI,CAACqb,YAAL,KAAsBrb,IAAI,CAACqb,YAAL,GAAoB,EAA1C,CAAD,EAAgDjR,IAAhD,CAAqD3J,IAAI,CAAC6a,OAA1D;;AAEAhb,UAAAA,QAAQ,CAACF,aAAa,IAAIJ,IAAI,CAACub,gBAAtB,IAA0C,CAACvb,IAAI,CAACS,IAAN,IAAcT,IAAxD,IAAgE,EAAjE,CAAR;;AAEAua,UAAAA,IAAI,GAAGva,IAAI,CAACwb,qBAAZ;AACD;;AAEDnB,QAAAA,GAAG,IAAIG,KAAK,CAACiB,KAAN,EAAP;;AAEAnB,QAAAA,IAAI,GAAGC,IAAI,IAAI,UAAU9H,CAAV,EAAa;AAC1B,iBAAOiJ,UAAU,CAACjJ,CAAD,EAAI0H,SAAS,GAAGK,KAAK,CAACrW,IAAN,GAAa,IAAzB,GAAgC,CAAhC,GAAoC,CAAxC,CAAjB;AACD,SAFD;;AAIAuV,QAAAA,aAAa,GAAG,CAAhB;;AAEAiB,QAAAA,KAAK,CAAC,CAAD,CAAL;AACD;AACF,KAhCK;AAiCNc,IAAAA,KAAK,EAAE,SAASA,KAAT,GAAiB;AACtB,OAAClB,IAAI,GAAGva,IAAI,CAAC2b,oBAAR,GAA+BC,YAApC,EAAkDvB,GAAlD;AACAX,MAAAA,aAAa,GAAG,CAAhB;AACAY,MAAAA,IAAI,GAAGlZ,UAAP;AACD,KArCK;AAsCNya,IAAAA,YAAY,EAAE,SAASA,YAAT,CAAsBC,SAAtB,EAAiCC,WAAjC,EAA8C;AAC1DjC,MAAAA,aAAa,GAAGgC,SAAS,IAAI,IAAIle,QAAjC,CAD0D,CACf;;AAE3Cmc,MAAAA,YAAY,GAAGjc,IAAI,CAACgQ,GAAL,CAASiO,WAAT,EAAsBjC,aAAtB,EAAqC,CAArC,CAAf;AACD,KA1CK;AA2CNoB,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAac,IAAb,EAAmB;AACtB9B,MAAAA,IAAI,GAAG,QAAQ8B,IAAI,IAAI,GAAhB,CAAP;AACA7B,MAAAA,SAAS,GAAGK,KAAK,CAACrW,IAAN,GAAa,IAAb,GAAoB+V,IAAhC;AACD,KA9CK;AA+CNxE,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAab,QAAb,EAAuB;AAC1BuF,MAAAA,UAAU,CAAC1W,OAAX,CAAmBmR,QAAnB,IAA+B,CAA/B,IAAoCuF,UAAU,CAAChQ,IAAX,CAAgByK,QAAhB,CAApC;;AAEA/F,MAAAA,KAAK;AACN,KAnDK;AAoDNhI,IAAAA,MAAM,EAAE,SAASA,MAAT,CAAgB+N,QAAhB,EAA0B3S,CAA1B,EAA6B;AACnC,QAAEA,CAAC,GAAGkY,UAAU,CAAC1W,OAAX,CAAmBmR,QAAnB,CAAN,KAAuCuF,UAAU,CAAC5X,MAAX,CAAkBN,CAAlB,EAAqB,CAArB,CAAvC,IAAkEwY,EAAE,IAAIxY,CAAxE,IAA6EwY,EAAE,EAA/E;AACD,KAtDK;AAuDNN,IAAAA,UAAU,EAAEA;AAvDN,GAAR;AAyDA,SAAOI,KAAP;AACD,CAxGa,EAnsCd;AAAA,IA4yCI1L,KAAK,GAAG,SAASA,KAAT,GAAiB;AAC3B,SAAO,CAAC4K,aAAD,IAAkBxP,OAAO,CAACiR,IAAR,EAAzB;AACD,CA9yCD;AAAA,IA+yCI;;AAEJ;AACA;AACA;AACA;AACA;AACAc,QAAQ,GAAG,EAtzCX;AAAA,IAuzCIC,cAAc,GAAG,qBAvzCrB;AAAA,IAwzCIC,UAAU,GAAG,OAxzCjB;AAAA,IAyzCIC,oBAAoB,GAAG,SAASA,oBAAT,CAA8B3d,KAA9B,EAAqC;AAC9D;AACA,MAAI0C,GAAG,GAAG,EAAV;AAAA,MACI8B,KAAK,GAAGxE,KAAK,CAACwO,MAAN,CAAa,CAAb,EAAgBxO,KAAK,CAAC4D,MAAN,GAAe,CAA/B,EAAkCY,KAAlC,CAAwC,GAAxC,CADZ;AAAA,MAEIoZ,GAAG,GAAGpZ,KAAK,CAAC,CAAD,CAFf;AAAA,MAGIf,CAAC,GAAG,CAHR;AAAA,MAIIuB,CAAC,GAAGR,KAAK,CAACZ,MAJd;AAAA,MAKI6L,KALJ;AAAA,MAMIoO,GANJ;AAAA,MAOIC,SAPJ;;AASA,SAAOra,CAAC,GAAGuB,CAAX,EAAcvB,CAAC,EAAf,EAAmB;AACjBoa,IAAAA,GAAG,GAAGrZ,KAAK,CAACf,CAAD,CAAX;AACAgM,IAAAA,KAAK,GAAGhM,CAAC,KAAKuB,CAAC,GAAG,CAAV,GAAc6Y,GAAG,CAACE,WAAJ,CAAgB,GAAhB,CAAd,GAAqCF,GAAG,CAACja,MAAjD;AACAka,IAAAA,SAAS,GAAGD,GAAG,CAACrP,MAAJ,CAAW,CAAX,EAAciB,KAAd,CAAZ;AACA/M,IAAAA,GAAG,CAACkb,GAAD,CAAH,GAAWtP,KAAK,CAACwP,SAAD,CAAL,GAAmBA,SAAS,CAACrP,OAAV,CAAkBiP,UAAlB,EAA8B,EAA9B,EAAkCzX,IAAlC,EAAnB,GAA8D,CAAC6X,SAA1E;AACAF,IAAAA,GAAG,GAAGC,GAAG,CAACrP,MAAJ,CAAWiB,KAAK,GAAG,CAAnB,EAAsBxJ,IAAtB,EAAN;AACD;;AAED,SAAOvD,GAAP;AACD,CA70CD;AAAA,IA80CIsb,mBAAmB,GAAG,SAASA,mBAAT,CAA6Bhe,KAA7B,EAAoC;AAC5D,MAAIie,IAAI,GAAGje,KAAK,CAACiF,OAAN,CAAc,GAAd,IAAqB,CAAhC;AAAA,MACIiZ,KAAK,GAAGle,KAAK,CAACiF,OAAN,CAAc,GAAd,CADZ;AAAA,MAEIkZ,MAAM,GAAGne,KAAK,CAACiF,OAAN,CAAc,GAAd,EAAmBgZ,IAAnB,CAFb;AAGA,SAAOje,KAAK,CAACoe,SAAN,CAAgBH,IAAhB,EAAsB,CAACE,MAAD,IAAWA,MAAM,GAAGD,KAApB,GAA4Ble,KAAK,CAACiF,OAAN,CAAc,GAAd,EAAmBiZ,KAAK,GAAG,CAA3B,CAA5B,GAA4DA,KAAlF,CAAP;AACD,CAn1CD;AAAA,IAo1CIG,qBAAqB,GAAG,SAASA,qBAAT,CAA+B5b,IAA/B,EAAqC;AAC/D;AACA,MAAI+B,KAAK,GAAG,CAAC/B,IAAI,GAAG,EAAR,EAAY+B,KAAZ,CAAkB,GAAlB,CAAZ;AAAA,MACI0M,IAAI,GAAGsM,QAAQ,CAAChZ,KAAK,CAAC,CAAD,CAAN,CADnB;AAEA,SAAO0M,IAAI,IAAI1M,KAAK,CAACZ,MAAN,GAAe,CAAvB,IAA4BsN,IAAI,CAACyF,MAAjC,GAA0CzF,IAAI,CAACyF,MAAL,CAAYvG,KAAZ,CAAkB,IAAlB,EAAwB,CAAC3N,IAAI,CAACwC,OAAL,CAAa,GAAb,CAAD,GAAqB,CAAC0Y,oBAAoB,CAACnZ,KAAK,CAAC,CAAD,CAAN,CAArB,CAArB,GAAwDwZ,mBAAmB,CAACvb,IAAD,CAAnB,CAA0B+B,KAA1B,CAAgC,GAAhC,EAAqCsV,GAArC,CAAyCjU,kBAAzC,CAAhF,CAA1C,GAA0L2X,QAAQ,CAACc,GAAT,IAAgBb,cAAc,CAACzC,IAAf,CAAoBvY,IAApB,CAAhB,GAA4C+a,QAAQ,CAACc,GAAT,CAAa,EAAb,EAAiB7b,IAAjB,CAA5C,GAAqEyO,IAAtQ;AACD,CAz1CD;AAAA,IA01CIyB,WAAW,GAAG,SAASA,WAAT,CAAqBzB,IAArB,EAA2B;AAC3C,SAAO,UAAU/K,CAAV,EAAa;AAClB,WAAO,IAAI+K,IAAI,CAAC,IAAI/K,CAAL,CAAf;AACD,GAFD;AAGD,CA91CD;AAAA,IA+1CI;AACJoY,kBAAkB,GAAG,SAASA,kBAAT,CAA4BnU,QAA5B,EAAsCoU,MAAtC,EAA8C;AACjE,MAAIhX,KAAK,GAAG4C,QAAQ,CAACgD,MAArB;AAAA,MACI8D,IADJ;;AAGA,SAAO1J,KAAP,EAAc;AACZ,QAAIA,KAAK,YAAYqG,QAArB,EAA+B;AAC7B0Q,MAAAA,kBAAkB,CAAC/W,KAAD,EAAQgX,MAAR,CAAlB;AACD,KAFD,MAEO,IAAIhX,KAAK,CAACT,IAAN,CAAW0X,QAAX,KAAwB,CAACjX,KAAK,CAACgF,KAAP,IAAgB,CAAChF,KAAK,CAACyB,OAA/C,KAA2DzB,KAAK,CAACgF,KAAN,KAAgBgS,MAA/E,EAAuF;AAC5F,UAAIhX,KAAK,CAAC4C,QAAV,EAAoB;AAClBmU,QAAAA,kBAAkB,CAAC/W,KAAK,CAAC4C,QAAP,EAAiBoU,MAAjB,CAAlB;AACD,OAFD,MAEO;AACLtN,QAAAA,IAAI,GAAG1J,KAAK,CAACkX,KAAb;AACAlX,QAAAA,KAAK,CAACkX,KAAN,GAAclX,KAAK,CAACmX,MAApB;AACAnX,QAAAA,KAAK,CAACmX,MAAN,GAAezN,IAAf;AACA1J,QAAAA,KAAK,CAACgF,KAAN,GAAcgS,MAAd;AACD;AACF;;AAEDhX,IAAAA,KAAK,GAAGA,KAAK,CAACO,KAAd;AACD;AACF,CAp3CD;AAAA,IAq3CIoJ,UAAU,GAAG,SAASA,UAAT,CAAoBD,IAApB,EAA0B0N,WAA1B,EAAuC;AACtD,SAAO,CAAC1N,IAAD,GAAQ0N,WAAR,GAAsB,CAAC3e,WAAW,CAACiR,IAAD,CAAX,GAAoBA,IAApB,GAA2BsM,QAAQ,CAACtM,IAAD,CAAR,IAAkBmN,qBAAqB,CAACnN,IAAD,CAAnE,KAA8E0N,WAA3G;AACD,CAv3CD;AAAA,IAw3CIC,WAAW,GAAG,SAASA,WAAT,CAAqBva,KAArB,EAA4Bwa,MAA5B,EAAoCC,OAApC,EAA6CC,SAA7C,EAAwD;AACxE,MAAID,OAAO,KAAK,KAAK,CAArB,EAAwB;AACtBA,IAAAA,OAAO,GAAG,SAASA,OAAT,CAAiB5Y,CAAjB,EAAoB;AAC5B,aAAO,IAAI2Y,MAAM,CAAC,IAAI3Y,CAAL,CAAjB;AACD,KAFD;AAGD;;AAED,MAAI6Y,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,IAAAA,SAAS,GAAG,SAASA,SAAT,CAAmB7Y,CAAnB,EAAsB;AAChC,aAAOA,CAAC,GAAG,EAAJ,GAAS2Y,MAAM,CAAC3Y,CAAC,GAAG,CAAL,CAAN,GAAgB,CAAzB,GAA6B,IAAI2Y,MAAM,CAAC,CAAC,IAAI3Y,CAAL,IAAU,CAAX,CAAN,GAAsB,CAA9D;AACD,KAFD;AAGD;;AAED,MAAI+K,IAAI,GAAG;AACT4N,IAAAA,MAAM,EAAEA,MADC;AAETC,IAAAA,OAAO,EAAEA,OAFA;AAGTC,IAAAA,SAAS,EAAEA;AAHF,GAAX;AAAA,MAKIC,aALJ;;AAOA5a,EAAAA,YAAY,CAACC,KAAD,EAAQ,UAAU7B,IAAV,EAAgB;AAClC+a,IAAAA,QAAQ,CAAC/a,IAAD,CAAR,GAAiBf,QAAQ,CAACe,IAAD,CAAR,GAAiByO,IAAlC;AACAsM,IAAAA,QAAQ,CAACyB,aAAa,GAAGxc,IAAI,CAACyc,WAAL,EAAjB,CAAR,GAA+CH,OAA/C;;AAEA,SAAK,IAAI5Y,CAAT,IAAc+K,IAAd,EAAoB;AAClBsM,MAAAA,QAAQ,CAACyB,aAAa,IAAI9Y,CAAC,KAAK,QAAN,GAAiB,KAAjB,GAAyBA,CAAC,KAAK,SAAN,GAAkB,MAAlB,GAA2B,QAAxD,CAAd,CAAR,GAA2FqX,QAAQ,CAAC/a,IAAI,GAAG,GAAP,GAAa0D,CAAd,CAAR,GAA2B+K,IAAI,CAAC/K,CAAD,CAA1H;AACD;AACF,GAPW,CAAZ;;AASA,SAAO+K,IAAP;AACD,CAt5CD;AAAA,IAu5CIiO,iBAAiB,GAAG,SAASA,iBAAT,CAA2BJ,OAA3B,EAAoC;AAC1D,SAAO,UAAU5Y,CAAV,EAAa;AAClB,WAAOA,CAAC,GAAG,EAAJ,GAAS,CAAC,IAAI4Y,OAAO,CAAC,IAAI5Y,CAAC,GAAG,CAAT,CAAZ,IAA2B,CAApC,GAAwC,KAAK4Y,OAAO,CAAC,CAAC5Y,CAAC,GAAG,EAAL,IAAW,CAAZ,CAAP,GAAwB,CAA5E;AACD,GAFD;AAGD,CA35CD;AAAA,IA45CIiZ,cAAc,GAAG,SAASA,cAAT,CAAwBzQ,IAAxB,EAA8B0Q,SAA9B,EAAyCC,MAAzC,EAAiD;AACpE,MAAIC,EAAE,GAAGF,SAAS,IAAI,CAAb,GAAiBA,SAAjB,GAA6B,CAAtC;AAAA,MACI;AACJG,EAAAA,EAAE,GAAG,CAACF,MAAM,KAAK3Q,IAAI,GAAG,EAAH,GAAQ,GAAjB,CAAP,KAAiC0Q,SAAS,GAAG,CAAZ,GAAgBA,SAAhB,GAA4B,CAA7D,CAFL;AAAA,MAGII,EAAE,GAAGD,EAAE,GAAGpgB,IAAL,IAAaC,IAAI,CAACqgB,IAAL,CAAU,IAAIH,EAAd,KAAqB,CAAlC,CAHT;AAAA,MAIIR,OAAO,GAAG,SAASA,OAAT,CAAiB5Y,CAAjB,EAAoB;AAChC,WAAOA,CAAC,KAAK,CAAN,GAAU,CAAV,GAAcoZ,EAAE,GAAGlgB,IAAI,CAACwT,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,GAAM1M,CAAlB,CAAL,GAA4BtG,IAAI,CAAC,CAACsG,CAAC,GAAGsZ,EAAL,IAAWD,EAAZ,CAAhC,GAAkD,CAAvE;AACD,GAND;AAAA,MAOItO,IAAI,GAAGvC,IAAI,KAAK,KAAT,GAAiBoQ,OAAjB,GAA2BpQ,IAAI,KAAK,IAAT,GAAgB,UAAUxI,CAAV,EAAa;AACjE,WAAO,IAAI4Y,OAAO,CAAC,IAAI5Y,CAAL,CAAlB;AACD,GAFqC,GAElCgZ,iBAAiB,CAACJ,OAAD,CATrB;;AAWAS,EAAAA,EAAE,GAAGpgB,IAAI,GAAGogB,EAAZ,CAZoE,CAYpD;;AAEhBtO,EAAAA,IAAI,CAACyF,MAAL,GAAc,UAAU0I,SAAV,EAAqBC,MAArB,EAA6B;AACzC,WAAOF,cAAc,CAACzQ,IAAD,EAAO0Q,SAAP,EAAkBC,MAAlB,CAArB;AACD,GAFD;;AAIA,SAAOpO,IAAP;AACD,CA/6CD;AAAA,IAg7CIyO,WAAW,GAAG,SAASA,WAAT,CAAqBhR,IAArB,EAA2BiR,SAA3B,EAAsC;AACtD,MAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,IAAAA,SAAS,GAAG,OAAZ;AACD;;AAED,MAAIb,OAAO,GAAG,SAASA,OAAT,CAAiB5Y,CAAjB,EAAoB;AAChC,WAAOA,CAAC,GAAG,EAAEA,CAAF,GAAMA,CAAN,IAAW,CAACyZ,SAAS,GAAG,CAAb,IAAkBzZ,CAAlB,GAAsByZ,SAAjC,IAA8C,CAAjD,GAAqD,CAA7D;AACD,GAFD;AAAA,MAGI1O,IAAI,GAAGvC,IAAI,KAAK,KAAT,GAAiBoQ,OAAjB,GAA2BpQ,IAAI,KAAK,IAAT,GAAgB,UAAUxI,CAAV,EAAa;AACjE,WAAO,IAAI4Y,OAAO,CAAC,IAAI5Y,CAAL,CAAlB;AACD,GAFqC,GAElCgZ,iBAAiB,CAACJ,OAAD,CALrB;;AAOA7N,EAAAA,IAAI,CAACyF,MAAL,GAAc,UAAUiJ,SAAV,EAAqB;AACjC,WAAOD,WAAW,CAAChR,IAAD,EAAOiR,SAAP,CAAlB;AACD,GAFD;;AAIA,SAAO1O,IAAP;AACD,CAj8CD,C,CAi8CG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA7M,YAAY,CAAC,sCAAD,EAAyC,UAAU5B,IAAV,EAAgBgB,CAAhB,EAAmB;AACtE,MAAIoc,KAAK,GAAGpc,CAAC,GAAG,CAAJ,GAAQA,CAAC,GAAG,CAAZ,GAAgBA,CAA5B;;AAEAob,EAAAA,WAAW,CAACpc,IAAI,GAAG,QAAP,IAAmBod,KAAK,GAAG,CAA3B,CAAD,EAAgCpc,CAAC,GAAG,UAAU0C,CAAV,EAAa;AAC1D,WAAO9G,IAAI,CAACwT,GAAL,CAAS1M,CAAT,EAAY0Z,KAAZ,CAAP;AACD,GAF2C,GAExC,UAAU1Z,CAAV,EAAa;AACf,WAAOA,CAAP;AACD,GAJU,EAIR,UAAUA,CAAV,EAAa;AACd,WAAO,IAAI9G,IAAI,CAACwT,GAAL,CAAS,IAAI1M,CAAb,EAAgB0Z,KAAhB,CAAX;AACD,GANU,EAMR,UAAU1Z,CAAV,EAAa;AACd,WAAOA,CAAC,GAAG,EAAJ,GAAS9G,IAAI,CAACwT,GAAL,CAAS1M,CAAC,GAAG,CAAb,EAAgB0Z,KAAhB,IAAyB,CAAlC,GAAsC,IAAIxgB,IAAI,CAACwT,GAAL,CAAS,CAAC,IAAI1M,CAAL,IAAU,CAAnB,EAAsB0Z,KAAtB,IAA+B,CAAhF;AACD,GARU,CAAX;AASD,CAZW,CAAZ;;AAcArC,QAAQ,CAACsC,MAAT,CAAgBC,QAAhB,GAA2BvC,QAAQ,CAACwC,IAAT,GAAgBxC,QAAQ,CAACsC,MAAT,CAAgBhB,MAA3D;;AAEAD,WAAW,CAAC,SAAD,EAAYO,cAAc,CAAC,IAAD,CAA1B,EAAkCA,cAAc,CAAC,KAAD,CAAhD,EAAyDA,cAAc,EAAvE,CAAX;;AAEA,CAAC,UAAUtZ,CAAV,EAAamU,CAAb,EAAgB;AACf,MAAIgG,EAAE,GAAG,IAAIhG,CAAb;AAAA,MACIiG,EAAE,GAAG,IAAID,EADb;AAAA,MAEIE,EAAE,GAAG,MAAMF,EAFf;AAAA,MAGIlB,OAAO,GAAG,SAASA,OAAT,CAAiB5Y,CAAjB,EAAoB;AAChC,WAAOA,CAAC,GAAG8Z,EAAJ,GAASna,CAAC,GAAGK,CAAJ,GAAQA,CAAjB,GAAqBA,CAAC,GAAG+Z,EAAJ,GAASpa,CAAC,GAAGzG,IAAI,CAACwT,GAAL,CAAS1M,CAAC,GAAG,MAAM8T,CAAnB,EAAsB,CAAtB,CAAJ,GAA+B,GAAxC,GAA8C9T,CAAC,GAAGga,EAAJ,GAASra,CAAC,IAAIK,CAAC,IAAI,OAAO8T,CAAhB,CAAD,GAAsB9T,CAAtB,GAA0B,KAAnC,GAA2CL,CAAC,GAAGzG,IAAI,CAACwT,GAAL,CAAS1M,CAAC,GAAG,QAAQ8T,CAArB,EAAwB,CAAxB,CAAJ,GAAiC,OAAtJ;AACD,GALD;;AAOA4E,EAAAA,WAAW,CAAC,QAAD,EAAW,UAAU1Y,CAAV,EAAa;AACjC,WAAO,IAAI4Y,OAAO,CAAC,IAAI5Y,CAAL,CAAlB;AACD,GAFU,EAER4Y,OAFQ,CAAX;AAGD,CAXD,EAWG,MAXH,EAWW,IAXX;;AAaAF,WAAW,CAAC,MAAD,EAAS,UAAU1Y,CAAV,EAAa;AAC/B,SAAOA,CAAC,GAAG9G,IAAI,CAACwT,GAAL,CAAS,CAAT,EAAY,MAAM1M,CAAC,GAAG,CAAV,CAAZ,CAAH,GAA+B,CAAvC;AACD,CAFU,CAAX;;AAIA0Y,WAAW,CAAC,MAAD,EAAS,UAAU1Y,CAAV,EAAa;AAC/B,SAAO,EAAE1G,KAAK,CAAC,IAAI0G,CAAC,GAAGA,CAAT,CAAL,GAAmB,CAArB,CAAP;AACD,CAFU,CAAX;;AAIA0Y,WAAW,CAAC,MAAD,EAAS,UAAU1Y,CAAV,EAAa;AAC/B,SAAOA,CAAC,KAAK,CAAN,GAAU,CAAV,GAAc,CAACxG,IAAI,CAACwG,CAAC,GAAG5G,QAAL,CAAL,GAAsB,CAA3C;AACD,CAFU,CAAX;;AAIAsf,WAAW,CAAC,MAAD,EAASc,WAAW,CAAC,IAAD,CAApB,EAA4BA,WAAW,CAAC,KAAD,CAAvC,EAAgDA,WAAW,EAA3D,CAAX;;AAEAnC,QAAQ,CAAC4C,WAAT,GAAuB5C,QAAQ,CAAC6C,KAAT,GAAiB3e,QAAQ,CAAC0e,WAAT,GAAuB;AAC7DzJ,EAAAA,MAAM,EAAE,SAASA,MAAT,CAAgB0J,KAAhB,EAAuBC,cAAvB,EAAuC;AAC7C,QAAID,KAAK,KAAK,KAAK,CAAnB,EAAsB;AACpBA,MAAAA,KAAK,GAAG,CAAR;AACD;;AAED,QAAId,EAAE,GAAG,IAAIc,KAAb;AAAA,QACIb,EAAE,GAAGa,KAAK,IAAIC,cAAc,GAAG,CAAH,GAAO,CAAzB,CADd;AAAA,QAEIb,EAAE,GAAGa,cAAc,GAAG,CAAH,GAAO,CAF9B;AAAA,QAGIhR,GAAG,GAAG,IAAInQ,QAHd;AAIA,WAAO,UAAUgH,CAAV,EAAa;AAClB,aAAO,CAAC,CAACqZ,EAAE,GAAGjV,MAAM,CAAC,CAAD,EAAI+E,GAAJ,EAASnJ,CAAT,CAAX,GAAyB,CAA1B,IAA+BsZ,EAAhC,IAAsCF,EAA7C;AACD,KAFD;AAGD;AAb4D,CAA/D;AAeA1gB,SAAS,CAACqS,IAAV,GAAiBsM,QAAQ,CAAC,UAAD,CAAzB;;AAEAnZ,YAAY,CAAC,oEAAD,EAAuE,UAAU5B,IAAV,EAAgB;AACjG,SAAOW,cAAc,IAAIX,IAAI,GAAG,GAAP,GAAaA,IAAb,GAAoB,SAA7C;AACD,CAFW,CAAZ;AAGA;AACA;AACA;AACA;AACA;;;AAGA,OAAO,IAAIqB,OAAO,GAAG,SAASA,OAAT,CAAiBP,MAAjB,EAAyBI,OAAzB,EAAkC;AACrD,OAAK4c,EAAL,GAAU/gB,KAAK,EAAf;AACA+D,EAAAA,MAAM,CAACG,KAAP,GAAe,IAAf;AACA,OAAKH,MAAL,GAAcA,MAAd;AACA,OAAKI,OAAL,GAAeA,OAAf;AACA,OAAK4T,GAAL,GAAW5T,OAAO,GAAGA,OAAO,CAAC4T,GAAX,GAAiBrT,YAAnC;AACA,OAAKsc,GAAL,GAAW7c,OAAO,GAAGA,OAAO,CAAC6T,SAAX,GAAuBC,UAAzC;AACD,CAPM;AAQP;AACA;AACA;AACA;AACA;;AAEA,OAAO,IAAIgJ,SAAS,GAAG,aAAa,YAAY;AAC9C,WAASA,SAAT,CAAmB1Z,IAAnB,EAAyB;AACvB,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAK8D,MAAL,GAAc,CAAC9D,IAAI,CAAC/H,KAAN,IAAe,CAA7B;;AAEA,QAAI,KAAKiK,OAAL,GAAelC,IAAI,CAAC0G,MAAL,KAAgBiT,QAAhB,GAA2B,CAAC,CAA5B,GAAgC3Z,IAAI,CAAC0G,MAAL,IAAe,CAAlE,EAAqE;AACnE;AACA,WAAKrE,OAAL,GAAerC,IAAI,CAACqF,WAAL,IAAoB,CAAnC;AACA,WAAKI,KAAL,GAAa,CAAC,CAACzF,IAAI,CAAC4Z,IAAP,IAAe,CAAC,CAAC5Z,IAAI,CAAC0X,QAAnC;AACD;;AAED,SAAK1V,GAAL,GAAW,CAAX;;AAEAuE,IAAAA,YAAY,CAAC,IAAD,EAAO,CAACvG,IAAI,CAACjI,QAAb,EAAuB,CAAvB,EAA0B,CAA1B,CAAZ;;AAEA,SAAKkN,IAAL,GAAYjF,IAAI,CAACiF,IAAjB;AACAiP,IAAAA,aAAa,IAAIxP,OAAO,CAACiR,IAAR,EAAjB;AACD;;AAED,MAAIkE,MAAM,GAAGH,SAAS,CAACviB,SAAvB;;AAEA0iB,EAAAA,MAAM,CAAC5hB,KAAP,GAAe,SAASA,KAAT,CAAegB,KAAf,EAAsB;AACnC,QAAIA,KAAK,IAAIA,KAAK,KAAK,CAAvB,EAA0B;AACxB,WAAKgH,MAAL,IAAe,KAAKA,MAAL,CAAYiD,iBAA3B,IAAgD,KAAK4W,SAAL,CAAe,KAAKnY,MAAL,GAAc1I,KAAd,GAAsB,KAAK6K,MAA1C,CAAhD;AACA,WAAKA,MAAL,GAAc7K,KAAd;AACA,aAAO,IAAP;AACD;;AAED,WAAO,KAAK6K,MAAZ;AACD,GARD;;AAUA+V,EAAAA,MAAM,CAAC9hB,QAAP,GAAkB,SAASA,QAAT,CAAkBkB,KAAlB,EAAyB;AACzC,WAAO4T,SAAS,CAAChQ,MAAV,GAAmB,KAAKiF,aAAL,CAAmB,KAAKI,OAAL,GAAe,CAAf,GAAmBjJ,KAAK,GAAG,CAACA,KAAK,GAAG,KAAKoJ,OAAd,IAAyB,KAAKH,OAAzD,GAAmEjJ,KAAtF,CAAnB,GAAkH,KAAK6I,aAAL,MAAwB,KAAKJ,IAAtJ;AACD,GAFD;;AAIAmY,EAAAA,MAAM,CAAC/X,aAAP,GAAuB,SAASA,aAAT,CAAuB7I,KAAvB,EAA8B;AACnD,QAAI,CAAC4T,SAAS,CAAChQ,MAAf,EAAuB;AACrB,aAAO,KAAK+F,KAAZ;AACD;;AAED,SAAKhB,MAAL,GAAc,CAAd;AACA,WAAO2E,YAAY,CAAC,IAAD,EAAO,KAAKrE,OAAL,GAAe,CAAf,GAAmBjJ,KAAnB,GAA2B,CAACA,KAAK,GAAG,KAAKiJ,OAAL,GAAe,KAAKG,OAA7B,KAAyC,KAAKH,OAAL,GAAe,CAAxD,CAAlC,CAAnB;AACD,GAPD;;AASA2X,EAAAA,MAAM,CAAC5W,SAAP,GAAmB,SAASA,SAAT,CAAmB8W,UAAnB,EAA+Bnb,cAA/B,EAA+C;AAChE0K,IAAAA,KAAK;;AAEL,QAAI,CAACuD,SAAS,CAAChQ,MAAf,EAAuB;AACrB,aAAO,KAAKuF,MAAZ;AACD;;AAED,QAAInC,MAAM,GAAG,KAAKG,GAAlB;;AAEA,QAAIH,MAAM,IAAIA,MAAM,CAACiD,iBAAjB,IAAsC,KAAKlB,GAA/C,EAAoD;AAClDgB,MAAAA,cAAc,CAAC,IAAD,EAAO+W,UAAP,CAAd;;AAEA,OAAC9Z,MAAM,CAACG,GAAR,IAAeH,MAAM,CAACA,MAAtB,IAAgCmD,cAAc,CAACnD,MAAD,EAAS,IAAT,CAA9C,CAHkD,CAGY;AAC9D;;AAEA,aAAOA,MAAM,IAAIA,MAAM,CAACA,MAAxB,EAAgC;AAC9B,YAAIA,MAAM,CAACA,MAAP,CAAckD,KAAd,KAAwBlD,MAAM,CAAC0B,MAAP,IAAiB1B,MAAM,CAAC+B,GAAP,IAAc,CAAd,GAAkB/B,MAAM,CAACmC,MAAP,GAAgBnC,MAAM,CAAC+B,GAAzC,GAA+C,CAAC/B,MAAM,CAAC6B,aAAP,KAAyB7B,MAAM,CAACmC,MAAjC,IAA2C,CAACnC,MAAM,CAAC+B,GAAnH,CAA5B,EAAqJ;AACnJ/B,UAAAA,MAAM,CAACgD,SAAP,CAAiBhD,MAAM,CAACmC,MAAxB,EAAgC,IAAhC;AACD;;AAEDnC,QAAAA,MAAM,GAAGA,MAAM,CAACA,MAAhB;AACD;;AAED,UAAI,CAAC,KAAKA,MAAN,IAAgB,KAAKG,GAAL,CAASiB,kBAAzB,KAAgD,KAAKW,GAAL,GAAW,CAAX,IAAgB+X,UAAU,GAAG,KAAKnX,KAAlC,IAA2C,KAAKZ,GAAL,GAAW,CAAX,IAAgB+X,UAAU,GAAG,CAAxE,IAA6E,CAAC,KAAKnX,KAAN,IAAe,CAACmX,UAA7I,CAAJ,EAA8J;AAC5J;AACArW,QAAAA,cAAc,CAAC,KAAKtD,GAAN,EAAW,IAAX,EAAiB,KAAKuB,MAAL,GAAc,KAAKmC,MAApC,CAAd;AACD;AACF;;AAED,QAAI,KAAK1B,MAAL,KAAgB2X,UAAhB,IAA8B,CAAC,KAAKrY,IAAN,IAAc,CAAC9C,cAA7C,IAA+D,KAAK0E,QAAL,IAAiBhL,IAAI,CAACwK,GAAL,CAAS,KAAKW,MAAd,MAA0BrL,QAA1G,IAAsH,CAAC2hB,UAAD,IAAe,CAAC,KAAKzW,QAArB,KAAkC,KAAK4M,GAAL,IAAY,KAAK8J,SAAnD,CAA1H,EAAyL;AACvL;AACA,WAAKhY,GAAL,KAAa,KAAKiY,MAAL,GAAcF,UAA3B,EAFuL,CAE/I;AACxC;AACA;;AAEAtb,MAAAA,eAAe,CAAC,IAAD,EAAOsb,UAAP,EAAmBnb,cAAnB,CAAf,CANuL,CAMpI;AACnD;;AAED;;AAED,WAAO,IAAP;AACD,GAzCD;;AA2CAib,EAAAA,MAAM,CAAClb,IAAP,GAAc,SAASA,IAAT,CAAc1F,KAAd,EAAqB2F,cAArB,EAAqC;AACjD,WAAOiO,SAAS,CAAChQ,MAAV,GAAmB,KAAKoG,SAAL,CAAe3K,IAAI,CAACgQ,GAAL,CAAS,KAAKxG,aAAL,EAAT,EAA+B7I,KAAK,GAAGgJ,qBAAqB,CAAC,IAAD,CAA5D,KAAuE,KAAKP,IAAL,GAAY,KAAKW,OAAxF,MAAqGpJ,KAAK,GAAG,KAAKyI,IAAR,GAAe,CAAzH,CAAf,EAA4I9C,cAA5I,CAAnB,GAAiL,KAAKuE,KAA7L,CADiD,CACmJ;AACrM,GAFD;;AAIA0W,EAAAA,MAAM,CAACjT,aAAP,GAAuB,SAASA,aAAT,CAAuB3N,KAAvB,EAA8B2F,cAA9B,EAA8C;AACnE,WAAOiO,SAAS,CAAChQ,MAAV,GAAmB,KAAKoG,SAAL,CAAe,KAAKnB,aAAL,KAAuB7I,KAAtC,EAA6C2F,cAA7C,CAAnB,GAAkF,KAAKkD,aAAL,KAAuBxJ,IAAI,CAACgQ,GAAL,CAAS,CAAT,EAAY,KAAKlG,MAAL,GAAc,KAAKQ,KAA/B,CAAvB,GAA+D,KAAKwC,KAA7J;AACD,GAFD;;AAIAyU,EAAAA,MAAM,CAACtL,QAAP,GAAkB,SAASA,QAAT,CAAkBtV,KAAlB,EAAyB2F,cAAzB,EAAyC;AACzD,WAAOiO,SAAS,CAAChQ,MAAV,GAAmB,KAAKoG,SAAL,CAAe,KAAKlL,QAAL,MAAmB,KAAK0N,KAAL,IAAc,EAAE,KAAKF,SAAL,KAAmB,CAArB,CAAd,GAAwC,IAAItM,KAA5C,GAAoDA,KAAvE,IAAgFgJ,qBAAqB,CAAC,IAAD,CAApH,EAA4HrD,cAA5H,CAAnB,GAAiK,KAAK7G,QAAL,KAAkBO,IAAI,CAACgQ,GAAL,CAAS,CAAT,EAAY,KAAKnF,KAAL,GAAa,KAAKzB,IAA9B,CAAlB,GAAwD,KAAK0D,KAArO;AACD,GAFD;;AAIAyU,EAAAA,MAAM,CAACtU,SAAP,GAAmB,SAASA,SAAT,CAAmBtM,KAAnB,EAA0B2F,cAA1B,EAA0C;AAC3D,QAAI2D,aAAa,GAAG,KAAKxK,QAAL,KAAkB,KAAKsK,OAA3C;;AAEA,WAAOwK,SAAS,CAAChQ,MAAV,GAAmB,KAAKoG,SAAL,CAAe,KAAKE,KAAL,GAAa,CAAClK,KAAK,GAAG,CAAT,IAAcsJ,aAA1C,EAAyD3D,cAAzD,CAAnB,GAA8F,KAAKsD,OAAL,GAAeC,eAAe,CAAC,KAAKC,MAAN,EAAcG,aAAd,CAAf,GAA8C,CAA7D,GAAiE,CAAtK;AACD,GAJD,CAIE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;;AAgBAsX,EAAAA,MAAM,CAAC9V,SAAP,GAAmB,SAASA,SAAT,CAAmB9K,KAAnB,EAA0B;AAC3C,QAAI,CAAC4T,SAAS,CAAChQ,MAAf,EAAuB;AACrB,aAAO,KAAKkG,IAAL,KAAc,CAAC3K,QAAf,GAA0B,CAA1B,GAA8B,KAAK2K,IAA1C,CADqB,CAC2B;AACjD;;AAED,QAAI,KAAKA,IAAL,KAAc9J,KAAlB,EAAyB;AACvB,aAAO,IAAP;AACD;;AAED,QAAIqJ,KAAK,GAAG,KAAKrC,MAAL,IAAe,KAAK+B,GAApB,GAA0BU,uBAAuB,CAAC,KAAKzC,MAAL,CAAYkD,KAAb,EAAoB,IAApB,CAAjD,GAA6E,KAAKf,MAA9F,CAT2C,CAS2D;AACtG;AACA;AACA;;AAEA,SAAKW,IAAL,GAAY,CAAC9J,KAAD,IAAU,CAAtB;AACA,SAAK+I,GAAL,GAAW,KAAKkY,GAAL,IAAYjhB,KAAK,KAAK,CAACb,QAAvB,GAAkC,CAAlC,GAAsC,KAAK2K,IAAtD,CAf2C,CAeiB;;AAE5DlB,IAAAA,iBAAiB,CAAC,KAAKoB,SAAL,CAAeO,MAAM,CAAC,CAAC,KAAKM,MAAP,EAAe,KAAKlB,KAApB,EAA2BN,KAA3B,CAArB,EAAwD,IAAxD,CAAD,CAAjB;;AAEAO,IAAAA,OAAO,CAAC,IAAD,CAAP,CAnB2C,CAmB5B;;;AAGf,WAAO,IAAP;AACD,GAvBD;;AAyBAgX,EAAAA,MAAM,CAACM,MAAP,GAAgB,SAASA,MAAT,CAAgBlhB,KAAhB,EAAuB;AACrC,QAAI,CAAC4T,SAAS,CAAChQ,MAAf,EAAuB;AACrB,aAAO,KAAKqd,GAAZ;AACD;;AAED,QAAI,KAAKA,GAAL,KAAajhB,KAAjB,EAAwB;AACtB,WAAKihB,GAAL,GAAWjhB,KAAX;;AAEA,UAAIA,KAAJ,EAAW;AACT,aAAKghB,MAAL,GAAc,KAAK7X,MAAL,IAAe9J,IAAI,CAACiQ,GAAL,CAAS,CAAC,KAAKzE,MAAf,EAAuB,KAAKP,OAAL,EAAvB,CAA7B,CADS,CAC4D;;AAErE,aAAKvB,GAAL,GAAW,KAAKT,IAAL,GAAY,CAAvB,CAHS,CAGiB;AAC3B,OAJD,MAIO;AACL+H,QAAAA,KAAK;;AAEL,aAAKtH,GAAL,GAAW,KAAKe,IAAhB,CAHK,CAGiB;;AAEtB,aAAKE,SAAL,CAAe,KAAKhD,MAAL,IAAe,CAAC,KAAKA,MAAL,CAAYiD,iBAA5B,GAAgD,KAAKK,OAAL,EAAhD,GAAiE,KAAKnB,MAAL,IAAe,KAAK6X,MAApG,EAA4G,KAAK1L,QAAL,OAAoB,CAApB,IAAyBjW,IAAI,CAACwK,GAAL,CAAS,KAAKW,MAAd,MAA0BrL,QAAnD,KAAgE,KAAKgK,MAAL,IAAehK,QAA/E,CAA5G,EALK,CAKkM;AACxM;AACF;;AAED,WAAO,IAAP;AACD,GAtBD;;AAwBAyhB,EAAAA,MAAM,CAACC,SAAP,GAAmB,SAASA,SAAT,CAAmB7gB,KAAnB,EAA0B;AAC3C,QAAI4T,SAAS,CAAChQ,MAAd,EAAsB;AACpB,WAAK8E,MAAL,GAAc1I,KAAd;AACA,UAAIgH,MAAM,GAAG,KAAKA,MAAL,IAAe,KAAKG,GAAjC;AACAH,MAAAA,MAAM,KAAKA,MAAM,CAAC+D,KAAP,IAAgB,CAAC,KAAK/D,MAA3B,CAAN,IAA4CyD,cAAc,CAACzD,MAAD,EAAS,IAAT,EAAehH,KAAK,GAAG,KAAK6K,MAA5B,CAA1D;AACA,aAAO,IAAP;AACD;;AAED,WAAO,KAAKnC,MAAZ;AACD,GATD;;AAWAkY,EAAAA,MAAM,CAAC7S,OAAP,GAAiB,SAASA,OAAT,CAAiBoT,cAAjB,EAAiC;AAChD,WAAO,KAAKzY,MAAL,GAAc,CAACrI,WAAW,CAAC8gB,cAAD,CAAX,GAA8B,KAAKtY,aAAL,EAA9B,GAAqD,KAAK/J,QAAL,EAAtD,IAAyEO,IAAI,CAACwK,GAAL,CAAS,KAAKd,GAAL,IAAY,CAArB,CAA9F;AACD,GAFD;;AAIA6X,EAAAA,MAAM,CAACtW,OAAP,GAAiB,SAASA,OAAT,CAAiB8W,WAAjB,EAA8B;AAC7C,QAAIpa,MAAM,GAAG,KAAKA,MAAL,IAAe,KAAKG,GAAjC,CAD6C,CACP;;AAEtC,WAAO,CAACH,MAAD,GAAU,KAAKmC,MAAf,GAAwBiY,WAAW,KAAK,CAAC,KAAKrY,GAAN,IAAa,KAAKE,OAAL,IAAgB,KAAKiB,KAArB,IAA8B,KAAKyD,aAAL,KAAuB,CAAvE,CAAX,GAAuF,KAAKxE,MAAL,IAAe,KAAKV,IAAL,GAAY,KAAKW,OAAhC,CAAvF,GAAkI,CAAC,KAAKL,GAAN,GAAY,KAAKI,MAAjB,GAA0BM,uBAAuB,CAACzC,MAAM,CAACsD,OAAP,CAAe8W,WAAf,CAAD,EAA8B,IAA9B,CAAlN;AACD,GAJD;;AAMAR,EAAAA,MAAM,CAACS,UAAP,GAAoB,SAASA,UAAT,CAAoB/W,OAApB,EAA6B;AAC/C,QAAI7E,SAAS,GAAG,IAAhB;AAAA,QACIC,IAAI,GAAGkO,SAAS,CAAChQ,MAAV,GAAmB0G,OAAnB,GAA6B7E,SAAS,CAAC6E,OAAV,EADxC;;AAGA,WAAO7E,SAAP,EAAkB;AAChBC,MAAAA,IAAI,GAAGD,SAAS,CAACiD,MAAV,GAAmBhD,IAAI,IAAID,SAAS,CAACsD,GAAV,IAAiB,CAArB,CAA9B;AACAtD,MAAAA,SAAS,GAAGA,SAAS,CAAC0B,GAAtB;AACD;;AAED,WAAOzB,IAAP;AACD,GAVD;;AAYAkb,EAAAA,MAAM,CAACnT,MAAP,GAAgB,SAASA,MAAT,CAAgBzN,KAAhB,EAAuB;AACrC,QAAI4T,SAAS,CAAChQ,MAAd,EAAsB;AACpB,WAAKqF,OAAL,GAAejJ,KAAK,KAAK0gB,QAAV,GAAqB,CAAC,CAAtB,GAA0B1gB,KAAzC;AACA,aAAO4N,sBAAsB,CAAC,IAAD,CAA7B;AACD;;AAED,WAAO,KAAK3E,OAAL,KAAiB,CAAC,CAAlB,GAAsByX,QAAtB,GAAiC,KAAKzX,OAA7C;AACD,GAPD;;AASA2X,EAAAA,MAAM,CAACxU,WAAP,GAAqB,SAASA,WAAT,CAAqBpM,KAArB,EAA4B;AAC/C,QAAI4T,SAAS,CAAChQ,MAAd,EAAsB;AACpB,UAAI8B,IAAI,GAAG,KAAKwE,KAAhB;AACA,WAAKd,OAAL,GAAepJ,KAAf;;AAEA4N,MAAAA,sBAAsB,CAAC,IAAD,CAAtB;;AAEA,aAAOlI,IAAI,GAAG,KAAKA,IAAL,CAAUA,IAAV,CAAH,GAAqB,IAAhC;AACD;;AAED,WAAO,KAAK0D,OAAZ;AACD,GAXD;;AAaAwX,EAAAA,MAAM,CAACD,IAAP,GAAc,SAASA,IAAT,CAAc3gB,KAAd,EAAqB;AACjC,QAAI4T,SAAS,CAAChQ,MAAd,EAAsB;AACpB,WAAK4I,KAAL,GAAaxM,KAAb;AACA,aAAO,IAAP;AACD;;AAED,WAAO,KAAKwM,KAAZ;AACD,GAPD;;AASAoU,EAAAA,MAAM,CAACU,IAAP,GAAc,SAASA,IAAT,CAAc5W,QAAd,EAAwB/E,cAAxB,EAAwC;AACpD,WAAO,KAAKqE,SAAL,CAAeY,cAAc,CAAC,IAAD,EAAOF,QAAP,CAA7B,EAA+CrK,WAAW,CAACsF,cAAD,CAA1D,CAAP;AACD,GAFD;;AAIAib,EAAAA,MAAM,CAACW,OAAP,GAAiB,SAASA,OAAT,CAAiBC,YAAjB,EAA+B7b,cAA/B,EAA+C;AAC9D,WAAO,KAAK8b,IAAL,GAAYzX,SAAZ,CAAsBwX,YAAY,GAAG,CAAC,KAAK3W,MAAT,GAAkB,CAApD,EAAuDxK,WAAW,CAACsF,cAAD,CAAlE,CAAP;AACD,GAFD;;AAIAib,EAAAA,MAAM,CAACa,IAAP,GAAc,SAASA,IAAT,CAAcrQ,IAAd,EAAoBzL,cAApB,EAAoC;AAChDyL,IAAAA,IAAI,IAAI,IAAR,IAAgB,KAAKkQ,IAAL,CAAUlQ,IAAV,EAAgBzL,cAAhB,CAAhB;AACA,WAAO,KAAK+b,QAAL,CAAc,KAAd,EAAqBR,MAArB,CAA4B,KAA5B,CAAP;AACD,GAHD;;AAKAN,EAAAA,MAAM,CAACe,OAAP,GAAiB,SAASA,OAAT,CAAiBvQ,IAAjB,EAAuBzL,cAAvB,EAAuC;AACtDyL,IAAAA,IAAI,IAAI,IAAR,IAAgB,KAAKkQ,IAAL,CAAUlQ,IAAI,IAAI,KAAKvI,aAAL,EAAlB,EAAwClD,cAAxC,CAAhB;AACA,WAAO,KAAK+b,QAAL,CAAc,IAAd,EAAoBR,MAApB,CAA2B,KAA3B,CAAP;AACD,GAHD;;AAKAN,EAAAA,MAAM,CAACgB,KAAP,GAAe,SAASA,KAAT,CAAeC,MAAf,EAAuBlc,cAAvB,EAAuC;AACpDkc,IAAAA,MAAM,IAAI,IAAV,IAAkB,KAAKP,IAAL,CAAUO,MAAV,EAAkBlc,cAAlB,CAAlB;AACA,WAAO,KAAKub,MAAL,CAAY,IAAZ,CAAP;AACD,GAHD;;AAKAN,EAAAA,MAAM,CAACkB,MAAP,GAAgB,SAASA,MAAT,GAAkB;AAChC,WAAO,KAAKZ,MAAL,CAAY,KAAZ,CAAP;AACD,GAFD;;AAIAN,EAAAA,MAAM,CAACc,QAAP,GAAkB,SAASA,QAAT,CAAkB1hB,KAAlB,EAAyB;AACzC,QAAI4T,SAAS,CAAChQ,MAAd,EAAsB;AACpB,OAAC,CAAC5D,KAAF,KAAY,KAAK0hB,QAAL,EAAZ,IAA+B,KAAK5W,SAAL,CAAe,CAAC,KAAKhB,IAAN,KAAe9J,KAAK,GAAG,CAACb,QAAJ,GAAe,CAAnC,CAAf,CAA/B,CADoB,CACkE;;AAEtF,aAAO,IAAP;AACD;;AAED,WAAO,KAAK2K,IAAL,GAAY,CAAnB;AACD,GARD;;AAUA8W,EAAAA,MAAM,CAAClU,UAAP,GAAoB,SAASA,UAAT,GAAsB;AACxC,SAAKrC,QAAL,GAAgB,KAAK/B,IAAL,GAAY,CAA5B;AACA,SAAKkC,MAAL,GAAc,CAACrL,QAAf;AACA,WAAO,IAAP;AACD,GAJD;;AAMAyhB,EAAAA,MAAM,CAACmB,QAAP,GAAkB,SAASA,QAAT,GAAoB;AACpC,QAAI/a,MAAM,GAAG,KAAKA,MAAL,IAAe,KAAKG,GAAjC;AAAA,QACIkO,KAAK,GAAG,KAAK3M,MADjB;AAAA,QAEI4B,OAFJ;AAGA,WAAO,CAAC,EAAE,CAACtD,MAAD,IAAW,KAAK+B,GAAL,IAAY,KAAKsB,QAAjB,IAA6BrD,MAAM,CAAC+a,QAAP,EAA7B,IAAkD,CAACzX,OAAO,GAAGtD,MAAM,CAACsD,OAAP,CAAe,IAAf,CAAX,KAAoC+K,KAAtF,IAA+F/K,OAAO,GAAG,KAAKyD,OAAL,CAAa,IAAb,IAAqB5O,QAA3I,CAAR;AACD,GALD;;AAOAyhB,EAAAA,MAAM,CAACoB,aAAP,GAAuB,SAASA,aAAT,CAAuBrT,IAAvB,EAA6ByH,QAA7B,EAAuCxH,MAAvC,EAA+C;AACpE,QAAI7H,IAAI,GAAG,KAAKA,IAAhB;;AAEA,QAAI6M,SAAS,CAAChQ,MAAV,GAAmB,CAAvB,EAA0B;AACxB,UAAI,CAACwS,QAAL,EAAe;AACb,eAAOrP,IAAI,CAAC4H,IAAD,CAAX;AACD,OAFD,MAEO;AACL5H,QAAAA,IAAI,CAAC4H,IAAD,CAAJ,GAAayH,QAAb;AACAxH,QAAAA,MAAM,KAAK7H,IAAI,CAAC4H,IAAI,GAAG,QAAR,CAAJ,GAAwBC,MAA7B,CAAN;AACAD,QAAAA,IAAI,KAAK,UAAT,KAAwB,KAAK5B,SAAL,GAAiBqJ,QAAzC;AACD;;AAED,aAAO,IAAP;AACD;;AAED,WAAOrP,IAAI,CAAC4H,IAAD,CAAX;AACD,GAhBD;;AAkBAiS,EAAAA,MAAM,CAACqB,IAAP,GAAc,SAASA,IAAT,CAAcC,WAAd,EAA2B;AACvC,QAAIrkB,IAAI,GAAG,IAAX;AACA,WAAO,IAAIskB,OAAJ,CAAY,UAAUC,OAAV,EAAmB;AACpC,UAAIpO,CAAC,GAAG/T,WAAW,CAACiiB,WAAD,CAAX,GAA2BA,WAA3B,GAAyChc,YAAjD;AAAA,UACImc,QAAQ,GAAG,SAASA,QAAT,GAAoB;AACjC,YAAIC,KAAK,GAAGzkB,IAAI,CAACokB,IAAjB;AACApkB,QAAAA,IAAI,CAACokB,IAAL,GAAY,IAAZ,CAFiC,CAEf;;AAElBhiB,QAAAA,WAAW,CAAC+T,CAAD,CAAX,KAAmBA,CAAC,GAAGA,CAAC,CAACnW,IAAD,CAAxB,MAAoCmW,CAAC,CAACiO,IAAF,IAAUjO,CAAC,KAAKnW,IAApD,MAA8DA,IAAI,CAACokB,IAAL,GAAYK,KAA1E;AACAF,QAAAA,OAAO,CAACpO,CAAD,CAAP;AACAnW,QAAAA,IAAI,CAACokB,IAAL,GAAYK,KAAZ;AACD,OARD;;AAUA,UAAIzkB,IAAI,CAACwM,QAAL,IAAiBxM,IAAI,CAAC8P,aAAL,OAAyB,CAA1C,IAA+C9P,IAAI,CAACkL,GAAL,IAAY,CAA3D,IAAgE,CAAClL,IAAI,CAACsL,MAAN,IAAgBtL,IAAI,CAACkL,GAAL,GAAW,CAA/F,EAAkG;AAChGsZ,QAAAA,QAAQ;AACT,OAFD,MAEO;AACLxkB,QAAAA,IAAI,CAACoP,KAAL,GAAaoV,QAAb;AACD;AACF,KAhBM,CAAP;AAiBD,GAnBD;;AAqBAzB,EAAAA,MAAM,CAACpK,IAAP,GAAc,SAASA,IAAT,GAAgB;AAC5BF,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD,GAFD;;AAIA,SAAOmK,SAAP;AACD,CAlUmC,EAA7B;;AAoUPra,YAAY,CAACqa,SAAS,CAACviB,SAAX,EAAsB;AAChCgM,EAAAA,KAAK,EAAE,CADyB;AAEhCxB,EAAAA,MAAM,EAAE,CAFwB;AAGhCF,EAAAA,IAAI,EAAE,CAH0B;AAIhCW,EAAAA,MAAM,EAAE,CAJwB;AAKhCQ,EAAAA,KAAK,EAAE,CALyB;AAMhChB,EAAAA,MAAM,EAAE,CANwB;AAOhCM,EAAAA,OAAO,EAAE,CAPuB;AAQhCuD,EAAAA,KAAK,EAAE,KARyB;AAShCxF,EAAAA,MAAM,EAAE,IATwB;AAUhCqD,EAAAA,QAAQ,EAAE,KAVsB;AAWhCjB,EAAAA,OAAO,EAAE,CAXuB;AAYhCL,EAAAA,GAAG,EAAE,CAZ2B;AAahC5B,EAAAA,GAAG,EAAE,CAb2B;AAchCgF,EAAAA,KAAK,EAAE,CAdyB;AAehC3B,EAAAA,MAAM,EAAE,CAACrL,QAfuB;AAgBhC8N,EAAAA,KAAK,EAAE,CAhByB;AAiBhCgU,EAAAA,GAAG,EAAE,KAjB2B;AAkBhCnX,EAAAA,IAAI,EAAE;AAlB0B,CAAtB,CAAZ;AAoBA;AACA;AACA;AACA;AACA;;;AAGA,OAAO,IAAI+D,QAAQ,GAAG,aAAa,UAAU0U,UAAV,EAAsB;AACvDxkB,EAAAA,cAAc,CAAC8P,QAAD,EAAW0U,UAAX,CAAd;;AAEA,WAAS1U,QAAT,CAAkB9G,IAAlB,EAAwB2D,QAAxB,EAAkC;AAChC,QAAI8X,KAAJ;;AAEA,QAAIzb,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,MAAAA,IAAI,GAAG,EAAP;AACD;;AAEDyb,IAAAA,KAAK,GAAGD,UAAU,CAACjS,IAAX,CAAgB,IAAhB,EAAsBvJ,IAAtB,KAA+B,IAAvC;AACAyb,IAAAA,KAAK,CAACvU,MAAN,GAAe,EAAf;AACAuU,IAAAA,KAAK,CAACvY,iBAAN,GAA0B,CAAC,CAAClD,IAAI,CAACkD,iBAAjC;AACAuY,IAAAA,KAAK,CAACpa,kBAAN,GAA2B,CAAC,CAACrB,IAAI,CAACqB,kBAAlC;AACAoa,IAAAA,KAAK,CAACzX,KAAN,GAAc1K,WAAW,CAAC0G,IAAI,CAAC0b,YAAN,CAAzB;AACAnhB,IAAAA,eAAe,IAAImJ,cAAc,CAAC1D,IAAI,CAACC,MAAL,IAAe1F,eAAhB,EAAiC1D,sBAAsB,CAAC4kB,KAAD,CAAvD,EAAgE9X,QAAhE,CAAjC;AACA3D,IAAAA,IAAI,CAAC2a,QAAL,IAAiBc,KAAK,CAACb,OAAN,EAAjB;AACA5a,IAAAA,IAAI,CAACma,MAAL,IAAesB,KAAK,CAACtB,MAAN,CAAa,IAAb,CAAf;AACAna,IAAAA,IAAI,CAACwP,aAAL,IAAsBrL,cAAc,CAACtN,sBAAsB,CAAC4kB,KAAD,CAAvB,EAAgCzb,IAAI,CAACwP,aAArC,CAApC;AACA,WAAOiM,KAAP;AACD;;AAED,MAAIE,OAAO,GAAG7U,QAAQ,CAAC3P,SAAvB;;AAEAwkB,EAAAA,OAAO,CAACC,EAAR,GAAa,SAASA,EAAT,CAAYrf,OAAZ,EAAqByD,IAArB,EAA2B2D,QAA3B,EAAqC;AAChDgE,IAAAA,gBAAgB,CAAC,CAAD,EAAIkF,SAAJ,EAAe,IAAf,CAAhB;;AAEA,WAAO,IAAP;AACD,GAJD;;AAMA8O,EAAAA,OAAO,CAACtR,IAAR,GAAe,SAASA,IAAT,CAAc9N,OAAd,EAAuByD,IAAvB,EAA6B2D,QAA7B,EAAuC;AACpDgE,IAAAA,gBAAgB,CAAC,CAAD,EAAIkF,SAAJ,EAAe,IAAf,CAAhB;;AAEA,WAAO,IAAP;AACD,GAJD;;AAMA8O,EAAAA,OAAO,CAACE,MAAR,GAAiB,SAASA,MAAT,CAAgBtf,OAAhB,EAAyBuf,QAAzB,EAAmCC,MAAnC,EAA2CpY,QAA3C,EAAqD;AACpEgE,IAAAA,gBAAgB,CAAC,CAAD,EAAIkF,SAAJ,EAAe,IAAf,CAAhB;;AAEA,WAAO,IAAP;AACD,GAJD;;AAMA8O,EAAAA,OAAO,CAAClC,GAAR,GAAc,SAASA,GAAT,CAAald,OAAb,EAAsByD,IAAtB,EAA4B2D,QAA5B,EAAsC;AAClD3D,IAAAA,IAAI,CAACjI,QAAL,GAAgB,CAAhB;AACAiI,IAAAA,IAAI,CAACC,MAAL,GAAc,IAAd;AACAF,IAAAA,gBAAgB,CAACC,IAAD,CAAhB,CAAuBqF,WAAvB,KAAuCrF,IAAI,CAAC0G,MAAL,GAAc,CAArD;AACA1G,IAAAA,IAAI,CAACiI,eAAL,GAAuB,CAAC,CAACjI,IAAI,CAACiI,eAA9B;AACA,QAAIG,KAAJ,CAAU7L,OAAV,EAAmByD,IAAnB,EAAyB6D,cAAc,CAAC,IAAD,EAAOF,QAAP,CAAvC,EAAyD,CAAzD;AACA,WAAO,IAAP;AACD,GAPD;;AASAgY,EAAAA,OAAO,CAACpS,IAAR,GAAe,SAASA,IAAT,CAAc8F,QAAd,EAAwBxH,MAAxB,EAAgClE,QAAhC,EAA0C;AACvD,WAAOD,cAAc,CAAC,IAAD,EAAO0E,KAAK,CAAC4T,WAAN,CAAkB,CAAlB,EAAqB3M,QAArB,EAA+BxH,MAA/B,CAAP,EAA+ClE,QAA/C,CAArB;AACD,GAFD,CAEE;AAFF;;AAKAgY,EAAAA,OAAO,CAACM,SAAR,GAAoB,SAASA,SAAT,CAAmB1f,OAAnB,EAA4BxE,QAA5B,EAAsCiI,IAAtC,EAA4Ckc,OAA5C,EAAqDvY,QAArD,EAA+DwY,aAA/D,EAA8EC,mBAA9E,EAAmG;AACrHpc,IAAAA,IAAI,CAACjI,QAAL,GAAgBA,QAAhB;AACAiI,IAAAA,IAAI,CAACkc,OAAL,GAAelc,IAAI,CAACkc,OAAL,IAAgBA,OAA/B;AACAlc,IAAAA,IAAI,CAACqc,UAAL,GAAkBF,aAAlB;AACAnc,IAAAA,IAAI,CAACsc,gBAAL,GAAwBF,mBAAxB;AACApc,IAAAA,IAAI,CAACC,MAAL,GAAc,IAAd;AACA,QAAImI,KAAJ,CAAU7L,OAAV,EAAmByD,IAAnB,EAAyB6D,cAAc,CAAC,IAAD,EAAOF,QAAP,CAAvC;AACA,WAAO,IAAP;AACD,GARD;;AAUAgY,EAAAA,OAAO,CAACY,WAAR,GAAsB,SAASA,WAAT,CAAqBhgB,OAArB,EAA8BxE,QAA9B,EAAwCiI,IAAxC,EAA8Ckc,OAA9C,EAAuDvY,QAAvD,EAAiEwY,aAAjE,EAAgFC,mBAAhF,EAAqG;AACzHpc,IAAAA,IAAI,CAACkI,YAAL,GAAoB,CAApB;AACAnI,IAAAA,gBAAgB,CAACC,IAAD,CAAhB,CAAuBiI,eAAvB,GAAyC3O,WAAW,CAAC0G,IAAI,CAACiI,eAAN,CAApD;AACA,WAAO,KAAKgU,SAAL,CAAe1f,OAAf,EAAwBxE,QAAxB,EAAkCiI,IAAlC,EAAwCkc,OAAxC,EAAiDvY,QAAjD,EAA2DwY,aAA3D,EAA0EC,mBAA1E,CAAP;AACD,GAJD;;AAMAT,EAAAA,OAAO,CAACa,aAAR,GAAwB,SAASA,aAAT,CAAuBjgB,OAAvB,EAAgCxE,QAAhC,EAA0C+jB,QAA1C,EAAoDC,MAApD,EAA4DG,OAA5D,EAAqEvY,QAArE,EAA+EwY,aAA/E,EAA8FC,mBAA9F,EAAmH;AACzIL,IAAAA,MAAM,CAAC5T,OAAP,GAAiB2T,QAAjB;AACA/b,IAAAA,gBAAgB,CAACgc,MAAD,CAAhB,CAAyB9T,eAAzB,GAA2C3O,WAAW,CAACyiB,MAAM,CAAC9T,eAAR,CAAtD;AACA,WAAO,KAAKgU,SAAL,CAAe1f,OAAf,EAAwBxE,QAAxB,EAAkCgkB,MAAlC,EAA0CG,OAA1C,EAAmDvY,QAAnD,EAA6DwY,aAA7D,EAA4EC,mBAA5E,CAAP;AACD,GAJD;;AAMAT,EAAAA,OAAO,CAACnd,MAAR,GAAiB,SAASA,MAAT,CAAgByE,SAAhB,EAA2BrE,cAA3B,EAA2CC,KAA3C,EAAkD;AACjE,QAAIuH,QAAQ,GAAG,KAAKjD,KAApB;AAAA,QACIsZ,IAAI,GAAG,KAAK7a,MAAL,GAAc,KAAKE,aAAL,EAAd,GAAqC,KAAKc,KADrD;AAAA,QAEI+D,GAAG,GAAG,KAAKjF,IAFf;AAAA,QAGIY,KAAK,GAAGW,SAAS,IAAI,CAAb,GAAiB,CAAjB,GAAqBpF,aAAa,CAACoF,SAAD,CAH9C;AAAA,QAII;AACJyZ,IAAAA,aAAa,GAAG,KAAKjZ,MAAL,GAAc,CAAd,KAAoBR,SAAS,GAAG,CAAhC,KAAsC,KAAKK,QAAL,IAAiB,CAACqD,GAAxD,CALhB;AAAA,QAMIhI,IANJ;AAAA,QAOI8B,KAPJ;AAAA,QAQIS,IARJ;AAAA,QASIqE,SATJ;AAAA,QAUIhD,aAVJ;AAAA,QAWIoa,UAXJ;AAAA,QAYIC,UAZJ;AAAA,QAaI7Y,SAbJ;AAAA,QAcI8Y,SAdJ;AAAA,QAeIrX,aAfJ;AAAA,QAgBIoU,IAhBJ;AAAA,QAiBInC,MAjBJ;AAkBA,aAASld,eAAT,IAA4B+H,KAAK,GAAGma,IAApC,IAA4CxZ,SAAS,IAAI,CAAzD,KAA+DX,KAAK,GAAGma,IAAvE;;AAEA,QAAIna,KAAK,KAAK,KAAKF,MAAf,IAAyBvD,KAAzB,IAAkC6d,aAAtC,EAAqD;AACnD,UAAItW,QAAQ,KAAK,KAAKjD,KAAlB,IAA2BwD,GAA/B,EAAoC;AAClC;AACArE,QAAAA,KAAK,IAAI,KAAKa,KAAL,GAAaiD,QAAtB;AACAnD,QAAAA,SAAS,IAAI,KAAKE,KAAL,GAAaiD,QAA1B;AACD;;AAEDzH,MAAAA,IAAI,GAAG2D,KAAP;AACAua,MAAAA,SAAS,GAAG,KAAKlb,MAAjB;AACAoC,MAAAA,SAAS,GAAG,KAAK/B,GAAjB;AACA2a,MAAAA,UAAU,GAAG,CAAC5Y,SAAd;;AAEA,UAAI2Y,aAAJ,EAAmB;AACjB/V,QAAAA,GAAG,KAAKP,QAAQ,GAAG,KAAK3C,MAArB,CAAH,CADiB,CACgB;;AAEjC,SAACR,SAAS,IAAI,CAACrE,cAAf,MAAmC,KAAK6E,MAAL,GAAcR,SAAjD;AACD;;AAED,UAAI,KAAKf,OAAT,EAAkB;AAChB;AACA0X,QAAAA,IAAI,GAAG,KAAKnU,KAAZ;AACAlD,QAAAA,aAAa,GAAGoE,GAAG,GAAG,KAAKtE,OAA3B;;AAEA,YAAI,KAAKH,OAAL,GAAe,CAAC,CAAhB,IAAqBe,SAAS,GAAG,CAArC,EAAwC;AACtC,iBAAO,KAAKA,SAAL,CAAeV,aAAa,GAAG,GAAhB,GAAsBU,SAArC,EAAgDrE,cAAhD,EAAgEC,KAAhE,CAAP;AACD;;AAEDF,QAAAA,IAAI,GAAGd,aAAa,CAACyE,KAAK,GAAGC,aAAT,CAApB,CATgB,CAS6B;;AAE7C,YAAID,KAAK,KAAKma,IAAd,EAAoB;AAClB;AACAlX,UAAAA,SAAS,GAAG,KAAKrD,OAAjB;AACAvD,UAAAA,IAAI,GAAGgI,GAAP;AACD,SAJD,MAIO;AACLpB,UAAAA,SAAS,GAAG,CAAC,EAAEjD,KAAK,GAAGC,aAAV,CAAb;;AAEA,cAAIgD,SAAS,IAAIA,SAAS,KAAKjD,KAAK,GAAGC,aAAvC,EAAsD;AACpD5D,YAAAA,IAAI,GAAGgI,GAAP;AACApB,YAAAA,SAAS;AACV;;AAED5G,UAAAA,IAAI,GAAGgI,GAAP,KAAehI,IAAI,GAAGgI,GAAtB;AACD;;AAEDnB,QAAAA,aAAa,GAAGrD,eAAe,CAAC,KAAKC,MAAN,EAAcG,aAAd,CAA/B;AACA,SAAC6D,QAAD,IAAa,KAAKhE,MAAlB,IAA4BoD,aAAa,KAAKD,SAA9C,KAA4DC,aAAa,GAAGD,SAA5E,EA3BgB,CA2BwE;;AAExF,YAAIqU,IAAI,IAAIrU,SAAS,GAAG,CAAxB,EAA2B;AACzB5G,UAAAA,IAAI,GAAGgI,GAAG,GAAGhI,IAAb;AACA8Y,UAAAA,MAAM,GAAG,CAAT;AACD;AACD;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGQ,YAAIlS,SAAS,KAAKC,aAAd,IAA+B,CAAC,KAAKT,KAAzC,EAAgD;AAC9C,cAAI+X,SAAS,GAAGlD,IAAI,IAAIpU,aAAa,GAAG,CAAxC;AAAA,cACIuX,QAAQ,GAAGD,SAAS,MAAMlD,IAAI,IAAIrU,SAAS,GAAG,CAA1B,CADxB;AAEAA,UAAAA,SAAS,GAAGC,aAAZ,KAA8BsX,SAAS,GAAG,CAACA,SAA3C;AACA1W,UAAAA,QAAQ,GAAG0W,SAAS,GAAG,CAAH,GAAOnW,GAA3B;AACA,eAAK5B,KAAL,GAAa,CAAb;AACA,eAAKvG,MAAL,CAAY4H,QAAQ,KAAKqR,MAAM,GAAG,CAAH,GAAO5Z,aAAa,CAAC0H,SAAS,GAAGhD,aAAb,CAA/B,CAApB,EAAiF3D,cAAjF,EAAiG,CAAC+H,GAAlG,EAAuG5B,KAAvG,GAA+G,CAA/G;AACA,eAAK3C,MAAL,GAAcE,KAAd,CAP8C,CAOzB;;AAErB,WAAC1D,cAAD,IAAmB,KAAKqB,MAAxB,IAAkCgG,SAAS,CAAC,IAAD,EAAO,UAAP,CAA3C;AACA,eAAKjG,IAAL,CAAU0F,aAAV,IAA2B,CAAC+R,MAA5B,KAAuC,KAAK9R,UAAL,GAAkBZ,KAAlB,GAA0B,CAAjE;;AAEA,cAAIqB,QAAQ,IAAIA,QAAQ,KAAK,KAAKjD,KAA9B,IAAuCwZ,UAAU,KAAK,CAAC,KAAK3a,GAA5D,IAAmE,KAAKhC,IAAL,CAAUgd,QAAV,IAAsB,CAAC,KAAK/c,MAA5B,IAAsC,CAAC,KAAKsB,IAAnH,EAAyH;AACvH;AACA,mBAAO,IAAP;AACD;;AAEDoF,UAAAA,GAAG,GAAG,KAAKjF,IAAX,CAjB8C,CAiB7B;;AAEjB+a,UAAAA,IAAI,GAAG,KAAK7Z,KAAZ;;AAEA,cAAIma,QAAJ,EAAc;AACZ,iBAAKhY,KAAL,GAAa,CAAb;AACAqB,YAAAA,QAAQ,GAAG0W,SAAS,GAAGnW,GAAH,GAAS,CAAC,MAA9B;AACA,iBAAKnI,MAAL,CAAY4H,QAAZ,EAAsB,IAAtB;AACA,iBAAKpG,IAAL,CAAU0F,aAAV,IAA2B,CAAC+R,MAA5B,IAAsC,KAAK9R,UAAL,EAAtC;AACD;;AAED,eAAKZ,KAAL,GAAa,CAAb;;AAEA,cAAI,CAAC,KAAK/C,GAAN,IAAa,CAAC2a,UAAlB,EAA8B;AAC5B,mBAAO,IAAP;AACD,WAhC6C,CAgC5C;;;AAGFnF,UAAAA,kBAAkB,CAAC,IAAD,EAAOC,MAAP,CAAlB;AACD;AACF;;AAED,UAAI,KAAKwF,SAAL,IAAkB,CAAC,KAAKC,QAAxB,IAAoC,KAAKnY,KAAL,GAAa,CAArD,EAAwD;AACtD6X,QAAAA,UAAU,GAAGzW,mBAAmB,CAAC,IAAD,EAAOtI,aAAa,CAACuI,QAAD,CAApB,EAAgCvI,aAAa,CAACc,IAAD,CAA7C,CAAhC;;AAEA,YAAIie,UAAJ,EAAgB;AACdta,UAAAA,KAAK,IAAI3D,IAAI,IAAIA,IAAI,GAAGie,UAAU,CAACjb,MAAtB,CAAb;AACD;AACF;;AAED,WAAKS,MAAL,GAAcE,KAAd;AACA,WAAKa,KAAL,GAAaxE,IAAb;AACA,WAAK4C,IAAL,GAAY,CAACwC,SAAb,CA9GmD,CA8G3B;;AAExB,UAAI,CAAC,KAAKT,QAAV,EAAoB;AAClB,aAAK0C,SAAL,GAAiB,KAAKhG,IAAL,CAAUmd,QAA3B;AACA,aAAK7Z,QAAL,GAAgB,CAAhB;AACA,aAAKG,MAAL,GAAcR,SAAd;AACAmD,QAAAA,QAAQ,GAAG,CAAX,CAJkB,CAIJ;AACf;;AAED,UAAI,CAACA,QAAD,IAAazH,IAAb,IAAqB,CAACC,cAA1B,EAA0C;AACxCqH,QAAAA,SAAS,CAAC,IAAD,EAAO,SAAP,CAAT;;AAEA,YAAI,KAAK7D,MAAL,KAAgBE,KAApB,EAA2B;AACzB;AACA,iBAAO,IAAP;AACD;AACF;;AAED,UAAI3D,IAAI,IAAIyH,QAAR,IAAoBnD,SAAS,IAAI,CAArC,EAAwC;AACtCxC,QAAAA,KAAK,GAAG,KAAK4F,MAAb;;AAEA,eAAO5F,KAAP,EAAc;AACZS,UAAAA,IAAI,GAAGT,KAAK,CAACO,KAAb;;AAEA,cAAI,CAACP,KAAK,CAACc,IAAN,IAAc5C,IAAI,IAAI8B,KAAK,CAACkB,MAA7B,KAAwClB,KAAK,CAACuB,GAA9C,IAAqD4a,UAAU,KAAKnc,KAAxE,EAA+E;AAC7E,gBAAIA,KAAK,CAACR,MAAN,KAAiB,IAArB,EAA2B;AACzB;AACA,qBAAO,KAAKzB,MAAL,CAAYyE,SAAZ,EAAuBrE,cAAvB,EAAuCC,KAAvC,CAAP;AACD;;AAED4B,YAAAA,KAAK,CAACjC,MAAN,CAAaiC,KAAK,CAACuB,GAAN,GAAY,CAAZ,GAAgB,CAACrD,IAAI,GAAG8B,KAAK,CAACkB,MAAd,IAAwBlB,KAAK,CAACuB,GAA9C,GAAoD,CAACvB,KAAK,CAACmB,MAAN,GAAenB,KAAK,CAACqB,aAAN,EAAf,GAAuCrB,KAAK,CAACmC,KAA9C,IAAuD,CAACjE,IAAI,GAAG8B,KAAK,CAACkB,MAAd,IAAwBlB,KAAK,CAACuB,GAAtJ,EAA2JpD,cAA3J,EAA2KC,KAA3K;;AAEA,gBAAIF,IAAI,KAAK,KAAKwE,KAAd,IAAuB,CAAC,KAAKnB,GAAN,IAAa,CAAC2a,UAAzC,EAAqD;AACnD;AACAC,cAAAA,UAAU,GAAG,CAAb;AACA1b,cAAAA,IAAI,KAAKoB,KAAK,IAAI,KAAKmB,MAAL,GAAc,CAACrL,QAA7B,CAAJ,CAHmD,CAGP;;AAE5C;AACD;AACF;;AAEDqI,UAAAA,KAAK,GAAGS,IAAR;AACD;AACF,OAzBD,MAyBO;AACLT,QAAAA,KAAK,GAAG,KAAK6F,KAAb;AACA,YAAI8W,YAAY,GAAGna,SAAS,GAAG,CAAZ,GAAgBA,SAAhB,GAA4BtE,IAA/C,CAFK,CAEgD;;AAErD,eAAO8B,KAAP,EAAc;AACZS,UAAAA,IAAI,GAAGT,KAAK,CAACM,KAAb;;AAEA,cAAI,CAACN,KAAK,CAACc,IAAN,IAAc6b,YAAY,IAAI3c,KAAK,CAACgB,IAArC,KAA8ChB,KAAK,CAACuB,GAApD,IAA2D4a,UAAU,KAAKnc,KAA9E,EAAqF;AACnF,gBAAIA,KAAK,CAACR,MAAN,KAAiB,IAArB,EAA2B;AACzB;AACA,qBAAO,KAAKzB,MAAL,CAAYyE,SAAZ,EAAuBrE,cAAvB,EAAuCC,KAAvC,CAAP;AACD;;AAED4B,YAAAA,KAAK,CAACjC,MAAN,CAAaiC,KAAK,CAACuB,GAAN,GAAY,CAAZ,GAAgB,CAACob,YAAY,GAAG3c,KAAK,CAACkB,MAAtB,IAAgClB,KAAK,CAACuB,GAAtD,GAA4D,CAACvB,KAAK,CAACmB,MAAN,GAAenB,KAAK,CAACqB,aAAN,EAAf,GAAuCrB,KAAK,CAACmC,KAA9C,IAAuD,CAACwa,YAAY,GAAG3c,KAAK,CAACkB,MAAtB,IAAgClB,KAAK,CAACuB,GAAtK,EAA2KpD,cAA3K,EAA2LC,KAA3L;;AAEA,gBAAIF,IAAI,KAAK,KAAKwE,KAAd,IAAuB,CAAC,KAAKnB,GAAN,IAAa,CAAC2a,UAAzC,EAAqD;AACnD;AACAC,cAAAA,UAAU,GAAG,CAAb;AACA1b,cAAAA,IAAI,KAAKoB,KAAK,IAAI,KAAKmB,MAAL,GAAc2Z,YAAY,GAAG,CAAChlB,QAAJ,GAAeA,QAAvD,CAAJ,CAHmD,CAGmB;;AAEtE;AACD;AACF;;AAEDqI,UAAAA,KAAK,GAAGS,IAAR;AACD;AACF;;AAED,UAAI0b,UAAU,IAAI,CAAChe,cAAnB,EAAmC;AACjC,aAAKic,KAAL;AACA+B,QAAAA,UAAU,CAACpe,MAAX,CAAkBG,IAAI,IAAIyH,QAAR,GAAmB,CAAnB,GAAuB,CAAChO,QAA1C,EAAoDqL,MAApD,GAA6D9E,IAAI,IAAIyH,QAAR,GAAmB,CAAnB,GAAuB,CAAC,CAArF;;AAEA,YAAI,KAAKpE,GAAT,EAAc;AACZ;AACA,eAAKL,MAAL,GAAckb,SAAd,CAFY,CAEa;;AAEzBha,UAAAA,OAAO,CAAC,IAAD,CAAP;;AAEA,iBAAO,KAAKrE,MAAL,CAAYyE,SAAZ,EAAuBrE,cAAvB,EAAuCC,KAAvC,CAAP;AACD;AACF;;AAED,WAAKmH,SAAL,IAAkB,CAACpH,cAAnB,IAAqCqH,SAAS,CAAC,IAAD,EAAO,UAAP,EAAmB,IAAnB,CAA9C;AACA,UAAI3D,KAAK,KAAKma,IAAV,IAAkBA,IAAI,IAAI,KAAK3a,aAAL,EAA1B,IAAkD,CAACQ,KAAD,IAAU8D,QAAhE,EAA0E,IAAIyW,SAAS,KAAK,KAAKlb,MAAnB,IAA6BrJ,IAAI,CAACwK,GAAL,CAASiB,SAAT,MAAwBzL,IAAI,CAACwK,GAAL,CAAS,KAAKd,GAAd,CAAzD,EAA6E,IAAI,CAAC,KAAK+C,KAAV,EAAiB;AACtK,SAAC9B,SAAS,IAAI,CAAC0D,GAAf,MAAwBrE,KAAK,KAAKma,IAAV,IAAkB,KAAKza,GAAL,GAAW,CAA7B,IAAkC,CAACM,KAAD,IAAU,KAAKN,GAAL,GAAW,CAA/E,KAAqFb,iBAAiB,CAAC,IAAD,EAAO,CAAP,CAAtG,CADsK,CACrD;;AAEjH,YAAI,CAACvC,cAAD,IAAmB,EAAEqE,SAAS,GAAG,CAAZ,IAAiB,CAACmD,QAApB,CAAnB,KAAqD9D,KAAK,IAAI8D,QAAT,IAAqB,CAACqW,IAA3E,CAAJ,EAAsF;AACpFxW,UAAAA,SAAS,CAAC,IAAD,EAAO3D,KAAK,KAAKma,IAAV,IAAkBxZ,SAAS,IAAI,CAA/B,GAAmC,YAAnC,GAAkD,mBAAzD,EAA8E,IAA9E,CAAT;;AAEA,eAAKiD,KAAL,IAAc,EAAE5D,KAAK,GAAGma,IAAR,IAAgB,KAAK1Y,SAAL,KAAmB,CAArC,CAAd,IAAyD,KAAKmC,KAAL,EAAzD;AACD;AACF;AACF;;AAED,WAAO,IAAP;AACD,GArOD;;AAuOAyV,EAAAA,OAAO,CAACzL,GAAR,GAAc,SAASA,GAAT,CAAazP,KAAb,EAAoBkD,QAApB,EAA8B;AAC1C,QAAI0Z,MAAM,GAAG,IAAb;;AAEAlkB,IAAAA,SAAS,CAACwK,QAAD,CAAT,KAAwBA,QAAQ,GAAGE,cAAc,CAAC,IAAD,EAAOF,QAAP,EAAiBlD,KAAjB,CAAjD;;AAEA,QAAI,EAAEA,KAAK,YAAYiZ,SAAnB,CAAJ,EAAmC;AACjC,UAAI7f,QAAQ,CAAC4G,KAAD,CAAZ,EAAqB;AACnBA,QAAAA,KAAK,CAAC/C,OAAN,CAAc,UAAU/B,GAAV,EAAe;AAC3B,iBAAO0hB,MAAM,CAACnN,GAAP,CAAWvU,GAAX,EAAgBgI,QAAhB,CAAP;AACD,SAFD;AAGA,eAAO,IAAP;AACD;;AAED,UAAI3K,SAAS,CAACyH,KAAD,CAAb,EAAsB;AACpB,eAAO,KAAK6c,QAAL,CAAc7c,KAAd,EAAqBkD,QAArB,CAAP;AACD;;AAED,UAAIzK,WAAW,CAACuH,KAAD,CAAf,EAAwB;AACtBA,QAAAA,KAAK,GAAG2H,KAAK,CAAC4T,WAAN,CAAkB,CAAlB,EAAqBvb,KAArB,CAAR;AACD,OAFD,MAEO;AACL,eAAO,IAAP;AACD;AACF;;AAED,WAAO,SAASA,KAAT,GAAiBiD,cAAc,CAAC,IAAD,EAAOjD,KAAP,EAAckD,QAAd,CAA/B,GAAyD,IAAhE,CAxB0C,CAwB4B;AACvE,GAzBD;;AA2BAgY,EAAAA,OAAO,CAAC4B,WAAR,GAAsB,SAASA,WAAT,CAAqBnG,MAArB,EAA6BoG,MAA7B,EAAqCC,SAArC,EAAgDC,gBAAhD,EAAkE;AACtF,QAAItG,MAAM,KAAK,KAAK,CAApB,EAAuB;AACrBA,MAAAA,MAAM,GAAG,IAAT;AACD;;AAED,QAAIoG,MAAM,KAAK,KAAK,CAApB,EAAuB;AACrBA,MAAAA,MAAM,GAAG,IAAT;AACD;;AAED,QAAIC,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,MAAAA,SAAS,GAAG,IAAZ;AACD;;AAED,QAAIC,gBAAgB,KAAK,KAAK,CAA9B,EAAiC;AAC/BA,MAAAA,gBAAgB,GAAG,CAACvlB,OAApB;AACD;;AAED,QAAIiG,CAAC,GAAG,EAAR;AAAA,QACIqC,KAAK,GAAG,KAAK4F,MADjB;;AAGA,WAAO5F,KAAP,EAAc;AACZ,UAAIA,KAAK,CAACkB,MAAN,IAAgB+b,gBAApB,EAAsC;AACpC,YAAIjd,KAAK,YAAY2H,KAArB,EAA4B;AAC1BoV,UAAAA,MAAM,IAAIpf,CAAC,CAACwG,IAAF,CAAOnE,KAAP,CAAV;AACD,SAFD,MAEO;AACLgd,UAAAA,SAAS,IAAIrf,CAAC,CAACwG,IAAF,CAAOnE,KAAP,CAAb;AACA2W,UAAAA,MAAM,IAAIhZ,CAAC,CAACwG,IAAF,CAAOyE,KAAP,CAAajL,CAAb,EAAgBqC,KAAK,CAAC8c,WAAN,CAAkB,IAAlB,EAAwBC,MAAxB,EAAgCC,SAAhC,CAAhB,CAAV;AACD;AACF;;AAEDhd,MAAAA,KAAK,GAAGA,KAAK,CAACO,KAAd;AACD;;AAED,WAAO5C,CAAP;AACD,GAlCD;;AAoCAud,EAAAA,OAAO,CAACgC,OAAR,GAAkB,SAASA,OAAT,CAAiBnE,EAAjB,EAAqB;AACrC,QAAIoE,UAAU,GAAG,KAAKL,WAAL,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,CAAjB;AAAA,QACI7gB,CAAC,GAAGkhB,UAAU,CAAC/gB,MADnB;;AAGA,WAAOH,CAAC,EAAR,EAAY;AACV,UAAIkhB,UAAU,CAAClhB,CAAD,CAAV,CAAcsD,IAAd,CAAmBwZ,EAAnB,KAA0BA,EAA9B,EAAkC;AAChC,eAAOoE,UAAU,CAAClhB,CAAD,CAAjB;AACD;AACF;AACF,GATD;;AAWAif,EAAAA,OAAO,CAACra,MAAR,GAAiB,SAASA,MAAT,CAAgBb,KAAhB,EAAuB;AACtC,QAAIzH,SAAS,CAACyH,KAAD,CAAb,EAAsB;AACpB,aAAO,KAAKod,WAAL,CAAiBpd,KAAjB,CAAP;AACD;;AAED,QAAIvH,WAAW,CAACuH,KAAD,CAAf,EAAwB;AACtB,aAAO,KAAKqd,YAAL,CAAkBrd,KAAlB,CAAP;AACD;;AAEDQ,IAAAA,qBAAqB,CAAC,IAAD,EAAOR,KAAP,CAArB;;AAEA,QAAIA,KAAK,KAAK,KAAKyD,OAAnB,EAA4B;AAC1B,WAAKA,OAAL,GAAe,KAAKoC,KAApB;AACD;;AAED,WAAO9E,QAAQ,CAAC,IAAD,CAAf;AACD,GAhBD;;AAkBAma,EAAAA,OAAO,CAAC1Y,SAAR,GAAoB,SAASA,SAAT,CAAmB8a,WAAnB,EAAgCnf,cAAhC,EAAgD;AAClE,QAAI,CAACiO,SAAS,CAAChQ,MAAf,EAAuB;AACrB,aAAO,KAAKuF,MAAZ;AACD;;AAED,SAAK8a,QAAL,GAAgB,CAAhB;;AAEA,QAAI,CAAC,KAAK9c,GAAN,IAAa,KAAK4B,GAAtB,EAA2B;AACzB;AACA,WAAKL,MAAL,GAAc9D,aAAa,CAAC6G,OAAO,CAAC/F,IAAR,IAAgB,KAAKqD,GAAL,GAAW,CAAX,GAAe+b,WAAW,GAAG,KAAK/b,GAAlC,GAAwC,CAAC,KAAKF,aAAL,KAAuBic,WAAxB,IAAuC,CAAC,KAAK/b,GAArG,CAAD,CAA3B;AACD;;AAEDwZ,IAAAA,UAAU,CAACrkB,SAAX,CAAqB8L,SAArB,CAA+BsG,IAA/B,CAAoC,IAApC,EAA0CwU,WAA1C,EAAuDnf,cAAvD;;AAEA,SAAKse,QAAL,GAAgB,CAAhB;AACA,WAAO,IAAP;AACD,GAhBD;;AAkBAvB,EAAAA,OAAO,CAAC2B,QAAR,GAAmB,SAASA,QAAT,CAAkBnO,KAAlB,EAAyBxL,QAAzB,EAAmC;AACpD,SAAKuD,MAAL,CAAYiI,KAAZ,IAAqBtL,cAAc,CAAC,IAAD,EAAOF,QAAP,CAAnC;AACA,WAAO,IAAP;AACD,GAHD;;AAKAgY,EAAAA,OAAO,CAACkC,WAAR,GAAsB,SAASA,WAAT,CAAqB1O,KAArB,EAA4B;AAChD,WAAO,KAAKjI,MAAL,CAAYiI,KAAZ,CAAP;AACA,WAAO,IAAP;AACD,GAHD;;AAKAwM,EAAAA,OAAO,CAACqC,QAAR,GAAmB,SAASA,QAAT,CAAkBra,QAAlB,EAA4B0L,QAA5B,EAAsCxH,MAAtC,EAA8C;AAC/D,QAAI/G,CAAC,GAAGsH,KAAK,CAAC4T,WAAN,CAAkB,CAAlB,EAAqB3M,QAAQ,IAAIzT,UAAjC,EAA6CiM,MAA7C,CAAR;AACA/G,IAAAA,CAAC,CAACmE,IAAF,GAAS,SAAT;AACA,SAAKgY,SAAL,GAAiB,CAAjB;AACA,WAAOvZ,cAAc,CAAC,IAAD,EAAO5C,CAAP,EAAU+C,cAAc,CAAC,IAAD,EAAOF,QAAP,CAAxB,CAArB;AACD,GALD;;AAOAgY,EAAAA,OAAO,CAACsC,WAAR,GAAsB,SAASA,WAAT,CAAqBta,QAArB,EAA+B;AACnD,QAAIlD,KAAK,GAAG,KAAK4F,MAAjB;AACA1C,IAAAA,QAAQ,GAAGE,cAAc,CAAC,IAAD,EAAOF,QAAP,CAAzB;;AAEA,WAAOlD,KAAP,EAAc;AACZ,UAAIA,KAAK,CAACkB,MAAN,KAAiBgC,QAAjB,IAA6BlD,KAAK,CAACwE,IAAN,KAAe,SAAhD,EAA2D;AACzD9D,QAAAA,iBAAiB,CAACV,KAAD,CAAjB;AACD;;AAEDA,MAAAA,KAAK,GAAGA,KAAK,CAACO,KAAd;AACD;AACF,GAXD;;AAaA2a,EAAAA,OAAO,CAACmC,YAAR,GAAuB,SAASA,YAAT,CAAsBvhB,OAAtB,EAA+B2hB,KAA/B,EAAsCC,UAAtC,EAAkD;AACvE,QAAIX,MAAM,GAAG,KAAKY,WAAL,CAAiB7hB,OAAjB,EAA0B4hB,UAA1B,CAAb;AAAA,QACIzhB,CAAC,GAAG8gB,MAAM,CAAC3gB,MADf;;AAGA,WAAOH,CAAC,EAAR,EAAY;AACV2hB,MAAAA,iBAAiB,KAAKb,MAAM,CAAC9gB,CAAD,CAA5B,IAAmC8gB,MAAM,CAAC9gB,CAAD,CAAN,CAAU+S,IAAV,CAAelT,OAAf,EAAwB2hB,KAAxB,CAAnC;AACD;;AAED,WAAO,IAAP;AACD,GATD;;AAWAvC,EAAAA,OAAO,CAACyC,WAAR,GAAsB,SAASA,WAAT,CAAqB7hB,OAArB,EAA8B4hB,UAA9B,EAA0C;AAC9D,QAAI/f,CAAC,GAAG,EAAR;AAAA,QACIkgB,aAAa,GAAGphB,OAAO,CAACX,OAAD,CAD3B;AAAA,QAEIkE,KAAK,GAAG,KAAK4F,MAFjB;AAAA,QAGIkY,YAAY,GAAGplB,SAAS,CAACglB,UAAD,CAH5B;AAAA,QAII;AACJK,IAAAA,QALA;;AAOA,WAAO/d,KAAP,EAAc;AACZ,UAAIA,KAAK,YAAY2H,KAArB,EAA4B;AAC1B,YAAItK,iBAAiB,CAAC2C,KAAK,CAACge,QAAP,EAAiBH,aAAjB,CAAjB,KAAqDC,YAAY,GAAG,CAAC,CAACF,iBAAD,IAAsB5d,KAAK,CAAC6C,QAAN,IAAkB7C,KAAK,CAACuB,GAA/C,KAAuDvB,KAAK,CAAC6Z,UAAN,CAAiB,CAAjB,KAAuB6D,UAA9E,IAA4F1d,KAAK,CAAC6Z,UAAN,CAAiB7Z,KAAK,CAACqB,aAAN,EAAjB,IAA0Cqc,UAAzI,GAAsJ,CAACA,UAAD,IAAe1d,KAAK,CAACua,QAAN,EAAtO,CAAJ,EAA6P;AAC3P;AACA5c,UAAAA,CAAC,CAACwG,IAAF,CAAOnE,KAAP;AACD;AACF,OALD,MAKO,IAAI,CAAC+d,QAAQ,GAAG/d,KAAK,CAAC2d,WAAN,CAAkBE,aAAlB,EAAiCH,UAAjC,CAAZ,EAA0DthB,MAA9D,EAAsE;AAC3EuB,QAAAA,CAAC,CAACwG,IAAF,CAAOyE,KAAP,CAAajL,CAAb,EAAgBogB,QAAhB;AACD;;AAED/d,MAAAA,KAAK,GAAGA,KAAK,CAACO,KAAd;AACD;;AAED,WAAO5C,CAAP;AACD,GAtBD,CAsBE;AACF;AACA;AACA;AACA;AACA;AA3BA;;AA8BAud,EAAAA,OAAO,CAAC+C,OAAR,GAAkB,SAASA,OAAT,CAAiB/a,QAAjB,EAA2B3D,IAA3B,EAAiC;AACjDA,IAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;;AAEA,QAAI2e,EAAE,GAAG,IAAT;AAAA,QACI3X,OAAO,GAAGnD,cAAc,CAAC8a,EAAD,EAAKhb,QAAL,CAD5B;AAAA,QAEIib,KAAK,GAAG5e,IAFZ;AAAA,QAGImI,OAAO,GAAGyW,KAAK,CAACzW,OAHpB;AAAA,QAII0W,QAAQ,GAAGD,KAAK,CAACE,OAJrB;AAAA,QAKIC,aAAa,GAAGH,KAAK,CAACG,aAL1B;AAAA,QAMI9W,eAAe,GAAG2W,KAAK,CAAC3W,eAN5B;AAAA,QAOI+W,OAPJ;AAAA,QAQI1gB,KAAK,GAAG8J,KAAK,CAACwT,EAAN,CAAS+C,EAAT,EAAatf,YAAY,CAAC;AACpC8K,MAAAA,IAAI,EAAEnK,IAAI,CAACmK,IAAL,IAAa,MADiB;AAEpC1F,MAAAA,IAAI,EAAE,KAF8B;AAGpCwD,MAAAA,eAAe,EAAE,KAHmB;AAIpCtJ,MAAAA,IAAI,EAAEqI,OAJ8B;AAKpChP,MAAAA,SAAS,EAAE,MALyB;AAMpCD,MAAAA,QAAQ,EAAEiI,IAAI,CAACjI,QAAL,IAAiBO,IAAI,CAACwK,GAAL,CAAS,CAACkE,OAAO,IAAImB,OAAO,IAAI,UAAUA,OAArB,GAA+BA,OAAO,CAACxJ,IAAvC,GAA8CggB,EAAE,CAACxb,KAArD,CAAR,IAAuEwb,EAAE,CAAC5a,SAAH,EAAhF,CAAjB,IAAoH3L,QAN1F;AAOpC0mB,MAAAA,OAAO,EAAE,SAASA,OAAT,GAAmB;AAC1BH,QAAAA,EAAE,CAAC9D,KAAH;;AAEA,YAAI,CAACmE,OAAL,EAAc;AACZ,cAAIjnB,QAAQ,GAAGiI,IAAI,CAACjI,QAAL,IAAiBO,IAAI,CAACwK,GAAL,CAAS,CAACkE,OAAO,IAAImB,OAAO,IAAI,UAAUA,OAArB,GAA+BA,OAAO,CAACxJ,IAAvC,GAA8CggB,EAAE,CAACxb,KAArD,CAAR,IAAuEwb,EAAE,CAAC5a,SAAH,EAAhF,CAAhC;AACAzF,UAAAA,KAAK,CAACoD,IAAN,KAAe3J,QAAf,IAA2BwO,YAAY,CAACjI,KAAD,EAAQvG,QAAR,EAAkB,CAAlB,EAAqB,CAArB,CAAZ,CAAoCyG,MAApC,CAA2CF,KAAK,CAAC6E,KAAjD,EAAwD,IAAxD,EAA8D,IAA9D,CAA3B;AACA6b,UAAAA,OAAO,GAAG,CAAV;AACD;;AAEDH,QAAAA,QAAQ,IAAIA,QAAQ,CAACxV,KAAT,CAAe/K,KAAf,EAAsBygB,aAAa,IAAI,EAAvC,CAAZ,CAT0B,CAS8B;AACzD;AAjBmC,KAAD,EAkBlC/e,IAlBkC,CAAzB,CARZ;;AA4BA,WAAOiI,eAAe,GAAG3J,KAAK,CAACE,MAAN,CAAa,CAAb,CAAH,GAAqBF,KAA3C;AACD,GAhCD;;AAkCAqd,EAAAA,OAAO,CAACsD,WAAR,GAAsB,SAASA,WAAT,CAAqBC,YAArB,EAAmCC,UAAnC,EAA+Cnf,IAA/C,EAAqD;AACzE,WAAO,KAAK0e,OAAL,CAAaS,UAAb,EAAyB9f,YAAY,CAAC;AAC3C8I,MAAAA,OAAO,EAAE;AACPxJ,QAAAA,IAAI,EAAEkF,cAAc,CAAC,IAAD,EAAOqb,YAAP;AADb;AADkC,KAAD,EAIzClf,IAJyC,CAArC,CAAP;AAKD,GAND;;AAQA2b,EAAAA,OAAO,CAACxU,MAAR,GAAiB,SAASA,MAAT,GAAkB;AACjC,WAAO,KAAKjD,OAAZ;AACD,GAFD;;AAIAyX,EAAAA,OAAO,CAACyD,SAAR,GAAoB,SAASA,SAAT,CAAmBC,SAAnB,EAA8B;AAChD,QAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,MAAAA,SAAS,GAAG,KAAKlc,KAAjB;AACD;;AAED,WAAO4L,oBAAoB,CAAC,IAAD,EAAOlL,cAAc,CAAC,IAAD,EAAOwb,SAAP,CAArB,CAA3B;AACD,GAND;;AAQA1D,EAAAA,OAAO,CAAC2D,aAAR,GAAwB,SAASA,aAAT,CAAuBC,UAAvB,EAAmC;AACzD,QAAIA,UAAU,KAAK,KAAK,CAAxB,EAA2B;AACzBA,MAAAA,UAAU,GAAG,KAAKpc,KAAlB;AACD;;AAED,WAAO4L,oBAAoB,CAAC,IAAD,EAAOlL,cAAc,CAAC,IAAD,EAAO0b,UAAP,CAArB,EAAyC,CAAzC,CAA3B;AACD,GAND;;AAQA5D,EAAAA,OAAO,CAAC6D,YAAR,GAAuB,SAASA,YAAT,CAAsBvmB,KAAtB,EAA6B;AAClD,WAAO4T,SAAS,CAAChQ,MAAV,GAAmB,KAAK0d,IAAL,CAAUthB,KAAV,EAAiB,IAAjB,CAAnB,GAA4C,KAAKqmB,aAAL,CAAmB,KAAKnc,KAAL,GAAa/K,QAAhC,CAAnD;AACD,GAFD;;AAIAujB,EAAAA,OAAO,CAAC8D,aAAR,GAAwB,SAASA,aAAT,CAAuBhU,MAAvB,EAA+BiU,YAA/B,EAA6ChC,gBAA7C,EAA+D;AACrF,QAAIA,gBAAgB,KAAK,KAAK,CAA9B,EAAiC;AAC/BA,MAAAA,gBAAgB,GAAG,CAAnB;AACD;;AAED,QAAIjd,KAAK,GAAG,KAAK4F,MAAjB;AAAA,QACIa,MAAM,GAAG,KAAKA,MADlB;AAAA,QAEI9H,CAFJ;;AAIA,WAAOqB,KAAP,EAAc;AACZ,UAAIA,KAAK,CAACkB,MAAN,IAAgB+b,gBAApB,EAAsC;AACpCjd,QAAAA,KAAK,CAACkB,MAAN,IAAgB8J,MAAhB;AACAhL,QAAAA,KAAK,CAACgB,IAAN,IAAcgK,MAAd;AACD;;AAEDhL,MAAAA,KAAK,GAAGA,KAAK,CAACO,KAAd;AACD;;AAED,QAAI0e,YAAJ,EAAkB;AAChB,WAAKtgB,CAAL,IAAU8H,MAAV,EAAkB;AAChB,YAAIA,MAAM,CAAC9H,CAAD,CAAN,IAAase,gBAAjB,EAAmC;AACjCxW,UAAAA,MAAM,CAAC9H,CAAD,CAAN,IAAaqM,MAAb;AACD;AACF;AACF;;AAED,WAAOjK,QAAQ,CAAC,IAAD,CAAf;AACD,GA3BD;;AA6BAma,EAAAA,OAAO,CAAChW,UAAR,GAAqB,SAASA,UAAT,GAAsB;AACzC,QAAIlF,KAAK,GAAG,KAAK4F,MAAjB;AACA,SAAKtB,KAAL,GAAa,CAAb;;AAEA,WAAOtE,KAAP,EAAc;AACZA,MAAAA,KAAK,CAACkF,UAAN;AACAlF,MAAAA,KAAK,GAAGA,KAAK,CAACO,KAAd;AACD;;AAED,WAAOwa,UAAU,CAACrkB,SAAX,CAAqBwO,UAArB,CAAgC4D,IAAhC,CAAqC,IAArC,CAAP;AACD,GAVD;;AAYAoS,EAAAA,OAAO,CAACgE,KAAR,GAAgB,SAASA,KAAT,CAAeC,aAAf,EAA8B;AAC5C,QAAIA,aAAa,KAAK,KAAK,CAA3B,EAA8B;AAC5BA,MAAAA,aAAa,GAAG,IAAhB;AACD;;AAED,QAAInf,KAAK,GAAG,KAAK4F,MAAjB;AAAA,QACInF,IADJ;;AAGA,WAAOT,KAAP,EAAc;AACZS,MAAAA,IAAI,GAAGT,KAAK,CAACO,KAAb;AACA,WAAKM,MAAL,CAAYb,KAAZ;AACAA,MAAAA,KAAK,GAAGS,IAAR;AACD;;AAED,SAAKd,GAAL,KAAa,KAAK+C,KAAL,GAAa,KAAKf,MAAL,GAAc,KAAK6X,MAAL,GAAc,CAAtD;AACA2F,IAAAA,aAAa,KAAK,KAAK1Y,MAAL,GAAc,EAAnB,CAAb;AACA,WAAO1F,QAAQ,CAAC,IAAD,CAAf;AACD,GAjBD;;AAmBAma,EAAAA,OAAO,CAAC7Z,aAAR,GAAwB,SAASA,aAAT,CAAuB7I,KAAvB,EAA8B;AACpD,QAAIsP,GAAG,GAAG,CAAV;AAAA,QACIzR,IAAI,GAAG,IADX;AAAA,QAEI2J,KAAK,GAAG3J,IAAI,CAACwP,KAFjB;AAAA,QAGIuW,SAAS,GAAG1kB,OAHhB;AAAA,QAII0I,IAJJ;AAAA,QAKIyN,KALJ;AAAA,QAMIrO,MANJ;;AAQA,QAAI4M,SAAS,CAAChQ,MAAd,EAAsB;AACpB,aAAO/F,IAAI,CAACiN,SAAL,CAAe,CAACjN,IAAI,CAACoL,OAAL,GAAe,CAAf,GAAmBpL,IAAI,CAACiB,QAAL,EAAnB,GAAqCjB,IAAI,CAACgL,aAAL,EAAtC,KAA+DhL,IAAI,CAAC6jB,QAAL,KAAkB,CAAC1hB,KAAnB,GAA2BA,KAA1F,CAAf,CAAP;AACD;;AAED,QAAInC,IAAI,CAAC8K,MAAT,EAAiB;AACf3B,MAAAA,MAAM,GAAGnJ,IAAI,CAACmJ,MAAd;;AAEA,aAAOQ,KAAP,EAAc;AACZI,QAAAA,IAAI,GAAGJ,KAAK,CAACM,KAAb,CADY,CACQ;;AAEpBN,QAAAA,KAAK,CAACmB,MAAN,IAAgBnB,KAAK,CAACqB,aAAN,EAAhB,CAHY,CAG2B;;AAEvCwM,QAAAA,KAAK,GAAG7N,KAAK,CAACkB,MAAd;;AAEA,YAAI2M,KAAK,GAAGuO,SAAR,IAAqB/lB,IAAI,CAACkN,KAA1B,IAAmCvD,KAAK,CAACuB,GAAzC,IAAgD,CAAClL,IAAI,CAACiO,KAA1D,EAAiE;AAC/D;AACAjO,UAAAA,IAAI,CAACiO,KAAL,GAAa,CAAb,CAF+D,CAE/C;;AAEhBrB,UAAAA,cAAc,CAAC5M,IAAD,EAAO2J,KAAP,EAAc6N,KAAK,GAAG7N,KAAK,CAACqD,MAA5B,EAAoC,CAApC,CAAd,CAAqDiB,KAArD,GAA6D,CAA7D;AACD,SALD,MAKO;AACL8X,UAAAA,SAAS,GAAGvO,KAAZ;AACD;;AAED,YAAIA,KAAK,GAAG,CAAR,IAAa7N,KAAK,CAACuB,GAAvB,EAA4B;AAC1B;AACAuG,UAAAA,GAAG,IAAI+F,KAAP;;AAEA,cAAI,CAACrO,MAAD,IAAW,CAACnJ,IAAI,CAACsJ,GAAjB,IAAwBH,MAAM,IAAIA,MAAM,CAACiD,iBAA7C,EAAgE;AAC9DpM,YAAAA,IAAI,CAAC6K,MAAL,IAAe2M,KAAK,GAAGxX,IAAI,CAACkL,GAA5B;AACAlL,YAAAA,IAAI,CAACqM,KAAL,IAAcmL,KAAd;AACAxX,YAAAA,IAAI,CAACsL,MAAL,IAAekM,KAAf;AACD;;AAEDxX,UAAAA,IAAI,CAAC2oB,aAAL,CAAmB,CAACnR,KAApB,EAA2B,KAA3B,EAAkC,CAAC,KAAnC;AACAuO,UAAAA,SAAS,GAAG,CAAZ;AACD;;AAEDpc,QAAAA,KAAK,CAACgB,IAAN,GAAa8G,GAAb,IAAoB9H,KAAK,CAACuB,GAA1B,KAAkCuG,GAAG,GAAG9H,KAAK,CAACgB,IAA9C;AACAhB,QAAAA,KAAK,GAAGI,IAAR;AACD;;AAED0F,MAAAA,YAAY,CAACzP,IAAD,EAAOA,IAAI,KAAKyD,eAAT,IAA4BzD,IAAI,CAACqM,KAAL,GAAaoF,GAAzC,GAA+CzR,IAAI,CAACqM,KAApD,GAA4DoF,GAAnE,EAAwE,CAAxE,EAA2E,CAA3E,CAAZ;;AAEAzR,MAAAA,IAAI,CAAC8K,MAAL,GAAc,CAAd;AACD;;AAED,WAAO9K,IAAI,CAAC8L,KAAZ;AACD,GAxDD;;AA0DAkE,EAAAA,QAAQ,CAAC+Y,UAAT,GAAsB,SAASA,UAAT,CAAoBlhB,IAApB,EAA0B;AAC9C,QAAIpE,eAAe,CAACyH,GAApB,EAAyB;AACvBvD,MAAAA,eAAe,CAAClE,eAAD,EAAkBmI,uBAAuB,CAAC/D,IAAD,EAAOpE,eAAP,CAAzC,CAAf;;AAEAyB,MAAAA,kBAAkB,GAAG0I,OAAO,CAACC,KAA7B;AACD;;AAED,QAAID,OAAO,CAACC,KAAR,IAAiBxI,YAArB,EAAmC;AACjCA,MAAAA,YAAY,IAAI3E,OAAO,CAACC,SAAR,IAAqB,GAArC;AACA,UAAIgJ,KAAK,GAAGlG,eAAe,CAAC8L,MAA5B;AACA,UAAI,CAAC5F,KAAD,IAAU,CAACA,KAAK,CAACuB,GAArB,EAA0B,IAAIxK,OAAO,CAACC,SAAR,IAAqBiN,OAAO,CAACkQ,UAAR,CAAmB/X,MAAnB,GAA4B,CAArD,EAAwD;AAChF,eAAO4D,KAAK,IAAI,CAACA,KAAK,CAACuB,GAAvB,EAA4B;AAC1BvB,UAAAA,KAAK,GAAGA,KAAK,CAACO,KAAd;AACD;;AAEDP,QAAAA,KAAK,IAAIiE,OAAO,CAACuR,KAAR,EAAT;AACD;AACF;AACF,GAlBD;;AAoBA,SAAOnP,QAAP;AACD,CAvrBkC,CAurBjC4S,SAvrBiC,CAA5B;;AAyrBPra,YAAY,CAACyH,QAAQ,CAAC3P,SAAV,EAAqB;AAC/B4N,EAAAA,KAAK,EAAE,CADwB;AAE/BkY,EAAAA,SAAS,EAAE,CAFoB;AAG/BC,EAAAA,QAAQ,EAAE;AAHqB,CAArB,CAAZ;;AAMA,IAAI4C,0BAA0B,GAAG,SAASA,0BAAT,CAAoCtjB,MAApC,EAA4CqU,IAA5C,EAAkDvC,KAAlD,EAAyDxD,GAAzD,EAA8DiV,MAA9D,EAAsEC,YAAtE,EAAoFC,SAApF,EAA+F;AAC9H;AACA,MAAI3a,EAAE,GAAG,IAAIyL,SAAJ,CAAc,KAAKvM,GAAnB,EAAwBhI,MAAxB,EAAgCqU,IAAhC,EAAsC,CAAtC,EAAyC,CAAzC,EAA4CqP,oBAA5C,EAAkE,IAAlE,EAAwEH,MAAxE,CAAT;AAAA,MACIrX,KAAK,GAAG,CADZ;AAAA,MAEIyX,UAAU,GAAG,CAFjB;AAAA,MAGI7M,MAHJ;AAAA,MAII8M,SAJJ;AAAA,MAKI3M,KALJ;AAAA,MAMI4M,MANJ;AAAA,MAOIC,KAPJ;AAAA,MAQIC,QARJ;AAAA,MASIC,SATJ;AAAA,MAUIpiB,CAVJ;AAWAkH,EAAAA,EAAE,CAACoG,CAAH,GAAO4C,KAAP;AACAhJ,EAAAA,EAAE,CAACmb,CAAH,GAAO3V,GAAP;AACAwD,EAAAA,KAAK,IAAI,EAAT,CAf8H,CAejH;;AAEbxD,EAAAA,GAAG,IAAI,EAAP;;AAEA,MAAI0V,SAAS,GAAG,CAAC1V,GAAG,CAAC5M,OAAJ,CAAY,SAAZ,CAAjB,EAAyC;AACvC4M,IAAAA,GAAG,GAAG8C,cAAc,CAAC9C,GAAD,CAApB;AACD;;AAED,MAAIkV,YAAJ,EAAkB;AAChB5hB,IAAAA,CAAC,GAAG,CAACkQ,KAAD,EAAQxD,GAAR,CAAJ;AACAkV,IAAAA,YAAY,CAAC5hB,CAAD,EAAI5B,MAAJ,EAAYqU,IAAZ,CAAZ,CAFgB,CAEe;;AAE/BvC,IAAAA,KAAK,GAAGlQ,CAAC,CAAC,CAAD,CAAT;AACA0M,IAAAA,GAAG,GAAG1M,CAAC,CAAC,CAAD,CAAP;AACD;;AAEDgiB,EAAAA,SAAS,GAAG9R,KAAK,CAACrP,KAAN,CAAY9E,oBAAZ,KAAqC,EAAjD;;AAEA,SAAOmZ,MAAM,GAAGnZ,oBAAoB,CAACsO,IAArB,CAA0BqC,GAA1B,CAAhB,EAAgD;AAC9CuV,IAAAA,MAAM,GAAG/M,MAAM,CAAC,CAAD,CAAf;AACAgN,IAAAA,KAAK,GAAGxV,GAAG,CAACuM,SAAJ,CAAc3O,KAAd,EAAqB4K,MAAM,CAAC5K,KAA5B,CAAR;;AAEA,QAAI+K,KAAJ,EAAW;AACTA,MAAAA,KAAK,GAAG,CAACA,KAAK,GAAG,CAAT,IAAc,CAAtB;AACD,KAFD,MAEO,IAAI6M,KAAK,CAAC7Y,MAAN,CAAa,CAAC,CAAd,MAAqB,OAAzB,EAAkC;AACvCgM,MAAAA,KAAK,GAAG,CAAR;AACD;;AAED,QAAI4M,MAAM,KAAKD,SAAS,CAACD,UAAU,EAAX,CAAxB,EAAwC;AACtCI,MAAAA,QAAQ,GAAGvhB,UAAU,CAACohB,SAAS,CAACD,UAAU,GAAG,CAAd,CAAV,CAAV,IAAyC,CAApD,CADsC,CACiB;;AAEvD7a,MAAAA,EAAE,CAACd,GAAH,GAAS;AACPxD,QAAAA,KAAK,EAAEsE,EAAE,CAACd,GADH;AAEPpF,QAAAA,CAAC,EAAEkhB,KAAK,IAAIH,UAAU,KAAK,CAAxB,GAA4BG,KAA5B,GAAoC,GAFhC;AAGP;AACAzS,QAAAA,CAAC,EAAE0S,QAJI;AAKPrN,QAAAA,CAAC,EAAEmN,MAAM,CAAC7Y,MAAP,CAAc,CAAd,MAAqB,GAArB,GAA2BxI,UAAU,CAACqhB,MAAM,CAAC5Y,MAAP,CAAc,CAAd,CAAD,CAAV,IAAgC4Y,MAAM,CAAC7Y,MAAP,CAAc,CAAd,MAAqB,GAArB,GAA2B,CAAC,CAA5B,GAAgC,CAAhE,CAA3B,GAAgGxI,UAAU,CAACqhB,MAAD,CAAV,GAAqBE,QALjH;AAMPG,QAAAA,CAAC,EAAEjN,KAAK,IAAIA,KAAK,GAAG,CAAjB,GAAqBnb,IAAI,CAACsF,KAA1B,GAAkC;AAN9B,OAAT;AAQA8K,MAAAA,KAAK,GAAGvO,oBAAoB,CAAC6Z,SAA7B;AACD;AACF;;AAED1O,EAAAA,EAAE,CAAC4N,CAAH,GAAOxK,KAAK,GAAGoC,GAAG,CAACjO,MAAZ,GAAqBiO,GAAG,CAACuM,SAAJ,CAAc3O,KAAd,EAAqBoC,GAAG,CAACjO,MAAzB,CAArB,GAAwD,EAA/D,CA1D8H,CA0D3D;;AAEnEyI,EAAAA,EAAE,CAACqb,EAAH,GAAQV,SAAR;;AAEA,MAAI7lB,OAAO,CAAC6Z,IAAR,CAAanJ,GAAb,KAAqB0V,SAAzB,EAAoC;AAClClb,IAAAA,EAAE,CAACmb,CAAH,GAAO,CAAP,CADkC,CACxB;AACX;;AAED,OAAKjc,GAAL,GAAWc,EAAX,CAlE8H,CAkE/G;;AAEf,SAAOA,EAAP;AACD,CArED;AAAA,IAsEIuJ,aAAa,GAAG,SAASA,aAAT,CAAuBrS,MAAvB,EAA+BqU,IAA/B,EAAqCvC,KAArC,EAA4CxD,GAA5C,EAAiDpC,KAAjD,EAAwDnM,OAAxD,EAAiE6T,QAAjE,EAA2E4P,YAA3E,EAAyFC,SAAzF,EAAoG;AACtH/mB,EAAAA,WAAW,CAAC4R,GAAD,CAAX,KAAqBA,GAAG,GAAGA,GAAG,CAACpC,KAAK,IAAI,CAAV,EAAalM,MAAb,EAAqBD,OAArB,CAA9B;AACA,MAAIqkB,YAAY,GAAGpkB,MAAM,CAACqU,IAAD,CAAzB;AAAA,MACIgQ,WAAW,GAAGvS,KAAK,KAAK,KAAV,GAAkBA,KAAlB,GAA0B,CAACpV,WAAW,CAAC0nB,YAAD,CAAZ,GAA6BA,YAA7B,GAA4CX,SAAS,GAAGzjB,MAAM,CAACqU,IAAI,CAAC3S,OAAL,CAAa,KAAb,KAAuB,CAAChF,WAAW,CAACsD,MAAM,CAAC,QAAQqU,IAAI,CAACpJ,MAAL,CAAY,CAAZ,CAAT,CAAP,CAAnC,GAAsEoJ,IAAtE,GAA6E,QAAQA,IAAI,CAACpJ,MAAL,CAAY,CAAZ,CAAtF,CAAN,CAA4GwY,SAA5G,CAAH,GAA4HzjB,MAAM,CAACqU,IAAD,CAAN,EAD7N;AAAA,MAEIkP,MAAM,GAAG,CAAC7mB,WAAW,CAAC0nB,YAAD,CAAZ,GAA6BE,YAA7B,GAA4Cb,SAAS,GAAGc,oBAAH,GAA0BC,WAF5F;AAAA,MAGI1b,EAHJ;;AAKA,MAAItM,SAAS,CAAC8R,GAAD,CAAb,EAAoB;AAClB,QAAI,CAACA,GAAG,CAAC5M,OAAJ,CAAY,SAAZ,CAAL,EAA6B;AAC3B4M,MAAAA,GAAG,GAAG8C,cAAc,CAAC9C,GAAD,CAApB;AACD;;AAED,QAAIA,GAAG,CAACtD,MAAJ,CAAW,CAAX,MAAkB,GAAtB,EAA2B;AACzBlC,MAAAA,EAAE,GAAGtG,UAAU,CAAC6hB,WAAD,CAAV,GAA0B7hB,UAAU,CAAC8L,GAAG,CAACrD,MAAJ,CAAW,CAAX,CAAD,CAAV,IAA6BqD,GAAG,CAACtD,MAAJ,CAAW,CAAX,MAAkB,GAAlB,GAAwB,CAAC,CAAzB,GAA6B,CAA1D,CAA1B,IAA0FgB,OAAO,CAACqY,WAAD,CAAP,IAAwB,CAAlH,CAAL;;AAEA,UAAIvb,EAAE,IAAIA,EAAE,KAAK,CAAjB,EAAoB;AAClB;AACAwF,QAAAA,GAAG,GAAGxF,EAAN;AACD;AACF;AACF;;AAED,MAAIub,WAAW,KAAK/V,GAApB,EAAyB;AACvB,QAAI,CAACvD,KAAK,CAACsZ,WAAW,GAAG/V,GAAf,CAAN,IAA6BA,GAAG,KAAK,EAAzC,EAA6C;AAC3C;AACAxF,MAAAA,EAAE,GAAG,IAAIyL,SAAJ,CAAc,KAAKvM,GAAnB,EAAwBhI,MAAxB,EAAgCqU,IAAhC,EAAsC,CAACgQ,WAAD,IAAgB,CAAtD,EAAyD/V,GAAG,IAAI+V,WAAW,IAAI,CAAnB,CAA5D,EAAmF,OAAOD,YAAP,KAAwB,SAAxB,GAAoCK,cAApC,GAAqDC,YAAxI,EAAsJ,CAAtJ,EAAyJnB,MAAzJ,CAAL;AACAE,MAAAA,SAAS,KAAK3a,EAAE,CAACqb,EAAH,GAAQV,SAAb,CAAT;AACA7P,MAAAA,QAAQ,IAAI9K,EAAE,CAAC8K,QAAH,CAAYA,QAAZ,EAAsB,IAAtB,EAA4B5T,MAA5B,CAAZ;AACA,aAAO,KAAKgI,GAAL,GAAWc,EAAlB;AACD;;AAED,KAACsb,YAAD,IAAiB,EAAE/P,IAAI,IAAIrU,MAAV,CAAjB,IAAsCtB,cAAc,CAAC2V,IAAD,EAAO/F,GAAP,CAApD;AACA,WAAOgV,0BAA0B,CAACvW,IAA3B,CAAgC,IAAhC,EAAsC/M,MAAtC,EAA8CqU,IAA9C,EAAoDgQ,WAApD,EAAiE/V,GAAjE,EAAsEiV,MAAtE,EAA8EC,YAAY,IAAIxoB,OAAO,CAACwoB,YAAtG,EAAoHC,SAApH,CAAP;AACD;AACF,CAxGD;AAAA,IAyGI;AACJkB,YAAY,GAAG,SAASA,YAAT,CAAsBnhB,IAAtB,EAA4B0I,KAA5B,EAAmClM,MAAnC,EAA2CD,OAA3C,EAAoD+B,KAApD,EAA2D;AACxEpF,EAAAA,WAAW,CAAC8G,IAAD,CAAX,KAAsBA,IAAI,GAAGohB,kBAAkB,CAACphB,IAAD,EAAO1B,KAAP,EAAcoK,KAAd,EAAqBlM,MAArB,EAA6BD,OAA7B,CAA/C;;AAEA,MAAI,CAAClD,SAAS,CAAC2G,IAAD,CAAV,IAAoBA,IAAI,CAACqhB,KAAL,IAAcrhB,IAAI,CAAC+I,QAAvC,IAAmDlP,QAAQ,CAACmG,IAAD,CAA3D,IAAqEtG,aAAa,CAACsG,IAAD,CAAtF,EAA8F;AAC5F,WAAOhH,SAAS,CAACgH,IAAD,CAAT,GAAkBohB,kBAAkB,CAACphB,IAAD,EAAO1B,KAAP,EAAcoK,KAAd,EAAqBlM,MAArB,EAA6BD,OAA7B,CAApC,GAA4EyD,IAAnF;AACD;;AAED,MAAIF,IAAI,GAAG,EAAX;AAAA,MACIV,CADJ;;AAGA,OAAKA,CAAL,IAAUY,IAAV,EAAgB;AACdF,IAAAA,IAAI,CAACV,CAAD,CAAJ,GAAUgiB,kBAAkB,CAACphB,IAAI,CAACZ,CAAD,CAAL,EAAUd,KAAV,EAAiBoK,KAAjB,EAAwBlM,MAAxB,EAAgCD,OAAhC,CAA5B;AACD;;AAED,SAAOuD,IAAP;AACD,CAzHD;AAAA,IA0HIwhB,YAAY,GAAG,SAASA,YAAT,CAAsBnmB,QAAtB,EAAgC6E,IAAhC,EAAsC1B,KAAtC,EAA6CoK,KAA7C,EAAoDlM,MAApD,EAA4DD,OAA5D,EAAqE;AACtF,MAAIglB,MAAJ,EAAYjc,EAAZ,EAAgBkc,QAAhB,EAA0B9kB,CAA1B;;AAEA,MAAIT,QAAQ,CAACd,QAAD,CAAR,IAAsB,CAAComB,MAAM,GAAG,IAAItlB,QAAQ,CAACd,QAAD,CAAZ,EAAV,EAAoC4U,IAApC,CAAyCvT,MAAzC,EAAiD+kB,MAAM,CAACjR,OAAP,GAAiBtQ,IAAI,CAAC7E,QAAD,CAArB,GAAkCgmB,YAAY,CAACnhB,IAAI,CAAC7E,QAAD,CAAL,EAAiBuN,KAAjB,EAAwBlM,MAAxB,EAAgCD,OAAhC,EAAyC+B,KAAzC,CAA/F,EAAgJA,KAAhJ,EAAuJoK,KAAvJ,EAA8JnM,OAA9J,MAA2K,KAArM,EAA4M;AAC1M+B,IAAAA,KAAK,CAACkG,GAAN,GAAYc,EAAE,GAAG,IAAIyL,SAAJ,CAAczS,KAAK,CAACkG,GAApB,EAAyBhI,MAAzB,EAAiCrB,QAAjC,EAA2C,CAA3C,EAA8C,CAA9C,EAAiDomB,MAAM,CAAC/iB,MAAxD,EAAgE+iB,MAAhE,EAAwE,CAAxE,EAA2EA,MAAM,CAACE,QAAlF,CAAjB;;AAEA,QAAInjB,KAAK,KAAKoR,WAAd,EAA2B;AACzB8R,MAAAA,QAAQ,GAAGljB,KAAK,CAAC0b,SAAN,CAAgB1b,KAAK,CAACmgB,QAAN,CAAevgB,OAAf,CAAuB1B,MAAvB,CAAhB,CAAX,CADyB,CACmC;;AAE5DE,MAAAA,CAAC,GAAG6kB,MAAM,CAACvR,MAAP,CAAcnT,MAAlB;;AAEA,aAAOH,CAAC,EAAR,EAAY;AACV8kB,QAAAA,QAAQ,CAACD,MAAM,CAACvR,MAAP,CAActT,CAAd,CAAD,CAAR,GAA6B4I,EAA7B;AACD;AACF;AACF;;AAED,SAAOic,MAAP;AACD,CA5ID;AAAA,IA6IIlD,iBA7IJ;AAAA,IA8II;AACJ9Z,UAAU,GAAG,SAASA,UAAT,CAAoBjG,KAApB,EAA2BK,IAA3B,EAAiC;AAC5C,MAAIqB,IAAI,GAAG1B,KAAK,CAAC0B,IAAjB;AAAA,MACImK,IAAI,GAAGnK,IAAI,CAACmK,IADhB;AAAA,MAEIhC,OAAO,GAAGnI,IAAI,CAACmI,OAFnB;AAAA,MAGIF,eAAe,GAAGjI,IAAI,CAACiI,eAH3B;AAAA,MAIIxD,IAAI,GAAGzE,IAAI,CAACyE,IAJhB;AAAA,MAKI0Y,QAAQ,GAAGnd,IAAI,CAACmd,QALpB;AAAA,MAMIuE,cAAc,GAAG1hB,IAAI,CAAC0hB,cAN1B;AAAA,MAOIpS,aAAa,GAAGtP,IAAI,CAACsP,aAPzB;AAAA,MAQIpH,YAAY,GAAGlI,IAAI,CAACkI,YARxB;AAAA,MASIwP,QAAQ,GAAG1X,IAAI,CAAC0X,QATpB;AAAA,MAUIxX,SAAS,GAAGF,IAAI,CAACE,SAVrB;AAAA,MAWIyhB,UAAU,GAAG3hB,IAAI,CAAC2hB,UAXtB;AAAA,MAYIhb,GAAG,GAAGrI,KAAK,CAACoD,IAZhB;AAAA,MAaIkgB,WAAW,GAAGtjB,KAAK,CAACyH,QAbxB;AAAA,MAcIxJ,OAAO,GAAG+B,KAAK,CAACmgB,QAdpB;AAAA,MAeIxe,MAAM,GAAG3B,KAAK,CAAC2B,MAfnB;AAAA,MAgBI4hB,WAAW,GAAG5hB,MAAM,IAAIA,MAAM,CAACgF,IAAP,KAAgB,QAA1B,GAAqChF,MAAM,CAACA,MAAP,CAAcwe,QAAnD,GAA8DliB,OAhBhF;AAAA,MAiBIulB,aAAa,GAAGxjB,KAAK,CAACyjB,UAAN,KAAqB,MAArB,IAA+B,CAAC7pB,mBAjBpD;AAAA,MAkBIymB,EAAE,GAAGrgB,KAAK,CAAC+E,QAlBf;AAAA,MAmBI2e,SAnBJ;AAAA,MAoBItlB,CApBJ;AAAA,MAqBI0C,CArBJ;AAAA,MAsBIkG,EAtBJ;AAAA,MAuBI9I,MAvBJ;AAAA,MAwBIylB,WAxBJ;AAAA,MAyBIC,MAzBJ;AAAA,MA0BItlB,OA1BJ;AAAA,MA2BI2kB,MA3BJ;AAAA,MA4BIC,QA5BJ;AAAA,MA6BI9Y,KA7BJ;AAAA,MA8BIyZ,WA9BJ;AAAA,MA+BIC,WA/BJ;AAgCAzD,EAAAA,EAAE,KAAK,CAACze,SAAD,IAAc,CAACiK,IAApB,CAAF,KAAgCA,IAAI,GAAG,MAAvC;AACA7L,EAAAA,KAAK,CAACqZ,KAAN,GAAcvN,UAAU,CAACD,IAAD,EAAOrS,SAAS,CAACqS,IAAjB,CAAxB;AACA7L,EAAAA,KAAK,CAACsZ,MAAN,GAAeF,QAAQ,GAAG9L,WAAW,CAACxB,UAAU,CAACsN,QAAQ,KAAK,IAAb,GAAoBvN,IAApB,GAA2BuN,QAA5B,EAAsC5f,SAAS,CAACqS,IAAhD,CAAX,CAAd,GAAkF,CAAzG;;AAEA,MAAIuN,QAAQ,IAAIpZ,KAAK,CAACmH,KAAlB,IAA2B,CAACnH,KAAK,CAAC4D,OAAtC,EAA+C;AAC7C;AACAwV,IAAAA,QAAQ,GAAGpZ,KAAK,CAACsZ,MAAjB;AACAtZ,IAAAA,KAAK,CAACsZ,MAAN,GAAetZ,KAAK,CAACqZ,KAArB;AACArZ,IAAAA,KAAK,CAACqZ,KAAN,GAAcD,QAAd;AACD;;AAEDpZ,EAAAA,KAAK,CAACsH,KAAN,GAAc,CAAC+Y,EAAD,IAAO,CAAC,CAAC3e,IAAI,CAACkI,YAA5B,CA5C4C,CA4CF;;AAE1C,MAAI,CAACyW,EAAD,IAAOze,SAAS,IAAI,CAACF,IAAI,CAACkc,OAA9B,EAAuC;AACrC;AACAtf,IAAAA,OAAO,GAAGL,OAAO,CAAC,CAAD,CAAP,GAAaU,SAAS,CAACV,OAAO,CAAC,CAAD,CAAR,CAAT,CAAsBK,OAAnC,GAA6C,CAAvD;AACAulB,IAAAA,WAAW,GAAGvlB,OAAO,IAAIoD,IAAI,CAACpD,OAAO,CAACiU,IAAT,CAA7B,CAHqC,CAGQ;;AAE7CmR,IAAAA,SAAS,GAAGpiB,cAAc,CAACI,IAAD,EAAOnE,cAAP,CAA1B;AACA+lB,IAAAA,WAAW,IAAIzgB,iBAAiB,CAACygB,WAAW,CAACpjB,MAAZ,CAAmB,CAAC,CAApB,EAAuB,IAAvB,CAAD,CAAhC;;AAEA,QAAI2J,OAAJ,EAAa;AACXhH,MAAAA,iBAAiB,CAAC7C,KAAK,CAACyH,QAAN,GAAiBqC,KAAK,CAACqR,GAAN,CAAUld,OAAV,EAAmB8C,YAAY,CAAC;AACjE4F,QAAAA,IAAI,EAAE,SAD2D;AAEjEjN,QAAAA,SAAS,EAAE,KAFsD;AAGjEiI,QAAAA,MAAM,EAAEA,MAHyD;AAIjEgI,QAAAA,eAAe,EAAE,IAJgD;AAKjExD,QAAAA,IAAI,EAAEnL,WAAW,CAACmL,IAAD,CALgD;AAMjE0D,QAAAA,OAAO,EAAE,IANwD;AAOjElQ,QAAAA,KAAK,EAAE,CAP0D;AAQjEklB,QAAAA,QAAQ,EAAEA,QARuD;AASjEuE,QAAAA,cAAc,EAAEA,cATiD;AAUjEpS,QAAAA,aAAa,EAAEA,aAVkD;AAWjE4M,QAAAA,OAAO,EAAE;AAXwD,OAAD,EAY/D/T,OAZ+D,CAA/B,CAAlB,CAAjB,CADW,CAaI;;;AAGfxJ,MAAAA,IAAI,GAAG,CAAP,IAAY,CAACsJ,eAAb,IAAgC,CAAC0Z,UAAjC,IAA+CrjB,KAAK,CAACyH,QAAN,CAAevH,MAAf,CAAsB,CAAC,CAAvB,EAA0B,IAA1B,CAA/C,CAhBW,CAgBqE;;AAEhF,UAAIyJ,eAAJ,EAAqB;AACnBtJ,QAAAA,IAAI,GAAG,CAAP,IAAY,CAACgjB,UAAb,KAA4BrjB,KAAK,CAACyH,QAAN,GAAiB,CAA7C,EADmB,CAC8B;;AAEjD,YAAIY,GAAG,IAAIhI,IAAI,IAAI,CAAnB,EAAsB;AACpBA,UAAAA,IAAI,KAAKL,KAAK,CAACmF,MAAN,GAAe9E,IAApB,CAAJ;AACA,iBAFoB,CAEZ;AACT,SANkB,CAMjB;AACF;AACA;AACA;AACA;AACA;;AAED,OAbD,MAaO,IAAIgjB,UAAU,KAAK,KAAnB,EAA0B;AAC/BrjB,QAAAA,KAAK,CAACyH,QAAN,GAAiB,CAAjB;AACD;AACF,KAlCD,MAkCO,IAAImC,YAAY,IAAIvB,GAApB,EAAyB;AAC9B;AACA,UAAIib,WAAJ,EAAiB;AACf,SAACD,UAAD,KAAgBrjB,KAAK,CAACyH,QAAN,GAAiB,CAAjC;AACD,OAFD,MAEO;AACLpH,QAAAA,IAAI,KAAKsJ,eAAe,GAAG,KAAvB,CAAJ,CADK,CAC8B;;AAEnC7I,QAAAA,CAAC,GAAGC,YAAY,CAAC;AACfrH,UAAAA,SAAS,EAAE,KADI;AAEfiN,UAAAA,IAAI,EAAE,aAFS;AAGf;AACAR,UAAAA,IAAI,EAAEwD,eAAe,IAAI3O,WAAW,CAACmL,IAAD,CAJrB;AAKfwD,UAAAA,eAAe,EAAEA,eALF;AAMf;AACAiU,UAAAA,OAAO,EAAE,CAPM;AAQfjc,UAAAA,MAAM,EAAEA,MARO,CAQA;;AARA,SAAD,EAUb+hB,SAVa,CAAhB;AAWAG,QAAAA,WAAW,KAAK/iB,CAAC,CAACxC,OAAO,CAACiU,IAAT,CAAD,GAAkBsR,WAAvB,CAAX,CAdK,CAc2C;;AAEhDhhB,QAAAA,iBAAiB,CAAC7C,KAAK,CAACyH,QAAN,GAAiBqC,KAAK,CAACqR,GAAN,CAAUld,OAAV,EAAmB6C,CAAnB,CAAlB,CAAjB;;AAEAT,QAAAA,IAAI,GAAG,CAAP,IAAYL,KAAK,CAACyH,QAAN,CAAevH,MAAf,CAAsB,CAAC,CAAvB,EAA0B,IAA1B,CAAZ,CAlBK,CAkBwC;;AAE7CF,QAAAA,KAAK,CAACmF,MAAN,GAAe9E,IAAf;;AAEA,YAAI,CAACsJ,eAAL,EAAsB;AACpB1D,UAAAA,UAAU,CAACjG,KAAK,CAACyH,QAAP,EAAiB3N,QAAjB,CAAV,CADoB,CACkB;;AAEvC,SAHD,MAGO,IAAI,CAACuG,IAAL,EAAW;AAChB;AACD;AACF;AACF;;AAEDL,IAAAA,KAAK,CAACkG,GAAN,GAAY,CAAZ;AACAC,IAAAA,IAAI,GAAGkC,GAAG,IAAIrN,WAAW,CAACmL,IAAD,CAAlB,IAA4BA,IAAI,IAAI,CAACkC,GAA5C;;AAEA,SAAKjK,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGH,OAAO,CAACM,MAAxB,EAAgCH,CAAC,EAAjC,EAAqC;AACnCF,MAAAA,MAAM,GAAGD,OAAO,CAACG,CAAD,CAAhB;AACAwlB,MAAAA,MAAM,GAAG1lB,MAAM,CAACG,KAAP,IAAgBL,QAAQ,CAACC,OAAD,CAAR,CAAkBG,CAAlB,EAAqBC,KAA9C;AACA2B,MAAAA,KAAK,CAAC0b,SAAN,CAAgBtd,CAAhB,IAAqB8kB,QAAQ,GAAG,EAAhC;AACAzlB,MAAAA,WAAW,CAACmmB,MAAM,CAAC1I,EAAR,CAAX,IAA0B1d,WAAW,CAACe,MAAtC,IAAgDsB,WAAW,EAA3D,CAJmC,CAI4B;;AAE/DuK,MAAAA,KAAK,GAAGmZ,WAAW,KAAKtlB,OAAhB,GAA0BG,CAA1B,GAA8BmlB,WAAW,CAAC3jB,OAAZ,CAAoB1B,MAApB,CAAtC;;AAEA,UAAII,OAAO,IAAI,CAAC2kB,MAAM,GAAG,IAAI3kB,OAAJ,EAAV,EAAyBmT,IAAzB,CAA8BvT,MAA9B,EAAsC2lB,WAAW,IAAIH,SAArD,EAAgE1jB,KAAhE,EAAuEoK,KAAvE,EAA8EmZ,WAA9E,MAA+F,KAA9G,EAAqH;AACnHvjB,QAAAA,KAAK,CAACkG,GAAN,GAAYc,EAAE,GAAG,IAAIyL,SAAJ,CAAczS,KAAK,CAACkG,GAApB,EAAyBhI,MAAzB,EAAiC+kB,MAAM,CAAC7lB,IAAxC,EAA8C,CAA9C,EAAiD,CAAjD,EAAoD6lB,MAAM,CAAC/iB,MAA3D,EAAmE+iB,MAAnE,EAA2E,CAA3E,EAA8EA,MAAM,CAACE,QAArF,CAAjB;;AAEAF,QAAAA,MAAM,CAACvR,MAAP,CAActS,OAAd,CAAsB,UAAUhC,IAAV,EAAgB;AACpC8lB,UAAAA,QAAQ,CAAC9lB,IAAD,CAAR,GAAiB4J,EAAjB;AACD,SAFD;;AAIAic,QAAAA,MAAM,CAACE,QAAP,KAAoBQ,WAAW,GAAG,CAAlC;AACD;;AAED,UAAI,CAACrlB,OAAD,IAAYulB,WAAhB,EAA6B;AAC3B,aAAK/iB,CAAL,IAAU4iB,SAAV,EAAqB;AACnB,cAAI/lB,QAAQ,CAACmD,CAAD,CAAR,KAAgBmiB,MAAM,GAAGD,YAAY,CAACliB,CAAD,EAAI4iB,SAAJ,EAAe1jB,KAAf,EAAsBoK,KAAtB,EAA6BlM,MAA7B,EAAqCqlB,WAArC,CAArC,CAAJ,EAA6F;AAC3FN,YAAAA,MAAM,CAACE,QAAP,KAAoBQ,WAAW,GAAG,CAAlC;AACD,WAFD,MAEO;AACLT,YAAAA,QAAQ,CAACpiB,CAAD,CAAR,GAAckG,EAAE,GAAGuJ,aAAa,CAACtF,IAAd,CAAmBjL,KAAnB,EAA0B9B,MAA1B,EAAkC4C,CAAlC,EAAqC,KAArC,EAA4C4iB,SAAS,CAAC5iB,CAAD,CAArD,EAA0DsJ,KAA1D,EAAiEmZ,WAAjE,EAA8E,CAA9E,EAAiF7hB,IAAI,CAACggB,YAAtF,CAAnB;AACD;AACF;AACF;;AAED1hB,MAAAA,KAAK,CAAC+jB,GAAN,IAAa/jB,KAAK,CAAC+jB,GAAN,CAAU3lB,CAAV,CAAb,IAA6B4B,KAAK,CAACmR,IAAN,CAAWjT,MAAX,EAAmB8B,KAAK,CAAC+jB,GAAN,CAAU3lB,CAAV,CAAnB,CAA7B;;AAEA,UAAIolB,aAAa,IAAIxjB,KAAK,CAACkG,GAA3B,EAAgC;AAC9B6Z,QAAAA,iBAAiB,GAAG/f,KAApB;;AAEA/D,QAAAA,eAAe,CAACujB,YAAhB,CAA6BthB,MAA7B,EAAqCglB,QAArC,EAA+CljB,KAAK,CAACgc,UAAN,CAAiB3b,IAAjB,CAA/C,EAH8B,CAG0C;;;AAGxEyjB,QAAAA,WAAW,GAAG,CAAC9jB,KAAK,CAAC2B,MAArB;AACAoe,QAAAA,iBAAiB,GAAG,CAApB;AACD;;AAED/f,MAAAA,KAAK,CAACkG,GAAN,IAAaC,IAAb,KAAsB1I,WAAW,CAACmmB,MAAM,CAAC1I,EAAR,CAAX,GAAyB,CAA/C;AACD;;AAEDyI,IAAAA,WAAW,IAAIK,yBAAyB,CAAChkB,KAAD,CAAxC;AACAA,IAAAA,KAAK,CAACikB,OAAN,IAAiBjkB,KAAK,CAACikB,OAAN,CAAcjkB,KAAd,CAAjB,CA5HqC,CA4HE;AACxC;;AAEDA,EAAAA,KAAK,CAAC0H,SAAN,GAAkBmX,QAAlB;AACA7e,EAAAA,KAAK,CAACgF,QAAN,GAAiB,CAAC,CAAChF,KAAK,CAAC+jB,GAAP,IAAc/jB,KAAK,CAACkG,GAArB,KAA6B,CAAC4d,WAA/C,CA9K4C,CA8KgB;;AAE5DliB,EAAAA,SAAS,IAAIvB,IAAI,IAAI,CAArB,IAA0BggB,EAAE,CAACngB,MAAH,CAAUrG,OAAV,EAAmB,IAAnB,EAAyB,IAAzB,CAA1B,CAhL4C,CAgLc;AAC3D,CAhUD;AAAA,IAiUIqqB,iBAAiB,GAAG,SAASA,iBAAT,CAA2BjmB,OAA3B,EAAoCyD,IAApC,EAA0C;AAChE,MAAIpD,OAAO,GAAGL,OAAO,CAAC,CAAD,CAAP,GAAaU,SAAS,CAACV,OAAO,CAAC,CAAD,CAAR,CAAT,CAAsBK,OAAnC,GAA6C,CAA3D;AAAA,MACI6lB,eAAe,GAAG7lB,OAAO,IAAIA,OAAO,CAAC+T,OADzC;AAAA,MAEI7Q,IAFJ;AAAA,MAGIV,CAHJ;AAAA,MAII1C,CAJJ;AAAA,MAKIiU,OALJ;;AAOA,MAAI,CAAC8R,eAAL,EAAsB;AACpB,WAAOziB,IAAP;AACD;;AAEDF,EAAAA,IAAI,GAAG9E,MAAM,CAAC,EAAD,EAAKgF,IAAL,CAAb;;AAEA,OAAKZ,CAAL,IAAUqjB,eAAV,EAA2B;AACzB,QAAIrjB,CAAC,IAAIU,IAAT,EAAe;AACb6Q,MAAAA,OAAO,GAAG8R,eAAe,CAACrjB,CAAD,CAAf,CAAmB3B,KAAnB,CAAyB,GAAzB,CAAV;AACAf,MAAAA,CAAC,GAAGiU,OAAO,CAAC9T,MAAZ;;AAEA,aAAOH,CAAC,EAAR,EAAY;AACVoD,QAAAA,IAAI,CAAC6Q,OAAO,CAACjU,CAAD,CAAR,CAAJ,GAAmBoD,IAAI,CAACV,CAAD,CAAvB;AACD;AACF;AACF;;AAED,SAAOU,IAAP;AACD,CA3VD;AAAA,IA4VI;AACJ4iB,cAAc,GAAG,SAASA,cAAT,CAAwB7R,IAAxB,EAA8BlV,GAA9B,EAAmCgnB,QAAnC,EAA6CC,QAA7C,EAAuD;AACtE,MAAIzY,IAAI,GAAGxO,GAAG,CAACwO,IAAJ,IAAYyY,QAAZ,IAAwB,cAAnC;AAAA,MACIxjB,CADJ;AAAA,MAEIhB,CAFJ;;AAIA,MAAIvE,QAAQ,CAAC8B,GAAD,CAAZ,EAAmB;AACjByC,IAAAA,CAAC,GAAGukB,QAAQ,CAAC9R,IAAD,CAAR,KAAmB8R,QAAQ,CAAC9R,IAAD,CAAR,GAAiB,EAApC,CAAJ,CADiB,CAC4B;;AAE7ClV,IAAAA,GAAG,CAAC+B,OAAJ,CAAY,UAAUzE,KAAV,EAAiByD,CAAjB,EAAoB;AAC9B,aAAO0B,CAAC,CAACwG,IAAF,CAAO;AACZ9D,QAAAA,CAAC,EAAEpE,CAAC,IAAIf,GAAG,CAACkB,MAAJ,GAAa,CAAjB,CAAD,GAAuB,GADd;AAEZO,QAAAA,CAAC,EAAEnE,KAFS;AAGZwnB,QAAAA,CAAC,EAAEtW;AAHS,OAAP,CAAP;AAKD,KAND;AAOD,GAVD,MAUO;AACL,SAAK/K,CAAL,IAAUzD,GAAV,EAAe;AACbyC,MAAAA,CAAC,GAAGukB,QAAQ,CAACvjB,CAAD,CAAR,KAAgBujB,QAAQ,CAACvjB,CAAD,CAAR,GAAc,EAA9B,CAAJ;AACAA,MAAAA,CAAC,KAAK,MAAN,IAAgBhB,CAAC,CAACwG,IAAF,CAAO;AACrB9D,QAAAA,CAAC,EAAE9B,UAAU,CAAC6R,IAAD,CADQ;AAErBzT,QAAAA,CAAC,EAAEzB,GAAG,CAACyD,CAAD,CAFe;AAGrBqhB,QAAAA,CAAC,EAAEtW;AAHkB,OAAP,CAAhB;AAKD;AACF;AACF,CAtXD;AAAA,IAuXIiX,kBAAkB,GAAG,SAASA,kBAAT,CAA4BnoB,KAA5B,EAAmCqF,KAAnC,EAA0C5B,CAA1C,EAA6CF,MAA7C,EAAqDD,OAArD,EAA8D;AACrF,SAAOrD,WAAW,CAACD,KAAD,CAAX,GAAqBA,KAAK,CAACsQ,IAAN,CAAWjL,KAAX,EAAkB5B,CAAlB,EAAqBF,MAArB,EAA6BD,OAA7B,CAArB,GAA6DvD,SAAS,CAACC,KAAD,CAAT,IAAoB,CAACA,KAAK,CAACiF,OAAN,CAAc,SAAd,CAArB,GAAgD0P,cAAc,CAAC3U,KAAD,CAA9D,GAAwEA,KAA5I;AACD,CAzXD;AAAA,IA0XI4pB,kBAAkB,GAAGxmB,cAAc,GAAG,gDA1X1C;AAAA,IA2XIymB,mBAAmB,GAAG,EA3X1B;;AA6XAxlB,YAAY,CAACulB,kBAAkB,GAAG,iDAAtB,EAAyE,UAAUnnB,IAAV,EAAgB;AACnG,SAAOonB,mBAAmB,CAACpnB,IAAD,CAAnB,GAA4B,CAAnC;AACD,CAFW,CAAZ;AAGA;AACA;AACA;AACA;AACA;;;AAGA,OAAO,IAAI0M,KAAK,GAAG,aAAa,UAAU2a,WAAV,EAAuB;AACrD/rB,EAAAA,cAAc,CAACoR,KAAD,EAAQ2a,WAAR,CAAd;;AAEA,WAAS3a,KAAT,CAAe7L,OAAf,EAAwByD,IAAxB,EAA8B2D,QAA9B,EAAwCqf,WAAxC,EAAqD;AACnD,QAAIC,MAAJ;;AAEA,QAAI,OAAOjjB,IAAP,KAAgB,QAApB,EAA8B;AAC5B2D,MAAAA,QAAQ,CAAC5L,QAAT,GAAoBiI,IAApB;AACAA,MAAAA,IAAI,GAAG2D,QAAP;AACAA,MAAAA,QAAQ,GAAG,IAAX;AACD;;AAEDsf,IAAAA,MAAM,GAAGF,WAAW,CAACxZ,IAAZ,CAAiB,IAAjB,EAAuByZ,WAAW,GAAGhjB,IAAH,GAAUD,gBAAgB,CAACC,IAAD,CAA5D,KAAuE,IAAhF;AACA,QAAIkjB,WAAW,GAAGD,MAAM,CAACjjB,IAAzB;AAAA,QACIjI,QAAQ,GAAGmrB,WAAW,CAACnrB,QAD3B;AAAA,QAEIE,KAAK,GAAGirB,WAAW,CAACjrB,KAFxB;AAAA,QAGIgQ,eAAe,GAAGib,WAAW,CAACjb,eAHlC;AAAA,QAIIiU,OAAO,GAAGgH,WAAW,CAAChH,OAJ1B;AAAA,QAKIlkB,SAAS,GAAGkrB,WAAW,CAAClrB,SAL5B;AAAA,QAMIkI,SAAS,GAAGgjB,WAAW,CAAChjB,SAN5B;AAAA,QAOIZ,QAAQ,GAAG4jB,WAAW,CAAC5jB,QAP3B;AAAA,QAQIkQ,aAAa,GAAG0T,WAAW,CAAC1T,aARhC;AAAA,QASIkI,QAAQ,GAAGwL,WAAW,CAACxL,QAT3B;AAAA,QAUIzX,MAAM,GAAGD,IAAI,CAACC,MAAL,IAAe1F,eAV5B;AAAA,QAWI+jB,aAAa,GAAG,CAACzkB,QAAQ,CAAC0C,OAAD,CAAR,IAAqB7C,aAAa,CAAC6C,OAAD,CAAlC,GAA8CpD,SAAS,CAACoD,OAAO,CAAC,CAAD,CAAR,CAAvD,GAAsE,YAAYyD,IAAnF,IAA2F,CAACzD,OAAD,CAA3F,GAAuGW,OAAO,CAACX,OAAD,CAXlI;AAAA,QAYIoiB,EAZJ;AAAA,QAaIjiB,CAbJ;AAAA,QAcIoD,IAdJ;AAAA,QAeI7B,CAfJ;AAAA,QAgBImB,CAhBJ;AAAA,QAiBI+jB,SAjBJ;AAAA,QAkBIC,WAlBJ;AAAA,QAmBIC,kBAnBJ;AAoBAJ,IAAAA,MAAM,CAACxE,QAAP,GAAkBH,aAAa,CAACzhB,MAAd,GAAuBP,QAAQ,CAACgiB,aAAD,CAA/B,GAAiDhjB,KAAK,CAAC,iBAAiBiB,OAAjB,GAA2B,mCAA5B,EAAiE,CAAC/E,OAAO,CAACG,cAA1E,CAAL,IAAkG,EAArK;AACAsrB,IAAAA,MAAM,CAACjJ,SAAP,GAAmB,EAAnB,CA/BmD,CA+B5B;;AAEvBiJ,IAAAA,MAAM,CAAClB,UAAP,GAAoB/pB,SAApB;;AAEA,QAAIkI,SAAS,IAAIgc,OAAb,IAAwBziB,eAAe,CAAC1B,QAAD,CAAvC,IAAqD0B,eAAe,CAACxB,KAAD,CAAxE,EAAiF;AAC/E+H,MAAAA,IAAI,GAAGijB,MAAM,CAACjjB,IAAd;AACA2e,MAAAA,EAAE,GAAGsE,MAAM,CAAC5f,QAAP,GAAkB,IAAIyD,QAAJ,CAAa;AAClC7B,QAAAA,IAAI,EAAE,QAD4B;AAElC3F,QAAAA,QAAQ,EAAEA,QAAQ,IAAI;AAFY,OAAb,CAAvB;AAIAqf,MAAAA,EAAE,CAAClP,IAAH;AACAkP,MAAAA,EAAE,CAAC1e,MAAH,GAAY0e,EAAE,CAACve,GAAH,GAASvJ,sBAAsB,CAACosB,MAAD,CAA3C;AACAtE,MAAAA,EAAE,CAAChd,MAAH,GAAY,CAAZ;;AAEA,UAAIua,OAAO,IAAIziB,eAAe,CAAC1B,QAAD,CAA1B,IAAwC0B,eAAe,CAACxB,KAAD,CAA3D,EAAoE;AAClEgG,QAAAA,CAAC,GAAGqgB,aAAa,CAACzhB,MAAlB;AACAumB,QAAAA,WAAW,GAAGlH,OAAO,IAAIjS,UAAU,CAACiS,OAAD,CAAnC;;AAEA,YAAI7iB,SAAS,CAAC6iB,OAAD,CAAb,EAAwB;AACtB;AACA,eAAK9c,CAAL,IAAU8c,OAAV,EAAmB;AACjB,gBAAI,CAAC2G,kBAAkB,CAAC3kB,OAAnB,CAA2BkB,CAA3B,CAAL,EAAoC;AAClCikB,cAAAA,kBAAkB,KAAKA,kBAAkB,GAAG,EAA1B,CAAlB;AACAA,cAAAA,kBAAkB,CAACjkB,CAAD,CAAlB,GAAwB8c,OAAO,CAAC9c,CAAD,CAA/B;AACD;AACF;AACF;;AAED,aAAK1C,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGuB,CAAhB,EAAmBvB,CAAC,EAApB,EAAwB;AACtBoD,UAAAA,IAAI,GAAGF,cAAc,CAACI,IAAD,EAAO8iB,mBAAP,CAArB;AACAhjB,UAAAA,IAAI,CAACoc,OAAL,GAAe,CAAf;AACAxE,UAAAA,QAAQ,KAAK5X,IAAI,CAAC4X,QAAL,GAAgBA,QAArB,CAAR;AACA2L,UAAAA,kBAAkB,IAAIroB,MAAM,CAAC8E,IAAD,EAAOujB,kBAAP,CAA5B;AACAF,UAAAA,SAAS,GAAG7E,aAAa,CAAC5hB,CAAD,CAAzB,CALsB,CAKQ;;AAE9BoD,UAAAA,IAAI,CAAC/H,QAAL,GAAgB,CAACqpB,kBAAkB,CAACrpB,QAAD,EAAWlB,sBAAsB,CAACosB,MAAD,CAAjC,EAA2CvmB,CAA3C,EAA8CymB,SAA9C,EAAyD7E,aAAzD,CAAnC;AACAxe,UAAAA,IAAI,CAAC7H,KAAL,GAAa,CAAC,CAACmpB,kBAAkB,CAACnpB,KAAD,EAAQpB,sBAAsB,CAACosB,MAAD,CAA9B,EAAwCvmB,CAAxC,EAA2CymB,SAA3C,EAAsD7E,aAAtD,CAAnB,IAA2F,CAA5F,IAAiG2E,MAAM,CAACnf,MAArH;;AAEA,cAAI,CAACoY,OAAD,IAAYje,CAAC,KAAK,CAAlB,IAAuB6B,IAAI,CAAC7H,KAAhC,EAAuC;AACrC;AACAgrB,YAAAA,MAAM,CAACnf,MAAP,GAAgB7L,KAAK,GAAG6H,IAAI,CAAC7H,KAA7B;AACAgrB,YAAAA,MAAM,CAACthB,MAAP,IAAiB1J,KAAjB;AACA6H,YAAAA,IAAI,CAAC7H,KAAL,GAAa,CAAb;AACD;;AAED0mB,UAAAA,EAAE,CAAC/C,EAAH,CAAMuH,SAAN,EAAiBrjB,IAAjB,EAAuBsjB,WAAW,GAAGA,WAAW,CAAC1mB,CAAD,EAAIymB,SAAJ,EAAe7E,aAAf,CAAd,GAA8C,CAAhF;AACAK,UAAAA,EAAE,CAAChH,KAAH,GAAWlB,QAAQ,CAACwC,IAApB;AACD;;AAED0F,QAAAA,EAAE,CAAC5mB,QAAH,KAAgBA,QAAQ,GAAGE,KAAK,GAAG,CAAnC,GAAuCgrB,MAAM,CAAC5f,QAAP,GAAkB,CAAzD,CAnCkE,CAmCN;AAC7D,OApCD,MAoCO,IAAInD,SAAJ,EAAe;AACpBH,QAAAA,gBAAgB,CAACV,YAAY,CAACsf,EAAE,CAAC3e,IAAH,CAAQV,QAAT,EAAmB;AAC9C6K,UAAAA,IAAI,EAAE;AADwC,SAAnB,CAAb,CAAhB;;AAIAwU,QAAAA,EAAE,CAAChH,KAAH,GAAWvN,UAAU,CAAClK,SAAS,CAACiK,IAAV,IAAkBnK,IAAI,CAACmK,IAAvB,IAA+B,MAAhC,CAArB;AACA,YAAIxL,IAAI,GAAG,CAAX;AAAA,YACIP,CADJ;AAAA,YAEIklB,EAFJ;AAAA,YAGIlmB,CAHJ;;AAKA,YAAIvD,QAAQ,CAACqG,SAAD,CAAZ,EAAyB;AACvBA,UAAAA,SAAS,CAACxC,OAAV,CAAkB,UAAUiH,KAAV,EAAiB;AACjC,mBAAOga,EAAE,CAAC/C,EAAH,CAAM0C,aAAN,EAAqB3Z,KAArB,EAA4B,GAA5B,CAAP;AACD,WAFD;AAGD,SAJD,MAIO;AACL7E,UAAAA,IAAI,GAAG,EAAP;;AAEA,eAAKV,CAAL,IAAUc,SAAV,EAAqB;AACnBd,YAAAA,CAAC,KAAK,MAAN,IAAgBA,CAAC,KAAK,UAAtB,IAAoCsjB,cAAc,CAACtjB,CAAD,EAAIc,SAAS,CAACd,CAAD,CAAb,EAAkBU,IAAlB,EAAwBI,SAAS,CAAC0iB,QAAlC,CAAlD;AACD;;AAED,eAAKxjB,CAAL,IAAUU,IAAV,EAAgB;AACd1B,YAAAA,CAAC,GAAG0B,IAAI,CAACV,CAAD,CAAJ,CAAQ2K,IAAR,CAAa,UAAU3L,CAAV,EAAasN,CAAb,EAAgB;AAC/B,qBAAOtN,CAAC,CAAC0C,CAAF,GAAM4K,CAAC,CAAC5K,CAAf;AACD,aAFG,CAAJ;AAGAnC,YAAAA,IAAI,GAAG,CAAP;;AAEA,iBAAKjC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG0B,CAAC,CAACvB,MAAlB,EAA0BH,CAAC,EAA3B,EAA+B;AAC7B4mB,cAAAA,EAAE,GAAGllB,CAAC,CAAC1B,CAAD,CAAN;AACAU,cAAAA,CAAC,GAAG;AACF+M,gBAAAA,IAAI,EAAEmZ,EAAE,CAAC7C,CADP;AAEF1oB,gBAAAA,QAAQ,EAAE,CAACurB,EAAE,CAACxiB,CAAH,IAAQpE,CAAC,GAAG0B,CAAC,CAAC1B,CAAC,GAAG,CAAL,CAAD,CAASoE,CAAZ,GAAgB,CAAzB,CAAD,IAAgC,GAAhC,GAAsC/I;AAF9C,eAAJ;AAIAqF,cAAAA,CAAC,CAACgC,CAAD,CAAD,GAAOkkB,EAAE,CAAClmB,CAAV;AACAuhB,cAAAA,EAAE,CAAC/C,EAAH,CAAM0C,aAAN,EAAqBlhB,CAArB,EAAwBuB,IAAxB;AACAA,cAAAA,IAAI,IAAIvB,CAAC,CAACrF,QAAV;AACD;AACF;;AAED4mB,UAAAA,EAAE,CAAC5mB,QAAH,KAAgBA,QAAhB,IAA4B4mB,EAAE,CAAC/C,EAAH,CAAM,EAAN,EAAU;AACpC7jB,YAAAA,QAAQ,EAAEA,QAAQ,GAAG4mB,EAAE,CAAC5mB,QAAH;AADe,WAAV,CAA5B,CAzBK,CA2BD;AACL;AACF;;AAEDA,MAAAA,QAAQ,IAAIkrB,MAAM,CAAClrB,QAAP,CAAgBA,QAAQ,GAAG4mB,EAAE,CAAC5mB,QAAH,EAA3B,CAAZ;AACD,KA7FD,MA6FO;AACLkrB,MAAAA,MAAM,CAAC5f,QAAP,GAAkB,CAAlB,CADK,CACgB;AACtB;;AAED,QAAIrL,SAAS,KAAK,IAAd,IAAsB,CAACE,mBAA3B,EAAgD;AAC9CmmB,MAAAA,iBAAiB,GAAGxnB,sBAAsB,CAACosB,MAAD,CAA1C;;AAEA1oB,MAAAA,eAAe,CAACujB,YAAhB,CAA6BQ,aAA7B;;AAEAD,MAAAA,iBAAiB,GAAG,CAApB;AACD;;AAED3a,IAAAA,cAAc,CAACzD,MAAD,EAASpJ,sBAAsB,CAACosB,MAAD,CAA/B,EAAyCtf,QAAzC,CAAd;;AAEA3D,IAAAA,IAAI,CAAC2a,QAAL,IAAiBsI,MAAM,CAACrI,OAAP,EAAjB;AACA5a,IAAAA,IAAI,CAACma,MAAL,IAAe8I,MAAM,CAAC9I,MAAP,CAAc,IAAd,CAAf;;AAEA,QAAIlS,eAAe,IAAI,CAAClQ,QAAD,IAAa,CAACmI,SAAd,IAA2B+iB,MAAM,CAACthB,MAAP,KAAkB9D,aAAa,CAACoC,MAAM,CAACkD,KAAR,CAA1D,IAA4E7J,WAAW,CAAC2O,eAAD,CAAvF,IAA4GlG,qBAAqB,CAAClL,sBAAsB,CAACosB,MAAD,CAAvB,CAAjI,IAAqKhjB,MAAM,CAACgF,IAAP,KAAgB,QAA5M,EAAsN;AACpNge,MAAAA,MAAM,CAAC7gB,MAAP,GAAgB,CAAChK,QAAjB,CADoN,CACzL;;AAE3B6qB,MAAAA,MAAM,CAACzkB,MAAP,CAAclG,IAAI,CAACiQ,GAAL,CAAS,CAAT,EAAY,CAACtQ,KAAb,CAAd,EAHoN,CAGhL;;AAErC;;AAEDuX,IAAAA,aAAa,IAAIrL,cAAc,CAACtN,sBAAsB,CAACosB,MAAD,CAAvB,EAAiCzT,aAAjC,CAA/B;AACA,WAAOyT,MAAP;AACD;;AAED,MAAIM,OAAO,GAAGnb,KAAK,CAACjR,SAApB;;AAEAosB,EAAAA,OAAO,CAAC/kB,MAAR,GAAiB,SAASA,MAAT,CAAgByE,SAAhB,EAA2BrE,cAA3B,EAA2CC,KAA3C,EAAkD;AACjE,QAAIuH,QAAQ,GAAG,KAAKjD,KAApB;AAAA,QACIsZ,IAAI,GAAG,KAAK7Z,KADhB;AAAA,QAEI+D,GAAG,GAAG,KAAKjF,IAFf;AAAA,QAGIY,KAAK,GAAGW,SAAS,GAAGwZ,IAAI,GAAGrkB,QAAnB,IAA+B6K,SAAS,IAAI,CAA5C,GAAgDwZ,IAAhD,GAAuDxZ,SAAS,GAAG7K,QAAZ,GAAuB,CAAvB,GAA2B6K,SAH9F;AAAA,QAIItE,IAJJ;AAAA,QAKI2G,EALJ;AAAA,QAMIC,SANJ;AAAA,QAOIhD,aAPJ;AAAA,QAQIiD,aARJ;AAAA,QASIiS,MATJ;AAAA,QAUIrS,KAVJ;AAAA,QAWI/B,QAXJ;AAAA,QAYIqU,QAZJ;;AAcA,QAAI,CAAC/Q,GAAL,EAAU;AACRzB,MAAAA,wBAAwB,CAAC,IAAD,EAAOjC,SAAP,EAAkBrE,cAAlB,EAAkCC,KAAlC,CAAxB;AACD,KAFD,MAEO,IAAIyD,KAAK,KAAK,KAAKF,MAAf,IAAyB,CAACa,SAA1B,IAAuCpE,KAAvC,IAAgD,CAAC,KAAKyE,QAAN,IAAkB,KAAKlB,MAAvE,IAAiF,KAAK2D,QAAL,IAAiB,KAAKtC,MAAL,GAAc,CAAd,KAAoBR,SAAS,GAAG,CAAtI,EAAyI;AAC9I;AACAtE,MAAAA,IAAI,GAAG2D,KAAP;AACAe,MAAAA,QAAQ,GAAG,KAAKA,QAAhB;;AAEA,UAAI,KAAKnB,OAAT,EAAkB;AAChB;AACAK,QAAAA,aAAa,GAAGoE,GAAG,GAAG,KAAKtE,OAA3B;;AAEA,YAAI,KAAKH,OAAL,GAAe,CAAC,CAAhB,IAAqBe,SAAS,GAAG,CAArC,EAAwC;AACtC,iBAAO,KAAKA,SAAL,CAAeV,aAAa,GAAG,GAAhB,GAAsBU,SAArC,EAAgDrE,cAAhD,EAAgEC,KAAhE,CAAP;AACD;;AAEDF,QAAAA,IAAI,GAAGd,aAAa,CAACyE,KAAK,GAAGC,aAAT,CAApB,CARgB,CAQ6B;;AAE7C,YAAID,KAAK,KAAKma,IAAd,EAAoB;AAClB;AACAlX,UAAAA,SAAS,GAAG,KAAKrD,OAAjB;AACAvD,UAAAA,IAAI,GAAGgI,GAAP;AACD,SAJD,MAIO;AACLpB,UAAAA,SAAS,GAAG,CAAC,EAAEjD,KAAK,GAAGC,aAAV,CAAb;;AAEA,cAAIgD,SAAS,IAAIA,SAAS,KAAKjD,KAAK,GAAGC,aAAvC,EAAsD;AACpD5D,YAAAA,IAAI,GAAGgI,GAAP;AACApB,YAAAA,SAAS;AACV;;AAED5G,UAAAA,IAAI,GAAGgI,GAAP,KAAehI,IAAI,GAAGgI,GAAtB;AACD;;AAED8Q,QAAAA,MAAM,GAAG,KAAKhS,KAAL,IAAcF,SAAS,GAAG,CAAnC;;AAEA,YAAIkS,MAAJ,EAAY;AACVC,UAAAA,QAAQ,GAAG,KAAKE,MAAhB;AACAjZ,UAAAA,IAAI,GAAGgI,GAAG,GAAGhI,IAAb;AACD;;AAED6G,QAAAA,aAAa,GAAGrD,eAAe,CAAC,KAAKC,MAAN,EAAcG,aAAd,CAA/B;;AAEA,YAAI5D,IAAI,KAAKyH,QAAT,IAAqB,CAACvH,KAAtB,IAA+B,KAAKyE,QAAxC,EAAkD;AAChD;AACA,iBAAO,IAAP;AACD;;AAED,YAAIiC,SAAS,KAAKC,aAAlB,EAAiC;AAC/BnC,UAAAA,QAAQ,IAAI,KAAKuU,MAAjB,IAA2BJ,kBAAkB,CAACnU,QAAD,EAAWoU,MAAX,CAA7C,CAD+B,CACkC;;AAEjE,cAAI,KAAKzX,IAAL,CAAU0F,aAAV,IAA2B,CAAC+R,MAA5B,IAAsC,CAAC,KAAK1S,KAAhD,EAAuD;AACrD,iBAAKA,KAAL,GAAalG,KAAK,GAAG,CAArB,CADqD,CAC7B;;AAExB,iBAAKL,MAAL,CAAYX,aAAa,CAAC0E,aAAa,GAAGgD,SAAjB,CAAzB,EAAsD,IAAtD,EAA4DI,UAA5D,GAAyEZ,KAAzE,GAAiF,CAAjF;AACD;AACF;AACF;;AAED,UAAI,CAAC,KAAKzB,QAAV,EAAoB;AAClB,YAAIgB,iBAAiB,CAAC,IAAD,EAAOrB,SAAS,GAAG,CAAZ,GAAgBA,SAAhB,GAA4BtE,IAAnC,EAAyCE,KAAzC,EAAgDD,cAAhD,CAArB,EAAsF;AACpF,eAAKwD,MAAL,GAAc,CAAd,CADoF,CACnE;;AAEjB,iBAAO,IAAP;AACD;;AAED,YAAIuE,GAAG,KAAK,KAAKjF,IAAjB,EAAuB;AACrB;AACA,iBAAO,KAAKlD,MAAL,CAAYyE,SAAZ,EAAuBrE,cAAvB,EAAuCC,KAAvC,CAAP;AACD;AACF;;AAED,WAAKuD,MAAL,GAAcE,KAAd;AACA,WAAKa,KAAL,GAAaxE,IAAb;;AAEA,UAAI,CAAC,KAAK4C,IAAN,IAAc,KAAKS,GAAvB,EAA4B;AAC1B,aAAKT,IAAL,GAAY,CAAZ,CAD0B,CACX;;AAEf,aAAKhD,KAAL,GAAa,CAAb;AACD;;AAED,WAAK6G,KAAL,GAAaA,KAAK,GAAG,CAACsS,QAAQ,IAAI,KAAKC,KAAlB,EAAyBhZ,IAAI,GAAGgI,GAAhC,CAArB;;AAEA,UAAI,KAAKf,KAAT,EAAgB;AACd,aAAKR,KAAL,GAAaA,KAAK,GAAG,IAAIA,KAAzB;AACD;;AAED,UAAIzG,IAAI,IAAI,CAACyH,QAAT,IAAqB,CAACxH,cAA1B,EAA0C;AACxCqH,QAAAA,SAAS,CAAC,IAAD,EAAO,SAAP,CAAT;;AAEA,YAAI,KAAK7D,MAAL,KAAgBE,KAApB,EAA2B;AACzB;AACA,iBAAO,IAAP;AACD;AACF;;AAEDgD,MAAAA,EAAE,GAAG,KAAKd,GAAV;;AAEA,aAAOc,EAAP,EAAW;AACTA,QAAAA,EAAE,CAACO,CAAH,CAAKT,KAAL,EAAYE,EAAE,CAACQ,CAAf;AACAR,QAAAA,EAAE,GAAGA,EAAE,CAACtE,KAAR;AACD;;AAEDqC,MAAAA,QAAQ,IAAIA,QAAQ,CAAC7E,MAAT,CAAgByE,SAAS,GAAG,CAAZ,GAAgBA,SAAhB,GAA4B,CAACtE,IAAD,IAAS8Y,MAAT,GAAkB,CAACrf,QAAnB,GAA8BiL,QAAQ,CAAC3B,IAAT,GAAgB2B,QAAQ,CAACsU,KAAT,CAAehZ,IAAI,GAAG,KAAK+C,IAA3B,CAA1F,EAA4H9C,cAA5H,EAA4IC,KAA5I,CAAZ,IAAkK,KAAKkH,QAAL,KAAkB,KAAKtC,MAAL,GAAcR,SAAhC,CAAlK;;AAEA,UAAI,KAAK+C,SAAL,IAAkB,CAACpH,cAAvB,EAAuC;AACrCqE,QAAAA,SAAS,GAAG,CAAZ,IAAiB,KAAK8C,QAAtB,IAAkC,KAAKA,QAAL,CAAcvH,MAAd,CAAqByE,SAArB,EAAgC,IAAhC,EAAsCpE,KAAtC,CAAlC,CADqC,CAC2C;;AAEhFoH,QAAAA,SAAS,CAAC,IAAD,EAAO,UAAP,CAAT;AACD;;AAED,WAAK/D,OAAL,IAAgBqD,SAAS,KAAKC,aAA9B,IAA+C,KAAKxF,IAAL,CAAUgd,QAAzD,IAAqE,CAACpe,cAAtE,IAAwF,KAAKqB,MAA7F,IAAuGgG,SAAS,CAAC,IAAD,EAAO,UAAP,CAAhH;;AAEA,UAAI,CAAC3D,KAAK,KAAK,KAAKM,KAAf,IAAwB,CAACN,KAA1B,KAAoC,KAAKF,MAAL,KAAgBE,KAAxD,EAA+D;AAC7DW,QAAAA,SAAS,GAAG,CAAZ,IAAiB,KAAK8C,QAAtB,IAAkC,CAAC,KAAKC,SAAxC,IAAqD,KAAKD,QAAL,CAAcvH,MAAd,CAAqByE,SAArB,EAAgC,IAAhC,EAAsC,IAAtC,CAArD;AACA,SAACA,SAAS,IAAI,CAAC0D,GAAf,MAAwBrE,KAAK,KAAK,KAAKM,KAAf,IAAwB,KAAKZ,GAAL,GAAW,CAAnC,IAAwC,CAACM,KAAD,IAAU,KAAKN,GAAL,GAAW,CAArF,KAA2Fb,iBAAiB,CAAC,IAAD,EAAO,CAAP,CAA5G,CAF6D,CAE0D;;AAEvH,YAAI,CAACvC,cAAD,IAAmB,EAAEqE,SAAS,GAAG,CAAZ,IAAiB,CAACmD,QAApB,CAAnB,KAAqD9D,KAAK,IAAI8D,QAA9D,CAAJ,EAA6E;AAC3E;AACAH,UAAAA,SAAS,CAAC,IAAD,EAAO3D,KAAK,KAAKma,IAAV,GAAiB,YAAjB,GAAgC,mBAAvC,EAA4D,IAA5D,CAAT;;AAEA,eAAKvW,KAAL,IAAc,EAAE5D,KAAK,GAAGma,IAAR,IAAgB,KAAK1Y,SAAL,KAAmB,CAArC,CAAd,IAAyD,KAAKmC,KAAL,EAAzD;AACD;AACF;AACF;;AAED,WAAO,IAAP;AACD,GA5ID;;AA8IAqd,EAAAA,OAAO,CAAChnB,OAAR,GAAkB,SAASA,OAAT,GAAmB;AACnC,WAAO,KAAKkiB,QAAZ;AACD,GAFD;;AAIA8E,EAAAA,OAAO,CAAC5d,UAAR,GAAqB,SAASA,UAAT,GAAsB;AACzC,SAAKnB,GAAL,GAAW,KAAK6d,GAAL,GAAW,KAAKtc,QAAL,GAAgB,KAAKC,SAAL,GAAiB,KAAKzH,KAAL,GAAa,KAAK6G,KAAL,GAAa,CAAjF;AACA,SAAK4U,SAAL,GAAiB,EAAjB;AACA,SAAK3W,QAAL,IAAiB,KAAKA,QAAL,CAAcsC,UAAd,EAAjB;AACA,WAAOod,WAAW,CAAC5rB,SAAZ,CAAsBwO,UAAtB,CAAiC4D,IAAjC,CAAsC,IAAtC,CAAP;AACD,GALD;;AAOAga,EAAAA,OAAO,CAAC9T,IAAR,GAAe,SAASA,IAAT,CAAclT,OAAd,EAAuByD,IAAvB,EAA6B;AAC1C,QAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,MAAAA,IAAI,GAAG,KAAP;AACD;;AAED,QAAI,CAACzD,OAAD,KAAa,CAACyD,IAAD,IAASA,IAAI,KAAK,KAA/B,CAAJ,EAA2C;AACzC,WAAKzB,KAAL,GAAa,KAAKiG,GAAL,GAAW,CAAxB;AACA,aAAO,KAAKvE,MAAL,GAAcsP,UAAU,CAAC,IAAD,CAAxB,GAAiC,IAAxC;AACD;;AAED,QAAI,KAAKlM,QAAT,EAAmB;AACjB,UAAIoZ,IAAI,GAAG,KAAKpZ,QAAL,CAAcvB,aAAd,EAAX;AACA,WAAKuB,QAAL,CAAcya,YAAd,CAA2BvhB,OAA3B,EAAoCyD,IAApC,EAA0Cqe,iBAAiB,IAAIA,iBAAiB,CAACre,IAAlB,CAAuBhI,SAAvB,KAAqC,IAApG,EAA0GqO,MAA1G,IAAoHkJ,UAAU,CAAC,IAAD,CAA9H,CAFiB,CAEqH;;AAEtI,WAAKtP,MAAL,IAAewc,IAAI,KAAK,KAAKpZ,QAAL,CAAcvB,aAAd,EAAxB,IAAyDyE,YAAY,CAAC,IAAD,EAAO,KAAK7E,IAAL,GAAY,KAAK2B,QAAL,CAAcT,KAA1B,GAAkC6Z,IAAzC,EAA+C,CAA/C,EAAkD,CAAlD,CAArE,CAJiB,CAI0G;;AAE3H,aAAO,IAAP;AACD;;AAED,QAAI6B,aAAa,GAAG,KAAKG,QAAzB;AAAA,QACI+E,cAAc,GAAGjnB,OAAO,GAAGW,OAAO,CAACX,OAAD,CAAV,GAAsB+hB,aADlD;AAAA,QAEImF,eAAe,GAAG,KAAKzJ,SAF3B;AAAA,QAGI0J,OAAO,GAAG,KAAKlf,GAHnB;AAAA,QAIImf,gBAJJ;AAAA,QAKIC,SALJ;AAAA,QAMIC,iBANJ;AAAA,QAOI3F,KAPJ;AAAA,QAQI9e,CARJ;AAAA,QASIkG,EATJ;AAAA,QAUI5I,CAVJ;;AAYA,QAAI,CAAC,CAACsD,IAAD,IAASA,IAAI,KAAK,KAAnB,KAA6BK,YAAY,CAACie,aAAD,EAAgBkF,cAAhB,CAA7C,EAA8E;AAC5ExjB,MAAAA,IAAI,KAAK,KAAT,KAAmB,KAAKwE,GAAL,GAAW,CAA9B;AACA,aAAO+K,UAAU,CAAC,IAAD,CAAjB;AACD;;AAEDoU,IAAAA,gBAAgB,GAAG,KAAKtB,GAAL,GAAW,KAAKA,GAAL,IAAY,EAA1C;;AAEA,QAAIriB,IAAI,KAAK,KAAb,EAAoB;AAClB;AACA,UAAIhH,SAAS,CAACgH,IAAD,CAAb,EAAqB;AACnBZ,QAAAA,CAAC,GAAG,EAAJ;;AAEA9B,QAAAA,YAAY,CAAC0C,IAAD,EAAO,UAAUtE,IAAV,EAAgB;AACjC,iBAAO0D,CAAC,CAAC1D,IAAD,CAAD,GAAU,CAAjB;AACD,SAFW,CAAZ;;AAIAsE,QAAAA,IAAI,GAAGZ,CAAP;AACD;;AAEDY,MAAAA,IAAI,GAAGwiB,iBAAiB,CAAClE,aAAD,EAAgBte,IAAhB,CAAxB;AACD;;AAEDtD,IAAAA,CAAC,GAAG4hB,aAAa,CAACzhB,MAAlB;;AAEA,WAAOH,CAAC,EAAR,EAAY;AACV,UAAI,CAAC8mB,cAAc,CAACtlB,OAAf,CAAuBogB,aAAa,CAAC5hB,CAAD,CAApC,CAAL,EAA+C;AAC7CknB,QAAAA,SAAS,GAAGH,eAAe,CAAC/mB,CAAD,CAA3B;;AAEA,YAAIsD,IAAI,KAAK,KAAb,EAAoB;AAClB2jB,UAAAA,gBAAgB,CAACjnB,CAAD,CAAhB,GAAsBsD,IAAtB;AACAke,UAAAA,KAAK,GAAG0F,SAAR;AACAC,UAAAA,iBAAiB,GAAG,EAApB;AACD,SAJD,MAIO;AACLA,UAAAA,iBAAiB,GAAGF,gBAAgB,CAACjnB,CAAD,CAAhB,GAAsBinB,gBAAgB,CAACjnB,CAAD,CAAhB,IAAuB,EAAjE;AACAwhB,UAAAA,KAAK,GAAGle,IAAR;AACD;;AAED,aAAKZ,CAAL,IAAU8e,KAAV,EAAiB;AACf5Y,UAAAA,EAAE,GAAGse,SAAS,IAAIA,SAAS,CAACxkB,CAAD,CAA3B;;AAEA,cAAIkG,EAAJ,EAAQ;AACN,gBAAI,EAAE,UAAUA,EAAE,CAACQ,CAAf,KAAqBR,EAAE,CAACQ,CAAH,CAAK2J,IAAL,CAAUrQ,CAAV,MAAiB,IAA1C,EAAgD;AAC9C6B,cAAAA,qBAAqB,CAAC,IAAD,EAAOqE,EAAP,EAAW,KAAX,CAArB;AACD;;AAED,mBAAOse,SAAS,CAACxkB,CAAD,CAAhB;AACD;;AAED,cAAIykB,iBAAiB,KAAK,KAA1B,EAAiC;AAC/BA,YAAAA,iBAAiB,CAACzkB,CAAD,CAAjB,GAAuB,CAAvB;AACD;AACF;AACF;AACF;;AAED,SAAKkE,QAAL,IAAiB,CAAC,KAAKkB,GAAvB,IAA8Bkf,OAA9B,IAAyCnU,UAAU,CAAC,IAAD,CAAnD,CAtF0C,CAsFiB;;AAE3D,WAAO,IAAP;AACD,GAzFD;;AA2FAnH,EAAAA,KAAK,CAACwT,EAAN,GAAW,SAASA,EAAT,CAAYrf,OAAZ,EAAqByD,IAArB,EAA2B;AACpC,WAAO,IAAIoI,KAAJ,CAAU7L,OAAV,EAAmByD,IAAnB,EAAyB6M,SAAS,CAAC,CAAD,CAAlC,CAAP;AACD,GAFD;;AAIAzE,EAAAA,KAAK,CAACiC,IAAN,GAAa,SAASA,IAAT,CAAc9N,OAAd,EAAuByD,IAAvB,EAA6B;AACxC,WAAO2H,gBAAgB,CAAC,CAAD,EAAIkF,SAAJ,CAAvB;AACD,GAFD;;AAIAzE,EAAAA,KAAK,CAAC4T,WAAN,GAAoB,SAASA,WAAT,CAAqB/jB,KAArB,EAA4BoX,QAA5B,EAAsCxH,MAAtC,EAA8C9M,KAA9C,EAAqD;AACvE,WAAO,IAAIqN,KAAJ,CAAUiH,QAAV,EAAoB,CAApB,EAAuB;AAC5BpH,MAAAA,eAAe,EAAE,KADW;AAE5BxD,MAAAA,IAAI,EAAE,KAFsB;AAG5BzM,MAAAA,SAAS,EAAE,KAHiB;AAI5BC,MAAAA,KAAK,EAAEA,KAJqB;AAK5BokB,MAAAA,UAAU,EAAEhN,QALgB;AAM5ByU,MAAAA,iBAAiB,EAAEzU,QANS;AAO5BiN,MAAAA,gBAAgB,EAAEzU,MAPU;AAQ5Bkc,MAAAA,uBAAuB,EAAElc,MARG;AAS5ByH,MAAAA,aAAa,EAAEvU;AATa,KAAvB,CAAP;AAWD,GAZD;;AAcAqN,EAAAA,KAAK,CAACyT,MAAN,GAAe,SAASA,MAAT,CAAgBtf,OAAhB,EAAyBuf,QAAzB,EAAmCC,MAAnC,EAA2C;AACxD,WAAOpU,gBAAgB,CAAC,CAAD,EAAIkF,SAAJ,CAAvB;AACD,GAFD;;AAIAzE,EAAAA,KAAK,CAACqR,GAAN,GAAY,SAASA,GAAT,CAAald,OAAb,EAAsByD,IAAtB,EAA4B;AACtCA,IAAAA,IAAI,CAACjI,QAAL,GAAgB,CAAhB;AACAiI,IAAAA,IAAI,CAACqF,WAAL,KAAqBrF,IAAI,CAAC0G,MAAL,GAAc,CAAnC;AACA,WAAO,IAAI0B,KAAJ,CAAU7L,OAAV,EAAmByD,IAAnB,CAAP;AACD,GAJD;;AAMAoI,EAAAA,KAAK,CAAC0V,YAAN,GAAqB,SAASA,YAAT,CAAsBvhB,OAAtB,EAA+B2hB,KAA/B,EAAsCC,UAAtC,EAAkD;AACrE,WAAO5jB,eAAe,CAACujB,YAAhB,CAA6BvhB,OAA7B,EAAsC2hB,KAAtC,EAA6CC,UAA7C,CAAP;AACD,GAFD;;AAIA,SAAO/V,KAAP;AACD,CA1b+B,CA0b9BsR,SA1b8B,CAAzB;;AA4bPra,YAAY,CAAC+I,KAAK,CAACjR,SAAP,EAAkB;AAC5BsnB,EAAAA,QAAQ,EAAE,EADkB;AAE5BlgB,EAAAA,KAAK,EAAE,CAFqB;AAG5BwH,EAAAA,QAAQ,EAAE,CAHkB;AAI5Bsc,EAAAA,GAAG,EAAE,CAJuB;AAK5BE,EAAAA,OAAO,EAAE;AALmB,CAAlB,CAAZ,C,CAMI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGAjlB,YAAY,CAAC,qCAAD,EAAwC,UAAU5B,IAAV,EAAgB;AAClE0M,EAAAA,KAAK,CAAC1M,IAAD,CAAL,GAAc,YAAY;AACxB,QAAIijB,EAAE,GAAG,IAAI7X,QAAJ,EAAT;AAAA,QACIe,MAAM,GAAGe,MAAM,CAACW,IAAP,CAAYsD,SAAZ,EAAuB,CAAvB,CADb;;AAGAhF,IAAAA,MAAM,CAAC7K,MAAP,CAActB,IAAI,KAAK,eAAT,GAA2B,CAA3B,GAA+B,CAA7C,EAAgD,CAAhD,EAAmD,CAAnD;AACA,WAAOijB,EAAE,CAACjjB,IAAD,CAAF,CAAS2N,KAAT,CAAesV,EAAf,EAAmB9W,MAAnB,CAAP;AACD,GAND;AAOD,CARW,CAAZ;AASA;AACA;AACA;AACA;AACA;;;AAGA,IAAIiZ,YAAY,GAAG,SAASA,YAAT,CAAsBtkB,MAAtB,EAA8BrB,QAA9B,EAAwClC,KAAxC,EAA+C;AAChE,SAAOuD,MAAM,CAACrB,QAAD,CAAN,GAAmBlC,KAA1B;AACD,CAFD;AAAA,IAGI+nB,WAAW,GAAG,SAASA,WAAT,CAAqBxkB,MAArB,EAA6BrB,QAA7B,EAAuClC,KAAvC,EAA8C;AAC9D,SAAOuD,MAAM,CAACrB,QAAD,CAAN,CAAiBlC,KAAjB,CAAP;AACD,CALD;AAAA,IAMI8nB,oBAAoB,GAAG,SAASA,oBAAT,CAA8BvkB,MAA9B,EAAsCrB,QAAtC,EAAgDlC,KAAhD,EAAuDgM,IAAvD,EAA6D;AACtF,SAAOzI,MAAM,CAACrB,QAAD,CAAN,CAAiB8J,IAAI,CAAC0b,EAAtB,EAA0B1nB,KAA1B,CAAP;AACD,CARD;AAAA,IASI+qB,gBAAgB,GAAG,SAASA,gBAAT,CAA0BxnB,MAA1B,EAAkCrB,QAAlC,EAA4ClC,KAA5C,EAAmD;AACxE,SAAOuD,MAAM,CAACynB,YAAP,CAAoB9oB,QAApB,EAA8BlC,KAA9B,CAAP;AACD,CAXD;AAAA,IAYIyX,UAAU,GAAG,SAASA,UAAT,CAAoBlU,MAApB,EAA4BrB,QAA5B,EAAsC;AACrD,SAAOjC,WAAW,CAACsD,MAAM,CAACrB,QAAD,CAAP,CAAX,GAAgC6lB,WAAhC,GAA8C5nB,YAAY,CAACoD,MAAM,CAACrB,QAAD,CAAP,CAAZ,IAAkCqB,MAAM,CAACynB,YAAzC,GAAwDD,gBAAxD,GAA2ElD,YAAhI;AACD,CAdD;AAAA,IAeII,YAAY,GAAG,SAASA,YAAT,CAAsB9b,KAAtB,EAA6BH,IAA7B,EAAmC;AACpD,SAAOA,IAAI,CAACwU,GAAL,CAASxU,IAAI,CAACnE,CAAd,EAAiBmE,IAAI,CAAC7F,CAAtB,EAAyB9G,IAAI,CAACsF,KAAL,CAAW,CAACqH,IAAI,CAAC4I,CAAL,GAAS5I,IAAI,CAACiO,CAAL,GAAS9N,KAAnB,IAA4B,OAAvC,IAAkD,OAA3E,EAAoFH,IAApF,CAAP;AACD,CAjBD;AAAA,IAkBIgc,cAAc,GAAG,SAASA,cAAT,CAAwB7b,KAAxB,EAA+BH,IAA/B,EAAqC;AACxD,SAAOA,IAAI,CAACwU,GAAL,CAASxU,IAAI,CAACnE,CAAd,EAAiBmE,IAAI,CAAC7F,CAAtB,EAAyB,CAAC,EAAE6F,IAAI,CAAC4I,CAAL,GAAS5I,IAAI,CAACiO,CAAL,GAAS9N,KAApB,CAA1B,EAAsDH,IAAtD,CAAP;AACD,CApBD;AAAA,IAqBIib,oBAAoB,GAAG,SAASA,oBAAT,CAA8B9a,KAA9B,EAAqCH,IAArC,EAA2C;AACpE,MAAIK,EAAE,GAAGL,IAAI,CAACT,GAAd;AAAA,MACIqJ,CAAC,GAAG,EADR;;AAGA,MAAI,CAACzI,KAAD,IAAUH,IAAI,CAACyG,CAAnB,EAAsB;AACpB;AACAmC,IAAAA,CAAC,GAAG5I,IAAI,CAACyG,CAAT;AACD,GAHD,MAGO,IAAItG,KAAK,KAAK,CAAV,IAAeH,IAAI,CAACwb,CAAxB,EAA2B;AAChC;AACA5S,IAAAA,CAAC,GAAG5I,IAAI,CAACwb,CAAT;AACD,GAHM,MAGA;AACL,WAAOnb,EAAP,EAAW;AACTuI,MAAAA,CAAC,GAAGvI,EAAE,CAAClG,CAAH,IAAQkG,EAAE,CAACob,CAAH,GAAOpb,EAAE,CAACob,CAAH,CAAKpb,EAAE,CAACuI,CAAH,GAAOvI,EAAE,CAAC4N,CAAH,GAAO9N,KAAnB,CAAP,GAAmC9M,IAAI,CAACsF,KAAL,CAAW,CAAC0H,EAAE,CAACuI,CAAH,GAAOvI,EAAE,CAAC4N,CAAH,GAAO9N,KAAf,IAAwB,KAAnC,IAA4C,KAAvF,IAAgGyI,CAApG,CADS,CAC8F;;AAEvGvI,MAAAA,EAAE,GAAGA,EAAE,CAACtE,KAAR;AACD;;AAED6M,IAAAA,CAAC,IAAI5I,IAAI,CAACiO,CAAV,CAPK,CAOQ;AACd;;AAEDjO,EAAAA,IAAI,CAACwU,GAAL,CAASxU,IAAI,CAACnE,CAAd,EAAiBmE,IAAI,CAAC7F,CAAtB,EAAyByO,CAAzB,EAA4B5I,IAA5B;AACD,CA1CD;AAAA,IA2CI6J,iBAAiB,GAAG,SAASA,iBAAT,CAA2B1J,KAA3B,EAAkCH,IAAlC,EAAwC;AAC9D,MAAIK,EAAE,GAAGL,IAAI,CAACT,GAAd;;AAEA,SAAOc,EAAP,EAAW;AACTA,IAAAA,EAAE,CAACO,CAAH,CAAKT,KAAL,EAAYE,EAAE,CAACQ,CAAf;AACAR,IAAAA,EAAE,GAAGA,EAAE,CAACtE,KAAR;AACD;AACF,CAlDD;AAAA,IAmDIqP,kBAAkB,GAAG,SAASA,kBAAT,CAA4BD,QAA5B,EAAsC9R,KAAtC,EAA6C9B,MAA7C,EAAqDrB,QAArD,EAA+D;AACtF,MAAImK,EAAE,GAAG,KAAKd,GAAd;AAAA,MACItD,IADJ;;AAGA,SAAOoE,EAAP,EAAW;AACTpE,IAAAA,IAAI,GAAGoE,EAAE,CAACtE,KAAV;AACAsE,IAAAA,EAAE,CAAClG,CAAH,KAASjE,QAAT,IAAqBmK,EAAE,CAAC8K,QAAH,CAAYA,QAAZ,EAAsB9R,KAAtB,EAA6B9B,MAA7B,CAArB;AACA8I,IAAAA,EAAE,GAAGpE,IAAL;AACD;AACF,CA5DD;AAAA,IA6DIiP,iBAAiB,GAAG,SAASA,iBAAT,CAA2BhV,QAA3B,EAAqC;AAC3D,MAAImK,EAAE,GAAG,KAAKd,GAAd;AAAA,MACI0f,wBADJ;AAAA,MAEIhjB,IAFJ;;AAIA,SAAOoE,EAAP,EAAW;AACTpE,IAAAA,IAAI,GAAGoE,EAAE,CAACtE,KAAV;;AAEA,QAAIsE,EAAE,CAAClG,CAAH,KAASjE,QAAT,IAAqB,CAACmK,EAAE,CAAC6e,EAAzB,IAA+B7e,EAAE,CAAC6e,EAAH,KAAUhpB,QAA7C,EAAuD;AACrD8F,MAAAA,qBAAqB,CAAC,IAAD,EAAOqE,EAAP,EAAW,KAAX,CAArB;AACD,KAFD,MAEO,IAAI,CAACA,EAAE,CAAC8e,GAAR,EAAa;AAClBF,MAAAA,wBAAwB,GAAG,CAA3B;AACD;;AAED5e,IAAAA,EAAE,GAAGpE,IAAL;AACD;;AAED,SAAO,CAACgjB,wBAAR;AACD,CA/ED;AAAA,IAgFIG,mBAAmB,GAAG,SAASA,mBAAT,CAA6B7nB,MAA7B,EAAqCrB,QAArC,EAA+ClC,KAA/C,EAAsDgM,IAAtD,EAA4D;AACpFA,EAAAA,IAAI,CAACqf,IAAL,CAAU9nB,MAAV,EAAkBrB,QAAlB,EAA4B8J,IAAI,CAACyb,CAAL,CAAOnX,IAAP,CAAYtE,IAAI,CAAC3G,KAAjB,EAAwBrF,KAAxB,EAA+BgM,IAAI,CAACsf,EAApC,CAA5B,EAAqEtf,IAArE;AACD,CAlFD;AAAA,IAmFIqd,yBAAyB,GAAG,SAASA,yBAAT,CAAmCriB,MAAnC,EAA2C;AACzE,MAAIqF,EAAE,GAAGrF,MAAM,CAACuE,GAAhB;AAAA,MACItD,IADJ;AAAA,MAEIsjB,GAFJ;AAAA,MAGIC,KAHJ;AAAA,MAIIC,IAJJ,CADyE,CAK/D;;AAEV,SAAOpf,EAAP,EAAW;AACTpE,IAAAA,IAAI,GAAGoE,EAAE,CAACtE,KAAV;AACAwjB,IAAAA,GAAG,GAAGC,KAAN;;AAEA,WAAOD,GAAG,IAAIA,GAAG,CAACG,EAAJ,GAASrf,EAAE,CAACqf,EAA1B,EAA8B;AAC5BH,MAAAA,GAAG,GAAGA,GAAG,CAACxjB,KAAV;AACD;;AAED,QAAIsE,EAAE,CAACvE,KAAH,GAAWyjB,GAAG,GAAGA,GAAG,CAACzjB,KAAP,GAAe2jB,IAAjC,EAAuC;AACrCpf,MAAAA,EAAE,CAACvE,KAAH,CAASC,KAAT,GAAiBsE,EAAjB;AACD,KAFD,MAEO;AACLmf,MAAAA,KAAK,GAAGnf,EAAR;AACD;;AAED,QAAIA,EAAE,CAACtE,KAAH,GAAWwjB,GAAf,EAAoB;AAClBA,MAAAA,GAAG,CAACzjB,KAAJ,GAAYuE,EAAZ;AACD,KAFD,MAEO;AACLof,MAAAA,IAAI,GAAGpf,EAAP;AACD;;AAEDA,IAAAA,EAAE,GAAGpE,IAAL;AACD;;AAEDjB,EAAAA,MAAM,CAACuE,GAAP,GAAaigB,KAAb;AACD,CAlHD,C,CAkHG;;;AAGH,OAAO,IAAI1T,SAAS,GAAG,aAAa,YAAY;AAC9C,WAASA,SAAT,CAAmB7P,IAAnB,EAAyB1E,MAAzB,EAAiCqU,IAAjC,EAAuCvC,KAAvC,EAA8CsW,MAA9C,EAAsDC,QAAtD,EAAgE5f,IAAhE,EAAsE8a,MAAtE,EAA8E0B,QAA9E,EAAwF;AACtF,SAAK3gB,CAAL,GAAStE,MAAT;AACA,SAAKqR,CAAL,GAASS,KAAT;AACA,SAAK4E,CAAL,GAAS0R,MAAT;AACA,SAAKxlB,CAAL,GAASyR,IAAT;AACA,SAAKhL,CAAL,GAASgf,QAAQ,IAAI3D,YAArB;AACA,SAAKpb,CAAL,GAASb,IAAI,IAAI,IAAjB;AACA,SAAKwU,GAAL,GAAWsG,MAAM,IAAIe,YAArB;AACA,SAAK6D,EAAL,GAAUlD,QAAQ,IAAI,CAAtB;AACA,SAAKzgB,KAAL,GAAaE,IAAb;;AAEA,QAAIA,IAAJ,EAAU;AACRA,MAAAA,IAAI,CAACH,KAAL,GAAa,IAAb;AACD;AACF;;AAED,MAAI+jB,OAAO,GAAG/T,SAAS,CAAC5Z,SAAxB;;AAEA2tB,EAAAA,OAAO,CAAC1U,QAAR,GAAmB,SAASA,QAAT,CAAkB5S,IAAlB,EAAwBc,KAAxB,EAA+B9B,MAA/B,EAAuC;AACxD,SAAK8nB,IAAL,GAAY,KAAKA,IAAL,IAAa,KAAK7K,GAA9B,CADwD,CACrB;;AAEnC,SAAKA,GAAL,GAAW4K,mBAAX;AACA,SAAK3D,CAAL,GAASljB,IAAT;AACA,SAAK+mB,EAAL,GAAU/nB,MAAV,CALwD,CAKtC;;AAElB,SAAK8B,KAAL,GAAaA,KAAb;AACD,GARD;;AAUA,SAAOyS,SAAP;AACD,CA9BmC,EAA7B,C,CA8BF;;AAELzT,YAAY,CAACjB,cAAc,GAAG,qOAAlB,EAAyP,UAAUX,IAAV,EAAgB;AACnR,SAAOG,cAAc,CAACH,IAAD,CAAd,GAAuB,CAA9B;AACD,CAFW,CAAZ;;AAIAf,QAAQ,CAACoqB,QAAT,GAAoBpqB,QAAQ,CAACqqB,SAAT,GAAqB5c,KAAzC;AACAzN,QAAQ,CAACsqB,YAAT,GAAwBtqB,QAAQ,CAACuqB,WAAT,GAAuBpe,QAA/C;AACAvM,eAAe,GAAG,IAAIuM,QAAJ,CAAa;AAC7B4U,EAAAA,YAAY,EAAE,KADe;AAE7Bpc,EAAAA,QAAQ,EAAExH,SAFmB;AAG7BuJ,EAAAA,kBAAkB,EAAE,IAHS;AAI7BmY,EAAAA,EAAE,EAAE,MAJyB;AAK7BtW,EAAAA,iBAAiB,EAAE;AALU,CAAb,CAAlB;AAOA1L,OAAO,CAACwoB,YAAR,GAAuBlM,kBAAvB;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAInX,KAAK,GAAG;AACVwoB,EAAAA,cAAc,EAAE,SAASA,cAAT,GAA0B;AACxC,SAAK,IAAIC,KAAK,GAAGvY,SAAS,CAAChQ,MAAtB,EAA8BwoB,IAAI,GAAG,IAAIvrB,KAAJ,CAAUsrB,KAAV,CAArC,EAAuDE,KAAK,GAAG,CAApE,EAAuEA,KAAK,GAAGF,KAA/E,EAAsFE,KAAK,EAA3F,EAA+F;AAC7FD,MAAAA,IAAI,CAACC,KAAD,CAAJ,GAAczY,SAAS,CAACyY,KAAD,CAAvB;AACD;;AAEDD,IAAAA,IAAI,CAAC3nB,OAAL,CAAa,UAAUkS,MAAV,EAAkB;AAC7B,aAAOD,aAAa,CAACC,MAAD,CAApB;AACD,KAFD;AAGD,GATS;AAUVvM,EAAAA,QAAQ,EAAE,SAASA,QAAT,CAAkBrD,IAAlB,EAAwB;AAChC,WAAO,IAAI8G,QAAJ,CAAa9G,IAAb,CAAP;AACD,GAZS;AAaVoe,EAAAA,WAAW,EAAE,SAASA,WAAT,CAAqB7hB,OAArB,EAA8B4hB,UAA9B,EAA0C;AACrD,WAAO5jB,eAAe,CAAC6jB,WAAhB,CAA4B7hB,OAA5B,EAAqC4hB,UAArC,CAAP;AACD,GAfS;AAgBVoH,EAAAA,WAAW,EAAE,SAASA,WAAT,CAAqB/oB,MAArB,EAA6BrB,QAA7B,EAAuCgS,IAAvC,EAA6CqY,OAA7C,EAAsD;AACjExsB,IAAAA,SAAS,CAACwD,MAAD,CAAT,KAAsBA,MAAM,GAAGU,OAAO,CAACV,MAAD,CAAP,CAAgB,CAAhB,CAA/B,EADiE,CACb;;AAEpD,QAAIipB,MAAM,GAAGxoB,SAAS,CAACT,MAAM,IAAI,EAAX,CAAT,CAAwBgU,GAArC;AAAA,QACIkV,MAAM,GAAGvY,IAAI,GAAGhO,YAAH,GAAkBL,kBADnC;;AAGAqO,IAAAA,IAAI,KAAK,QAAT,KAAsBA,IAAI,GAAG,EAA7B;AACA,WAAO,CAAC3Q,MAAD,GAAUA,MAAV,GAAmB,CAACrB,QAAD,GAAY,UAAUA,QAAV,EAAoBgS,IAApB,EAA0BqY,OAA1B,EAAmC;AACvE,aAAOE,MAAM,CAAC,CAACzpB,QAAQ,CAACd,QAAD,CAAR,IAAsBc,QAAQ,CAACd,QAAD,CAAR,CAAmBqV,GAAzC,IAAgDiV,MAAjD,EAAyDjpB,MAAzD,EAAiErB,QAAjE,EAA2EgS,IAA3E,EAAiFqY,OAAjF,CAAD,CAAb;AACD,KAFyB,GAEtBE,MAAM,CAAC,CAACzpB,QAAQ,CAACd,QAAD,CAAR,IAAsBc,QAAQ,CAACd,QAAD,CAAR,CAAmBqV,GAAzC,IAAgDiV,MAAjD,EAAyDjpB,MAAzD,EAAiErB,QAAjE,EAA2EgS,IAA3E,EAAiFqY,OAAjF,CAAD,CAFV;AAGD,GA1BS;AA2BVG,EAAAA,WAAW,EAAE,SAASA,WAAT,CAAqBnpB,MAArB,EAA6BrB,QAA7B,EAAuCgS,IAAvC,EAA6C;AACxD3Q,IAAAA,MAAM,GAAGU,OAAO,CAACV,MAAD,CAAhB;;AAEA,QAAIA,MAAM,CAACK,MAAP,GAAgB,CAApB,EAAuB;AACrB,UAAI+oB,OAAO,GAAGppB,MAAM,CAACuW,GAAP,CAAW,UAAUjS,CAAV,EAAa;AACpC,eAAO7F,IAAI,CAAC0qB,WAAL,CAAiB7kB,CAAjB,EAAoB3F,QAApB,EAA8BgS,IAA9B,CAAP;AACD,OAFa,CAAd;AAAA,UAGIlP,CAAC,GAAG2nB,OAAO,CAAC/oB,MAHhB;AAIA,aAAO,UAAU5D,KAAV,EAAiB;AACtB,YAAIyD,CAAC,GAAGuB,CAAR;;AAEA,eAAOvB,CAAC,EAAR,EAAY;AACVkpB,UAAAA,OAAO,CAAClpB,CAAD,CAAP,CAAWzD,KAAX;AACD;AACF,OAND;AAOD;;AAEDuD,IAAAA,MAAM,GAAGA,MAAM,CAAC,CAAD,CAAN,IAAa,EAAtB;;AAEA,QAAIsT,MAAM,GAAG7T,QAAQ,CAACd,QAAD,CAArB;AAAA,QACImP,KAAK,GAAGrN,SAAS,CAACT,MAAD,CADrB;AAAA,QAEI4C,CAAC,GAAGkL,KAAK,CAAC1N,OAAN,IAAiB,CAAC0N,KAAK,CAAC1N,OAAN,CAAc+T,OAAd,IAAyB,EAA1B,EAA8BxV,QAA9B,CAAjB,IAA4DA,QAFpE;AAAA,QAGI;AACJ4kB,IAAAA,MAAM,GAAGjQ,MAAM,GAAG,UAAU7W,KAAV,EAAiB;AACjC,UAAImG,CAAC,GAAG,IAAI0Q,MAAJ,EAAR;AACAJ,MAAAA,WAAW,CAAClL,GAAZ,GAAkB,CAAlB;AACApF,MAAAA,CAAC,CAAC2Q,IAAF,CAAOvT,MAAP,EAAe2Q,IAAI,GAAGlU,KAAK,GAAGkU,IAAX,GAAkBlU,KAArC,EAA4CyW,WAA5C,EAAyD,CAAzD,EAA4D,CAAClT,MAAD,CAA5D;AACA4C,MAAAA,CAAC,CAACZ,MAAF,CAAS,CAAT,EAAYY,CAAZ;AACAsQ,MAAAA,WAAW,CAAClL,GAAZ,IAAmBsK,iBAAiB,CAAC,CAAD,EAAIY,WAAJ,CAApC;AACD,KANc,GAMXpF,KAAK,CAACmP,GAAN,CAAUjd,MAAV,EAAkB4C,CAAlB,CAVJ;;AAYA,WAAO0Q,MAAM,GAAGiQ,MAAH,GAAY,UAAU9mB,KAAV,EAAiB;AACxC,aAAO8mB,MAAM,CAACvjB,MAAD,EAAS4C,CAAT,EAAY+N,IAAI,GAAGlU,KAAK,GAAGkU,IAAX,GAAkBlU,KAAlC,EAAyCqR,KAAzC,EAAgD,CAAhD,CAAb;AACD,KAFD;AAGD,GA7DS;AA8DVub,EAAAA,UAAU,EAAE,SAASA,UAAT,CAAoBtpB,OAApB,EAA6B;AACvC,WAAOhC,eAAe,CAAC6jB,WAAhB,CAA4B7hB,OAA5B,EAAqC,IAArC,EAA2CM,MAA3C,GAAoD,CAA3D;AACD,GAhES;AAiEVyC,EAAAA,QAAQ,EAAE,SAASA,QAAT,CAAkBrG,KAAlB,EAAyB;AACjCA,IAAAA,KAAK,IAAIA,KAAK,CAACkR,IAAf,KAAwBlR,KAAK,CAACkR,IAAN,GAAaC,UAAU,CAACnR,KAAK,CAACkR,IAAP,EAAarS,SAAS,CAACqS,IAAvB,CAA/C;AACA,WAAOxK,UAAU,CAAC7H,SAAD,EAAYmB,KAAK,IAAI,EAArB,CAAjB;AACD,GApES;AAqEV2W,EAAAA,MAAM,EAAE,SAASA,MAAT,CAAgB3W,KAAhB,EAAuB;AAC7B,WAAO0G,UAAU,CAACnI,OAAD,EAAUyB,KAAK,IAAI,EAAnB,CAAjB;AACD,GAvES;AAwEV6sB,EAAAA,cAAc,EAAE,SAASA,cAAT,CAAwBC,KAAxB,EAA+B;AAC7C,QAAIrqB,IAAI,GAAGqqB,KAAK,CAACrqB,IAAjB;AAAA,QACIsqB,MAAM,GAAGD,KAAK,CAACC,MADnB;AAAA,QAEIC,OAAO,GAAGF,KAAK,CAACE,OAFpB;AAAA,QAGI3mB,QAAQ,GAAGymB,KAAK,CAACzmB,QAHrB;AAAA,QAII4mB,cAAc,GAAGH,KAAK,CAACG,cAJ3B;AAKA,KAACD,OAAO,IAAI,EAAZ,EAAgBxoB,KAAhB,CAAsB,GAAtB,EAA2BC,OAA3B,CAAmC,UAAUyoB,UAAV,EAAsB;AACvD,aAAOA,UAAU,IAAI,CAAClqB,QAAQ,CAACkqB,UAAD,CAAvB,IAAuC,CAACxrB,QAAQ,CAACwrB,UAAD,CAAhD,IAAgE7qB,KAAK,CAACI,IAAI,GAAG,mBAAP,GAA6ByqB,UAA7B,GAA0C,UAA3C,CAA5E;AACD,KAFD;;AAIAjqB,IAAAA,QAAQ,CAACR,IAAD,CAAR,GAAiB,UAAUa,OAAV,EAAmByD,IAAnB,EAAyB2e,EAAzB,EAA6B;AAC5C,aAAOqH,MAAM,CAAC9oB,OAAO,CAACX,OAAD,CAAR,EAAmB8C,YAAY,CAACW,IAAI,IAAI,EAAT,EAAaV,QAAb,CAA/B,EAAuDqf,EAAvD,CAAb;AACD,KAFD;;AAIA,QAAIuH,cAAJ,EAAoB;AAClBpf,MAAAA,QAAQ,CAAC3P,SAAT,CAAmBuE,IAAnB,IAA2B,UAAUa,OAAV,EAAmByD,IAAnB,EAAyB2D,QAAzB,EAAmC;AAC5D,eAAO,KAAKuM,GAAL,CAAShU,QAAQ,CAACR,IAAD,CAAR,CAAea,OAAf,EAAwBlD,SAAS,CAAC2G,IAAD,CAAT,GAAkBA,IAAlB,GAAyB,CAAC2D,QAAQ,GAAG3D,IAAZ,KAAqB,EAAtE,EAA0E,IAA1E,CAAT,EAA0F2D,QAA1F,CAAP;AACD,OAFD;AAGD;AACF,GA3FS;AA4FVyiB,EAAAA,YAAY,EAAE,SAASA,YAAT,CAAsB1qB,IAAtB,EAA4ByO,IAA5B,EAAkC;AAC9CsM,IAAAA,QAAQ,CAAC/a,IAAD,CAAR,GAAiB0O,UAAU,CAACD,IAAD,CAA3B;AACD,GA9FS;AA+FVkc,EAAAA,SAAS,EAAE,SAASA,SAAT,CAAmBlc,IAAnB,EAAyB0N,WAAzB,EAAsC;AAC/C,WAAOhL,SAAS,CAAChQ,MAAV,GAAmBuN,UAAU,CAACD,IAAD,EAAO0N,WAAP,CAA7B,GAAmDpB,QAA1D;AACD,GAjGS;AAkGVkH,EAAAA,OAAO,EAAE,SAASA,OAAT,CAAiBnE,EAAjB,EAAqB;AAC5B,WAAOjf,eAAe,CAACojB,OAAhB,CAAwBnE,EAAxB,CAAP;AACD,GApGS;AAqGV8M,EAAAA,UAAU,EAAE,SAASA,UAAT,CAAoBtmB,IAApB,EAA0BumB,mBAA1B,EAA+C;AACzD,QAAIvmB,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnBA,MAAAA,IAAI,GAAG,EAAP;AACD;;AAED,QAAI2e,EAAE,GAAG,IAAI7X,QAAJ,CAAa9G,IAAb,CAAT;AAAA,QACIS,KADJ;AAAA,QAEIS,IAFJ;AAGAyd,IAAAA,EAAE,CAACzb,iBAAH,GAAuB5J,WAAW,CAAC0G,IAAI,CAACkD,iBAAN,CAAlC;;AAEA3I,IAAAA,eAAe,CAAC+G,MAAhB,CAAuBqd,EAAvB;;AAEAA,IAAAA,EAAE,CAACve,GAAH,GAAS,CAAT,CAZyD,CAY7C;;AAEZue,IAAAA,EAAE,CAACxb,KAAH,GAAWwb,EAAE,CAACvc,MAAH,GAAY7H,eAAe,CAAC4I,KAAvC;AACA1C,IAAAA,KAAK,GAAGlG,eAAe,CAAC8L,MAAxB;;AAEA,WAAO5F,KAAP,EAAc;AACZS,MAAAA,IAAI,GAAGT,KAAK,CAACO,KAAb;;AAEA,UAAIulB,mBAAmB,IAAI,EAAE,CAAC9lB,KAAK,CAACiB,IAAP,IAAejB,KAAK,YAAY2H,KAAhC,IAAyC3H,KAAK,CAACT,IAAN,CAAWqc,UAAX,KAA0B5b,KAAK,CAACge,QAAN,CAAe,CAAf,CAArE,CAA3B,EAAoH;AAClH/a,QAAAA,cAAc,CAACib,EAAD,EAAKle,KAAL,EAAYA,KAAK,CAACkB,MAAN,GAAelB,KAAK,CAACqD,MAAjC,CAAd;AACD;;AAEDrD,MAAAA,KAAK,GAAGS,IAAR;AACD;;AAEDwC,IAAAA,cAAc,CAACnJ,eAAD,EAAkBokB,EAAlB,EAAsB,CAAtB,CAAd;;AAEA,WAAOA,EAAP;AACD,GAnIS;AAoIV6H,EAAAA,KAAK,EAAE;AACLhZ,IAAAA,IAAI,EAAEA,IADD;AAELE,IAAAA,QAAQ,EAAEA,QAFL;AAGLzD,IAAAA,UAAU,EAAEA,UAHP;AAILD,IAAAA,MAAM,EAAEA,MAJH;AAKLgC,IAAAA,IAAI,EAAEA,IALD;AAMLoB,IAAAA,SAAS,EAAEA,SANN;AAOL5E,IAAAA,OAAO,EAAEA,OAPJ;AAQLG,IAAAA,KAAK,EAAEA,KARF;AASL8J,IAAAA,UAAU,EAAEA,UATP;AAULvV,IAAAA,OAAO,EAAEA,OAVJ;AAWLuM,IAAAA,QAAQ,EAAEA,QAXL;AAYL4D,IAAAA,QAAQ,EAAEA,QAZL;AAaLV,IAAAA,IAAI,EAAEA,IAbD;AAcLO,IAAAA,OAAO,EAAEA,OAdJ;AAeLmB,IAAAA,WAAW,EAAEA,WAfR;AAgBLvE,IAAAA,OAAO,EAAEA;AAhBJ,GApIG;AAsJV2c,EAAAA,OAAO,EAAE3rB,QAtJC;AAuJV4rB,EAAAA,OAAO,EAAExqB,QAvJC;AAwJVyqB,EAAAA,MAAM,EAAEjiB,OAxJE;AAyJVmb,EAAAA,UAAU,EAAE/Y,QAAQ,CAAC+Y,UAzJX;AA0JVoG,EAAAA,OAAO,EAAEhqB,QA1JC;AA2JV2qB,EAAAA,cAAc,EAAErsB,eA3JN;AA4JVssB,EAAAA,IAAI,EAAE;AACJ9V,IAAAA,SAAS,EAAEA,SADP;AAEJ+V,IAAAA,OAAO,EAAErrB,UAFL;AAGJ2M,IAAAA,KAAK,EAAEA,KAHH;AAIJtB,IAAAA,QAAQ,EAAEA,QAJN;AAKJ4S,IAAAA,SAAS,EAAEA,SALP;AAMJqN,IAAAA,QAAQ,EAAE9pB,SANN;AAOJgE,IAAAA,qBAAqB,EAAEA,qBAPnB;AAQJ+lB,IAAAA,kBAAkB,EAAE,SAASA,kBAAT,CAA4B/tB,KAA5B,EAAmC;AACrD,aAAOf,mBAAmB,GAAGe,KAA7B;AACD;AAVG;AA5JI,CAAZ;;AA0KAqE,YAAY,CAAC,6CAAD,EAAgD,UAAU5B,IAAV,EAAgB;AAC1E,SAAOiB,KAAK,CAACjB,IAAD,CAAL,GAAc0M,KAAK,CAAC1M,IAAD,CAA1B;AACD,CAFW,CAAZ;;AAIAgJ,OAAO,CAACwL,GAAR,CAAYpJ,QAAQ,CAAC+Y,UAArB;;AAEAnQ,WAAW,GAAG/S,KAAK,CAACif,EAAN,CAAS,EAAT,EAAa;AACzB7jB,EAAAA,QAAQ,EAAE;AADe,CAAb,CAAd,C,CAEI;;AAEJ,IAAIkvB,mBAAmB,GAAG,SAASA,mBAAT,CAA6B1F,MAA7B,EAAqC1Q,IAArC,EAA2C;AACnE,MAAIvL,EAAE,GAAGic,MAAM,CAAC/c,GAAhB;;AAEA,SAAOc,EAAE,IAAIA,EAAE,CAAClG,CAAH,KAASyR,IAAf,IAAuBvL,EAAE,CAAC6e,EAAH,KAAUtT,IAAjC,IAAyCvL,EAAE,CAACqb,EAAH,KAAU9P,IAA1D,EAAgE;AAC9DvL,IAAAA,EAAE,GAAGA,EAAE,CAACtE,KAAR;AACD;;AAED,SAAOsE,EAAP;AACD,CARD;AAAA,IASI4hB,aAAa,GAAG,SAASA,aAAT,CAAuB5oB,KAAvB,EAA8B6oB,SAA9B,EAAyC;AAC3D,MAAI5qB,OAAO,GAAG+B,KAAK,CAACmgB,QAApB;AAAA,MACIrf,CADJ;AAAA,MAEI1C,CAFJ;AAAA,MAGI4I,EAHJ;;AAKA,OAAKlG,CAAL,IAAU+nB,SAAV,EAAqB;AACnBzqB,IAAAA,CAAC,GAAGH,OAAO,CAACM,MAAZ;;AAEA,WAAOH,CAAC,EAAR,EAAY;AACV4I,MAAAA,EAAE,GAAGhH,KAAK,CAAC0b,SAAN,CAAgBtd,CAAhB,EAAmB0C,CAAnB,CAAL;;AAEA,UAAIkG,EAAE,KAAKA,EAAE,GAAGA,EAAE,CAACQ,CAAb,CAAN,EAAuB;AACrB,YAAIR,EAAE,CAACd,GAAP,EAAY;AACV;AACAc,UAAAA,EAAE,GAAG2hB,mBAAmB,CAAC3hB,EAAD,EAAKlG,CAAL,CAAxB;AACD;;AAEDkG,QAAAA,EAAE,IAAIA,EAAE,CAAC8K,QAAT,IAAqB9K,EAAE,CAAC8K,QAAH,CAAY+W,SAAS,CAAC/nB,CAAD,CAArB,EAA0Bd,KAA1B,EAAiC/B,OAAO,CAACG,CAAD,CAAxC,EAA6C0C,CAA7C,CAArB;AACD;AACF;AACF;AACF,CA/BD;AAAA,IAgCIgoB,oBAAoB,GAAG,SAASA,oBAAT,CAA8B1rB,IAA9B,EAAoC0U,QAApC,EAA8C;AACvE,SAAO;AACL1U,IAAAA,IAAI,EAAEA,IADD;AAEL4U,IAAAA,OAAO,EAAE,CAFJ;AAGL;AACAP,IAAAA,IAAI,EAAE,SAASA,IAAT,CAAcvT,MAAd,EAAsBwD,IAAtB,EAA4B1B,KAA5B,EAAmC;AACvCA,MAAAA,KAAK,CAACikB,OAAN,GAAgB,UAAUjkB,KAAV,EAAiB;AAC/B,YAAI+oB,IAAJ,EAAUjoB,CAAV;;AAEA,YAAIpG,SAAS,CAACgH,IAAD,CAAb,EAAqB;AACnBqnB,UAAAA,IAAI,GAAG,EAAP;;AAEA/pB,UAAAA,YAAY,CAAC0C,IAAD,EAAO,UAAUtE,IAAV,EAAgB;AACjC,mBAAO2rB,IAAI,CAAC3rB,IAAD,CAAJ,GAAa,CAApB;AACD,WAFW,CAAZ,CAHmB,CAKf;;;AAGJsE,UAAAA,IAAI,GAAGqnB,IAAP;AACD;;AAED,YAAIjX,QAAJ,EAAc;AACZiX,UAAAA,IAAI,GAAG,EAAP;;AAEA,eAAKjoB,CAAL,IAAUY,IAAV,EAAgB;AACdqnB,YAAAA,IAAI,CAACjoB,CAAD,CAAJ,GAAUgR,QAAQ,CAACpQ,IAAI,CAACZ,CAAD,CAAL,CAAlB;AACD;;AAEDY,UAAAA,IAAI,GAAGqnB,IAAP;AACD;;AAEDH,QAAAA,aAAa,CAAC5oB,KAAD,EAAQ0B,IAAR,CAAb;AACD,OAzBD;AA0BD;AA/BI,GAAP;AAiCD,CAlED,C,CAkEG;;;AAGH,OAAO,IAAI/E,IAAI,GAAG0B,KAAK,CAACwoB,cAAN,CAAqB;AACrCzpB,EAAAA,IAAI,EAAE,MAD+B;AAErCqU,EAAAA,IAAI,EAAE,SAASA,IAAT,CAAcvT,MAAd,EAAsBwD,IAAtB,EAA4B1B,KAA5B,EAAmCoK,KAAnC,EAA0CnM,OAA1C,EAAmD;AACvD,QAAI6C,CAAJ,EAAOkG,EAAP;;AAEA,SAAKlG,CAAL,IAAUY,IAAV,EAAgB;AACdsF,MAAAA,EAAE,GAAG,KAAK4K,GAAL,CAAS1T,MAAT,EAAiB,cAAjB,EAAiC,CAACA,MAAM,CAACa,YAAP,CAAoB+B,CAApB,KAA0B,CAA3B,IAAgC,EAAjE,EAAqEY,IAAI,CAACZ,CAAD,CAAzE,EAA8EsJ,KAA9E,EAAqFnM,OAArF,EAA8F,CAA9F,EAAiG,CAAjG,EAAoG6C,CAApG,CAAL;AACAkG,MAAAA,EAAE,KAAKA,EAAE,CAAC6e,EAAH,GAAQ/kB,CAAb,CAAF;;AAEA,WAAK4Q,MAAL,CAAYpL,IAAZ,CAAiBxF,CAAjB;AACD;AACF;AAXoC,CAArB,EAYf;AACD1D,EAAAA,IAAI,EAAE,UADL;AAEDqU,EAAAA,IAAI,EAAE,SAASA,IAAT,CAAcvT,MAAd,EAAsBvD,KAAtB,EAA6B;AACjC,QAAIyD,CAAC,GAAGzD,KAAK,CAAC4D,MAAd;;AAEA,WAAOH,CAAC,EAAR,EAAY;AACV,WAAKwT,GAAL,CAAS1T,MAAT,EAAiBE,CAAjB,EAAoBF,MAAM,CAACE,CAAD,CAAN,IAAa,CAAjC,EAAoCzD,KAAK,CAACyD,CAAD,CAAzC;AACD;AACF;AARA,CAZe,EAqBf0qB,oBAAoB,CAAC,YAAD,EAAevb,cAAf,CArBL,EAqBqCub,oBAAoB,CAAC,WAAD,CArBzD,EAqBwEA,oBAAoB,CAAC,MAAD,EAASpb,IAAT,CArB5F,KAqB+GrP,KArB1H,C,CAqBiI;;AAExIyL,KAAK,CAAC0N,OAAN,GAAgBhP,QAAQ,CAACgP,OAAT,GAAmB7a,IAAI,CAAC6a,OAAL,GAAe,OAAlD;AACAjb,UAAU,GAAG,CAAb;AACAtB,aAAa,MAAM+P,KAAK,EAAxB;AACA,IAAIge,MAAM,GAAG7Q,QAAQ,CAAC6Q,MAAtB;AAAA,IACIC,MAAM,GAAG9Q,QAAQ,CAAC8Q,MADtB;AAAA,IAEIC,MAAM,GAAG/Q,QAAQ,CAAC+Q,MAFtB;AAAA,IAGIC,MAAM,GAAGhR,QAAQ,CAACgR,MAHtB;AAAA,IAIIC,MAAM,GAAGjR,QAAQ,CAACiR,MAJtB;AAAA,IAKI3O,MAAM,GAAGtC,QAAQ,CAACsC,MALtB;AAAA,IAMI4O,IAAI,GAAGlR,QAAQ,CAACkR,IANpB;AAAA,IAOIC,KAAK,GAAGnR,QAAQ,CAACmR,KAPrB;AAAA,IAQIC,KAAK,GAAGpR,QAAQ,CAACoR,KARrB;AAAA,IASIC,KAAK,GAAGrR,QAAQ,CAACqR,KATrB;AAAA,IAUIC,MAAM,GAAGtR,QAAQ,CAACsR,MAVtB;AAAA,IAWIC,OAAO,GAAGvR,QAAQ,CAACuR,OAXvB;AAAA,IAYIC,IAAI,GAAGxR,QAAQ,CAACwR,IAZpB;AAAA,IAaI5O,WAAW,GAAG5C,QAAQ,CAAC4C,WAb3B;AAAA,IAcI6O,MAAM,GAAGzR,QAAQ,CAACyR,MAdtB;AAAA,IAeIC,IAAI,GAAG1R,QAAQ,CAAC0R,IAfpB;AAAA,IAgBIC,IAAI,GAAG3R,QAAQ,CAAC2R,IAhBpB;AAAA,IAiBIC,IAAI,GAAG5R,QAAQ,CAAC4R,IAjBpB;AAkBA,SAASf,MAAT,EAAiBC,MAAjB,EAAyBC,MAAzB,EAAiCC,MAAjC,EAAyCC,MAAzC,EAAiD3O,MAAjD,EAAyD4O,IAAzD,EAA+DC,KAA/D,EAAsEC,KAAtE,EAA6EC,KAA7E,EAAoFC,MAApF,EAA4FC,OAA5F,EAAqGC,IAArG,EAA2G5O,WAA3G,EAAwH6O,MAAxH,EAAgIC,IAAhI,EAAsIC,IAAtI,EAA4IC,IAA5I;AACA,SAASjgB,KAAK,IAAI2c,QAAlB,EAA4B3c,KAAK,IAAI4c,SAArC,EAAgDle,QAAQ,IAAIoe,WAA5D,EAAyEpe,QAAQ,IAAIme,YAArF,EAAmGhqB,IAAI,IAAIqtB,OAA3G,EAAoH9a,IAApH,EAA0HE,QAA1H,EAAoIzD,UAApI,EAAgJD,MAAhJ,EAAwJgC,IAAxJ,EAA8JoB,SAA9J,EAAyK5E,OAAzK,EAAkLG,KAAlL,EAAyL8J,UAAzL,EAAqMvV,OAArM,EAA8MuM,QAA9M,EAAwN4D,QAAxN,EAAkOV,IAAlO,EAAwOO,OAAxO,EAAiPmB,WAAjP,EAA8PvE,OAA9P,G,CAAyQ;;AAEzQ,SAAS3M,YAAT,EAAuBlD,OAAvB,EAAgCC,eAAhC,EAAiDlB,SAAjD,EAA4DI,YAA5D,EAA0E8mB,oBAA1E,EAAgG9lB,OAAhG,EAAyGiF,YAAzG,EAAuH4B,qBAAvH,EAA8I3D,YAA9I,EAA4JglB,yBAA5J,EAAuLxO,kBAAvL,EAA2MlG,cAA3M,EAA2N0T,YAA3N,EAAyOrlB,QAAzO,EAAmPyI,OAAnP,EAA4PlN,OAA5P,EAAqQqU,cAArQ,EAAqRlO,MAArR,EAA6RzC,cAA7R,EAA6SwV,UAA7S,EAAyTzT,SAAzT,EAAoUkW,SAApU","sourcesContent":["function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\n/*!\n * GSAP 3.9.1\n * https://greensock.com\n *\n * @license Copyright 2008-2021, GreenSock. All rights reserved.\n * Subject to the terms at https://greensock.com/standard-license or for\n * Club GreenSock members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n*/\n\n/* eslint-disable */\nvar _config = {\n  autoSleep: 120,\n  force3D: \"auto\",\n  nullTargetWarn: 1,\n  units: {\n    lineHeight: \"\"\n  }\n},\n    _defaults = {\n  duration: .5,\n  overwrite: false,\n  delay: 0\n},\n    _suppressOverwrites,\n    _bigNum = 1e8,\n    _tinyNum = 1 / _bigNum,\n    _2PI = Math.PI * 2,\n    _HALF_PI = _2PI / 4,\n    _gsID = 0,\n    _sqrt = Math.sqrt,\n    _cos = Math.cos,\n    _sin = Math.sin,\n    _isString = function _isString(value) {\n  return typeof value === \"string\";\n},\n    _isFunction = function _isFunction(value) {\n  return typeof value === \"function\";\n},\n    _isNumber = function _isNumber(value) {\n  return typeof value === \"number\";\n},\n    _isUndefined = function _isUndefined(value) {\n  return typeof value === \"undefined\";\n},\n    _isObject = function _isObject(value) {\n  return typeof value === \"object\";\n},\n    _isNotFalse = function _isNotFalse(value) {\n  return value !== false;\n},\n    _windowExists = function _windowExists() {\n  return typeof window !== \"undefined\";\n},\n    _isFuncOrString = function _isFuncOrString(value) {\n  return _isFunction(value) || _isString(value);\n},\n    _isTypedArray = typeof ArrayBuffer === \"function\" && ArrayBuffer.isView || function () {},\n    // note: IE10 has ArrayBuffer, but NOT ArrayBuffer.isView().\n_isArray = Array.isArray,\n    _strictNumExp = /(?:-?\\.?\\d|\\.)+/gi,\n    //only numbers (including negatives and decimals) but NOT relative values.\n_numExp = /[-+=.]*\\d+[.e\\-+]*\\d*[e\\-+]*\\d*/g,\n    //finds any numbers, including ones that start with += or -=, negative numbers, and ones in scientific notation like 1e-8.\n_numWithUnitExp = /[-+=.]*\\d+[.e-]*\\d*[a-z%]*/g,\n    _complexStringNumExp = /[-+=.]*\\d+\\.?\\d*(?:e-|e\\+)?\\d*/gi,\n    //duplicate so that while we're looping through matches from exec(), it doesn't contaminate the lastIndex of _numExp which we use to search for colors too.\n_relExp = /[+-]=-?[.\\d]+/,\n    _delimitedValueExp = /[^,'\"\\[\\]\\s]+/gi,\n    // previously /[#\\-+.]*\\b[a-z\\d\\-=+%.]+/gi but didn't catch special characters.\n_unitExp = /[\\d.+\\-=]+(?:e[-+]\\d*)*/i,\n    _globalTimeline,\n    _win,\n    _coreInitted,\n    _doc,\n    _globals = {},\n    _installScope = {},\n    _coreReady,\n    _install = function _install(scope) {\n  return (_installScope = _merge(scope, _globals)) && gsap;\n},\n    _missingPlugin = function _missingPlugin(property, value) {\n  return console.warn(\"Invalid property\", property, \"set to\", value, \"Missing plugin? gsap.registerPlugin()\");\n},\n    _warn = function _warn(message, suppress) {\n  return !suppress && console.warn(message);\n},\n    _addGlobal = function _addGlobal(name, obj) {\n  return name && (_globals[name] = obj) && _installScope && (_installScope[name] = obj) || _globals;\n},\n    _emptyFunc = function _emptyFunc() {\n  return 0;\n},\n    _reservedProps = {},\n    _lazyTweens = [],\n    _lazyLookup = {},\n    _lastRenderedFrame,\n    _plugins = {},\n    _effects = {},\n    _nextGCFrame = 30,\n    _harnessPlugins = [],\n    _callbackNames = \"\",\n    _harness = function _harness(targets) {\n  var target = targets[0],\n      harnessPlugin,\n      i;\n  _isObject(target) || _isFunction(target) || (targets = [targets]);\n\n  if (!(harnessPlugin = (target._gsap || {}).harness)) {\n    // find the first target with a harness. We assume targets passed into an animation will be of similar type, meaning the same kind of harness can be used for them all (performance optimization)\n    i = _harnessPlugins.length;\n\n    while (i-- && !_harnessPlugins[i].targetTest(target)) {}\n\n    harnessPlugin = _harnessPlugins[i];\n  }\n\n  i = targets.length;\n\n  while (i--) {\n    targets[i] && (targets[i]._gsap || (targets[i]._gsap = new GSCache(targets[i], harnessPlugin))) || targets.splice(i, 1);\n  }\n\n  return targets;\n},\n    _getCache = function _getCache(target) {\n  return target._gsap || _harness(toArray(target))[0]._gsap;\n},\n    _getProperty = function _getProperty(target, property, v) {\n  return (v = target[property]) && _isFunction(v) ? target[property]() : _isUndefined(v) && target.getAttribute && target.getAttribute(property) || v;\n},\n    _forEachName = function _forEachName(names, func) {\n  return (names = names.split(\",\")).forEach(func) || names;\n},\n    //split a comma-delimited list of names into an array, then run a forEach() function and return the split array (this is just a way to consolidate/shorten some code).\n_round = function _round(value) {\n  return Math.round(value * 100000) / 100000 || 0;\n},\n    _roundPrecise = function _roundPrecise(value) {\n  return Math.round(value * 10000000) / 10000000 || 0;\n},\n    // increased precision mostly for timing values.\n_arrayContainsAny = function _arrayContainsAny(toSearch, toFind) {\n  //searches one array to find matches for any of the items in the toFind array. As soon as one is found, it returns true. It does NOT return all the matches; it's simply a boolean search.\n  var l = toFind.length,\n      i = 0;\n\n  for (; toSearch.indexOf(toFind[i]) < 0 && ++i < l;) {}\n\n  return i < l;\n},\n    _lazyRender = function _lazyRender() {\n  var l = _lazyTweens.length,\n      a = _lazyTweens.slice(0),\n      i,\n      tween;\n\n  _lazyLookup = {};\n  _lazyTweens.length = 0;\n\n  for (i = 0; i < l; i++) {\n    tween = a[i];\n    tween && tween._lazy && (tween.render(tween._lazy[0], tween._lazy[1], true)._lazy = 0);\n  }\n},\n    _lazySafeRender = function _lazySafeRender(animation, time, suppressEvents, force) {\n  _lazyTweens.length && _lazyRender();\n  animation.render(time, suppressEvents, force);\n  _lazyTweens.length && _lazyRender(); //in case rendering caused any tweens to lazy-init, we should render them because typically when someone calls seek() or time() or progress(), they expect an immediate render.\n},\n    _numericIfPossible = function _numericIfPossible(value) {\n  var n = parseFloat(value);\n  return (n || n === 0) && (value + \"\").match(_delimitedValueExp).length < 2 ? n : _isString(value) ? value.trim() : value;\n},\n    _passThrough = function _passThrough(p) {\n  return p;\n},\n    _setDefaults = function _setDefaults(obj, defaults) {\n  for (var p in defaults) {\n    p in obj || (obj[p] = defaults[p]);\n  }\n\n  return obj;\n},\n    _setKeyframeDefaults = function _setKeyframeDefaults(excludeDuration) {\n  return function (obj, defaults) {\n    for (var p in defaults) {\n      p in obj || p === \"duration\" && excludeDuration || p === \"ease\" || (obj[p] = defaults[p]);\n    }\n  };\n},\n    _merge = function _merge(base, toMerge) {\n  for (var p in toMerge) {\n    base[p] = toMerge[p];\n  }\n\n  return base;\n},\n    _mergeDeep = function _mergeDeep(base, toMerge) {\n  for (var p in toMerge) {\n    p !== \"__proto__\" && p !== \"constructor\" && p !== \"prototype\" && (base[p] = _isObject(toMerge[p]) ? _mergeDeep(base[p] || (base[p] = {}), toMerge[p]) : toMerge[p]);\n  }\n\n  return base;\n},\n    _copyExcluding = function _copyExcluding(obj, excluding) {\n  var copy = {},\n      p;\n\n  for (p in obj) {\n    p in excluding || (copy[p] = obj[p]);\n  }\n\n  return copy;\n},\n    _inheritDefaults = function _inheritDefaults(vars) {\n  var parent = vars.parent || _globalTimeline,\n      func = vars.keyframes ? _setKeyframeDefaults(_isArray(vars.keyframes)) : _setDefaults;\n\n  if (_isNotFalse(vars.inherit)) {\n    while (parent) {\n      func(vars, parent.vars.defaults);\n      parent = parent.parent || parent._dp;\n    }\n  }\n\n  return vars;\n},\n    _arraysMatch = function _arraysMatch(a1, a2) {\n  var i = a1.length,\n      match = i === a2.length;\n\n  while (match && i-- && a1[i] === a2[i]) {}\n\n  return i < 0;\n},\n    _addLinkedListItem = function _addLinkedListItem(parent, child, firstProp, lastProp, sortBy) {\n  if (firstProp === void 0) {\n    firstProp = \"_first\";\n  }\n\n  if (lastProp === void 0) {\n    lastProp = \"_last\";\n  }\n\n  var prev = parent[lastProp],\n      t;\n\n  if (sortBy) {\n    t = child[sortBy];\n\n    while (prev && prev[sortBy] > t) {\n      prev = prev._prev;\n    }\n  }\n\n  if (prev) {\n    child._next = prev._next;\n    prev._next = child;\n  } else {\n    child._next = parent[firstProp];\n    parent[firstProp] = child;\n  }\n\n  if (child._next) {\n    child._next._prev = child;\n  } else {\n    parent[lastProp] = child;\n  }\n\n  child._prev = prev;\n  child.parent = child._dp = parent;\n  return child;\n},\n    _removeLinkedListItem = function _removeLinkedListItem(parent, child, firstProp, lastProp) {\n  if (firstProp === void 0) {\n    firstProp = \"_first\";\n  }\n\n  if (lastProp === void 0) {\n    lastProp = \"_last\";\n  }\n\n  var prev = child._prev,\n      next = child._next;\n\n  if (prev) {\n    prev._next = next;\n  } else if (parent[firstProp] === child) {\n    parent[firstProp] = next;\n  }\n\n  if (next) {\n    next._prev = prev;\n  } else if (parent[lastProp] === child) {\n    parent[lastProp] = prev;\n  }\n\n  child._next = child._prev = child.parent = null; // don't delete the _dp just so we can revert if necessary. But parent should be null to indicate the item isn't in a linked list.\n},\n    _removeFromParent = function _removeFromParent(child, onlyIfParentHasAutoRemove) {\n  child.parent && (!onlyIfParentHasAutoRemove || child.parent.autoRemoveChildren) && child.parent.remove(child);\n  child._act = 0;\n},\n    _uncache = function _uncache(animation, child) {\n  if (animation && (!child || child._end > animation._dur || child._start < 0)) {\n    // performance optimization: if a child animation is passed in we should only uncache if that child EXTENDS the animation (its end time is beyond the end)\n    var a = animation;\n\n    while (a) {\n      a._dirty = 1;\n      a = a.parent;\n    }\n  }\n\n  return animation;\n},\n    _recacheAncestors = function _recacheAncestors(animation) {\n  var parent = animation.parent;\n\n  while (parent && parent.parent) {\n    //sometimes we must force a re-sort of all children and update the duration/totalDuration of all ancestor timelines immediately in case, for example, in the middle of a render loop, one tween alters another tween's timeScale which shoves its startTime before 0, forcing the parent timeline to shift around and shiftChildren() which could affect that next tween's render (startTime). Doesn't matter for the root timeline though.\n    parent._dirty = 1;\n    parent.totalDuration();\n    parent = parent.parent;\n  }\n\n  return animation;\n},\n    _hasNoPausedAncestors = function _hasNoPausedAncestors(animation) {\n  return !animation || animation._ts && _hasNoPausedAncestors(animation.parent);\n},\n    _elapsedCycleDuration = function _elapsedCycleDuration(animation) {\n  return animation._repeat ? _animationCycle(animation._tTime, animation = animation.duration() + animation._rDelay) * animation : 0;\n},\n    // feed in the totalTime and cycleDuration and it'll return the cycle (iteration minus 1) and if the playhead is exactly at the very END, it will NOT bump up to the next cycle.\n_animationCycle = function _animationCycle(tTime, cycleDuration) {\n  var whole = Math.floor(tTime /= cycleDuration);\n  return tTime && whole === tTime ? whole - 1 : whole;\n},\n    _parentToChildTotalTime = function _parentToChildTotalTime(parentTime, child) {\n  return (parentTime - child._start) * child._ts + (child._ts >= 0 ? 0 : child._dirty ? child.totalDuration() : child._tDur);\n},\n    _setEnd = function _setEnd(animation) {\n  return animation._end = _roundPrecise(animation._start + (animation._tDur / Math.abs(animation._ts || animation._rts || _tinyNum) || 0));\n},\n    _alignPlayhead = function _alignPlayhead(animation, totalTime) {\n  // adjusts the animation's _start and _end according to the provided totalTime (only if the parent's smoothChildTiming is true and the animation isn't paused). It doesn't do any rendering or forcing things back into parent timelines, etc. - that's what totalTime() is for.\n  var parent = animation._dp;\n\n  if (parent && parent.smoothChildTiming && animation._ts) {\n    animation._start = _roundPrecise(parent._time - (animation._ts > 0 ? totalTime / animation._ts : ((animation._dirty ? animation.totalDuration() : animation._tDur) - totalTime) / -animation._ts));\n\n    _setEnd(animation);\n\n    parent._dirty || _uncache(parent, animation); //for performance improvement. If the parent's cache is already dirty, it already took care of marking the ancestors as dirty too, so skip the function call here.\n  }\n\n  return animation;\n},\n\n/*\n_totalTimeToTime = (clampedTotalTime, duration, repeat, repeatDelay, yoyo) => {\n\tlet cycleDuration = duration + repeatDelay,\n\t\ttime = _round(clampedTotalTime % cycleDuration);\n\tif (time > duration) {\n\t\ttime = duration;\n\t}\n\treturn (yoyo && (~~(clampedTotalTime / cycleDuration) & 1)) ? duration - time : time;\n},\n*/\n_postAddChecks = function _postAddChecks(timeline, child) {\n  var t;\n\n  if (child._time || child._initted && !child._dur) {\n    //in case, for example, the _start is moved on a tween that has already rendered. Imagine it's at its end state, then the startTime is moved WAY later (after the end of this timeline), it should render at its beginning.\n    t = _parentToChildTotalTime(timeline.rawTime(), child);\n\n    if (!child._dur || _clamp(0, child.totalDuration(), t) - child._tTime > _tinyNum) {\n      child.render(t, true);\n    }\n  } //if the timeline has already ended but the inserted tween/timeline extends the duration, we should enable this timeline again so that it renders properly. We should also align the playhead with the parent timeline's when appropriate.\n\n\n  if (_uncache(timeline, child)._dp && timeline._initted && timeline._time >= timeline._dur && timeline._ts) {\n    //in case any of the ancestors had completed but should now be enabled...\n    if (timeline._dur < timeline.duration()) {\n      t = timeline;\n\n      while (t._dp) {\n        t.rawTime() >= 0 && t.totalTime(t._tTime); //moves the timeline (shifts its startTime) if necessary, and also enables it. If it's currently zero, though, it may not be scheduled to render until later so there's no need to force it to align with the current playhead position. Only move to catch up with the playhead.\n\n        t = t._dp;\n      }\n    }\n\n    timeline._zTime = -_tinyNum; // helps ensure that the next render() will be forced (crossingStart = true in render()), even if the duration hasn't changed (we're adding a child which would need to get rendered). Definitely an edge case. Note: we MUST do this AFTER the loop above where the totalTime() might trigger a render() because this _addToTimeline() method gets called from the Animation constructor, BEFORE tweens even record their targets, etc. so we wouldn't want things to get triggered in the wrong order.\n  }\n},\n    _addToTimeline = function _addToTimeline(timeline, child, position, skipChecks) {\n  child.parent && _removeFromParent(child);\n  child._start = _roundPrecise((_isNumber(position) ? position : position || timeline !== _globalTimeline ? _parsePosition(timeline, position, child) : timeline._time) + child._delay);\n  child._end = _roundPrecise(child._start + (child.totalDuration() / Math.abs(child.timeScale()) || 0));\n\n  _addLinkedListItem(timeline, child, \"_first\", \"_last\", timeline._sort ? \"_start\" : 0);\n\n  _isFromOrFromStart(child) || (timeline._recent = child);\n  skipChecks || _postAddChecks(timeline, child);\n  return timeline;\n},\n    _scrollTrigger = function _scrollTrigger(animation, trigger) {\n  return (_globals.ScrollTrigger || _missingPlugin(\"scrollTrigger\", trigger)) && _globals.ScrollTrigger.create(trigger, animation);\n},\n    _attemptInitTween = function _attemptInitTween(tween, totalTime, force, suppressEvents) {\n  _initTween(tween, totalTime);\n\n  if (!tween._initted) {\n    return 1;\n  }\n\n  if (!force && tween._pt && (tween._dur && tween.vars.lazy !== false || !tween._dur && tween.vars.lazy) && _lastRenderedFrame !== _ticker.frame) {\n    _lazyTweens.push(tween);\n\n    tween._lazy = [totalTime, suppressEvents];\n    return 1;\n  }\n},\n    _parentPlayheadIsBeforeStart = function _parentPlayheadIsBeforeStart(_ref) {\n  var parent = _ref.parent;\n  return parent && parent._ts && parent._initted && !parent._lock && (parent.rawTime() < 0 || _parentPlayheadIsBeforeStart(parent));\n},\n    // check parent's _lock because when a timeline repeats/yoyos and does its artificial wrapping, we shouldn't force the ratio back to 0\n_isFromOrFromStart = function _isFromOrFromStart(_ref2) {\n  var data = _ref2.data;\n  return data === \"isFromStart\" || data === \"isStart\";\n},\n    _renderZeroDurationTween = function _renderZeroDurationTween(tween, totalTime, suppressEvents, force) {\n  var prevRatio = tween.ratio,\n      ratio = totalTime < 0 || !totalTime && (!tween._start && _parentPlayheadIsBeforeStart(tween) && !(!tween._initted && _isFromOrFromStart(tween)) || (tween._ts < 0 || tween._dp._ts < 0) && !_isFromOrFromStart(tween)) ? 0 : 1,\n      // if the tween or its parent is reversed and the totalTime is 0, we should go to a ratio of 0. Edge case: if a from() or fromTo() stagger tween is placed later in a timeline, the \"startAt\" zero-duration tween could initially render at a time when the parent timeline's playhead is technically BEFORE where this tween is, so make sure that any \"from\" and \"fromTo\" startAt tweens are rendered the first time at a ratio of 1.\n  repeatDelay = tween._rDelay,\n      tTime = 0,\n      pt,\n      iteration,\n      prevIteration;\n\n  if (repeatDelay && tween._repeat) {\n    // in case there's a zero-duration tween that has a repeat with a repeatDelay\n    tTime = _clamp(0, tween._tDur, totalTime);\n    iteration = _animationCycle(tTime, repeatDelay);\n    tween._yoyo && iteration & 1 && (ratio = 1 - ratio);\n\n    if (iteration !== _animationCycle(tween._tTime, repeatDelay)) {\n      // if iteration changed\n      prevRatio = 1 - ratio;\n      tween.vars.repeatRefresh && tween._initted && tween.invalidate();\n    }\n  }\n\n  if (ratio !== prevRatio || force || tween._zTime === _tinyNum || !totalTime && tween._zTime) {\n    if (!tween._initted && _attemptInitTween(tween, totalTime, force, suppressEvents)) {\n      // if we render the very beginning (time == 0) of a fromTo(), we must force the render (normal tweens wouldn't need to render at a time of 0 when the prevTime was also 0). This is also mandatory to make sure overwriting kicks in immediately.\n      return;\n    }\n\n    prevIteration = tween._zTime;\n    tween._zTime = totalTime || (suppressEvents ? _tinyNum : 0); // when the playhead arrives at EXACTLY time 0 (right on top) of a zero-duration tween, we need to discern if events are suppressed so that when the playhead moves again (next time), it'll trigger the callback. If events are NOT suppressed, obviously the callback would be triggered in this render. Basically, the callback should fire either when the playhead ARRIVES or LEAVES this exact spot, not both. Imagine doing a timeline.seek(0) and there's a callback that sits at 0. Since events are suppressed on that seek() by default, nothing will fire, but when the playhead moves off of that position, the callback should fire. This behavior is what people intuitively expect.\n\n    suppressEvents || (suppressEvents = totalTime && !prevIteration); // if it was rendered previously at exactly 0 (_zTime) and now the playhead is moving away, DON'T fire callbacks otherwise they'll seem like duplicates.\n\n    tween.ratio = ratio;\n    tween._from && (ratio = 1 - ratio);\n    tween._time = 0;\n    tween._tTime = tTime;\n    pt = tween._pt;\n\n    while (pt) {\n      pt.r(ratio, pt.d);\n      pt = pt._next;\n    }\n\n    tween._startAt && totalTime < 0 && tween._startAt.render(totalTime, true, true);\n    tween._onUpdate && !suppressEvents && _callback(tween, \"onUpdate\");\n    tTime && tween._repeat && !suppressEvents && tween.parent && _callback(tween, \"onRepeat\");\n\n    if ((totalTime >= tween._tDur || totalTime < 0) && tween.ratio === ratio) {\n      ratio && _removeFromParent(tween, 1);\n\n      if (!suppressEvents) {\n        _callback(tween, ratio ? \"onComplete\" : \"onReverseComplete\", true);\n\n        tween._prom && tween._prom();\n      }\n    }\n  } else if (!tween._zTime) {\n    tween._zTime = totalTime;\n  }\n},\n    _findNextPauseTween = function _findNextPauseTween(animation, prevTime, time) {\n  var child;\n\n  if (time > prevTime) {\n    child = animation._first;\n\n    while (child && child._start <= time) {\n      if (child.data === \"isPause\" && child._start > prevTime) {\n        return child;\n      }\n\n      child = child._next;\n    }\n  } else {\n    child = animation._last;\n\n    while (child && child._start >= time) {\n      if (child.data === \"isPause\" && child._start < prevTime) {\n        return child;\n      }\n\n      child = child._prev;\n    }\n  }\n},\n    _setDuration = function _setDuration(animation, duration, skipUncache, leavePlayhead) {\n  var repeat = animation._repeat,\n      dur = _roundPrecise(duration) || 0,\n      totalProgress = animation._tTime / animation._tDur;\n  totalProgress && !leavePlayhead && (animation._time *= dur / animation._dur);\n  animation._dur = dur;\n  animation._tDur = !repeat ? dur : repeat < 0 ? 1e10 : _roundPrecise(dur * (repeat + 1) + animation._rDelay * repeat);\n  totalProgress > 0 && !leavePlayhead ? _alignPlayhead(animation, animation._tTime = animation._tDur * totalProgress) : animation.parent && _setEnd(animation);\n  skipUncache || _uncache(animation.parent, animation);\n  return animation;\n},\n    _onUpdateTotalDuration = function _onUpdateTotalDuration(animation) {\n  return animation instanceof Timeline ? _uncache(animation) : _setDuration(animation, animation._dur);\n},\n    _zeroPosition = {\n  _start: 0,\n  endTime: _emptyFunc,\n  totalDuration: _emptyFunc\n},\n    _parsePosition = function _parsePosition(animation, position, percentAnimation) {\n  var labels = animation.labels,\n      recent = animation._recent || _zeroPosition,\n      clippedDuration = animation.duration() >= _bigNum ? recent.endTime(false) : animation._dur,\n      //in case there's a child that infinitely repeats, users almost never intend for the insertion point of a new child to be based on a SUPER long value like that so we clip it and assume the most recently-added child's endTime should be used instead.\n  i,\n      offset,\n      isPercent;\n\n  if (_isString(position) && (isNaN(position) || position in labels)) {\n    //if the string is a number like \"1\", check to see if there's a label with that name, otherwise interpret it as a number (absolute value).\n    offset = position.charAt(0);\n    isPercent = position.substr(-1) === \"%\";\n    i = position.indexOf(\"=\");\n\n    if (offset === \"<\" || offset === \">\") {\n      i >= 0 && (position = position.replace(/=/, \"\"));\n      return (offset === \"<\" ? recent._start : recent.endTime(recent._repeat >= 0)) + (parseFloat(position.substr(1)) || 0) * (isPercent ? (i < 0 ? recent : percentAnimation).totalDuration() / 100 : 1);\n    }\n\n    if (i < 0) {\n      position in labels || (labels[position] = clippedDuration);\n      return labels[position];\n    }\n\n    offset = parseFloat(position.charAt(i - 1) + position.substr(i + 1));\n\n    if (isPercent && percentAnimation) {\n      offset = offset / 100 * (_isArray(percentAnimation) ? percentAnimation[0] : percentAnimation).totalDuration();\n    }\n\n    return i > 1 ? _parsePosition(animation, position.substr(0, i - 1), percentAnimation) + offset : clippedDuration + offset;\n  }\n\n  return position == null ? clippedDuration : +position;\n},\n    _createTweenType = function _createTweenType(type, params, timeline) {\n  var isLegacy = _isNumber(params[1]),\n      varsIndex = (isLegacy ? 2 : 1) + (type < 2 ? 0 : 1),\n      vars = params[varsIndex],\n      irVars,\n      parent;\n\n  isLegacy && (vars.duration = params[1]);\n  vars.parent = timeline;\n\n  if (type) {\n    irVars = vars;\n    parent = timeline;\n\n    while (parent && !(\"immediateRender\" in irVars)) {\n      // inheritance hasn't happened yet, but someone may have set a default in an ancestor timeline. We could do vars.immediateRender = _isNotFalse(_inheritDefaults(vars).immediateRender) but that'd exact a slight performance penalty because _inheritDefaults() also runs in the Tween constructor. We're paying a small kb price here to gain speed.\n      irVars = parent.vars.defaults || {};\n      parent = _isNotFalse(parent.vars.inherit) && parent.parent;\n    }\n\n    vars.immediateRender = _isNotFalse(irVars.immediateRender);\n    type < 2 ? vars.runBackwards = 1 : vars.startAt = params[varsIndex - 1]; // \"from\" vars\n  }\n\n  return new Tween(params[0], vars, params[varsIndex + 1]);\n},\n    _conditionalReturn = function _conditionalReturn(value, func) {\n  return value || value === 0 ? func(value) : func;\n},\n    _clamp = function _clamp(min, max, value) {\n  return value < min ? min : value > max ? max : value;\n},\n    getUnit = function getUnit(value, v) {\n  return !_isString(value) || !(v = _unitExp.exec(value)) ? \"\" : value.substr(v.index + v[0].length);\n},\n    // note: protect against padded numbers as strings, like \"100.100\". That shouldn't return \"00\" as the unit. If it's numeric, return no unit.\nclamp = function clamp(min, max, value) {\n  return _conditionalReturn(value, function (v) {\n    return _clamp(min, max, v);\n  });\n},\n    _slice = [].slice,\n    _isArrayLike = function _isArrayLike(value, nonEmpty) {\n  return value && _isObject(value) && \"length\" in value && (!nonEmpty && !value.length || value.length - 1 in value && _isObject(value[0])) && !value.nodeType && value !== _win;\n},\n    _flatten = function _flatten(ar, leaveStrings, accumulator) {\n  if (accumulator === void 0) {\n    accumulator = [];\n  }\n\n  return ar.forEach(function (value) {\n    var _accumulator;\n\n    return _isString(value) && !leaveStrings || _isArrayLike(value, 1) ? (_accumulator = accumulator).push.apply(_accumulator, toArray(value)) : accumulator.push(value);\n  }) || accumulator;\n},\n    //takes any value and returns an array. If it's a string (and leaveStrings isn't true), it'll use document.querySelectorAll() and convert that to an array. It'll also accept iterables like jQuery objects.\ntoArray = function toArray(value, scope, leaveStrings) {\n  return _isString(value) && !leaveStrings && (_coreInitted || !_wake()) ? _slice.call((scope || _doc).querySelectorAll(value), 0) : _isArray(value) ? _flatten(value, leaveStrings) : _isArrayLike(value) ? _slice.call(value, 0) : value ? [value] : [];\n},\n    selector = function selector(value) {\n  value = toArray(value)[0] || _warn(\"Invalid scope\") || {};\n  return function (v) {\n    var el = value.current || value.nativeElement || value;\n    return toArray(v, el.querySelectorAll ? el : el === value ? _warn(\"Invalid scope\") || _doc.createElement(\"div\") : value);\n  };\n},\n    shuffle = function shuffle(a) {\n  return a.sort(function () {\n    return .5 - Math.random();\n  });\n},\n    // alternative that's a bit faster and more reliably diverse but bigger:   for (let j, v, i = a.length; i; j = Math.floor(Math.random() * i), v = a[--i], a[i] = a[j], a[j] = v); return a;\n//for distributing values across an array. Can accept a number, a function or (most commonly) a function which can contain the following properties: {base, amount, from, ease, grid, axis, length, each}. Returns a function that expects the following parameters: index, target, array. Recognizes the following\ndistribute = function distribute(v) {\n  if (_isFunction(v)) {\n    return v;\n  }\n\n  var vars = _isObject(v) ? v : {\n    each: v\n  },\n      //n:1 is just to indicate v was a number; we leverage that later to set v according to the length we get. If a number is passed in, we treat it like the old stagger value where 0.1, for example, would mean that things would be distributed with 0.1 between each element in the array rather than a total \"amount\" that's chunked out among them all.\n  ease = _parseEase(vars.ease),\n      from = vars.from || 0,\n      base = parseFloat(vars.base) || 0,\n      cache = {},\n      isDecimal = from > 0 && from < 1,\n      ratios = isNaN(from) || isDecimal,\n      axis = vars.axis,\n      ratioX = from,\n      ratioY = from;\n\n  if (_isString(from)) {\n    ratioX = ratioY = {\n      center: .5,\n      edges: .5,\n      end: 1\n    }[from] || 0;\n  } else if (!isDecimal && ratios) {\n    ratioX = from[0];\n    ratioY = from[1];\n  }\n\n  return function (i, target, a) {\n    var l = (a || vars).length,\n        distances = cache[l],\n        originX,\n        originY,\n        x,\n        y,\n        d,\n        j,\n        max,\n        min,\n        wrapAt;\n\n    if (!distances) {\n      wrapAt = vars.grid === \"auto\" ? 0 : (vars.grid || [1, _bigNum])[1];\n\n      if (!wrapAt) {\n        max = -_bigNum;\n\n        while (max < (max = a[wrapAt++].getBoundingClientRect().left) && wrapAt < l) {}\n\n        wrapAt--;\n      }\n\n      distances = cache[l] = [];\n      originX = ratios ? Math.min(wrapAt, l) * ratioX - .5 : from % wrapAt;\n      originY = wrapAt === _bigNum ? 0 : ratios ? l * ratioY / wrapAt - .5 : from / wrapAt | 0;\n      max = 0;\n      min = _bigNum;\n\n      for (j = 0; j < l; j++) {\n        x = j % wrapAt - originX;\n        y = originY - (j / wrapAt | 0);\n        distances[j] = d = !axis ? _sqrt(x * x + y * y) : Math.abs(axis === \"y\" ? y : x);\n        d > max && (max = d);\n        d < min && (min = d);\n      }\n\n      from === \"random\" && shuffle(distances);\n      distances.max = max - min;\n      distances.min = min;\n      distances.v = l = (parseFloat(vars.amount) || parseFloat(vars.each) * (wrapAt > l ? l - 1 : !axis ? Math.max(wrapAt, l / wrapAt) : axis === \"y\" ? l / wrapAt : wrapAt) || 0) * (from === \"edges\" ? -1 : 1);\n      distances.b = l < 0 ? base - l : base;\n      distances.u = getUnit(vars.amount || vars.each) || 0; //unit\n\n      ease = ease && l < 0 ? _invertEase(ease) : ease;\n    }\n\n    l = (distances[i] - distances.min) / distances.max || 0;\n    return _roundPrecise(distances.b + (ease ? ease(l) : l) * distances.v) + distances.u; //round in order to work around floating point errors\n  };\n},\n    _roundModifier = function _roundModifier(v) {\n  //pass in 0.1 get a function that'll round to the nearest tenth, or 5 to round to the closest 5, or 0.001 to the closest 1000th, etc.\n  var p = Math.pow(10, ((v + \"\").split(\".\")[1] || \"\").length); //to avoid floating point math errors (like 24 * 0.1 == 2.4000000000000004), we chop off at a specific number of decimal places (much faster than toFixed())\n\n  return function (raw) {\n    var n = Math.round(parseFloat(raw) / v) * v * p;\n    return (n - n % 1) / p + (_isNumber(raw) ? 0 : getUnit(raw)); // n - n % 1 replaces Math.floor() in order to handle negative values properly. For example, Math.floor(-150.00000000000003) is 151!\n  };\n},\n    snap = function snap(snapTo, value) {\n  var isArray = _isArray(snapTo),\n      radius,\n      is2D;\n\n  if (!isArray && _isObject(snapTo)) {\n    radius = isArray = snapTo.radius || _bigNum;\n\n    if (snapTo.values) {\n      snapTo = toArray(snapTo.values);\n\n      if (is2D = !_isNumber(snapTo[0])) {\n        radius *= radius; //performance optimization so we don't have to Math.sqrt() in the loop.\n      }\n    } else {\n      snapTo = _roundModifier(snapTo.increment);\n    }\n  }\n\n  return _conditionalReturn(value, !isArray ? _roundModifier(snapTo) : _isFunction(snapTo) ? function (raw) {\n    is2D = snapTo(raw);\n    return Math.abs(is2D - raw) <= radius ? is2D : raw;\n  } : function (raw) {\n    var x = parseFloat(is2D ? raw.x : raw),\n        y = parseFloat(is2D ? raw.y : 0),\n        min = _bigNum,\n        closest = 0,\n        i = snapTo.length,\n        dx,\n        dy;\n\n    while (i--) {\n      if (is2D) {\n        dx = snapTo[i].x - x;\n        dy = snapTo[i].y - y;\n        dx = dx * dx + dy * dy;\n      } else {\n        dx = Math.abs(snapTo[i] - x);\n      }\n\n      if (dx < min) {\n        min = dx;\n        closest = i;\n      }\n    }\n\n    closest = !radius || min <= radius ? snapTo[closest] : raw;\n    return is2D || closest === raw || _isNumber(raw) ? closest : closest + getUnit(raw);\n  });\n},\n    random = function random(min, max, roundingIncrement, returnFunction) {\n  return _conditionalReturn(_isArray(min) ? !max : roundingIncrement === true ? !!(roundingIncrement = 0) : !returnFunction, function () {\n    return _isArray(min) ? min[~~(Math.random() * min.length)] : (roundingIncrement = roundingIncrement || 1e-5) && (returnFunction = roundingIncrement < 1 ? Math.pow(10, (roundingIncrement + \"\").length - 2) : 1) && Math.floor(Math.round((min - roundingIncrement / 2 + Math.random() * (max - min + roundingIncrement * .99)) / roundingIncrement) * roundingIncrement * returnFunction) / returnFunction;\n  });\n},\n    pipe = function pipe() {\n  for (var _len = arguments.length, functions = new Array(_len), _key = 0; _key < _len; _key++) {\n    functions[_key] = arguments[_key];\n  }\n\n  return function (value) {\n    return functions.reduce(function (v, f) {\n      return f(v);\n    }, value);\n  };\n},\n    unitize = function unitize(func, unit) {\n  return function (value) {\n    return func(parseFloat(value)) + (unit || getUnit(value));\n  };\n},\n    normalize = function normalize(min, max, value) {\n  return mapRange(min, max, 0, 1, value);\n},\n    _wrapArray = function _wrapArray(a, wrapper, value) {\n  return _conditionalReturn(value, function (index) {\n    return a[~~wrapper(index)];\n  });\n},\n    wrap = function wrap(min, max, value) {\n  // NOTE: wrap() CANNOT be an arrow function! A very odd compiling bug causes problems (unrelated to GSAP).\n  var range = max - min;\n  return _isArray(min) ? _wrapArray(min, wrap(0, min.length), max) : _conditionalReturn(value, function (value) {\n    return (range + (value - min) % range) % range + min;\n  });\n},\n    wrapYoyo = function wrapYoyo(min, max, value) {\n  var range = max - min,\n      total = range * 2;\n  return _isArray(min) ? _wrapArray(min, wrapYoyo(0, min.length - 1), max) : _conditionalReturn(value, function (value) {\n    value = (total + (value - min) % total) % total || 0;\n    return min + (value > range ? total - value : value);\n  });\n},\n    _replaceRandom = function _replaceRandom(value) {\n  //replaces all occurrences of random(...) in a string with the calculated random value. can be a range like random(-100, 100, 5) or an array like random([0, 100, 500])\n  var prev = 0,\n      s = \"\",\n      i,\n      nums,\n      end,\n      isArray;\n\n  while (~(i = value.indexOf(\"random(\", prev))) {\n    end = value.indexOf(\")\", i);\n    isArray = value.charAt(i + 7) === \"[\";\n    nums = value.substr(i + 7, end - i - 7).match(isArray ? _delimitedValueExp : _strictNumExp);\n    s += value.substr(prev, i - prev) + random(isArray ? nums : +nums[0], isArray ? 0 : +nums[1], +nums[2] || 1e-5);\n    prev = end + 1;\n  }\n\n  return s + value.substr(prev, value.length - prev);\n},\n    mapRange = function mapRange(inMin, inMax, outMin, outMax, value) {\n  var inRange = inMax - inMin,\n      outRange = outMax - outMin;\n  return _conditionalReturn(value, function (value) {\n    return outMin + ((value - inMin) / inRange * outRange || 0);\n  });\n},\n    interpolate = function interpolate(start, end, progress, mutate) {\n  var func = isNaN(start + end) ? 0 : function (p) {\n    return (1 - p) * start + p * end;\n  };\n\n  if (!func) {\n    var isString = _isString(start),\n        master = {},\n        p,\n        i,\n        interpolators,\n        l,\n        il;\n\n    progress === true && (mutate = 1) && (progress = null);\n\n    if (isString) {\n      start = {\n        p: start\n      };\n      end = {\n        p: end\n      };\n    } else if (_isArray(start) && !_isArray(end)) {\n      interpolators = [];\n      l = start.length;\n      il = l - 2;\n\n      for (i = 1; i < l; i++) {\n        interpolators.push(interpolate(start[i - 1], start[i])); //build the interpolators up front as a performance optimization so that when the function is called many times, it can just reuse them.\n      }\n\n      l--;\n\n      func = function func(p) {\n        p *= l;\n        var i = Math.min(il, ~~p);\n        return interpolators[i](p - i);\n      };\n\n      progress = end;\n    } else if (!mutate) {\n      start = _merge(_isArray(start) ? [] : {}, start);\n    }\n\n    if (!interpolators) {\n      for (p in end) {\n        _addPropTween.call(master, start, p, \"get\", end[p]);\n      }\n\n      func = function func(p) {\n        return _renderPropTweens(p, master) || (isString ? start.p : start);\n      };\n    }\n  }\n\n  return _conditionalReturn(progress, func);\n},\n    _getLabelInDirection = function _getLabelInDirection(timeline, fromTime, backward) {\n  //used for nextLabel() and previousLabel()\n  var labels = timeline.labels,\n      min = _bigNum,\n      p,\n      distance,\n      label;\n\n  for (p in labels) {\n    distance = labels[p] - fromTime;\n\n    if (distance < 0 === !!backward && distance && min > (distance = Math.abs(distance))) {\n      label = p;\n      min = distance;\n    }\n  }\n\n  return label;\n},\n    _callback = function _callback(animation, type, executeLazyFirst) {\n  var v = animation.vars,\n      callback = v[type],\n      params,\n      scope;\n\n  if (!callback) {\n    return;\n  }\n\n  params = v[type + \"Params\"];\n  scope = v.callbackScope || animation;\n  executeLazyFirst && _lazyTweens.length && _lazyRender(); //in case rendering caused any tweens to lazy-init, we should render them because typically when a timeline finishes, users expect things to have rendered fully. Imagine an onUpdate on a timeline that reports/checks tweened values.\n\n  return params ? callback.apply(scope, params) : callback.call(scope);\n},\n    _interrupt = function _interrupt(animation) {\n  _removeFromParent(animation);\n\n  animation.scrollTrigger && animation.scrollTrigger.kill(false);\n  animation.progress() < 1 && _callback(animation, \"onInterrupt\");\n  return animation;\n},\n    _quickTween,\n    _createPlugin = function _createPlugin(config) {\n  config = !config.name && config[\"default\"] || config; //UMD packaging wraps things oddly, so for example MotionPathHelper becomes {MotionPathHelper:MotionPathHelper, default:MotionPathHelper}.\n\n  var name = config.name,\n      isFunc = _isFunction(config),\n      Plugin = name && !isFunc && config.init ? function () {\n    this._props = [];\n  } : config,\n      //in case someone passes in an object that's not a plugin, like CustomEase\n  instanceDefaults = {\n    init: _emptyFunc,\n    render: _renderPropTweens,\n    add: _addPropTween,\n    kill: _killPropTweensOf,\n    modifier: _addPluginModifier,\n    rawVars: 0\n  },\n      statics = {\n    targetTest: 0,\n    get: 0,\n    getSetter: _getSetter,\n    aliases: {},\n    register: 0\n  };\n\n  _wake();\n\n  if (config !== Plugin) {\n    if (_plugins[name]) {\n      return;\n    }\n\n    _setDefaults(Plugin, _setDefaults(_copyExcluding(config, instanceDefaults), statics)); //static methods\n\n\n    _merge(Plugin.prototype, _merge(instanceDefaults, _copyExcluding(config, statics))); //instance methods\n\n\n    _plugins[Plugin.prop = name] = Plugin;\n\n    if (config.targetTest) {\n      _harnessPlugins.push(Plugin);\n\n      _reservedProps[name] = 1;\n    }\n\n    name = (name === \"css\" ? \"CSS\" : name.charAt(0).toUpperCase() + name.substr(1)) + \"Plugin\"; //for the global name. \"motionPath\" should become MotionPathPlugin\n  }\n\n  _addGlobal(name, Plugin);\n\n  config.register && config.register(gsap, Plugin, PropTween);\n},\n\n/*\n * --------------------------------------------------------------------------------------\n * COLORS\n * --------------------------------------------------------------------------------------\n */\n_255 = 255,\n    _colorLookup = {\n  aqua: [0, _255, _255],\n  lime: [0, _255, 0],\n  silver: [192, 192, 192],\n  black: [0, 0, 0],\n  maroon: [128, 0, 0],\n  teal: [0, 128, 128],\n  blue: [0, 0, _255],\n  navy: [0, 0, 128],\n  white: [_255, _255, _255],\n  olive: [128, 128, 0],\n  yellow: [_255, _255, 0],\n  orange: [_255, 165, 0],\n  gray: [128, 128, 128],\n  purple: [128, 0, 128],\n  green: [0, 128, 0],\n  red: [_255, 0, 0],\n  pink: [_255, 192, 203],\n  cyan: [0, _255, _255],\n  transparent: [_255, _255, _255, 0]\n},\n    // possible future idea to replace the hard-coded color name values - put this in the ticker.wake() where we set the _doc:\n// let ctx = _doc.createElement(\"canvas\").getContext(\"2d\");\n// _forEachName(\"aqua,lime,silver,black,maroon,teal,blue,navy,white,olive,yellow,orange,gray,purple,green,red,pink,cyan\", color => {ctx.fillStyle = color; _colorLookup[color] = splitColor(ctx.fillStyle)});\n_hue = function _hue(h, m1, m2) {\n  h += h < 0 ? 1 : h > 1 ? -1 : 0;\n  return (h * 6 < 1 ? m1 + (m2 - m1) * h * 6 : h < .5 ? m2 : h * 3 < 2 ? m1 + (m2 - m1) * (2 / 3 - h) * 6 : m1) * _255 + .5 | 0;\n},\n    splitColor = function splitColor(v, toHSL, forceAlpha) {\n  var a = !v ? _colorLookup.black : _isNumber(v) ? [v >> 16, v >> 8 & _255, v & _255] : 0,\n      r,\n      g,\n      b,\n      h,\n      s,\n      l,\n      max,\n      min,\n      d,\n      wasHSL;\n\n  if (!a) {\n    if (v.substr(-1) === \",\") {\n      //sometimes a trailing comma is included and we should chop it off (typically from a comma-delimited list of values like a textShadow:\"2px 2px 2px blue, 5px 5px 5px rgb(255,0,0)\" - in this example \"blue,\" has a trailing comma. We could strip it out inside parseComplex() but we'd need to do it to the beginning and ending values plus it wouldn't provide protection from other potential scenarios like if the user passes in a similar value.\n      v = v.substr(0, v.length - 1);\n    }\n\n    if (_colorLookup[v]) {\n      a = _colorLookup[v];\n    } else if (v.charAt(0) === \"#\") {\n      if (v.length < 6) {\n        //for shorthand like #9F0 or #9F0F (could have alpha)\n        r = v.charAt(1);\n        g = v.charAt(2);\n        b = v.charAt(3);\n        v = \"#\" + r + r + g + g + b + b + (v.length === 5 ? v.charAt(4) + v.charAt(4) : \"\");\n      }\n\n      if (v.length === 9) {\n        // hex with alpha, like #fd5e53ff\n        a = parseInt(v.substr(1, 6), 16);\n        return [a >> 16, a >> 8 & _255, a & _255, parseInt(v.substr(7), 16) / 255];\n      }\n\n      v = parseInt(v.substr(1), 16);\n      a = [v >> 16, v >> 8 & _255, v & _255];\n    } else if (v.substr(0, 3) === \"hsl\") {\n      a = wasHSL = v.match(_strictNumExp);\n\n      if (!toHSL) {\n        h = +a[0] % 360 / 360;\n        s = +a[1] / 100;\n        l = +a[2] / 100;\n        g = l <= .5 ? l * (s + 1) : l + s - l * s;\n        r = l * 2 - g;\n        a.length > 3 && (a[3] *= 1); //cast as number\n\n        a[0] = _hue(h + 1 / 3, r, g);\n        a[1] = _hue(h, r, g);\n        a[2] = _hue(h - 1 / 3, r, g);\n      } else if (~v.indexOf(\"=\")) {\n        //if relative values are found, just return the raw strings with the relative prefixes in place.\n        a = v.match(_numExp);\n        forceAlpha && a.length < 4 && (a[3] = 1);\n        return a;\n      }\n    } else {\n      a = v.match(_strictNumExp) || _colorLookup.transparent;\n    }\n\n    a = a.map(Number);\n  }\n\n  if (toHSL && !wasHSL) {\n    r = a[0] / _255;\n    g = a[1] / _255;\n    b = a[2] / _255;\n    max = Math.max(r, g, b);\n    min = Math.min(r, g, b);\n    l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0;\n    } else {\n      d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n      h = max === r ? (g - b) / d + (g < b ? 6 : 0) : max === g ? (b - r) / d + 2 : (r - g) / d + 4;\n      h *= 60;\n    }\n\n    a[0] = ~~(h + .5);\n    a[1] = ~~(s * 100 + .5);\n    a[2] = ~~(l * 100 + .5);\n  }\n\n  forceAlpha && a.length < 4 && (a[3] = 1);\n  return a;\n},\n    _colorOrderData = function _colorOrderData(v) {\n  // strips out the colors from the string, finds all the numeric slots (with units) and returns an array of those. The Array also has a \"c\" property which is an Array of the index values where the colors belong. This is to help work around issues where there's a mis-matched order of color/numeric data like drop-shadow(#f00 0px 1px 2px) and drop-shadow(0x 1px 2px #f00). This is basically a helper function used in _formatColors()\n  var values = [],\n      c = [],\n      i = -1;\n  v.split(_colorExp).forEach(function (v) {\n    var a = v.match(_numWithUnitExp) || [];\n    values.push.apply(values, a);\n    c.push(i += a.length + 1);\n  });\n  values.c = c;\n  return values;\n},\n    _formatColors = function _formatColors(s, toHSL, orderMatchData) {\n  var result = \"\",\n      colors = (s + result).match(_colorExp),\n      type = toHSL ? \"hsla(\" : \"rgba(\",\n      i = 0,\n      c,\n      shell,\n      d,\n      l;\n\n  if (!colors) {\n    return s;\n  }\n\n  colors = colors.map(function (color) {\n    return (color = splitColor(color, toHSL, 1)) && type + (toHSL ? color[0] + \",\" + color[1] + \"%,\" + color[2] + \"%,\" + color[3] : color.join(\",\")) + \")\";\n  });\n\n  if (orderMatchData) {\n    d = _colorOrderData(s);\n    c = orderMatchData.c;\n\n    if (c.join(result) !== d.c.join(result)) {\n      shell = s.replace(_colorExp, \"1\").split(_numWithUnitExp);\n      l = shell.length - 1;\n\n      for (; i < l; i++) {\n        result += shell[i] + (~c.indexOf(i) ? colors.shift() || type + \"0,0,0,0)\" : (d.length ? d : colors.length ? colors : orderMatchData).shift());\n      }\n    }\n  }\n\n  if (!shell) {\n    shell = s.split(_colorExp);\n    l = shell.length - 1;\n\n    for (; i < l; i++) {\n      result += shell[i] + colors[i];\n    }\n  }\n\n  return result + shell[l];\n},\n    _colorExp = function () {\n  var s = \"(?:\\\\b(?:(?:rgb|rgba|hsl|hsla)\\\\(.+?\\\\))|\\\\B#(?:[0-9a-f]{3,4}){1,2}\\\\b\",\n      //we'll dynamically build this Regular Expression to conserve file size. After building it, it will be able to find rgb(), rgba(), # (hexadecimal), and named color values like red, blue, purple, etc.,\n  p;\n\n  for (p in _colorLookup) {\n    s += \"|\" + p + \"\\\\b\";\n  }\n\n  return new RegExp(s + \")\", \"gi\");\n}(),\n    _hslExp = /hsl[a]?\\(/,\n    _colorStringFilter = function _colorStringFilter(a) {\n  var combined = a.join(\" \"),\n      toHSL;\n  _colorExp.lastIndex = 0;\n\n  if (_colorExp.test(combined)) {\n    toHSL = _hslExp.test(combined);\n    a[1] = _formatColors(a[1], toHSL);\n    a[0] = _formatColors(a[0], toHSL, _colorOrderData(a[1])); // make sure the order of numbers/colors match with the END value.\n\n    return true;\n  }\n},\n\n/*\n * --------------------------------------------------------------------------------------\n * TICKER\n * --------------------------------------------------------------------------------------\n */\n_tickerActive,\n    _ticker = function () {\n  var _getTime = Date.now,\n      _lagThreshold = 500,\n      _adjustedLag = 33,\n      _startTime = _getTime(),\n      _lastUpdate = _startTime,\n      _gap = 1000 / 240,\n      _nextTime = _gap,\n      _listeners = [],\n      _id,\n      _req,\n      _raf,\n      _self,\n      _delta,\n      _i,\n      _tick = function _tick(v) {\n    var elapsed = _getTime() - _lastUpdate,\n        manual = v === true,\n        overlap,\n        dispatch,\n        time,\n        frame;\n\n    elapsed > _lagThreshold && (_startTime += elapsed - _adjustedLag);\n    _lastUpdate += elapsed;\n    time = _lastUpdate - _startTime;\n    overlap = time - _nextTime;\n\n    if (overlap > 0 || manual) {\n      frame = ++_self.frame;\n      _delta = time - _self.time * 1000;\n      _self.time = time = time / 1000;\n      _nextTime += overlap + (overlap >= _gap ? 4 : _gap - overlap);\n      dispatch = 1;\n    }\n\n    manual || (_id = _req(_tick)); //make sure the request is made before we dispatch the \"tick\" event so that timing is maintained. Otherwise, if processing the \"tick\" requires a bunch of time (like 15ms) and we're using a setTimeout() that's based on 16.7ms, it'd technically take 31.7ms between frames otherwise.\n\n    if (dispatch) {\n      for (_i = 0; _i < _listeners.length; _i++) {\n        // use _i and check _listeners.length instead of a variable because a listener could get removed during the loop, and if that happens to an element less than the current index, it'd throw things off in the loop.\n        _listeners[_i](time, _delta, frame, v);\n      }\n    }\n  };\n\n  _self = {\n    time: 0,\n    frame: 0,\n    tick: function tick() {\n      _tick(true);\n    },\n    deltaRatio: function deltaRatio(fps) {\n      return _delta / (1000 / (fps || 60));\n    },\n    wake: function wake() {\n      if (_coreReady) {\n        if (!_coreInitted && _windowExists()) {\n          _win = _coreInitted = window;\n          _doc = _win.document || {};\n          _globals.gsap = gsap;\n          (_win.gsapVersions || (_win.gsapVersions = [])).push(gsap.version);\n\n          _install(_installScope || _win.GreenSockGlobals || !_win.gsap && _win || {});\n\n          _raf = _win.requestAnimationFrame;\n        }\n\n        _id && _self.sleep();\n\n        _req = _raf || function (f) {\n          return setTimeout(f, _nextTime - _self.time * 1000 + 1 | 0);\n        };\n\n        _tickerActive = 1;\n\n        _tick(2);\n      }\n    },\n    sleep: function sleep() {\n      (_raf ? _win.cancelAnimationFrame : clearTimeout)(_id);\n      _tickerActive = 0;\n      _req = _emptyFunc;\n    },\n    lagSmoothing: function lagSmoothing(threshold, adjustedLag) {\n      _lagThreshold = threshold || 1 / _tinyNum; //zero should be interpreted as basically unlimited\n\n      _adjustedLag = Math.min(adjustedLag, _lagThreshold, 0);\n    },\n    fps: function fps(_fps) {\n      _gap = 1000 / (_fps || 240);\n      _nextTime = _self.time * 1000 + _gap;\n    },\n    add: function add(callback) {\n      _listeners.indexOf(callback) < 0 && _listeners.push(callback);\n\n      _wake();\n    },\n    remove: function remove(callback, i) {\n      ~(i = _listeners.indexOf(callback)) && _listeners.splice(i, 1) && _i >= i && _i--;\n    },\n    _listeners: _listeners\n  };\n  return _self;\n}(),\n    _wake = function _wake() {\n  return !_tickerActive && _ticker.wake();\n},\n    //also ensures the core classes are initialized.\n\n/*\n* -------------------------------------------------\n* EASING\n* -------------------------------------------------\n*/\n_easeMap = {},\n    _customEaseExp = /^[\\d.\\-M][\\d.\\-,\\s]/,\n    _quotesExp = /[\"']/g,\n    _parseObjectInString = function _parseObjectInString(value) {\n  //takes a string like \"{wiggles:10, type:anticipate})\" and turns it into a real object. Notice it ends in \")\" and includes the {} wrappers. This is because we only use this function for parsing ease configs and prioritized optimization rather than reusability.\n  var obj = {},\n      split = value.substr(1, value.length - 3).split(\":\"),\n      key = split[0],\n      i = 1,\n      l = split.length,\n      index,\n      val,\n      parsedVal;\n\n  for (; i < l; i++) {\n    val = split[i];\n    index = i !== l - 1 ? val.lastIndexOf(\",\") : val.length;\n    parsedVal = val.substr(0, index);\n    obj[key] = isNaN(parsedVal) ? parsedVal.replace(_quotesExp, \"\").trim() : +parsedVal;\n    key = val.substr(index + 1).trim();\n  }\n\n  return obj;\n},\n    _valueInParentheses = function _valueInParentheses(value) {\n  var open = value.indexOf(\"(\") + 1,\n      close = value.indexOf(\")\"),\n      nested = value.indexOf(\"(\", open);\n  return value.substring(open, ~nested && nested < close ? value.indexOf(\")\", close + 1) : close);\n},\n    _configEaseFromString = function _configEaseFromString(name) {\n  //name can be a string like \"elastic.out(1,0.5)\", and pass in _easeMap as obj and it'll parse it out and call the actual function like _easeMap.Elastic.easeOut.config(1,0.5). It will also parse custom ease strings as long as CustomEase is loaded and registered (internally as _easeMap._CE).\n  var split = (name + \"\").split(\"(\"),\n      ease = _easeMap[split[0]];\n  return ease && split.length > 1 && ease.config ? ease.config.apply(null, ~name.indexOf(\"{\") ? [_parseObjectInString(split[1])] : _valueInParentheses(name).split(\",\").map(_numericIfPossible)) : _easeMap._CE && _customEaseExp.test(name) ? _easeMap._CE(\"\", name) : ease;\n},\n    _invertEase = function _invertEase(ease) {\n  return function (p) {\n    return 1 - ease(1 - p);\n  };\n},\n    // allow yoyoEase to be set in children and have those affected when the parent/ancestor timeline yoyos.\n_propagateYoyoEase = function _propagateYoyoEase(timeline, isYoyo) {\n  var child = timeline._first,\n      ease;\n\n  while (child) {\n    if (child instanceof Timeline) {\n      _propagateYoyoEase(child, isYoyo);\n    } else if (child.vars.yoyoEase && (!child._yoyo || !child._repeat) && child._yoyo !== isYoyo) {\n      if (child.timeline) {\n        _propagateYoyoEase(child.timeline, isYoyo);\n      } else {\n        ease = child._ease;\n        child._ease = child._yEase;\n        child._yEase = ease;\n        child._yoyo = isYoyo;\n      }\n    }\n\n    child = child._next;\n  }\n},\n    _parseEase = function _parseEase(ease, defaultEase) {\n  return !ease ? defaultEase : (_isFunction(ease) ? ease : _easeMap[ease] || _configEaseFromString(ease)) || defaultEase;\n},\n    _insertEase = function _insertEase(names, easeIn, easeOut, easeInOut) {\n  if (easeOut === void 0) {\n    easeOut = function easeOut(p) {\n      return 1 - easeIn(1 - p);\n    };\n  }\n\n  if (easeInOut === void 0) {\n    easeInOut = function easeInOut(p) {\n      return p < .5 ? easeIn(p * 2) / 2 : 1 - easeIn((1 - p) * 2) / 2;\n    };\n  }\n\n  var ease = {\n    easeIn: easeIn,\n    easeOut: easeOut,\n    easeInOut: easeInOut\n  },\n      lowercaseName;\n\n  _forEachName(names, function (name) {\n    _easeMap[name] = _globals[name] = ease;\n    _easeMap[lowercaseName = name.toLowerCase()] = easeOut;\n\n    for (var p in ease) {\n      _easeMap[lowercaseName + (p === \"easeIn\" ? \".in\" : p === \"easeOut\" ? \".out\" : \".inOut\")] = _easeMap[name + \".\" + p] = ease[p];\n    }\n  });\n\n  return ease;\n},\n    _easeInOutFromOut = function _easeInOutFromOut(easeOut) {\n  return function (p) {\n    return p < .5 ? (1 - easeOut(1 - p * 2)) / 2 : .5 + easeOut((p - .5) * 2) / 2;\n  };\n},\n    _configElastic = function _configElastic(type, amplitude, period) {\n  var p1 = amplitude >= 1 ? amplitude : 1,\n      //note: if amplitude is < 1, we simply adjust the period for a more natural feel. Otherwise the math doesn't work right and the curve starts at 1.\n  p2 = (period || (type ? .3 : .45)) / (amplitude < 1 ? amplitude : 1),\n      p3 = p2 / _2PI * (Math.asin(1 / p1) || 0),\n      easeOut = function easeOut(p) {\n    return p === 1 ? 1 : p1 * Math.pow(2, -10 * p) * _sin((p - p3) * p2) + 1;\n  },\n      ease = type === \"out\" ? easeOut : type === \"in\" ? function (p) {\n    return 1 - easeOut(1 - p);\n  } : _easeInOutFromOut(easeOut);\n\n  p2 = _2PI / p2; //precalculate to optimize\n\n  ease.config = function (amplitude, period) {\n    return _configElastic(type, amplitude, period);\n  };\n\n  return ease;\n},\n    _configBack = function _configBack(type, overshoot) {\n  if (overshoot === void 0) {\n    overshoot = 1.70158;\n  }\n\n  var easeOut = function easeOut(p) {\n    return p ? --p * p * ((overshoot + 1) * p + overshoot) + 1 : 0;\n  },\n      ease = type === \"out\" ? easeOut : type === \"in\" ? function (p) {\n    return 1 - easeOut(1 - p);\n  } : _easeInOutFromOut(easeOut);\n\n  ease.config = function (overshoot) {\n    return _configBack(type, overshoot);\n  };\n\n  return ease;\n}; // a cheaper (kb and cpu) but more mild way to get a parameterized weighted ease by feeding in a value between -1 (easeIn) and 1 (easeOut) where 0 is linear.\n// _weightedEase = ratio => {\n// \tlet y = 0.5 + ratio / 2;\n// \treturn p => (2 * (1 - p) * p * y + p * p);\n// },\n// a stronger (but more expensive kb/cpu) parameterized weighted ease that lets you feed in a value between -1 (easeIn) and 1 (easeOut) where 0 is linear.\n// _weightedEaseStrong = ratio => {\n// \tratio = .5 + ratio / 2;\n// \tlet o = 1 / 3 * (ratio < .5 ? ratio : 1 - ratio),\n// \t\tb = ratio - o,\n// \t\tc = ratio + o;\n// \treturn p => p === 1 ? p : 3 * b * (1 - p) * (1 - p) * p + 3 * c * (1 - p) * p * p + p * p * p;\n// };\n\n\n_forEachName(\"Linear,Quad,Cubic,Quart,Quint,Strong\", function (name, i) {\n  var power = i < 5 ? i + 1 : i;\n\n  _insertEase(name + \",Power\" + (power - 1), i ? function (p) {\n    return Math.pow(p, power);\n  } : function (p) {\n    return p;\n  }, function (p) {\n    return 1 - Math.pow(1 - p, power);\n  }, function (p) {\n    return p < .5 ? Math.pow(p * 2, power) / 2 : 1 - Math.pow((1 - p) * 2, power) / 2;\n  });\n});\n\n_easeMap.Linear.easeNone = _easeMap.none = _easeMap.Linear.easeIn;\n\n_insertEase(\"Elastic\", _configElastic(\"in\"), _configElastic(\"out\"), _configElastic());\n\n(function (n, c) {\n  var n1 = 1 / c,\n      n2 = 2 * n1,\n      n3 = 2.5 * n1,\n      easeOut = function easeOut(p) {\n    return p < n1 ? n * p * p : p < n2 ? n * Math.pow(p - 1.5 / c, 2) + .75 : p < n3 ? n * (p -= 2.25 / c) * p + .9375 : n * Math.pow(p - 2.625 / c, 2) + .984375;\n  };\n\n  _insertEase(\"Bounce\", function (p) {\n    return 1 - easeOut(1 - p);\n  }, easeOut);\n})(7.5625, 2.75);\n\n_insertEase(\"Expo\", function (p) {\n  return p ? Math.pow(2, 10 * (p - 1)) : 0;\n});\n\n_insertEase(\"Circ\", function (p) {\n  return -(_sqrt(1 - p * p) - 1);\n});\n\n_insertEase(\"Sine\", function (p) {\n  return p === 1 ? 1 : -_cos(p * _HALF_PI) + 1;\n});\n\n_insertEase(\"Back\", _configBack(\"in\"), _configBack(\"out\"), _configBack());\n\n_easeMap.SteppedEase = _easeMap.steps = _globals.SteppedEase = {\n  config: function config(steps, immediateStart) {\n    if (steps === void 0) {\n      steps = 1;\n    }\n\n    var p1 = 1 / steps,\n        p2 = steps + (immediateStart ? 0 : 1),\n        p3 = immediateStart ? 1 : 0,\n        max = 1 - _tinyNum;\n    return function (p) {\n      return ((p2 * _clamp(0, max, p) | 0) + p3) * p1;\n    };\n  }\n};\n_defaults.ease = _easeMap[\"quad.out\"];\n\n_forEachName(\"onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt\", function (name) {\n  return _callbackNames += name + \",\" + name + \"Params,\";\n});\n/*\n * --------------------------------------------------------------------------------------\n * CACHE\n * --------------------------------------------------------------------------------------\n */\n\n\nexport var GSCache = function GSCache(target, harness) {\n  this.id = _gsID++;\n  target._gsap = this;\n  this.target = target;\n  this.harness = harness;\n  this.get = harness ? harness.get : _getProperty;\n  this.set = harness ? harness.getSetter : _getSetter;\n};\n/*\n * --------------------------------------------------------------------------------------\n * ANIMATION\n * --------------------------------------------------------------------------------------\n */\n\nexport var Animation = /*#__PURE__*/function () {\n  function Animation(vars) {\n    this.vars = vars;\n    this._delay = +vars.delay || 0;\n\n    if (this._repeat = vars.repeat === Infinity ? -2 : vars.repeat || 0) {\n      // TODO: repeat: Infinity on a timeline's children must flag that timeline internally and affect its totalDuration, otherwise it'll stop in the negative direction when reaching the start.\n      this._rDelay = vars.repeatDelay || 0;\n      this._yoyo = !!vars.yoyo || !!vars.yoyoEase;\n    }\n\n    this._ts = 1;\n\n    _setDuration(this, +vars.duration, 1, 1);\n\n    this.data = vars.data;\n    _tickerActive || _ticker.wake();\n  }\n\n  var _proto = Animation.prototype;\n\n  _proto.delay = function delay(value) {\n    if (value || value === 0) {\n      this.parent && this.parent.smoothChildTiming && this.startTime(this._start + value - this._delay);\n      this._delay = value;\n      return this;\n    }\n\n    return this._delay;\n  };\n\n  _proto.duration = function duration(value) {\n    return arguments.length ? this.totalDuration(this._repeat > 0 ? value + (value + this._rDelay) * this._repeat : value) : this.totalDuration() && this._dur;\n  };\n\n  _proto.totalDuration = function totalDuration(value) {\n    if (!arguments.length) {\n      return this._tDur;\n    }\n\n    this._dirty = 0;\n    return _setDuration(this, this._repeat < 0 ? value : (value - this._repeat * this._rDelay) / (this._repeat + 1));\n  };\n\n  _proto.totalTime = function totalTime(_totalTime, suppressEvents) {\n    _wake();\n\n    if (!arguments.length) {\n      return this._tTime;\n    }\n\n    var parent = this._dp;\n\n    if (parent && parent.smoothChildTiming && this._ts) {\n      _alignPlayhead(this, _totalTime);\n\n      !parent._dp || parent.parent || _postAddChecks(parent, this); // edge case: if this is a child of a timeline that already completed, for example, we must re-activate the parent.\n      //in case any of the ancestor timelines had completed but should now be enabled, we should reset their totalTime() which will also ensure that they're lined up properly and enabled. Skip for animations that are on the root (wasteful). Example: a TimelineLite.exportRoot() is performed when there's a paused tween on the root, the export will not complete until that tween is unpaused, but imagine a child gets restarted later, after all [unpaused] tweens have completed. The start of that child would get pushed out, but one of the ancestors may have completed.\n\n      while (parent && parent.parent) {\n        if (parent.parent._time !== parent._start + (parent._ts >= 0 ? parent._tTime / parent._ts : (parent.totalDuration() - parent._tTime) / -parent._ts)) {\n          parent.totalTime(parent._tTime, true);\n        }\n\n        parent = parent.parent;\n      }\n\n      if (!this.parent && this._dp.autoRemoveChildren && (this._ts > 0 && _totalTime < this._tDur || this._ts < 0 && _totalTime > 0 || !this._tDur && !_totalTime)) {\n        //if the animation doesn't have a parent, put it back into its last parent (recorded as _dp for exactly cases like this). Limit to parents with autoRemoveChildren (like globalTimeline) so that if the user manually removes an animation from a timeline and then alters its playhead, it doesn't get added back in.\n        _addToTimeline(this._dp, this, this._start - this._delay);\n      }\n    }\n\n    if (this._tTime !== _totalTime || !this._dur && !suppressEvents || this._initted && Math.abs(this._zTime) === _tinyNum || !_totalTime && !this._initted && (this.add || this._ptLookup)) {\n      // check for _ptLookup on a Tween instance to ensure it has actually finished being instantiated, otherwise if this.reverse() gets called in the Animation constructor, it could trigger a render() here even though the _targets weren't populated, thus when _init() is called there won't be any PropTweens (it'll act like the tween is non-functional)\n      this._ts || (this._pTime = _totalTime); // otherwise, if an animation is paused, then the playhead is moved back to zero, then resumed, it'd revert back to the original time at the pause\n      //if (!this._lock) { // avoid endless recursion (not sure we need this yet or if it's worth the performance hit)\n      //   this._lock = 1;\n\n      _lazySafeRender(this, _totalTime, suppressEvents); //   this._lock = 0;\n      //}\n\n    }\n\n    return this;\n  };\n\n  _proto.time = function time(value, suppressEvents) {\n    return arguments.length ? this.totalTime(Math.min(this.totalDuration(), value + _elapsedCycleDuration(this)) % (this._dur + this._rDelay) || (value ? this._dur : 0), suppressEvents) : this._time; // note: if the modulus results in 0, the playhead could be exactly at the end or the beginning, and we always defer to the END with a non-zero value, otherwise if you set the time() to the very end (duration()), it would render at the START!\n  };\n\n  _proto.totalProgress = function totalProgress(value, suppressEvents) {\n    return arguments.length ? this.totalTime(this.totalDuration() * value, suppressEvents) : this.totalDuration() ? Math.min(1, this._tTime / this._tDur) : this.ratio;\n  };\n\n  _proto.progress = function progress(value, suppressEvents) {\n    return arguments.length ? this.totalTime(this.duration() * (this._yoyo && !(this.iteration() & 1) ? 1 - value : value) + _elapsedCycleDuration(this), suppressEvents) : this.duration() ? Math.min(1, this._time / this._dur) : this.ratio;\n  };\n\n  _proto.iteration = function iteration(value, suppressEvents) {\n    var cycleDuration = this.duration() + this._rDelay;\n\n    return arguments.length ? this.totalTime(this._time + (value - 1) * cycleDuration, suppressEvents) : this._repeat ? _animationCycle(this._tTime, cycleDuration) + 1 : 1;\n  } // potential future addition:\n  // isPlayingBackwards() {\n  // \tlet animation = this,\n  // \t\torientation = 1; // 1 = forward, -1 = backward\n  // \twhile (animation) {\n  // \t\torientation *= animation.reversed() || (animation.repeat() && !(animation.iteration() & 1)) ? -1 : 1;\n  // \t\tanimation = animation.parent;\n  // \t}\n  // \treturn orientation < 0;\n  // }\n  ;\n\n  _proto.timeScale = function timeScale(value) {\n    if (!arguments.length) {\n      return this._rts === -_tinyNum ? 0 : this._rts; // recorded timeScale. Special case: if someone calls reverse() on an animation with timeScale of 0, we assign it -_tinyNum to remember it's reversed.\n    }\n\n    if (this._rts === value) {\n      return this;\n    }\n\n    var tTime = this.parent && this._ts ? _parentToChildTotalTime(this.parent._time, this) : this._tTime; // make sure to do the parentToChildTotalTime() BEFORE setting the new _ts because the old one must be used in that calculation.\n    // future addition? Up side: fast and minimal file size. Down side: only works on this animation; if a timeline is reversed, for example, its childrens' onReverse wouldn't get called.\n    //(+value < 0 && this._rts >= 0) && _callback(this, \"onReverse\", true);\n    // prioritize rendering where the parent's playhead lines up instead of this._tTime because there could be a tween that's animating another tween's timeScale in the same rendering loop (same parent), thus if the timeScale tween renders first, it would alter _start BEFORE _tTime was set on that tick (in the rendering loop), effectively freezing it until the timeScale tween finishes.\n\n    this._rts = +value || 0;\n    this._ts = this._ps || value === -_tinyNum ? 0 : this._rts; // _ts is the functional timeScale which would be 0 if the animation is paused.\n\n    _recacheAncestors(this.totalTime(_clamp(-this._delay, this._tDur, tTime), true));\n\n    _setEnd(this); // if parent.smoothChildTiming was false, the end time didn't get updated in the _alignPlayhead() method, so do it here.\n\n\n    return this;\n  };\n\n  _proto.paused = function paused(value) {\n    if (!arguments.length) {\n      return this._ps;\n    }\n\n    if (this._ps !== value) {\n      this._ps = value;\n\n      if (value) {\n        this._pTime = this._tTime || Math.max(-this._delay, this.rawTime()); // if the pause occurs during the delay phase, make sure that's factored in when resuming.\n\n        this._ts = this._act = 0; // _ts is the functional timeScale, so a paused tween would effectively have a timeScale of 0. We record the \"real\" timeScale as _rts (recorded time scale)\n      } else {\n        _wake();\n\n        this._ts = this._rts; //only defer to _pTime (pauseTime) if tTime is zero. Remember, someone could pause() an animation, then scrub the playhead and resume(). If the parent doesn't have smoothChildTiming, we render at the rawTime() because the startTime won't get updated.\n\n        this.totalTime(this.parent && !this.parent.smoothChildTiming ? this.rawTime() : this._tTime || this._pTime, this.progress() === 1 && Math.abs(this._zTime) !== _tinyNum && (this._tTime -= _tinyNum)); // edge case: animation.progress(1).pause().play() wouldn't render again because the playhead is already at the end, but the call to totalTime() below will add it back to its parent...and not remove it again (since removing only happens upon rendering at a new time). Offsetting the _tTime slightly is done simply to cause the final render in totalTime() that'll pop it off its timeline (if autoRemoveChildren is true, of course). Check to make sure _zTime isn't -_tinyNum to avoid an edge case where the playhead is pushed to the end but INSIDE a tween/callback, the timeline itself is paused thus halting rendering and leaving a few unrendered. When resuming, it wouldn't render those otherwise.\n      }\n    }\n\n    return this;\n  };\n\n  _proto.startTime = function startTime(value) {\n    if (arguments.length) {\n      this._start = value;\n      var parent = this.parent || this._dp;\n      parent && (parent._sort || !this.parent) && _addToTimeline(parent, this, value - this._delay);\n      return this;\n    }\n\n    return this._start;\n  };\n\n  _proto.endTime = function endTime(includeRepeats) {\n    return this._start + (_isNotFalse(includeRepeats) ? this.totalDuration() : this.duration()) / Math.abs(this._ts || 1);\n  };\n\n  _proto.rawTime = function rawTime(wrapRepeats) {\n    var parent = this.parent || this._dp; // _dp = detached parent\n\n    return !parent ? this._tTime : wrapRepeats && (!this._ts || this._repeat && this._time && this.totalProgress() < 1) ? this._tTime % (this._dur + this._rDelay) : !this._ts ? this._tTime : _parentToChildTotalTime(parent.rawTime(wrapRepeats), this);\n  };\n\n  _proto.globalTime = function globalTime(rawTime) {\n    var animation = this,\n        time = arguments.length ? rawTime : animation.rawTime();\n\n    while (animation) {\n      time = animation._start + time / (animation._ts || 1);\n      animation = animation._dp;\n    }\n\n    return time;\n  };\n\n  _proto.repeat = function repeat(value) {\n    if (arguments.length) {\n      this._repeat = value === Infinity ? -2 : value;\n      return _onUpdateTotalDuration(this);\n    }\n\n    return this._repeat === -2 ? Infinity : this._repeat;\n  };\n\n  _proto.repeatDelay = function repeatDelay(value) {\n    if (arguments.length) {\n      var time = this._time;\n      this._rDelay = value;\n\n      _onUpdateTotalDuration(this);\n\n      return time ? this.time(time) : this;\n    }\n\n    return this._rDelay;\n  };\n\n  _proto.yoyo = function yoyo(value) {\n    if (arguments.length) {\n      this._yoyo = value;\n      return this;\n    }\n\n    return this._yoyo;\n  };\n\n  _proto.seek = function seek(position, suppressEvents) {\n    return this.totalTime(_parsePosition(this, position), _isNotFalse(suppressEvents));\n  };\n\n  _proto.restart = function restart(includeDelay, suppressEvents) {\n    return this.play().totalTime(includeDelay ? -this._delay : 0, _isNotFalse(suppressEvents));\n  };\n\n  _proto.play = function play(from, suppressEvents) {\n    from != null && this.seek(from, suppressEvents);\n    return this.reversed(false).paused(false);\n  };\n\n  _proto.reverse = function reverse(from, suppressEvents) {\n    from != null && this.seek(from || this.totalDuration(), suppressEvents);\n    return this.reversed(true).paused(false);\n  };\n\n  _proto.pause = function pause(atTime, suppressEvents) {\n    atTime != null && this.seek(atTime, suppressEvents);\n    return this.paused(true);\n  };\n\n  _proto.resume = function resume() {\n    return this.paused(false);\n  };\n\n  _proto.reversed = function reversed(value) {\n    if (arguments.length) {\n      !!value !== this.reversed() && this.timeScale(-this._rts || (value ? -_tinyNum : 0)); // in case timeScale is zero, reversing would have no effect so we use _tinyNum.\n\n      return this;\n    }\n\n    return this._rts < 0;\n  };\n\n  _proto.invalidate = function invalidate() {\n    this._initted = this._act = 0;\n    this._zTime = -_tinyNum;\n    return this;\n  };\n\n  _proto.isActive = function isActive() {\n    var parent = this.parent || this._dp,\n        start = this._start,\n        rawTime;\n    return !!(!parent || this._ts && this._initted && parent.isActive() && (rawTime = parent.rawTime(true)) >= start && rawTime < this.endTime(true) - _tinyNum);\n  };\n\n  _proto.eventCallback = function eventCallback(type, callback, params) {\n    var vars = this.vars;\n\n    if (arguments.length > 1) {\n      if (!callback) {\n        delete vars[type];\n      } else {\n        vars[type] = callback;\n        params && (vars[type + \"Params\"] = params);\n        type === \"onUpdate\" && (this._onUpdate = callback);\n      }\n\n      return this;\n    }\n\n    return vars[type];\n  };\n\n  _proto.then = function then(onFulfilled) {\n    var self = this;\n    return new Promise(function (resolve) {\n      var f = _isFunction(onFulfilled) ? onFulfilled : _passThrough,\n          _resolve = function _resolve() {\n        var _then = self.then;\n        self.then = null; // temporarily null the then() method to avoid an infinite loop (see https://github.com/greensock/GSAP/issues/322)\n\n        _isFunction(f) && (f = f(self)) && (f.then || f === self) && (self.then = _then);\n        resolve(f);\n        self.then = _then;\n      };\n\n      if (self._initted && self.totalProgress() === 1 && self._ts >= 0 || !self._tTime && self._ts < 0) {\n        _resolve();\n      } else {\n        self._prom = _resolve;\n      }\n    });\n  };\n\n  _proto.kill = function kill() {\n    _interrupt(this);\n  };\n\n  return Animation;\n}();\n\n_setDefaults(Animation.prototype, {\n  _time: 0,\n  _start: 0,\n  _end: 0,\n  _tTime: 0,\n  _tDur: 0,\n  _dirty: 0,\n  _repeat: 0,\n  _yoyo: false,\n  parent: null,\n  _initted: false,\n  _rDelay: 0,\n  _ts: 1,\n  _dp: 0,\n  ratio: 0,\n  _zTime: -_tinyNum,\n  _prom: 0,\n  _ps: false,\n  _rts: 1\n});\n/*\n * -------------------------------------------------\n * TIMELINE\n * -------------------------------------------------\n */\n\n\nexport var Timeline = /*#__PURE__*/function (_Animation) {\n  _inheritsLoose(Timeline, _Animation);\n\n  function Timeline(vars, position) {\n    var _this;\n\n    if (vars === void 0) {\n      vars = {};\n    }\n\n    _this = _Animation.call(this, vars) || this;\n    _this.labels = {};\n    _this.smoothChildTiming = !!vars.smoothChildTiming;\n    _this.autoRemoveChildren = !!vars.autoRemoveChildren;\n    _this._sort = _isNotFalse(vars.sortChildren);\n    _globalTimeline && _addToTimeline(vars.parent || _globalTimeline, _assertThisInitialized(_this), position);\n    vars.reversed && _this.reverse();\n    vars.paused && _this.paused(true);\n    vars.scrollTrigger && _scrollTrigger(_assertThisInitialized(_this), vars.scrollTrigger);\n    return _this;\n  }\n\n  var _proto2 = Timeline.prototype;\n\n  _proto2.to = function to(targets, vars, position) {\n    _createTweenType(0, arguments, this);\n\n    return this;\n  };\n\n  _proto2.from = function from(targets, vars, position) {\n    _createTweenType(1, arguments, this);\n\n    return this;\n  };\n\n  _proto2.fromTo = function fromTo(targets, fromVars, toVars, position) {\n    _createTweenType(2, arguments, this);\n\n    return this;\n  };\n\n  _proto2.set = function set(targets, vars, position) {\n    vars.duration = 0;\n    vars.parent = this;\n    _inheritDefaults(vars).repeatDelay || (vars.repeat = 0);\n    vars.immediateRender = !!vars.immediateRender;\n    new Tween(targets, vars, _parsePosition(this, position), 1);\n    return this;\n  };\n\n  _proto2.call = function call(callback, params, position) {\n    return _addToTimeline(this, Tween.delayedCall(0, callback, params), position);\n  } //ONLY for backward compatibility! Maybe delete?\n  ;\n\n  _proto2.staggerTo = function staggerTo(targets, duration, vars, stagger, position, onCompleteAll, onCompleteAllParams) {\n    vars.duration = duration;\n    vars.stagger = vars.stagger || stagger;\n    vars.onComplete = onCompleteAll;\n    vars.onCompleteParams = onCompleteAllParams;\n    vars.parent = this;\n    new Tween(targets, vars, _parsePosition(this, position));\n    return this;\n  };\n\n  _proto2.staggerFrom = function staggerFrom(targets, duration, vars, stagger, position, onCompleteAll, onCompleteAllParams) {\n    vars.runBackwards = 1;\n    _inheritDefaults(vars).immediateRender = _isNotFalse(vars.immediateRender);\n    return this.staggerTo(targets, duration, vars, stagger, position, onCompleteAll, onCompleteAllParams);\n  };\n\n  _proto2.staggerFromTo = function staggerFromTo(targets, duration, fromVars, toVars, stagger, position, onCompleteAll, onCompleteAllParams) {\n    toVars.startAt = fromVars;\n    _inheritDefaults(toVars).immediateRender = _isNotFalse(toVars.immediateRender);\n    return this.staggerTo(targets, duration, toVars, stagger, position, onCompleteAll, onCompleteAllParams);\n  };\n\n  _proto2.render = function render(totalTime, suppressEvents, force) {\n    var prevTime = this._time,\n        tDur = this._dirty ? this.totalDuration() : this._tDur,\n        dur = this._dur,\n        tTime = totalTime <= 0 ? 0 : _roundPrecise(totalTime),\n        // if a paused timeline is resumed (or its _start is updated for another reason...which rounds it), that could result in the playhead shifting a **tiny** amount and a zero-duration child at that spot may get rendered at a different ratio, like its totalTime in render() may be 1e-17 instead of 0, for example.\n    crossingStart = this._zTime < 0 !== totalTime < 0 && (this._initted || !dur),\n        time,\n        child,\n        next,\n        iteration,\n        cycleDuration,\n        prevPaused,\n        pauseTween,\n        timeScale,\n        prevStart,\n        prevIteration,\n        yoyo,\n        isYoyo;\n    this !== _globalTimeline && tTime > tDur && totalTime >= 0 && (tTime = tDur);\n\n    if (tTime !== this._tTime || force || crossingStart) {\n      if (prevTime !== this._time && dur) {\n        //if totalDuration() finds a child with a negative startTime and smoothChildTiming is true, things get shifted around internally so we need to adjust the time accordingly. For example, if a tween starts at -30 we must shift EVERYTHING forward 30 seconds and move this timeline's startTime backward by 30 seconds so that things align with the playhead (no jump).\n        tTime += this._time - prevTime;\n        totalTime += this._time - prevTime;\n      }\n\n      time = tTime;\n      prevStart = this._start;\n      timeScale = this._ts;\n      prevPaused = !timeScale;\n\n      if (crossingStart) {\n        dur || (prevTime = this._zTime); //when the playhead arrives at EXACTLY time 0 (right on top) of a zero-duration timeline, we need to discern if events are suppressed so that when the playhead moves again (next time), it'll trigger the callback. If events are NOT suppressed, obviously the callback would be triggered in this render. Basically, the callback should fire either when the playhead ARRIVES or LEAVES this exact spot, not both. Imagine doing a timeline.seek(0) and there's a callback that sits at 0. Since events are suppressed on that seek() by default, nothing will fire, but when the playhead moves off of that position, the callback should fire. This behavior is what people intuitively expect.\n\n        (totalTime || !suppressEvents) && (this._zTime = totalTime);\n      }\n\n      if (this._repeat) {\n        //adjust the time for repeats and yoyos\n        yoyo = this._yoyo;\n        cycleDuration = dur + this._rDelay;\n\n        if (this._repeat < -1 && totalTime < 0) {\n          return this.totalTime(cycleDuration * 100 + totalTime, suppressEvents, force);\n        }\n\n        time = _roundPrecise(tTime % cycleDuration); //round to avoid floating point errors. (4 % 0.8 should be 0 but some browsers report it as 0.79999999!)\n\n        if (tTime === tDur) {\n          // the tDur === tTime is for edge cases where there's a lengthy decimal on the duration and it may reach the very end but the time is rendered as not-quite-there (remember, tDur is rounded to 4 decimals whereas dur isn't)\n          iteration = this._repeat;\n          time = dur;\n        } else {\n          iteration = ~~(tTime / cycleDuration);\n\n          if (iteration && iteration === tTime / cycleDuration) {\n            time = dur;\n            iteration--;\n          }\n\n          time > dur && (time = dur);\n        }\n\n        prevIteration = _animationCycle(this._tTime, cycleDuration);\n        !prevTime && this._tTime && prevIteration !== iteration && (prevIteration = iteration); // edge case - if someone does addPause() at the very beginning of a repeating timeline, that pause is technically at the same spot as the end which causes this._time to get set to 0 when the totalTime would normally place the playhead at the end. See https://greensock.com/forums/topic/23823-closing-nav-animation-not-working-on-ie-and-iphone-6-maybe-other-older-browser/?tab=comments#comment-113005\n\n        if (yoyo && iteration & 1) {\n          time = dur - time;\n          isYoyo = 1;\n        }\n        /*\n        make sure children at the end/beginning of the timeline are rendered properly. If, for example,\n        a 3-second long timeline rendered at 2.9 seconds previously, and now renders at 3.2 seconds (which\n        would get translated to 2.8 seconds if the timeline yoyos or 0.2 seconds if it just repeats), there\n        could be a callback or a short tween that's at 2.95 or 3 seconds in which wouldn't render. So\n        we need to push the timeline to the end (and/or beginning depending on its yoyo value). Also we must\n        ensure that zero-duration tweens at the very beginning or end of the Timeline work.\n        */\n\n\n        if (iteration !== prevIteration && !this._lock) {\n          var rewinding = yoyo && prevIteration & 1,\n              doesWrap = rewinding === (yoyo && iteration & 1);\n          iteration < prevIteration && (rewinding = !rewinding);\n          prevTime = rewinding ? 0 : dur;\n          this._lock = 1;\n          this.render(prevTime || (isYoyo ? 0 : _roundPrecise(iteration * cycleDuration)), suppressEvents, !dur)._lock = 0;\n          this._tTime = tTime; // if a user gets the iteration() inside the onRepeat, for example, it should be accurate.\n\n          !suppressEvents && this.parent && _callback(this, \"onRepeat\");\n          this.vars.repeatRefresh && !isYoyo && (this.invalidate()._lock = 1);\n\n          if (prevTime && prevTime !== this._time || prevPaused !== !this._ts || this.vars.onRepeat && !this.parent && !this._act) {\n            // if prevTime is 0 and we render at the very end, _time will be the end, thus won't match. So in this edge case, prevTime won't match _time but that's okay. If it gets killed in the onRepeat, eject as well.\n            return this;\n          }\n\n          dur = this._dur; // in case the duration changed in the onRepeat\n\n          tDur = this._tDur;\n\n          if (doesWrap) {\n            this._lock = 2;\n            prevTime = rewinding ? dur : -0.0001;\n            this.render(prevTime, true);\n            this.vars.repeatRefresh && !isYoyo && this.invalidate();\n          }\n\n          this._lock = 0;\n\n          if (!this._ts && !prevPaused) {\n            return this;\n          } //in order for yoyoEase to work properly when there's a stagger, we must swap out the ease in each sub-tween.\n\n\n          _propagateYoyoEase(this, isYoyo);\n        }\n      }\n\n      if (this._hasPause && !this._forcing && this._lock < 2) {\n        pauseTween = _findNextPauseTween(this, _roundPrecise(prevTime), _roundPrecise(time));\n\n        if (pauseTween) {\n          tTime -= time - (time = pauseTween._start);\n        }\n      }\n\n      this._tTime = tTime;\n      this._time = time;\n      this._act = !timeScale; //as long as it's not paused, force it to be active so that if the user renders independent of the parent timeline, it'll be forced to re-render on the next tick.\n\n      if (!this._initted) {\n        this._onUpdate = this.vars.onUpdate;\n        this._initted = 1;\n        this._zTime = totalTime;\n        prevTime = 0; // upon init, the playhead should always go forward; someone could invalidate() a completed timeline and then if they restart(), that would make child tweens render in reverse order which could lock in the wrong starting values if they build on each other, like tl.to(obj, {x: 100}).to(obj, {x: 0}).\n      }\n\n      if (!prevTime && time && !suppressEvents) {\n        _callback(this, \"onStart\");\n\n        if (this._tTime !== tTime) {\n          // in case the onStart triggered a render at a different spot, eject. Like if someone did animation.pause(0.5) or something inside the onStart.\n          return this;\n        }\n      }\n\n      if (time >= prevTime && totalTime >= 0) {\n        child = this._first;\n\n        while (child) {\n          next = child._next;\n\n          if ((child._act || time >= child._start) && child._ts && pauseTween !== child) {\n            if (child.parent !== this) {\n              // an extreme edge case - the child's render could do something like kill() the \"next\" one in the linked list, or reparent it. In that case we must re-initiate the whole render to be safe.\n              return this.render(totalTime, suppressEvents, force);\n            }\n\n            child.render(child._ts > 0 ? (time - child._start) * child._ts : (child._dirty ? child.totalDuration() : child._tDur) + (time - child._start) * child._ts, suppressEvents, force);\n\n            if (time !== this._time || !this._ts && !prevPaused) {\n              //in case a tween pauses or seeks the timeline when rendering, like inside of an onUpdate/onComplete\n              pauseTween = 0;\n              next && (tTime += this._zTime = -_tinyNum); // it didn't finish rendering, so flag zTime as negative so that so that the next time render() is called it'll be forced (to render any remaining children)\n\n              break;\n            }\n          }\n\n          child = next;\n        }\n      } else {\n        child = this._last;\n        var adjustedTime = totalTime < 0 ? totalTime : time; //when the playhead goes backward beyond the start of this timeline, we must pass that information down to the child animations so that zero-duration tweens know whether to render their starting or ending values.\n\n        while (child) {\n          next = child._prev;\n\n          if ((child._act || adjustedTime <= child._end) && child._ts && pauseTween !== child) {\n            if (child.parent !== this) {\n              // an extreme edge case - the child's render could do something like kill() the \"next\" one in the linked list, or reparent it. In that case we must re-initiate the whole render to be safe.\n              return this.render(totalTime, suppressEvents, force);\n            }\n\n            child.render(child._ts > 0 ? (adjustedTime - child._start) * child._ts : (child._dirty ? child.totalDuration() : child._tDur) + (adjustedTime - child._start) * child._ts, suppressEvents, force);\n\n            if (time !== this._time || !this._ts && !prevPaused) {\n              //in case a tween pauses or seeks the timeline when rendering, like inside of an onUpdate/onComplete\n              pauseTween = 0;\n              next && (tTime += this._zTime = adjustedTime ? -_tinyNum : _tinyNum); // it didn't finish rendering, so adjust zTime so that so that the next time render() is called it'll be forced (to render any remaining children)\n\n              break;\n            }\n          }\n\n          child = next;\n        }\n      }\n\n      if (pauseTween && !suppressEvents) {\n        this.pause();\n        pauseTween.render(time >= prevTime ? 0 : -_tinyNum)._zTime = time >= prevTime ? 1 : -1;\n\n        if (this._ts) {\n          //the callback resumed playback! So since we may have held back the playhead due to where the pause is positioned, go ahead and jump to where it's SUPPOSED to be (if no pause happened).\n          this._start = prevStart; //if the pause was at an earlier time and the user resumed in the callback, it could reposition the timeline (changing its startTime), throwing things off slightly, so we make sure the _start doesn't shift.\n\n          _setEnd(this);\n\n          return this.render(totalTime, suppressEvents, force);\n        }\n      }\n\n      this._onUpdate && !suppressEvents && _callback(this, \"onUpdate\", true);\n      if (tTime === tDur && tDur >= this.totalDuration() || !tTime && prevTime) if (prevStart === this._start || Math.abs(timeScale) !== Math.abs(this._ts)) if (!this._lock) {\n        (totalTime || !dur) && (tTime === tDur && this._ts > 0 || !tTime && this._ts < 0) && _removeFromParent(this, 1); // don't remove if the timeline is reversed and the playhead isn't at 0, otherwise tl.progress(1).reverse() won't work. Only remove if the playhead is at the end and timeScale is positive, or if the playhead is at 0 and the timeScale is negative.\n\n        if (!suppressEvents && !(totalTime < 0 && !prevTime) && (tTime || prevTime || !tDur)) {\n          _callback(this, tTime === tDur && totalTime >= 0 ? \"onComplete\" : \"onReverseComplete\", true);\n\n          this._prom && !(tTime < tDur && this.timeScale() > 0) && this._prom();\n        }\n      }\n    }\n\n    return this;\n  };\n\n  _proto2.add = function add(child, position) {\n    var _this2 = this;\n\n    _isNumber(position) || (position = _parsePosition(this, position, child));\n\n    if (!(child instanceof Animation)) {\n      if (_isArray(child)) {\n        child.forEach(function (obj) {\n          return _this2.add(obj, position);\n        });\n        return this;\n      }\n\n      if (_isString(child)) {\n        return this.addLabel(child, position);\n      }\n\n      if (_isFunction(child)) {\n        child = Tween.delayedCall(0, child);\n      } else {\n        return this;\n      }\n    }\n\n    return this !== child ? _addToTimeline(this, child, position) : this; //don't allow a timeline to be added to itself as a child!\n  };\n\n  _proto2.getChildren = function getChildren(nested, tweens, timelines, ignoreBeforeTime) {\n    if (nested === void 0) {\n      nested = true;\n    }\n\n    if (tweens === void 0) {\n      tweens = true;\n    }\n\n    if (timelines === void 0) {\n      timelines = true;\n    }\n\n    if (ignoreBeforeTime === void 0) {\n      ignoreBeforeTime = -_bigNum;\n    }\n\n    var a = [],\n        child = this._first;\n\n    while (child) {\n      if (child._start >= ignoreBeforeTime) {\n        if (child instanceof Tween) {\n          tweens && a.push(child);\n        } else {\n          timelines && a.push(child);\n          nested && a.push.apply(a, child.getChildren(true, tweens, timelines));\n        }\n      }\n\n      child = child._next;\n    }\n\n    return a;\n  };\n\n  _proto2.getById = function getById(id) {\n    var animations = this.getChildren(1, 1, 1),\n        i = animations.length;\n\n    while (i--) {\n      if (animations[i].vars.id === id) {\n        return animations[i];\n      }\n    }\n  };\n\n  _proto2.remove = function remove(child) {\n    if (_isString(child)) {\n      return this.removeLabel(child);\n    }\n\n    if (_isFunction(child)) {\n      return this.killTweensOf(child);\n    }\n\n    _removeLinkedListItem(this, child);\n\n    if (child === this._recent) {\n      this._recent = this._last;\n    }\n\n    return _uncache(this);\n  };\n\n  _proto2.totalTime = function totalTime(_totalTime2, suppressEvents) {\n    if (!arguments.length) {\n      return this._tTime;\n    }\n\n    this._forcing = 1;\n\n    if (!this._dp && this._ts) {\n      //special case for the global timeline (or any other that has no parent or detached parent).\n      this._start = _roundPrecise(_ticker.time - (this._ts > 0 ? _totalTime2 / this._ts : (this.totalDuration() - _totalTime2) / -this._ts));\n    }\n\n    _Animation.prototype.totalTime.call(this, _totalTime2, suppressEvents);\n\n    this._forcing = 0;\n    return this;\n  };\n\n  _proto2.addLabel = function addLabel(label, position) {\n    this.labels[label] = _parsePosition(this, position);\n    return this;\n  };\n\n  _proto2.removeLabel = function removeLabel(label) {\n    delete this.labels[label];\n    return this;\n  };\n\n  _proto2.addPause = function addPause(position, callback, params) {\n    var t = Tween.delayedCall(0, callback || _emptyFunc, params);\n    t.data = \"isPause\";\n    this._hasPause = 1;\n    return _addToTimeline(this, t, _parsePosition(this, position));\n  };\n\n  _proto2.removePause = function removePause(position) {\n    var child = this._first;\n    position = _parsePosition(this, position);\n\n    while (child) {\n      if (child._start === position && child.data === \"isPause\") {\n        _removeFromParent(child);\n      }\n\n      child = child._next;\n    }\n  };\n\n  _proto2.killTweensOf = function killTweensOf(targets, props, onlyActive) {\n    var tweens = this.getTweensOf(targets, onlyActive),\n        i = tweens.length;\n\n    while (i--) {\n      _overwritingTween !== tweens[i] && tweens[i].kill(targets, props);\n    }\n\n    return this;\n  };\n\n  _proto2.getTweensOf = function getTweensOf(targets, onlyActive) {\n    var a = [],\n        parsedTargets = toArray(targets),\n        child = this._first,\n        isGlobalTime = _isNumber(onlyActive),\n        // a number is interpreted as a global time. If the animation spans\n    children;\n\n    while (child) {\n      if (child instanceof Tween) {\n        if (_arrayContainsAny(child._targets, parsedTargets) && (isGlobalTime ? (!_overwritingTween || child._initted && child._ts) && child.globalTime(0) <= onlyActive && child.globalTime(child.totalDuration()) > onlyActive : !onlyActive || child.isActive())) {\n          // note: if this is for overwriting, it should only be for tweens that aren't paused and are initted.\n          a.push(child);\n        }\n      } else if ((children = child.getTweensOf(parsedTargets, onlyActive)).length) {\n        a.push.apply(a, children);\n      }\n\n      child = child._next;\n    }\n\n    return a;\n  } // potential future feature - targets() on timelines\n  // targets() {\n  // \tlet result = [];\n  // \tthis.getChildren(true, true, false).forEach(t => result.push(...t.targets()));\n  // \treturn result.filter((v, i) => result.indexOf(v) === i);\n  // }\n  ;\n\n  _proto2.tweenTo = function tweenTo(position, vars) {\n    vars = vars || {};\n\n    var tl = this,\n        endTime = _parsePosition(tl, position),\n        _vars = vars,\n        startAt = _vars.startAt,\n        _onStart = _vars.onStart,\n        onStartParams = _vars.onStartParams,\n        immediateRender = _vars.immediateRender,\n        initted,\n        tween = Tween.to(tl, _setDefaults({\n      ease: vars.ease || \"none\",\n      lazy: false,\n      immediateRender: false,\n      time: endTime,\n      overwrite: \"auto\",\n      duration: vars.duration || Math.abs((endTime - (startAt && \"time\" in startAt ? startAt.time : tl._time)) / tl.timeScale()) || _tinyNum,\n      onStart: function onStart() {\n        tl.pause();\n\n        if (!initted) {\n          var duration = vars.duration || Math.abs((endTime - (startAt && \"time\" in startAt ? startAt.time : tl._time)) / tl.timeScale());\n          tween._dur !== duration && _setDuration(tween, duration, 0, 1).render(tween._time, true, true);\n          initted = 1;\n        }\n\n        _onStart && _onStart.apply(tween, onStartParams || []); //in case the user had an onStart in the vars - we don't want to overwrite it.\n      }\n    }, vars));\n\n    return immediateRender ? tween.render(0) : tween;\n  };\n\n  _proto2.tweenFromTo = function tweenFromTo(fromPosition, toPosition, vars) {\n    return this.tweenTo(toPosition, _setDefaults({\n      startAt: {\n        time: _parsePosition(this, fromPosition)\n      }\n    }, vars));\n  };\n\n  _proto2.recent = function recent() {\n    return this._recent;\n  };\n\n  _proto2.nextLabel = function nextLabel(afterTime) {\n    if (afterTime === void 0) {\n      afterTime = this._time;\n    }\n\n    return _getLabelInDirection(this, _parsePosition(this, afterTime));\n  };\n\n  _proto2.previousLabel = function previousLabel(beforeTime) {\n    if (beforeTime === void 0) {\n      beforeTime = this._time;\n    }\n\n    return _getLabelInDirection(this, _parsePosition(this, beforeTime), 1);\n  };\n\n  _proto2.currentLabel = function currentLabel(value) {\n    return arguments.length ? this.seek(value, true) : this.previousLabel(this._time + _tinyNum);\n  };\n\n  _proto2.shiftChildren = function shiftChildren(amount, adjustLabels, ignoreBeforeTime) {\n    if (ignoreBeforeTime === void 0) {\n      ignoreBeforeTime = 0;\n    }\n\n    var child = this._first,\n        labels = this.labels,\n        p;\n\n    while (child) {\n      if (child._start >= ignoreBeforeTime) {\n        child._start += amount;\n        child._end += amount;\n      }\n\n      child = child._next;\n    }\n\n    if (adjustLabels) {\n      for (p in labels) {\n        if (labels[p] >= ignoreBeforeTime) {\n          labels[p] += amount;\n        }\n      }\n    }\n\n    return _uncache(this);\n  };\n\n  _proto2.invalidate = function invalidate() {\n    var child = this._first;\n    this._lock = 0;\n\n    while (child) {\n      child.invalidate();\n      child = child._next;\n    }\n\n    return _Animation.prototype.invalidate.call(this);\n  };\n\n  _proto2.clear = function clear(includeLabels) {\n    if (includeLabels === void 0) {\n      includeLabels = true;\n    }\n\n    var child = this._first,\n        next;\n\n    while (child) {\n      next = child._next;\n      this.remove(child);\n      child = next;\n    }\n\n    this._dp && (this._time = this._tTime = this._pTime = 0);\n    includeLabels && (this.labels = {});\n    return _uncache(this);\n  };\n\n  _proto2.totalDuration = function totalDuration(value) {\n    var max = 0,\n        self = this,\n        child = self._last,\n        prevStart = _bigNum,\n        prev,\n        start,\n        parent;\n\n    if (arguments.length) {\n      return self.timeScale((self._repeat < 0 ? self.duration() : self.totalDuration()) / (self.reversed() ? -value : value));\n    }\n\n    if (self._dirty) {\n      parent = self.parent;\n\n      while (child) {\n        prev = child._prev; //record it here in case the tween changes position in the sequence...\n\n        child._dirty && child.totalDuration(); //could change the tween._startTime, so make sure the animation's cache is clean before analyzing it.\n\n        start = child._start;\n\n        if (start > prevStart && self._sort && child._ts && !self._lock) {\n          //in case one of the tweens shifted out of order, it needs to be re-inserted into the correct position in the sequence\n          self._lock = 1; //prevent endless recursive calls - there are methods that get triggered that check duration/totalDuration when we add().\n\n          _addToTimeline(self, child, start - child._delay, 1)._lock = 0;\n        } else {\n          prevStart = start;\n        }\n\n        if (start < 0 && child._ts) {\n          //children aren't allowed to have negative startTimes unless smoothChildTiming is true, so adjust here if one is found.\n          max -= start;\n\n          if (!parent && !self._dp || parent && parent.smoothChildTiming) {\n            self._start += start / self._ts;\n            self._time -= start;\n            self._tTime -= start;\n          }\n\n          self.shiftChildren(-start, false, -1e999);\n          prevStart = 0;\n        }\n\n        child._end > max && child._ts && (max = child._end);\n        child = prev;\n      }\n\n      _setDuration(self, self === _globalTimeline && self._time > max ? self._time : max, 1, 1);\n\n      self._dirty = 0;\n    }\n\n    return self._tDur;\n  };\n\n  Timeline.updateRoot = function updateRoot(time) {\n    if (_globalTimeline._ts) {\n      _lazySafeRender(_globalTimeline, _parentToChildTotalTime(time, _globalTimeline));\n\n      _lastRenderedFrame = _ticker.frame;\n    }\n\n    if (_ticker.frame >= _nextGCFrame) {\n      _nextGCFrame += _config.autoSleep || 120;\n      var child = _globalTimeline._first;\n      if (!child || !child._ts) if (_config.autoSleep && _ticker._listeners.length < 2) {\n        while (child && !child._ts) {\n          child = child._next;\n        }\n\n        child || _ticker.sleep();\n      }\n    }\n  };\n\n  return Timeline;\n}(Animation);\n\n_setDefaults(Timeline.prototype, {\n  _lock: 0,\n  _hasPause: 0,\n  _forcing: 0\n});\n\nvar _addComplexStringPropTween = function _addComplexStringPropTween(target, prop, start, end, setter, stringFilter, funcParam) {\n  //note: we call _addComplexStringPropTween.call(tweenInstance...) to ensure that it's scoped properly. We may call it from within a plugin too, thus \"this\" would refer to the plugin.\n  var pt = new PropTween(this._pt, target, prop, 0, 1, _renderComplexString, null, setter),\n      index = 0,\n      matchIndex = 0,\n      result,\n      startNums,\n      color,\n      endNum,\n      chunk,\n      startNum,\n      hasRandom,\n      a;\n  pt.b = start;\n  pt.e = end;\n  start += \"\"; //ensure values are strings\n\n  end += \"\";\n\n  if (hasRandom = ~end.indexOf(\"random(\")) {\n    end = _replaceRandom(end);\n  }\n\n  if (stringFilter) {\n    a = [start, end];\n    stringFilter(a, target, prop); //pass an array with the starting and ending values and let the filter do whatever it needs to the values.\n\n    start = a[0];\n    end = a[1];\n  }\n\n  startNums = start.match(_complexStringNumExp) || [];\n\n  while (result = _complexStringNumExp.exec(end)) {\n    endNum = result[0];\n    chunk = end.substring(index, result.index);\n\n    if (color) {\n      color = (color + 1) % 5;\n    } else if (chunk.substr(-5) === \"rgba(\") {\n      color = 1;\n    }\n\n    if (endNum !== startNums[matchIndex++]) {\n      startNum = parseFloat(startNums[matchIndex - 1]) || 0; //these nested PropTweens are handled in a special way - we'll never actually call a render or setter method on them. We'll just loop through them in the parent complex string PropTween's render method.\n\n      pt._pt = {\n        _next: pt._pt,\n        p: chunk || matchIndex === 1 ? chunk : \",\",\n        //note: SVG spec allows omission of comma/space when a negative sign is wedged between two numbers, like 2.5-5.3 instead of 2.5,-5.3 but when tweening, the negative value may switch to positive, so we insert the comma just in case.\n        s: startNum,\n        c: endNum.charAt(1) === \"=\" ? parseFloat(endNum.substr(2)) * (endNum.charAt(0) === \"-\" ? -1 : 1) : parseFloat(endNum) - startNum,\n        m: color && color < 4 ? Math.round : 0\n      };\n      index = _complexStringNumExp.lastIndex;\n    }\n  }\n\n  pt.c = index < end.length ? end.substring(index, end.length) : \"\"; //we use the \"c\" of the PropTween to store the final part of the string (after the last number)\n\n  pt.fp = funcParam;\n\n  if (_relExp.test(end) || hasRandom) {\n    pt.e = 0; //if the end string contains relative values or dynamic random(...) values, delete the end it so that on the final render we don't actually set it to the string with += or -= characters (forces it to use the calculated value).\n  }\n\n  this._pt = pt; //start the linked list with this new PropTween. Remember, we call _addComplexStringPropTween.call(tweenInstance...) to ensure that it's scoped properly. We may call it from within a plugin too, thus \"this\" would refer to the plugin.\n\n  return pt;\n},\n    _addPropTween = function _addPropTween(target, prop, start, end, index, targets, modifier, stringFilter, funcParam) {\n  _isFunction(end) && (end = end(index || 0, target, targets));\n  var currentValue = target[prop],\n      parsedStart = start !== \"get\" ? start : !_isFunction(currentValue) ? currentValue : funcParam ? target[prop.indexOf(\"set\") || !_isFunction(target[\"get\" + prop.substr(3)]) ? prop : \"get\" + prop.substr(3)](funcParam) : target[prop](),\n      setter = !_isFunction(currentValue) ? _setterPlain : funcParam ? _setterFuncWithParam : _setterFunc,\n      pt;\n\n  if (_isString(end)) {\n    if (~end.indexOf(\"random(\")) {\n      end = _replaceRandom(end);\n    }\n\n    if (end.charAt(1) === \"=\") {\n      pt = parseFloat(parsedStart) + parseFloat(end.substr(2)) * (end.charAt(0) === \"-\" ? -1 : 1) + (getUnit(parsedStart) || 0);\n\n      if (pt || pt === 0) {\n        // to avoid isNaN, like if someone passes in a value like \"!= whatever\"\n        end = pt;\n      }\n    }\n  }\n\n  if (parsedStart !== end) {\n    if (!isNaN(parsedStart * end) && end !== \"\") {\n      // fun fact: any number multiplied by \"\" is evaluated as the number 0!\n      pt = new PropTween(this._pt, target, prop, +parsedStart || 0, end - (parsedStart || 0), typeof currentValue === \"boolean\" ? _renderBoolean : _renderPlain, 0, setter);\n      funcParam && (pt.fp = funcParam);\n      modifier && pt.modifier(modifier, this, target);\n      return this._pt = pt;\n    }\n\n    !currentValue && !(prop in target) && _missingPlugin(prop, end);\n    return _addComplexStringPropTween.call(this, target, prop, parsedStart, end, setter, stringFilter || _config.stringFilter, funcParam);\n  }\n},\n    //creates a copy of the vars object and processes any function-based values (putting the resulting values directly into the copy) as well as strings with \"random()\" in them. It does NOT process relative values.\n_processVars = function _processVars(vars, index, target, targets, tween) {\n  _isFunction(vars) && (vars = _parseFuncOrString(vars, tween, index, target, targets));\n\n  if (!_isObject(vars) || vars.style && vars.nodeType || _isArray(vars) || _isTypedArray(vars)) {\n    return _isString(vars) ? _parseFuncOrString(vars, tween, index, target, targets) : vars;\n  }\n\n  var copy = {},\n      p;\n\n  for (p in vars) {\n    copy[p] = _parseFuncOrString(vars[p], tween, index, target, targets);\n  }\n\n  return copy;\n},\n    _checkPlugin = function _checkPlugin(property, vars, tween, index, target, targets) {\n  var plugin, pt, ptLookup, i;\n\n  if (_plugins[property] && (plugin = new _plugins[property]()).init(target, plugin.rawVars ? vars[property] : _processVars(vars[property], index, target, targets, tween), tween, index, targets) !== false) {\n    tween._pt = pt = new PropTween(tween._pt, target, property, 0, 1, plugin.render, plugin, 0, plugin.priority);\n\n    if (tween !== _quickTween) {\n      ptLookup = tween._ptLookup[tween._targets.indexOf(target)]; //note: we can't use tween._ptLookup[index] because for staggered tweens, the index from the fullTargets array won't match what it is in each individual tween that spawns from the stagger.\n\n      i = plugin._props.length;\n\n      while (i--) {\n        ptLookup[plugin._props[i]] = pt;\n      }\n    }\n  }\n\n  return plugin;\n},\n    _overwritingTween,\n    //store a reference temporarily so we can avoid overwriting itself.\n_initTween = function _initTween(tween, time) {\n  var vars = tween.vars,\n      ease = vars.ease,\n      startAt = vars.startAt,\n      immediateRender = vars.immediateRender,\n      lazy = vars.lazy,\n      onUpdate = vars.onUpdate,\n      onUpdateParams = vars.onUpdateParams,\n      callbackScope = vars.callbackScope,\n      runBackwards = vars.runBackwards,\n      yoyoEase = vars.yoyoEase,\n      keyframes = vars.keyframes,\n      autoRevert = vars.autoRevert,\n      dur = tween._dur,\n      prevStartAt = tween._startAt,\n      targets = tween._targets,\n      parent = tween.parent,\n      fullTargets = parent && parent.data === \"nested\" ? parent.parent._targets : targets,\n      autoOverwrite = tween._overwrite === \"auto\" && !_suppressOverwrites,\n      tl = tween.timeline,\n      cleanVars,\n      i,\n      p,\n      pt,\n      target,\n      hasPriority,\n      gsData,\n      harness,\n      plugin,\n      ptLookup,\n      index,\n      harnessVars,\n      overwritten;\n  tl && (!keyframes || !ease) && (ease = \"none\");\n  tween._ease = _parseEase(ease, _defaults.ease);\n  tween._yEase = yoyoEase ? _invertEase(_parseEase(yoyoEase === true ? ease : yoyoEase, _defaults.ease)) : 0;\n\n  if (yoyoEase && tween._yoyo && !tween._repeat) {\n    //there must have been a parent timeline with yoyo:true that is currently in its yoyo phase, so flip the eases.\n    yoyoEase = tween._yEase;\n    tween._yEase = tween._ease;\n    tween._ease = yoyoEase;\n  }\n\n  tween._from = !tl && !!vars.runBackwards; //nested timelines should never run backwards - the backwards-ness is in the child tweens.\n\n  if (!tl || keyframes && !vars.stagger) {\n    //if there's an internal timeline, skip all the parsing because we passed that task down the chain.\n    harness = targets[0] ? _getCache(targets[0]).harness : 0;\n    harnessVars = harness && vars[harness.prop]; //someone may need to specify CSS-specific values AND non-CSS values, like if the element has an \"x\" property plus it's a standard DOM element. We allow people to distinguish by wrapping plugin-specific stuff in a css:{} object for example.\n\n    cleanVars = _copyExcluding(vars, _reservedProps);\n    prevStartAt && _removeFromParent(prevStartAt.render(-1, true));\n\n    if (startAt) {\n      _removeFromParent(tween._startAt = Tween.set(targets, _setDefaults({\n        data: \"isStart\",\n        overwrite: false,\n        parent: parent,\n        immediateRender: true,\n        lazy: _isNotFalse(lazy),\n        startAt: null,\n        delay: 0,\n        onUpdate: onUpdate,\n        onUpdateParams: onUpdateParams,\n        callbackScope: callbackScope,\n        stagger: 0\n      }, startAt))); //copy the properties/values into a new object to avoid collisions, like var to = {x:0}, from = {x:500}; timeline.fromTo(e, from, to).fromTo(e, to, from);\n\n\n      time < 0 && !immediateRender && !autoRevert && tween._startAt.render(-1, true); // rare edge case, like if a render is forced in the negative direction of a non-initted tween.\n\n      if (immediateRender) {\n        time > 0 && !autoRevert && (tween._startAt = 0); //tweens that render immediately (like most from() and fromTo() tweens) shouldn't revert when their parent timeline's playhead goes backward past the startTime because the initial render could have happened anytime and it shouldn't be directly correlated to this tween's startTime. Imagine setting up a complex animation where the beginning states of various objects are rendered immediately but the tween doesn't happen for quite some time - if we revert to the starting values as soon as the playhead goes backward past the tween's startTime, it will throw things off visually. Reversion should only happen in Timeline instances where immediateRender was false or when autoRevert is explicitly set to true.\n\n        if (dur && time <= 0) {\n          time && (tween._zTime = time);\n          return; //we skip initialization here so that overwriting doesn't occur until the tween actually begins. Otherwise, if you create several immediateRender:true tweens of the same target/properties to drop into a Timeline, the last one created would overwrite the first ones because they didn't get placed into the timeline yet before the first render occurs and kicks in overwriting.\n        } // if (time > 0) {\n        // \tautoRevert || (tween._startAt = 0); //tweens that render immediately (like most from() and fromTo() tweens) shouldn't revert when their parent timeline's playhead goes backward past the startTime because the initial render could have happened anytime and it shouldn't be directly correlated to this tween's startTime. Imagine setting up a complex animation where the beginning states of various objects are rendered immediately but the tween doesn't happen for quite some time - if we revert to the starting values as soon as the playhead goes backward past the tween's startTime, it will throw things off visually. Reversion should only happen in Timeline instances where immediateRender was false or when autoRevert is explicitly set to true.\n        // } else if (dur && !(time < 0 && prevStartAt)) {\n        // \ttime && (tween._zTime = time);\n        // \treturn; //we skip initialization here so that overwriting doesn't occur until the tween actually begins. Otherwise, if you create several immediateRender:true tweens of the same target/properties to drop into a Timeline, the last one created would overwrite the first ones because they didn't get placed into the timeline yet before the first render occurs and kicks in overwriting.\n        // }\n\n      } else if (autoRevert === false) {\n        tween._startAt = 0;\n      }\n    } else if (runBackwards && dur) {\n      //from() tweens must be handled uniquely: their beginning values must be rendered but we don't want overwriting to occur yet (when time is still 0). Wait until the tween actually begins before doing all the routines like overwriting. At that time, we should render at the END of the tween to ensure that things initialize correctly (remember, from() tweens go backwards)\n      if (prevStartAt) {\n        !autoRevert && (tween._startAt = 0);\n      } else {\n        time && (immediateRender = false); //in rare cases (like if a from() tween runs and then is invalidate()-ed), immediateRender could be true but the initial forced-render gets skipped, so there's no need to force the render in this context when the _time is greater than 0\n\n        p = _setDefaults({\n          overwrite: false,\n          data: \"isFromStart\",\n          //we tag the tween with as \"isFromStart\" so that if [inside a plugin] we need to only do something at the very END of a tween, we have a way of identifying this tween as merely the one that's setting the beginning values for a \"from()\" tween. For example, clearProps in CSSPlugin should only get applied at the very END of a tween and without this tag, from(...{height:100, clearProps:\"height\", delay:1}) would wipe the height at the beginning of the tween and after 1 second, it'd kick back in.\n          lazy: immediateRender && _isNotFalse(lazy),\n          immediateRender: immediateRender,\n          //zero-duration tweens render immediately by default, but if we're not specifically instructed to render this tween immediately, we should skip this and merely _init() to record the starting values (rendering them immediately would push them to completion which is wasteful in that case - we'd have to render(-1) immediately after)\n          stagger: 0,\n          parent: parent //ensures that nested tweens that had a stagger are handled properly, like gsap.from(\".class\", {y:gsap.utils.wrap([-100,100])})\n\n        }, cleanVars);\n        harnessVars && (p[harness.prop] = harnessVars); // in case someone does something like .from(..., {css:{}})\n\n        _removeFromParent(tween._startAt = Tween.set(targets, p));\n\n        time < 0 && tween._startAt.render(-1, true); // rare edge case, like if a render is forced in the negative direction of a non-initted from() tween.\n\n        tween._zTime = time;\n\n        if (!immediateRender) {\n          _initTween(tween._startAt, _tinyNum); //ensures that the initial values are recorded\n\n        } else if (!time) {\n          return;\n        }\n      }\n    }\n\n    tween._pt = 0;\n    lazy = dur && _isNotFalse(lazy) || lazy && !dur;\n\n    for (i = 0; i < targets.length; i++) {\n      target = targets[i];\n      gsData = target._gsap || _harness(targets)[i]._gsap;\n      tween._ptLookup[i] = ptLookup = {};\n      _lazyLookup[gsData.id] && _lazyTweens.length && _lazyRender(); //if other tweens of the same target have recently initted but haven't rendered yet, we've got to force the render so that the starting values are correct (imagine populating a timeline with a bunch of sequential tweens and then jumping to the end)\n\n      index = fullTargets === targets ? i : fullTargets.indexOf(target);\n\n      if (harness && (plugin = new harness()).init(target, harnessVars || cleanVars, tween, index, fullTargets) !== false) {\n        tween._pt = pt = new PropTween(tween._pt, target, plugin.name, 0, 1, plugin.render, plugin, 0, plugin.priority);\n\n        plugin._props.forEach(function (name) {\n          ptLookup[name] = pt;\n        });\n\n        plugin.priority && (hasPriority = 1);\n      }\n\n      if (!harness || harnessVars) {\n        for (p in cleanVars) {\n          if (_plugins[p] && (plugin = _checkPlugin(p, cleanVars, tween, index, target, fullTargets))) {\n            plugin.priority && (hasPriority = 1);\n          } else {\n            ptLookup[p] = pt = _addPropTween.call(tween, target, p, \"get\", cleanVars[p], index, fullTargets, 0, vars.stringFilter);\n          }\n        }\n      }\n\n      tween._op && tween._op[i] && tween.kill(target, tween._op[i]);\n\n      if (autoOverwrite && tween._pt) {\n        _overwritingTween = tween;\n\n        _globalTimeline.killTweensOf(target, ptLookup, tween.globalTime(time)); // make sure the overwriting doesn't overwrite THIS tween!!!\n\n\n        overwritten = !tween.parent;\n        _overwritingTween = 0;\n      }\n\n      tween._pt && lazy && (_lazyLookup[gsData.id] = 1);\n    }\n\n    hasPriority && _sortPropTweensByPriority(tween);\n    tween._onInit && tween._onInit(tween); //plugins like RoundProps must wait until ALL of the PropTweens are instantiated. In the plugin's init() function, it sets the _onInit on the tween instance. May not be pretty/intuitive, but it's fast and keeps file size down.\n  }\n\n  tween._onUpdate = onUpdate;\n  tween._initted = (!tween._op || tween._pt) && !overwritten; // if overwrittenProps resulted in the entire tween being killed, do NOT flag it as initted or else it may render for one tick.\n\n  keyframes && time <= 0 && tl.render(_bigNum, true, true); // if there's a 0% keyframe, it'll render in the \"before\" state for any staggered/delayed animations thus when the following tween initializes, it'll use the \"before\" state instead of the \"after\" state as the initial values.\n},\n    _addAliasesToVars = function _addAliasesToVars(targets, vars) {\n  var harness = targets[0] ? _getCache(targets[0]).harness : 0,\n      propertyAliases = harness && harness.aliases,\n      copy,\n      p,\n      i,\n      aliases;\n\n  if (!propertyAliases) {\n    return vars;\n  }\n\n  copy = _merge({}, vars);\n\n  for (p in propertyAliases) {\n    if (p in copy) {\n      aliases = propertyAliases[p].split(\",\");\n      i = aliases.length;\n\n      while (i--) {\n        copy[aliases[i]] = copy[p];\n      }\n    }\n  }\n\n  return copy;\n},\n    // parses multiple formats, like {\"0%\": {x: 100}, {\"50%\": {x: -20}} and { x: {\"0%\": 100, \"50%\": -20} }, and an \"ease\" can be set on any object. We populate an \"allProps\" object with an Array for each property, like {x: [{}, {}], y:[{}, {}]} with data for each property tween. The objects have a \"t\" (time), \"v\", (value), and \"e\" (ease) property. This allows us to piece together a timeline later.\n_parseKeyframe = function _parseKeyframe(prop, obj, allProps, easeEach) {\n  var ease = obj.ease || easeEach || \"power1.inOut\",\n      p,\n      a;\n\n  if (_isArray(obj)) {\n    a = allProps[prop] || (allProps[prop] = []); // t = time (out of 100), v = value, e = ease\n\n    obj.forEach(function (value, i) {\n      return a.push({\n        t: i / (obj.length - 1) * 100,\n        v: value,\n        e: ease\n      });\n    });\n  } else {\n    for (p in obj) {\n      a = allProps[p] || (allProps[p] = []);\n      p === \"ease\" || a.push({\n        t: parseFloat(prop),\n        v: obj[p],\n        e: ease\n      });\n    }\n  }\n},\n    _parseFuncOrString = function _parseFuncOrString(value, tween, i, target, targets) {\n  return _isFunction(value) ? value.call(tween, i, target, targets) : _isString(value) && ~value.indexOf(\"random(\") ? _replaceRandom(value) : value;\n},\n    _staggerTweenProps = _callbackNames + \"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase\",\n    _staggerPropsToSkip = {};\n\n_forEachName(_staggerTweenProps + \",id,stagger,delay,duration,paused,scrollTrigger\", function (name) {\n  return _staggerPropsToSkip[name] = 1;\n});\n/*\n * --------------------------------------------------------------------------------------\n * TWEEN\n * --------------------------------------------------------------------------------------\n */\n\n\nexport var Tween = /*#__PURE__*/function (_Animation2) {\n  _inheritsLoose(Tween, _Animation2);\n\n  function Tween(targets, vars, position, skipInherit) {\n    var _this3;\n\n    if (typeof vars === \"number\") {\n      position.duration = vars;\n      vars = position;\n      position = null;\n    }\n\n    _this3 = _Animation2.call(this, skipInherit ? vars : _inheritDefaults(vars)) || this;\n    var _this3$vars = _this3.vars,\n        duration = _this3$vars.duration,\n        delay = _this3$vars.delay,\n        immediateRender = _this3$vars.immediateRender,\n        stagger = _this3$vars.stagger,\n        overwrite = _this3$vars.overwrite,\n        keyframes = _this3$vars.keyframes,\n        defaults = _this3$vars.defaults,\n        scrollTrigger = _this3$vars.scrollTrigger,\n        yoyoEase = _this3$vars.yoyoEase,\n        parent = vars.parent || _globalTimeline,\n        parsedTargets = (_isArray(targets) || _isTypedArray(targets) ? _isNumber(targets[0]) : \"length\" in vars) ? [targets] : toArray(targets),\n        tl,\n        i,\n        copy,\n        l,\n        p,\n        curTarget,\n        staggerFunc,\n        staggerVarsToMerge;\n    _this3._targets = parsedTargets.length ? _harness(parsedTargets) : _warn(\"GSAP target \" + targets + \" not found. https://greensock.com\", !_config.nullTargetWarn) || [];\n    _this3._ptLookup = []; //PropTween lookup. An array containing an object for each target, having keys for each tweening property\n\n    _this3._overwrite = overwrite;\n\n    if (keyframes || stagger || _isFuncOrString(duration) || _isFuncOrString(delay)) {\n      vars = _this3.vars;\n      tl = _this3.timeline = new Timeline({\n        data: \"nested\",\n        defaults: defaults || {}\n      });\n      tl.kill();\n      tl.parent = tl._dp = _assertThisInitialized(_this3);\n      tl._start = 0;\n\n      if (stagger || _isFuncOrString(duration) || _isFuncOrString(delay)) {\n        l = parsedTargets.length;\n        staggerFunc = stagger && distribute(stagger);\n\n        if (_isObject(stagger)) {\n          //users can pass in callbacks like onStart/onComplete in the stagger object. These should fire with each individual tween.\n          for (p in stagger) {\n            if (~_staggerTweenProps.indexOf(p)) {\n              staggerVarsToMerge || (staggerVarsToMerge = {});\n              staggerVarsToMerge[p] = stagger[p];\n            }\n          }\n        }\n\n        for (i = 0; i < l; i++) {\n          copy = _copyExcluding(vars, _staggerPropsToSkip);\n          copy.stagger = 0;\n          yoyoEase && (copy.yoyoEase = yoyoEase);\n          staggerVarsToMerge && _merge(copy, staggerVarsToMerge);\n          curTarget = parsedTargets[i]; //don't just copy duration or delay because if they're a string or function, we'd end up in an infinite loop because _isFuncOrString() would evaluate as true in the child tweens, entering this loop, etc. So we parse the value straight from vars and default to 0.\n\n          copy.duration = +_parseFuncOrString(duration, _assertThisInitialized(_this3), i, curTarget, parsedTargets);\n          copy.delay = (+_parseFuncOrString(delay, _assertThisInitialized(_this3), i, curTarget, parsedTargets) || 0) - _this3._delay;\n\n          if (!stagger && l === 1 && copy.delay) {\n            // if someone does delay:\"random(1, 5)\", repeat:-1, for example, the delay shouldn't be inside the repeat.\n            _this3._delay = delay = copy.delay;\n            _this3._start += delay;\n            copy.delay = 0;\n          }\n\n          tl.to(curTarget, copy, staggerFunc ? staggerFunc(i, curTarget, parsedTargets) : 0);\n          tl._ease = _easeMap.none;\n        }\n\n        tl.duration() ? duration = delay = 0 : _this3.timeline = 0; // if the timeline's duration is 0, we don't need a timeline internally!\n      } else if (keyframes) {\n        _inheritDefaults(_setDefaults(tl.vars.defaults, {\n          ease: \"none\"\n        }));\n\n        tl._ease = _parseEase(keyframes.ease || vars.ease || \"none\");\n        var time = 0,\n            a,\n            kf,\n            v;\n\n        if (_isArray(keyframes)) {\n          keyframes.forEach(function (frame) {\n            return tl.to(parsedTargets, frame, \">\");\n          });\n        } else {\n          copy = {};\n\n          for (p in keyframes) {\n            p === \"ease\" || p === \"easeEach\" || _parseKeyframe(p, keyframes[p], copy, keyframes.easeEach);\n          }\n\n          for (p in copy) {\n            a = copy[p].sort(function (a, b) {\n              return a.t - b.t;\n            });\n            time = 0;\n\n            for (i = 0; i < a.length; i++) {\n              kf = a[i];\n              v = {\n                ease: kf.e,\n                duration: (kf.t - (i ? a[i - 1].t : 0)) / 100 * duration\n              };\n              v[p] = kf.v;\n              tl.to(parsedTargets, v, time);\n              time += v.duration;\n            }\n          }\n\n          tl.duration() < duration && tl.to({}, {\n            duration: duration - tl.duration()\n          }); // in case keyframes didn't go to 100%\n        }\n      }\n\n      duration || _this3.duration(duration = tl.duration());\n    } else {\n      _this3.timeline = 0; //speed optimization, faster lookups (no going up the prototype chain)\n    }\n\n    if (overwrite === true && !_suppressOverwrites) {\n      _overwritingTween = _assertThisInitialized(_this3);\n\n      _globalTimeline.killTweensOf(parsedTargets);\n\n      _overwritingTween = 0;\n    }\n\n    _addToTimeline(parent, _assertThisInitialized(_this3), position);\n\n    vars.reversed && _this3.reverse();\n    vars.paused && _this3.paused(true);\n\n    if (immediateRender || !duration && !keyframes && _this3._start === _roundPrecise(parent._time) && _isNotFalse(immediateRender) && _hasNoPausedAncestors(_assertThisInitialized(_this3)) && parent.data !== \"nested\") {\n      _this3._tTime = -_tinyNum; //forces a render without having to set the render() \"force\" parameter to true because we want to allow lazying by default (using the \"force\" parameter always forces an immediate full render)\n\n      _this3.render(Math.max(0, -delay)); //in case delay is negative\n\n    }\n\n    scrollTrigger && _scrollTrigger(_assertThisInitialized(_this3), scrollTrigger);\n    return _this3;\n  }\n\n  var _proto3 = Tween.prototype;\n\n  _proto3.render = function render(totalTime, suppressEvents, force) {\n    var prevTime = this._time,\n        tDur = this._tDur,\n        dur = this._dur,\n        tTime = totalTime > tDur - _tinyNum && totalTime >= 0 ? tDur : totalTime < _tinyNum ? 0 : totalTime,\n        time,\n        pt,\n        iteration,\n        cycleDuration,\n        prevIteration,\n        isYoyo,\n        ratio,\n        timeline,\n        yoyoEase;\n\n    if (!dur) {\n      _renderZeroDurationTween(this, totalTime, suppressEvents, force);\n    } else if (tTime !== this._tTime || !totalTime || force || !this._initted && this._tTime || this._startAt && this._zTime < 0 !== totalTime < 0) {\n      //this senses if we're crossing over the start time, in which case we must record _zTime and force the render, but we do it in this lengthy conditional way for performance reasons (usually we can skip the calculations): this._initted && (this._zTime < 0) !== (totalTime < 0)\n      time = tTime;\n      timeline = this.timeline;\n\n      if (this._repeat) {\n        //adjust the time for repeats and yoyos\n        cycleDuration = dur + this._rDelay;\n\n        if (this._repeat < -1 && totalTime < 0) {\n          return this.totalTime(cycleDuration * 100 + totalTime, suppressEvents, force);\n        }\n\n        time = _roundPrecise(tTime % cycleDuration); //round to avoid floating point errors. (4 % 0.8 should be 0 but some browsers report it as 0.79999999!)\n\n        if (tTime === tDur) {\n          // the tDur === tTime is for edge cases where there's a lengthy decimal on the duration and it may reach the very end but the time is rendered as not-quite-there (remember, tDur is rounded to 4 decimals whereas dur isn't)\n          iteration = this._repeat;\n          time = dur;\n        } else {\n          iteration = ~~(tTime / cycleDuration);\n\n          if (iteration && iteration === tTime / cycleDuration) {\n            time = dur;\n            iteration--;\n          }\n\n          time > dur && (time = dur);\n        }\n\n        isYoyo = this._yoyo && iteration & 1;\n\n        if (isYoyo) {\n          yoyoEase = this._yEase;\n          time = dur - time;\n        }\n\n        prevIteration = _animationCycle(this._tTime, cycleDuration);\n\n        if (time === prevTime && !force && this._initted) {\n          //could be during the repeatDelay part. No need to render and fire callbacks.\n          return this;\n        }\n\n        if (iteration !== prevIteration) {\n          timeline && this._yEase && _propagateYoyoEase(timeline, isYoyo); //repeatRefresh functionality\n\n          if (this.vars.repeatRefresh && !isYoyo && !this._lock) {\n            this._lock = force = 1; //force, otherwise if lazy is true, the _attemptInitTween() will return and we'll jump out and get caught bouncing on each tick.\n\n            this.render(_roundPrecise(cycleDuration * iteration), true).invalidate()._lock = 0;\n          }\n        }\n      }\n\n      if (!this._initted) {\n        if (_attemptInitTween(this, totalTime < 0 ? totalTime : time, force, suppressEvents)) {\n          this._tTime = 0; // in constructor if immediateRender is true, we set _tTime to -_tinyNum to have the playhead cross the starting point but we can't leave _tTime as a negative number.\n\n          return this;\n        }\n\n        if (dur !== this._dur) {\n          // while initting, a plugin like InertiaPlugin might alter the duration, so rerun from the start to ensure everything renders as it should.\n          return this.render(totalTime, suppressEvents, force);\n        }\n      }\n\n      this._tTime = tTime;\n      this._time = time;\n\n      if (!this._act && this._ts) {\n        this._act = 1; //as long as it's not paused, force it to be active so that if the user renders independent of the parent timeline, it'll be forced to re-render on the next tick.\n\n        this._lazy = 0;\n      }\n\n      this.ratio = ratio = (yoyoEase || this._ease)(time / dur);\n\n      if (this._from) {\n        this.ratio = ratio = 1 - ratio;\n      }\n\n      if (time && !prevTime && !suppressEvents) {\n        _callback(this, \"onStart\");\n\n        if (this._tTime !== tTime) {\n          // in case the onStart triggered a render at a different spot, eject. Like if someone did animation.pause(0.5) or something inside the onStart.\n          return this;\n        }\n      }\n\n      pt = this._pt;\n\n      while (pt) {\n        pt.r(ratio, pt.d);\n        pt = pt._next;\n      }\n\n      timeline && timeline.render(totalTime < 0 ? totalTime : !time && isYoyo ? -_tinyNum : timeline._dur * timeline._ease(time / this._dur), suppressEvents, force) || this._startAt && (this._zTime = totalTime);\n\n      if (this._onUpdate && !suppressEvents) {\n        totalTime < 0 && this._startAt && this._startAt.render(totalTime, true, force); //note: for performance reasons, we tuck this conditional logic inside less traveled areas (most tweens don't have an onUpdate). We'd just have it at the end before the onComplete, but the values should be updated before any onUpdate is called, so we ALSO put it here and then if it's not called, we do so later near the onComplete.\n\n        _callback(this, \"onUpdate\");\n      }\n\n      this._repeat && iteration !== prevIteration && this.vars.onRepeat && !suppressEvents && this.parent && _callback(this, \"onRepeat\");\n\n      if ((tTime === this._tDur || !tTime) && this._tTime === tTime) {\n        totalTime < 0 && this._startAt && !this._onUpdate && this._startAt.render(totalTime, true, true);\n        (totalTime || !dur) && (tTime === this._tDur && this._ts > 0 || !tTime && this._ts < 0) && _removeFromParent(this, 1); // don't remove if we're rendering at exactly a time of 0, as there could be autoRevert values that should get set on the next tick (if the playhead goes backward beyond the startTime, negative totalTime). Don't remove if the timeline is reversed and the playhead isn't at 0, otherwise tl.progress(1).reverse() won't work. Only remove if the playhead is at the end and timeScale is positive, or if the playhead is at 0 and the timeScale is negative.\n\n        if (!suppressEvents && !(totalTime < 0 && !prevTime) && (tTime || prevTime)) {\n          // if prevTime and tTime are zero, we shouldn't fire the onReverseComplete. This could happen if you gsap.to(... {paused:true}).play();\n          _callback(this, tTime === tDur ? \"onComplete\" : \"onReverseComplete\", true);\n\n          this._prom && !(tTime < tDur && this.timeScale() > 0) && this._prom();\n        }\n      }\n    }\n\n    return this;\n  };\n\n  _proto3.targets = function targets() {\n    return this._targets;\n  };\n\n  _proto3.invalidate = function invalidate() {\n    this._pt = this._op = this._startAt = this._onUpdate = this._lazy = this.ratio = 0;\n    this._ptLookup = [];\n    this.timeline && this.timeline.invalidate();\n    return _Animation2.prototype.invalidate.call(this);\n  };\n\n  _proto3.kill = function kill(targets, vars) {\n    if (vars === void 0) {\n      vars = \"all\";\n    }\n\n    if (!targets && (!vars || vars === \"all\")) {\n      this._lazy = this._pt = 0;\n      return this.parent ? _interrupt(this) : this;\n    }\n\n    if (this.timeline) {\n      var tDur = this.timeline.totalDuration();\n      this.timeline.killTweensOf(targets, vars, _overwritingTween && _overwritingTween.vars.overwrite !== true)._first || _interrupt(this); // if nothing is left tweening, interrupt.\n\n      this.parent && tDur !== this.timeline.totalDuration() && _setDuration(this, this._dur * this.timeline._tDur / tDur, 0, 1); // if a nested tween is killed that changes the duration, it should affect this tween's duration. We must use the ratio, though, because sometimes the internal timeline is stretched like for keyframes where they don't all add up to whatever the parent tween's duration was set to.\n\n      return this;\n    }\n\n    var parsedTargets = this._targets,\n        killingTargets = targets ? toArray(targets) : parsedTargets,\n        propTweenLookup = this._ptLookup,\n        firstPT = this._pt,\n        overwrittenProps,\n        curLookup,\n        curOverwriteProps,\n        props,\n        p,\n        pt,\n        i;\n\n    if ((!vars || vars === \"all\") && _arraysMatch(parsedTargets, killingTargets)) {\n      vars === \"all\" && (this._pt = 0);\n      return _interrupt(this);\n    }\n\n    overwrittenProps = this._op = this._op || [];\n\n    if (vars !== \"all\") {\n      //so people can pass in a comma-delimited list of property names\n      if (_isString(vars)) {\n        p = {};\n\n        _forEachName(vars, function (name) {\n          return p[name] = 1;\n        });\n\n        vars = p;\n      }\n\n      vars = _addAliasesToVars(parsedTargets, vars);\n    }\n\n    i = parsedTargets.length;\n\n    while (i--) {\n      if (~killingTargets.indexOf(parsedTargets[i])) {\n        curLookup = propTweenLookup[i];\n\n        if (vars === \"all\") {\n          overwrittenProps[i] = vars;\n          props = curLookup;\n          curOverwriteProps = {};\n        } else {\n          curOverwriteProps = overwrittenProps[i] = overwrittenProps[i] || {};\n          props = vars;\n        }\n\n        for (p in props) {\n          pt = curLookup && curLookup[p];\n\n          if (pt) {\n            if (!(\"kill\" in pt.d) || pt.d.kill(p) === true) {\n              _removeLinkedListItem(this, pt, \"_pt\");\n            }\n\n            delete curLookup[p];\n          }\n\n          if (curOverwriteProps !== \"all\") {\n            curOverwriteProps[p] = 1;\n          }\n        }\n      }\n    }\n\n    this._initted && !this._pt && firstPT && _interrupt(this); //if all tweening properties are killed, kill the tween. Without this line, if there's a tween with multiple targets and then you killTweensOf() each target individually, the tween would technically still remain active and fire its onComplete even though there aren't any more properties tweening.\n\n    return this;\n  };\n\n  Tween.to = function to(targets, vars) {\n    return new Tween(targets, vars, arguments[2]);\n  };\n\n  Tween.from = function from(targets, vars) {\n    return _createTweenType(1, arguments);\n  };\n\n  Tween.delayedCall = function delayedCall(delay, callback, params, scope) {\n    return new Tween(callback, 0, {\n      immediateRender: false,\n      lazy: false,\n      overwrite: false,\n      delay: delay,\n      onComplete: callback,\n      onReverseComplete: callback,\n      onCompleteParams: params,\n      onReverseCompleteParams: params,\n      callbackScope: scope\n    });\n  };\n\n  Tween.fromTo = function fromTo(targets, fromVars, toVars) {\n    return _createTweenType(2, arguments);\n  };\n\n  Tween.set = function set(targets, vars) {\n    vars.duration = 0;\n    vars.repeatDelay || (vars.repeat = 0);\n    return new Tween(targets, vars);\n  };\n\n  Tween.killTweensOf = function killTweensOf(targets, props, onlyActive) {\n    return _globalTimeline.killTweensOf(targets, props, onlyActive);\n  };\n\n  return Tween;\n}(Animation);\n\n_setDefaults(Tween.prototype, {\n  _targets: [],\n  _lazy: 0,\n  _startAt: 0,\n  _op: 0,\n  _onInit: 0\n}); //add the pertinent timeline methods to Tween instances so that users can chain conveniently and create a timeline automatically. (removed due to concerns that it'd ultimately add to more confusion especially for beginners)\n// _forEachName(\"to,from,fromTo,set,call,add,addLabel,addPause\", name => {\n// \tTween.prototype[name] = function() {\n// \t\tlet tl = new Timeline();\n// \t\treturn _addToTimeline(tl, this)[name].apply(tl, toArray(arguments));\n// \t}\n// });\n//for backward compatibility. Leverage the timeline calls.\n\n\n_forEachName(\"staggerTo,staggerFrom,staggerFromTo\", function (name) {\n  Tween[name] = function () {\n    var tl = new Timeline(),\n        params = _slice.call(arguments, 0);\n\n    params.splice(name === \"staggerFromTo\" ? 5 : 4, 0, 0);\n    return tl[name].apply(tl, params);\n  };\n});\n/*\n * --------------------------------------------------------------------------------------\n * PROPTWEEN\n * --------------------------------------------------------------------------------------\n */\n\n\nvar _setterPlain = function _setterPlain(target, property, value) {\n  return target[property] = value;\n},\n    _setterFunc = function _setterFunc(target, property, value) {\n  return target[property](value);\n},\n    _setterFuncWithParam = function _setterFuncWithParam(target, property, value, data) {\n  return target[property](data.fp, value);\n},\n    _setterAttribute = function _setterAttribute(target, property, value) {\n  return target.setAttribute(property, value);\n},\n    _getSetter = function _getSetter(target, property) {\n  return _isFunction(target[property]) ? _setterFunc : _isUndefined(target[property]) && target.setAttribute ? _setterAttribute : _setterPlain;\n},\n    _renderPlain = function _renderPlain(ratio, data) {\n  return data.set(data.t, data.p, Math.round((data.s + data.c * ratio) * 1000000) / 1000000, data);\n},\n    _renderBoolean = function _renderBoolean(ratio, data) {\n  return data.set(data.t, data.p, !!(data.s + data.c * ratio), data);\n},\n    _renderComplexString = function _renderComplexString(ratio, data) {\n  var pt = data._pt,\n      s = \"\";\n\n  if (!ratio && data.b) {\n    //b = beginning string\n    s = data.b;\n  } else if (ratio === 1 && data.e) {\n    //e = ending string\n    s = data.e;\n  } else {\n    while (pt) {\n      s = pt.p + (pt.m ? pt.m(pt.s + pt.c * ratio) : Math.round((pt.s + pt.c * ratio) * 10000) / 10000) + s; //we use the \"p\" property for the text inbetween (like a suffix). And in the context of a complex string, the modifier (m) is typically just Math.round(), like for RGB colors.\n\n      pt = pt._next;\n    }\n\n    s += data.c; //we use the \"c\" of the PropTween to store the final chunk of non-numeric text.\n  }\n\n  data.set(data.t, data.p, s, data);\n},\n    _renderPropTweens = function _renderPropTweens(ratio, data) {\n  var pt = data._pt;\n\n  while (pt) {\n    pt.r(ratio, pt.d);\n    pt = pt._next;\n  }\n},\n    _addPluginModifier = function _addPluginModifier(modifier, tween, target, property) {\n  var pt = this._pt,\n      next;\n\n  while (pt) {\n    next = pt._next;\n    pt.p === property && pt.modifier(modifier, tween, target);\n    pt = next;\n  }\n},\n    _killPropTweensOf = function _killPropTweensOf(property) {\n  var pt = this._pt,\n      hasNonDependentRemaining,\n      next;\n\n  while (pt) {\n    next = pt._next;\n\n    if (pt.p === property && !pt.op || pt.op === property) {\n      _removeLinkedListItem(this, pt, \"_pt\");\n    } else if (!pt.dep) {\n      hasNonDependentRemaining = 1;\n    }\n\n    pt = next;\n  }\n\n  return !hasNonDependentRemaining;\n},\n    _setterWithModifier = function _setterWithModifier(target, property, value, data) {\n  data.mSet(target, property, data.m.call(data.tween, value, data.mt), data);\n},\n    _sortPropTweensByPriority = function _sortPropTweensByPriority(parent) {\n  var pt = parent._pt,\n      next,\n      pt2,\n      first,\n      last; //sorts the PropTween linked list in order of priority because some plugins need to do their work after ALL of the PropTweens were created (like RoundPropsPlugin and ModifiersPlugin)\n\n  while (pt) {\n    next = pt._next;\n    pt2 = first;\n\n    while (pt2 && pt2.pr > pt.pr) {\n      pt2 = pt2._next;\n    }\n\n    if (pt._prev = pt2 ? pt2._prev : last) {\n      pt._prev._next = pt;\n    } else {\n      first = pt;\n    }\n\n    if (pt._next = pt2) {\n      pt2._prev = pt;\n    } else {\n      last = pt;\n    }\n\n    pt = next;\n  }\n\n  parent._pt = first;\n}; //PropTween key: t = target, p = prop, r = renderer, d = data, s = start, c = change, op = overwriteProperty (ONLY populated when it's different than p), pr = priority, _next/_prev for the linked list siblings, set = setter, m = modifier, mSet = modifierSetter (the original setter, before a modifier was added)\n\n\nexport var PropTween = /*#__PURE__*/function () {\n  function PropTween(next, target, prop, start, change, renderer, data, setter, priority) {\n    this.t = target;\n    this.s = start;\n    this.c = change;\n    this.p = prop;\n    this.r = renderer || _renderPlain;\n    this.d = data || this;\n    this.set = setter || _setterPlain;\n    this.pr = priority || 0;\n    this._next = next;\n\n    if (next) {\n      next._prev = this;\n    }\n  }\n\n  var _proto4 = PropTween.prototype;\n\n  _proto4.modifier = function modifier(func, tween, target) {\n    this.mSet = this.mSet || this.set; //in case it was already set (a PropTween can only have one modifier)\n\n    this.set = _setterWithModifier;\n    this.m = func;\n    this.mt = target; //modifier target\n\n    this.tween = tween;\n  };\n\n  return PropTween;\n}(); //Initialization tasks\n\n_forEachName(_callbackNames + \"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger\", function (name) {\n  return _reservedProps[name] = 1;\n});\n\n_globals.TweenMax = _globals.TweenLite = Tween;\n_globals.TimelineLite = _globals.TimelineMax = Timeline;\n_globalTimeline = new Timeline({\n  sortChildren: false,\n  defaults: _defaults,\n  autoRemoveChildren: true,\n  id: \"root\",\n  smoothChildTiming: true\n});\n_config.stringFilter = _colorStringFilter;\n/*\n * --------------------------------------------------------------------------------------\n * GSAP\n * --------------------------------------------------------------------------------------\n */\n\nvar _gsap = {\n  registerPlugin: function registerPlugin() {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    args.forEach(function (config) {\n      return _createPlugin(config);\n    });\n  },\n  timeline: function timeline(vars) {\n    return new Timeline(vars);\n  },\n  getTweensOf: function getTweensOf(targets, onlyActive) {\n    return _globalTimeline.getTweensOf(targets, onlyActive);\n  },\n  getProperty: function getProperty(target, property, unit, uncache) {\n    _isString(target) && (target = toArray(target)[0]); //in case selector text or an array is passed in\n\n    var getter = _getCache(target || {}).get,\n        format = unit ? _passThrough : _numericIfPossible;\n\n    unit === \"native\" && (unit = \"\");\n    return !target ? target : !property ? function (property, unit, uncache) {\n      return format((_plugins[property] && _plugins[property].get || getter)(target, property, unit, uncache));\n    } : format((_plugins[property] && _plugins[property].get || getter)(target, property, unit, uncache));\n  },\n  quickSetter: function quickSetter(target, property, unit) {\n    target = toArray(target);\n\n    if (target.length > 1) {\n      var setters = target.map(function (t) {\n        return gsap.quickSetter(t, property, unit);\n      }),\n          l = setters.length;\n      return function (value) {\n        var i = l;\n\n        while (i--) {\n          setters[i](value);\n        }\n      };\n    }\n\n    target = target[0] || {};\n\n    var Plugin = _plugins[property],\n        cache = _getCache(target),\n        p = cache.harness && (cache.harness.aliases || {})[property] || property,\n        // in case it's an alias, like \"rotate\" for \"rotation\".\n    setter = Plugin ? function (value) {\n      var p = new Plugin();\n      _quickTween._pt = 0;\n      p.init(target, unit ? value + unit : value, _quickTween, 0, [target]);\n      p.render(1, p);\n      _quickTween._pt && _renderPropTweens(1, _quickTween);\n    } : cache.set(target, p);\n\n    return Plugin ? setter : function (value) {\n      return setter(target, p, unit ? value + unit : value, cache, 1);\n    };\n  },\n  isTweening: function isTweening(targets) {\n    return _globalTimeline.getTweensOf(targets, true).length > 0;\n  },\n  defaults: function defaults(value) {\n    value && value.ease && (value.ease = _parseEase(value.ease, _defaults.ease));\n    return _mergeDeep(_defaults, value || {});\n  },\n  config: function config(value) {\n    return _mergeDeep(_config, value || {});\n  },\n  registerEffect: function registerEffect(_ref3) {\n    var name = _ref3.name,\n        effect = _ref3.effect,\n        plugins = _ref3.plugins,\n        defaults = _ref3.defaults,\n        extendTimeline = _ref3.extendTimeline;\n    (plugins || \"\").split(\",\").forEach(function (pluginName) {\n      return pluginName && !_plugins[pluginName] && !_globals[pluginName] && _warn(name + \" effect requires \" + pluginName + \" plugin.\");\n    });\n\n    _effects[name] = function (targets, vars, tl) {\n      return effect(toArray(targets), _setDefaults(vars || {}, defaults), tl);\n    };\n\n    if (extendTimeline) {\n      Timeline.prototype[name] = function (targets, vars, position) {\n        return this.add(_effects[name](targets, _isObject(vars) ? vars : (position = vars) && {}, this), position);\n      };\n    }\n  },\n  registerEase: function registerEase(name, ease) {\n    _easeMap[name] = _parseEase(ease);\n  },\n  parseEase: function parseEase(ease, defaultEase) {\n    return arguments.length ? _parseEase(ease, defaultEase) : _easeMap;\n  },\n  getById: function getById(id) {\n    return _globalTimeline.getById(id);\n  },\n  exportRoot: function exportRoot(vars, includeDelayedCalls) {\n    if (vars === void 0) {\n      vars = {};\n    }\n\n    var tl = new Timeline(vars),\n        child,\n        next;\n    tl.smoothChildTiming = _isNotFalse(vars.smoothChildTiming);\n\n    _globalTimeline.remove(tl);\n\n    tl._dp = 0; //otherwise it'll get re-activated when adding children and be re-introduced into _globalTimeline's linked list (then added to itself).\n\n    tl._time = tl._tTime = _globalTimeline._time;\n    child = _globalTimeline._first;\n\n    while (child) {\n      next = child._next;\n\n      if (includeDelayedCalls || !(!child._dur && child instanceof Tween && child.vars.onComplete === child._targets[0])) {\n        _addToTimeline(tl, child, child._start - child._delay);\n      }\n\n      child = next;\n    }\n\n    _addToTimeline(_globalTimeline, tl, 0);\n\n    return tl;\n  },\n  utils: {\n    wrap: wrap,\n    wrapYoyo: wrapYoyo,\n    distribute: distribute,\n    random: random,\n    snap: snap,\n    normalize: normalize,\n    getUnit: getUnit,\n    clamp: clamp,\n    splitColor: splitColor,\n    toArray: toArray,\n    selector: selector,\n    mapRange: mapRange,\n    pipe: pipe,\n    unitize: unitize,\n    interpolate: interpolate,\n    shuffle: shuffle\n  },\n  install: _install,\n  effects: _effects,\n  ticker: _ticker,\n  updateRoot: Timeline.updateRoot,\n  plugins: _plugins,\n  globalTimeline: _globalTimeline,\n  core: {\n    PropTween: PropTween,\n    globals: _addGlobal,\n    Tween: Tween,\n    Timeline: Timeline,\n    Animation: Animation,\n    getCache: _getCache,\n    _removeLinkedListItem: _removeLinkedListItem,\n    suppressOverwrites: function suppressOverwrites(value) {\n      return _suppressOverwrites = value;\n    }\n  }\n};\n\n_forEachName(\"to,from,fromTo,delayedCall,set,killTweensOf\", function (name) {\n  return _gsap[name] = Tween[name];\n});\n\n_ticker.add(Timeline.updateRoot);\n\n_quickTween = _gsap.to({}, {\n  duration: 0\n}); // ---- EXTRA PLUGINS --------------------------------------------------------\n\nvar _getPluginPropTween = function _getPluginPropTween(plugin, prop) {\n  var pt = plugin._pt;\n\n  while (pt && pt.p !== prop && pt.op !== prop && pt.fp !== prop) {\n    pt = pt._next;\n  }\n\n  return pt;\n},\n    _addModifiers = function _addModifiers(tween, modifiers) {\n  var targets = tween._targets,\n      p,\n      i,\n      pt;\n\n  for (p in modifiers) {\n    i = targets.length;\n\n    while (i--) {\n      pt = tween._ptLookup[i][p];\n\n      if (pt && (pt = pt.d)) {\n        if (pt._pt) {\n          // is a plugin\n          pt = _getPluginPropTween(pt, p);\n        }\n\n        pt && pt.modifier && pt.modifier(modifiers[p], tween, targets[i], p);\n      }\n    }\n  }\n},\n    _buildModifierPlugin = function _buildModifierPlugin(name, modifier) {\n  return {\n    name: name,\n    rawVars: 1,\n    //don't pre-process function-based values or \"random()\" strings.\n    init: function init(target, vars, tween) {\n      tween._onInit = function (tween) {\n        var temp, p;\n\n        if (_isString(vars)) {\n          temp = {};\n\n          _forEachName(vars, function (name) {\n            return temp[name] = 1;\n          }); //if the user passes in a comma-delimited list of property names to roundProps, like \"x,y\", we round to whole numbers.\n\n\n          vars = temp;\n        }\n\n        if (modifier) {\n          temp = {};\n\n          for (p in vars) {\n            temp[p] = modifier(vars[p]);\n          }\n\n          vars = temp;\n        }\n\n        _addModifiers(tween, vars);\n      };\n    }\n  };\n}; //register core plugins\n\n\nexport var gsap = _gsap.registerPlugin({\n  name: \"attr\",\n  init: function init(target, vars, tween, index, targets) {\n    var p, pt;\n\n    for (p in vars) {\n      pt = this.add(target, \"setAttribute\", (target.getAttribute(p) || 0) + \"\", vars[p], index, targets, 0, 0, p);\n      pt && (pt.op = p);\n\n      this._props.push(p);\n    }\n  }\n}, {\n  name: \"endArray\",\n  init: function init(target, value) {\n    var i = value.length;\n\n    while (i--) {\n      this.add(target, i, target[i] || 0, value[i]);\n    }\n  }\n}, _buildModifierPlugin(\"roundProps\", _roundModifier), _buildModifierPlugin(\"modifiers\"), _buildModifierPlugin(\"snap\", snap)) || _gsap; //to prevent the core plugins from being dropped via aggressive tree shaking, we must include them in the variable declaration in this way.\n\nTween.version = Timeline.version = gsap.version = \"3.9.1\";\n_coreReady = 1;\n_windowExists() && _wake();\nvar Power0 = _easeMap.Power0,\n    Power1 = _easeMap.Power1,\n    Power2 = _easeMap.Power2,\n    Power3 = _easeMap.Power3,\n    Power4 = _easeMap.Power4,\n    Linear = _easeMap.Linear,\n    Quad = _easeMap.Quad,\n    Cubic = _easeMap.Cubic,\n    Quart = _easeMap.Quart,\n    Quint = _easeMap.Quint,\n    Strong = _easeMap.Strong,\n    Elastic = _easeMap.Elastic,\n    Back = _easeMap.Back,\n    SteppedEase = _easeMap.SteppedEase,\n    Bounce = _easeMap.Bounce,\n    Sine = _easeMap.Sine,\n    Expo = _easeMap.Expo,\n    Circ = _easeMap.Circ;\nexport { Power0, Power1, Power2, Power3, Power4, Linear, Quad, Cubic, Quart, Quint, Strong, Elastic, Back, SteppedEase, Bounce, Sine, Expo, Circ };\nexport { Tween as TweenMax, Tween as TweenLite, Timeline as TimelineMax, Timeline as TimelineLite, gsap as default, wrap, wrapYoyo, distribute, random, snap, normalize, getUnit, clamp, splitColor, toArray, selector, mapRange, pipe, unitize, interpolate, shuffle }; //export some internal methods/orojects for use in CSSPlugin so that we can externalize that file and allow custom builds that exclude it.\n\nexport { _getProperty, _numExp, _numWithUnitExp, _isString, _isUndefined, _renderComplexString, _relExp, _setDefaults, _removeLinkedListItem, _forEachName, _sortPropTweensByPriority, _colorStringFilter, _replaceRandom, _checkPlugin, _plugins, _ticker, _config, _roundModifier, _round, _missingPlugin, _getSetter, _getCache, _colorExp };"]}]}